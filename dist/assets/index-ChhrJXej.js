function eS(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in n)){const d=Object.getOwnPropertyDescriptor(r,a);d&&Object.defineProperty(n,a,d.get?d:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const d of a)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function t(a){const d={};return a.integrity&&(d.integrity=a.integrity),a.referrerPolicy&&(d.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?d.credentials="include":a.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function r(a){if(a.ep)return;a.ep=!0;const d=t(a);fetch(a.href,d)}})();var Rw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function W1(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var uv={exports:{}},rd={},dv={exports:{}},ut={};var jw;function tS(){if(jw)return ut;jw=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),h=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),_=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),T=Symbol.iterator;function k(R){return R===null||typeof R!="object"?null:(R=T&&R[T]||R["@@iterator"],typeof R=="function"?R:null)}var $={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,F={};function H(R,q,se){this.props=R,this.context=q,this.refs=F,this.updater=se||$}H.prototype.isReactComponent={},H.prototype.setState=function(R,q){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,q,"setState")},H.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function ye(){}ye.prototype=H.prototype;function le(R,q,se){this.props=R,this.context=q,this.refs=F,this.updater=se||$}var C=le.prototype=new ye;C.constructor=le,M(C,H.prototype),C.isPureReactComponent=!0;var ie=Array.isArray,c=Object.prototype.hasOwnProperty,ze={current:null},de={key:!0,ref:!0,__self:!0,__source:!0};function Ie(R,q,se){var ve,Re={},je=null,qe=null;if(q!=null)for(ve in q.ref!==void 0&&(qe=q.ref),q.key!==void 0&&(je=""+q.key),q)c.call(q,ve)&&!de.hasOwnProperty(ve)&&(Re[ve]=q[ve]);var Be=arguments.length-2;if(Be===1)Re.children=se;else if(1<Be){for(var Ze=Array(Be),gt=0;gt<Be;gt++)Ze[gt]=arguments[gt+2];Re.children=Ze}if(R&&R.defaultProps)for(ve in Be=R.defaultProps,Be)Re[ve]===void 0&&(Re[ve]=Be[ve]);return{$$typeof:n,type:R,key:je,ref:qe,props:Re,_owner:ze.current}}function Je(R,q){return{$$typeof:n,type:R.type,key:q,ref:R.ref,props:R.props,_owner:R._owner}}function Qe(R){return typeof R=="object"&&R!==null&&R.$$typeof===n}function Ve(R){var q={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(se){return q[se]})}var $e=/\/+/g;function be(R,q){return typeof R=="object"&&R!==null&&R.key!=null?Ve(""+R.key):q.toString(36)}function te(R,q,se,ve,Re){var je=typeof R;(je==="undefined"||je==="boolean")&&(R=null);var qe=!1;if(R===null)qe=!0;else switch(je){case"string":case"number":qe=!0;break;case"object":switch(R.$$typeof){case n:case e:qe=!0}}if(qe)return qe=R,Re=Re(qe),R=ve===""?"."+be(qe,0):ve,ie(Re)?(se="",R!=null&&(se=R.replace($e,"$&/")+"/"),te(Re,q,se,"",function(gt){return gt})):Re!=null&&(Qe(Re)&&(Re=Je(Re,se+(!Re.key||qe&&qe.key===Re.key?"":(""+Re.key).replace($e,"$&/")+"/")+R)),q.push(Re)),1;if(qe=0,ve=ve===""?".":ve+":",ie(R))for(var Be=0;Be<R.length;Be++){je=R[Be];var Ze=ve+be(je,Be);qe+=te(je,q,se,Ze,Re)}else if(Ze=k(R),typeof Ze=="function")for(R=Ze.call(R),Be=0;!(je=R.next()).done;)je=je.value,Ze=ve+be(je,Be++),qe+=te(je,q,se,Ze,Re);else if(je==="object")throw q=String(R),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.");return qe}function ee(R,q,se){if(R==null)return R;var ve=[],Re=0;return te(R,ve,"","",function(je){return q.call(se,je,Re++)}),ve}function Y(R){if(R._status===-1){var q=R._result;q=q(),q.then(function(se){(R._status===0||R._status===-1)&&(R._status=1,R._result=se)},function(se){(R._status===0||R._status===-1)&&(R._status=2,R._result=se)}),R._status===-1&&(R._status=0,R._result=q)}if(R._status===1)return R._result.default;throw R._result}var we={current:null},ne={transition:null},X={ReactCurrentDispatcher:we,ReactCurrentBatchConfig:ne,ReactCurrentOwner:ze};function ce(){throw Error("act(...) is not supported in production builds of React.")}return ut.Children={map:ee,forEach:function(R,q,se){ee(R,function(){q.apply(this,arguments)},se)},count:function(R){var q=0;return ee(R,function(){q++}),q},toArray:function(R){return ee(R,function(q){return q})||[]},only:function(R){if(!Qe(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},ut.Component=H,ut.Fragment=t,ut.Profiler=a,ut.PureComponent=le,ut.StrictMode=r,ut.Suspense=y,ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,ut.act=ce,ut.cloneElement=function(R,q,se){if(R==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+R+".");var ve=M({},R.props),Re=R.key,je=R.ref,qe=R._owner;if(q!=null){if(q.ref!==void 0&&(je=q.ref,qe=ze.current),q.key!==void 0&&(Re=""+q.key),R.type&&R.type.defaultProps)var Be=R.type.defaultProps;for(Ze in q)c.call(q,Ze)&&!de.hasOwnProperty(Ze)&&(ve[Ze]=q[Ze]===void 0&&Be!==void 0?Be[Ze]:q[Ze])}var Ze=arguments.length-2;if(Ze===1)ve.children=se;else if(1<Ze){Be=Array(Ze);for(var gt=0;gt<Ze;gt++)Be[gt]=arguments[gt+2];ve.children=Be}return{$$typeof:n,type:R.type,key:Re,ref:je,props:ve,_owner:qe}},ut.createContext=function(R){return R={$$typeof:h,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},R.Provider={$$typeof:d,_context:R},R.Consumer=R},ut.createElement=Ie,ut.createFactory=function(R){var q=Ie.bind(null,R);return q.type=R,q},ut.createRef=function(){return{current:null}},ut.forwardRef=function(R){return{$$typeof:g,render:R}},ut.isValidElement=Qe,ut.lazy=function(R){return{$$typeof:N,_payload:{_status:-1,_result:R},_init:Y}},ut.memo=function(R,q){return{$$typeof:_,type:R,compare:q===void 0?null:q}},ut.startTransition=function(R){var q=ne.transition;ne.transition={};try{R()}finally{ne.transition=q}},ut.unstable_act=ce,ut.useCallback=function(R,q){return we.current.useCallback(R,q)},ut.useContext=function(R){return we.current.useContext(R)},ut.useDebugValue=function(){},ut.useDeferredValue=function(R){return we.current.useDeferredValue(R)},ut.useEffect=function(R,q){return we.current.useEffect(R,q)},ut.useId=function(){return we.current.useId()},ut.useImperativeHandle=function(R,q,se){return we.current.useImperativeHandle(R,q,se)},ut.useInsertionEffect=function(R,q){return we.current.useInsertionEffect(R,q)},ut.useLayoutEffect=function(R,q){return we.current.useLayoutEffect(R,q)},ut.useMemo=function(R,q){return we.current.useMemo(R,q)},ut.useReducer=function(R,q,se){return we.current.useReducer(R,q,se)},ut.useRef=function(R){return we.current.useRef(R)},ut.useState=function(R){return we.current.useState(R)},ut.useSyncExternalStore=function(R,q,se){return we.current.useSyncExternalStore(R,q,se)},ut.useTransition=function(){return we.current.useTransition()},ut.version="18.3.1",ut}var $w;function Cm(){return $w||($w=1,dv.exports=tS()),dv.exports}var Ow;function nS(){if(Ow)return rd;Ow=1;var n=Cm(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function h(g,y,_){var N,T={},k=null,$=null;_!==void 0&&(k=""+_),y.key!==void 0&&(k=""+y.key),y.ref!==void 0&&($=y.ref);for(N in y)r.call(y,N)&&!d.hasOwnProperty(N)&&(T[N]=y[N]);if(g&&g.defaultProps)for(N in y=g.defaultProps,y)T[N]===void 0&&(T[N]=y[N]);return{$$typeof:e,type:g,key:k,ref:$,props:T,_owner:a.current}}return rd.Fragment=t,rd.jsx=h,rd.jsxs=h,rd}var Mw;function sS(){return Mw||(Mw=1,uv.exports=nS()),uv.exports}var p=sS(),D=Cm();const V1=W1(D),rS=eS({__proto__:null,default:V1},[D]);var xp={},fv={exports:{}},Ds={},hv={exports:{}},pv={};var Dw;function iS(){return Dw||(Dw=1,(function(n){function e(ne,X){var ce=ne.length;ne.push(X);e:for(;0<ce;){var R=ce-1>>>1,q=ne[R];if(0<a(q,X))ne[R]=X,ne[ce]=q,ce=R;else break e}}function t(ne){return ne.length===0?null:ne[0]}function r(ne){if(ne.length===0)return null;var X=ne[0],ce=ne.pop();if(ce!==X){ne[0]=ce;e:for(var R=0,q=ne.length,se=q>>>1;R<se;){var ve=2*(R+1)-1,Re=ne[ve],je=ve+1,qe=ne[je];if(0>a(Re,ce))je<q&&0>a(qe,Re)?(ne[R]=qe,ne[je]=ce,R=je):(ne[R]=Re,ne[ve]=ce,R=ve);else if(je<q&&0>a(qe,ce))ne[R]=qe,ne[je]=ce,R=je;else break e}}return X}function a(ne,X){var ce=ne.sortIndex-X.sortIndex;return ce!==0?ce:ne.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;n.unstable_now=function(){return d.now()}}else{var h=Date,g=h.now();n.unstable_now=function(){return h.now()-g}}var y=[],_=[],N=1,T=null,k=3,$=!1,M=!1,F=!1,H=typeof setTimeout=="function"?setTimeout:null,ye=typeof clearTimeout=="function"?clearTimeout:null,le=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(ne){for(var X=t(_);X!==null;){if(X.callback===null)r(_);else if(X.startTime<=ne)r(_),X.sortIndex=X.expirationTime,e(y,X);else break;X=t(_)}}function ie(ne){if(F=!1,C(ne),!M)if(t(y)!==null)M=!0,Y(c);else{var X=t(_);X!==null&&we(ie,X.startTime-ne)}}function c(ne,X){M=!1,F&&(F=!1,ye(Ie),Ie=-1),$=!0;var ce=k;try{for(C(X),T=t(y);T!==null&&(!(T.expirationTime>X)||ne&&!Ve());){var R=T.callback;if(typeof R=="function"){T.callback=null,k=T.priorityLevel;var q=R(T.expirationTime<=X);X=n.unstable_now(),typeof q=="function"?T.callback=q:T===t(y)&&r(y),C(X)}else r(y);T=t(y)}if(T!==null)var se=!0;else{var ve=t(_);ve!==null&&we(ie,ve.startTime-X),se=!1}return se}finally{T=null,k=ce,$=!1}}var ze=!1,de=null,Ie=-1,Je=5,Qe=-1;function Ve(){return!(n.unstable_now()-Qe<Je)}function $e(){if(de!==null){var ne=n.unstable_now();Qe=ne;var X=!0;try{X=de(!0,ne)}finally{X?be():(ze=!1,de=null)}}else ze=!1}var be;if(typeof le=="function")be=function(){le($e)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,ee=te.port2;te.port1.onmessage=$e,be=function(){ee.postMessage(null)}}else be=function(){H($e,0)};function Y(ne){de=ne,ze||(ze=!0,be())}function we(ne,X){Ie=H(function(){ne(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ne){ne.callback=null},n.unstable_continueExecution=function(){M||$||(M=!0,Y(c))},n.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Je=0<ne?Math.floor(1e3/ne):5},n.unstable_getCurrentPriorityLevel=function(){return k},n.unstable_getFirstCallbackNode=function(){return t(y)},n.unstable_next=function(ne){switch(k){case 1:case 2:case 3:var X=3;break;default:X=k}var ce=k;k=X;try{return ne()}finally{k=ce}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ne,X){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var ce=k;k=ne;try{return X()}finally{k=ce}},n.unstable_scheduleCallback=function(ne,X,ce){var R=n.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?R+ce:R):ce=R,ne){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=ce+q,ne={id:N++,callback:X,priorityLevel:ne,startTime:ce,expirationTime:q,sortIndex:-1},ce>R?(ne.sortIndex=ce,e(_,ne),t(y)===null&&ne===t(_)&&(F?(ye(Ie),Ie=-1):F=!0,we(ie,ce-R))):(ne.sortIndex=q,e(y,ne),M||$||(M=!0,Y(c))),ne},n.unstable_shouldYield=Ve,n.unstable_wrapCallback=function(ne){var X=k;return function(){var ce=k;k=X;try{return ne.apply(this,arguments)}finally{k=ce}}}})(pv)),pv}var Lw;function oS(){return Lw||(Lw=1,hv.exports=iS()),hv.exports}var Fw;function aS(){if(Fw)return Ds;Fw=1;var n=Cm(),e=oS();function t(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,l=1;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,a={};function d(s,i){h(s,i),h(s+"Capture",i)}function h(s,i){for(a[s]=i,s=0;s<i.length;s++)r.add(i[s])}var g=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),y=Object.prototype.hasOwnProperty,_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,N={},T={};function k(s){return y.call(T,s)?!0:y.call(N,s)?!1:_.test(s)?T[s]=!0:(N[s]=!0,!1)}function $(s,i,l,f){if(l!==null&&l.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return f?!1:l!==null?!l.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function M(s,i,l,f){if(i===null||typeof i>"u"||$(s,i,l,f))return!0;if(f)return!1;if(l!==null)switch(l.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function F(s,i,l,f,v,w,S){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=f,this.attributeNamespace=v,this.mustUseProperty=l,this.propertyName=s,this.type=i,this.sanitizeURL=w,this.removeEmptyString=S}var H={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){H[s]=new F(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];H[i]=new F(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){H[s]=new F(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){H[s]=new F(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){H[s]=new F(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){H[s]=new F(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){H[s]=new F(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){H[s]=new F(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){H[s]=new F(s,5,!1,s.toLowerCase(),null,!1,!1)});var ye=/[\-:]([a-z])/g;function le(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(ye,le);H[i]=new F(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(ye,le);H[i]=new F(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(ye,le);H[i]=new F(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){H[s]=new F(s,1,!1,s.toLowerCase(),null,!1,!1)}),H.xlinkHref=new F("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){H[s]=new F(s,1,!1,s.toLowerCase(),null,!0,!0)});function C(s,i,l,f){var v=H.hasOwnProperty(i)?H[i]:null;(v!==null?v.type!==0:f||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(M(i,l,v,f)&&(l=null),f||v===null?k(i)&&(l===null?s.removeAttribute(i):s.setAttribute(i,""+l)):v.mustUseProperty?s[v.propertyName]=l===null?v.type===3?!1:"":l:(i=v.attributeName,f=v.attributeNamespace,l===null?s.removeAttribute(i):(v=v.type,l=v===3||v===4&&l===!0?"":""+l,f?s.setAttributeNS(f,i,l):s.setAttribute(i,l))))}var ie=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),ze=Symbol.for("react.portal"),de=Symbol.for("react.fragment"),Ie=Symbol.for("react.strict_mode"),Je=Symbol.for("react.profiler"),Qe=Symbol.for("react.provider"),Ve=Symbol.for("react.context"),$e=Symbol.for("react.forward_ref"),be=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),Y=Symbol.for("react.lazy"),we=Symbol.for("react.offscreen"),ne=Symbol.iterator;function X(s){return s===null||typeof s!="object"?null:(s=ne&&s[ne]||s["@@iterator"],typeof s=="function"?s:null)}var ce=Object.assign,R;function q(s){if(R===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);R=i&&i[1]||""}return`
`+R+s}var se=!1;function ve(s,i){if(!s||se)return"";se=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(K){var f=K}Reflect.construct(s,[],i)}else{try{i.call()}catch(K){f=K}s.call(i.prototype)}else{try{throw Error()}catch(K){f=K}s()}}catch(K){if(K&&f&&typeof K.stack=="string"){for(var v=K.stack.split(`
`),w=f.stack.split(`
`),S=v.length-1,j=w.length-1;1<=S&&0<=j&&v[S]!==w[j];)j--;for(;1<=S&&0<=j;S--,j--)if(v[S]!==w[j]){if(S!==1||j!==1)do if(S--,j--,0>j||v[S]!==w[j]){var L=`
`+v[S].replace(" at new "," at ");return s.displayName&&L.includes("<anonymous>")&&(L=L.replace("<anonymous>",s.displayName)),L}while(1<=S&&0<=j);break}}}finally{se=!1,Error.prepareStackTrace=l}return(s=s?s.displayName||s.name:"")?q(s):""}function Re(s){switch(s.tag){case 5:return q(s.type);case 16:return q("Lazy");case 13:return q("Suspense");case 19:return q("SuspenseList");case 0:case 2:case 15:return s=ve(s.type,!1),s;case 11:return s=ve(s.type.render,!1),s;case 1:return s=ve(s.type,!0),s;default:return""}}function je(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case de:return"Fragment";case ze:return"Portal";case Je:return"Profiler";case Ie:return"StrictMode";case be:return"Suspense";case te:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case Ve:return(s.displayName||"Context")+".Consumer";case Qe:return(s._context.displayName||"Context")+".Provider";case $e:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case ee:return i=s.displayName||null,i!==null?i:je(s.type)||"Memo";case Y:i=s._payload,s=s._init;try{return je(s(i))}catch{}}return null}function qe(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return je(i);case 8:return i===Ie?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Be(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ze(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function gt(s){var i=Ze(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),f=""+s[i];if(!s.hasOwnProperty(i)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var v=l.get,w=l.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return v.call(this)},set:function(S){f=""+S,w.call(this,S)}}),Object.defineProperty(s,i,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(S){f=""+S},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function un(s){s._valueTracker||(s._valueTracker=gt(s))}function En(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var l=i.getValue(),f="";return s&&(f=Ze(s)?s.checked?"true":"false":s.value),s=f,s!==l?(i.setValue(s),!0):!1}function bs(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Fn(s,i){var l=i.checked;return ce({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??s._wrapperState.initialChecked})}function an(s,i){var l=i.defaultValue==null?"":i.defaultValue,f=i.checked!=null?i.checked:i.defaultChecked;l=Be(i.value!=null?i.value:l),s._wrapperState={initialChecked:f,initialValue:l,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Un(s,i){i=i.checked,i!=null&&C(s,"checked",i,!1)}function Us(s,i){Un(s,i);var l=Be(i.value),f=i.type;if(l!=null)f==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+l):s.value!==""+l&&(s.value=""+l);else if(f==="submit"||f==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?zs(s,i.type,l):i.hasOwnProperty("defaultValue")&&zs(s,i.type,Be(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function At(s,i,l){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var f=i.type;if(!(f!=="submit"&&f!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,l||i===s.value||(s.value=i),s.defaultValue=i}l=s.name,l!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,l!==""&&(s.name=l)}function zs(s,i,l){(i!=="number"||bs(s.ownerDocument)!==s)&&(l==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+l&&(s.defaultValue=""+l))}var zn=Array.isArray;function os(s,i,l,f){if(s=s.options,i){i={};for(var v=0;v<l.length;v++)i["$"+l[v]]=!0;for(l=0;l<s.length;l++)v=i.hasOwnProperty("$"+s[l].value),s[l].selected!==v&&(s[l].selected=v),v&&f&&(s[l].defaultSelected=!0)}else{for(l=""+Be(l),i=null,v=0;v<s.length;v++){if(s[v].value===l){s[v].selected=!0,f&&(s[v].defaultSelected=!0);return}i!==null||s[v].disabled||(i=s[v])}i!==null&&(i.selected=!0)}}function Bn(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return ce({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Yn(s,i){var l=i.value;if(l==null){if(l=i.children,i=i.defaultValue,l!=null){if(i!=null)throw Error(t(92));if(zn(l)){if(1<l.length)throw Error(t(93));l=l[0]}i=l}i==null&&(i=""),l=i}s._wrapperState={initialValue:Be(l)}}function Xn(s,i){var l=Be(i.value),f=Be(i.defaultValue);l!=null&&(l=""+l,l!==s.value&&(s.value=l),i.defaultValue==null&&s.defaultValue!==l&&(s.defaultValue=l)),f!=null&&(s.defaultValue=""+f)}function as(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function Cs(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ls(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?Cs(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Nn,mr=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,l,f,v){MSApp.execUnsafeLocalFunction(function(){return s(i,l,f,v)})}:s})(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(Nn=Nn||document.createElement("div"),Nn.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Nn.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function Wn(s,i){if(i){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=i;return}}s.textContent=i}var cs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Jn=["Webkit","ms","Moz","O"];Object.keys(cs).forEach(function(s){Jn.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),cs[i]=cs[s]})});function Bs(s,i,l){return i==null||typeof i=="boolean"||i===""?"":l||typeof i!="number"||i===0||cs.hasOwnProperty(s)&&cs[s]?(""+i).trim():i+"px"}function oe(s,i){s=s.style;for(var l in i)if(i.hasOwnProperty(l)){var f=l.indexOf("--")===0,v=Bs(l,i[l],f);l==="float"&&(l="cssFloat"),f?s.setProperty(l,v):s[l]=v}}var xe=ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ce(s,i){if(i){if(xe[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function Le(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ht=null;function Vt(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ft=null,Kt=null,Tn=null;function He(s){if(s=ha(s)){if(typeof Ft!="function")throw Error(t(280));var i=s.stateNode;i&&(i=vl(i),Ft(s.stateNode,s.type,i))}}function bt(s){Kt?Tn?Tn.push(s):Tn=[s]:Kt=s}function wt(){if(Kt){var s=Kt,i=Tn;if(Tn=Kt=null,He(s),i)for(s=0;s<i.length;s++)He(i[s])}}function Jt(s,i){return s(i)}function Ct(){}var Qt=!1;function V(s,i,l){if(Qt)return s(i,l);Qt=!0;try{return Jt(s,i,l)}finally{Qt=!1,(Kt!==null||Tn!==null)&&(Ct(),wt())}}function Ht(s,i){var l=s.stateNode;if(l===null)return null;var f=vl(l);if(f===null)return null;l=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(t(231,i,typeof l));return l}var Rt=!1;if(g)try{var tn={};Object.defineProperty(tn,"passive",{get:function(){Rt=!0}}),window.addEventListener("test",tn,tn),window.removeEventListener("test",tn,tn)}catch{Rt=!1}function ge(s,i,l,f,v,w,S,j,L){var K=Array.prototype.slice.call(arguments,3);try{i.apply(l,K)}catch(ae){this.onError(ae)}}var jt=!1,ot=null,_t=!1,tr=null,Gt={onError:function(s){jt=!0,ot=s}};function us(s,i,l,f,v,w,S,j,L){jt=!1,ot=null,ge.apply(Gt,arguments)}function Ws(s,i,l,f,v,w,S,j,L){if(us.apply(this,arguments),jt){if(jt){var K=ot;jt=!1,ot=null}else throw Error(t(198));_t||(_t=!0,tr=K)}}function ke(s){var i=s,l=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(l=i.return),s=i.return;while(s)}return i.tag===3?l:null}function qt(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function ks(s){if(ke(s)!==s)throw Error(t(188))}function Ss(s){var i=s.alternate;if(!i){if(i=ke(s),i===null)throw Error(t(188));return i!==s?null:s}for(var l=s,f=i;;){var v=l.return;if(v===null)break;var w=v.alternate;if(w===null){if(f=v.return,f!==null){l=f;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===l)return ks(v),s;if(w===f)return ks(v),i;w=w.sibling}throw Error(t(188))}if(l.return!==f.return)l=v,f=w;else{for(var S=!1,j=v.child;j;){if(j===l){S=!0,l=v,f=w;break}if(j===f){S=!0,f=v,l=w;break}j=j.sibling}if(!S){for(j=w.child;j;){if(j===l){S=!0,l=w,f=v;break}if(j===f){S=!0,f=w,l=v;break}j=j.sibling}if(!S)throw Error(t(189))}}if(l.alternate!==f)throw Error(t(190))}if(l.tag!==3)throw Error(t(188));return l.stateNode.current===l?s:i}function nr(s){return s=Ss(s),s!==null?ni(s):null}function ni(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=ni(s);if(i!==null)return i;s=s.sibling}return null}var si=e.unstable_scheduleCallback,ri=e.unstable_cancelCallback,ds=e.unstable_shouldYield,ii=e.unstable_requestPaint,St=e.unstable_now,oi=e.unstable_getCurrentPriorityLevel,gr=e.unstable_ImmediatePriority,sr=e.unstable_UserBlockingPriority,Vs=e.unstable_NormalPriority,Vi=e.unstable_LowPriority,ai=e.unstable_IdlePriority,rr=null,Vn=null;function nn(s){if(Vn&&typeof Vn.onCommitFiberRoot=="function")try{Vn.onCommitFiberRoot(rr,s,void 0,(s.current.flags&128)===128)}catch{}}var B=Math.clz32?Math.clz32:De,Q=Math.log,G=Math.LN2;function De(s){return s>>>=0,s===0?32:31-(Q(s)/G|0)|0}var Oe=64,Fe=4194304;function dn(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function $t(s,i){var l=s.pendingLanes;if(l===0)return 0;var f=0,v=s.suspendedLanes,w=s.pingedLanes,S=l&268435455;if(S!==0){var j=S&~v;j!==0?f=dn(j):(w&=S,w!==0&&(f=dn(w)))}else S=l&~v,S!==0?f=dn(S):w!==0&&(f=dn(w));if(f===0)return 0;if(i!==0&&i!==f&&(i&v)===0&&(v=f&-f,w=i&-i,v>=w||v===16&&(w&4194240)!==0))return i;if((f&4)!==0&&(f|=l&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=f;0<i;)l=31-B(i),v=1<<l,f|=s[l],i&=~v;return f}function Ja(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Za(s,i){for(var l=s.suspendedLanes,f=s.pingedLanes,v=s.expirationTimes,w=s.pendingLanes;0<w;){var S=31-B(w),j=1<<S,L=v[S];L===-1?((j&l)===0||(j&f)!==0)&&(v[S]=Ja(j,i)):L<=i&&(s.expiredLanes|=j),w&=~j}}function li(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Hi(){var s=Oe;return Oe<<=1,(Oe&4194240)===0&&(Oe=64),s}function qi(s){for(var i=[],l=0;31>l;l++)i.push(s);return i}function vr(s,i,l){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-B(i),s[i]=l}function el(s,i){var l=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var f=s.eventTimes;for(s=s.expirationTimes;0<l;){var v=31-B(l),w=1<<v;i[v]=0,f[v]=-1,s[v]=-1,l&=~w}}function ci(s,i){var l=s.entangledLanes|=i;for(s=s.entanglements;l;){var f=31-B(l),v=1<<f;v&i|s[f]&i&&(s[f]|=i),l&=~v}}var vt=0;function Jo(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Zo,Ki,Qi,ea,Gi,ui=!1,Hs=[],Es=null,qs=null,Ns=null,jr=new Map,$r=new Map,A=[],z="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Z(s,i){switch(s){case"focusin":case"focusout":Es=null;break;case"dragenter":case"dragleave":qs=null;break;case"mouseover":case"mouseout":Ns=null;break;case"pointerover":case"pointerout":jr.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":$r.delete(i.pointerId)}}function pe(s,i,l,f,v,w){return s===null||s.nativeEvent!==w?(s={blockedOn:i,domEventName:l,eventSystemFlags:f,nativeEvent:w,targetContainers:[v]},i!==null&&(i=ha(i),i!==null&&Ki(i)),s):(s.eventSystemFlags|=f,i=s.targetContainers,v!==null&&i.indexOf(v)===-1&&i.push(v),s)}function Me(s,i,l,f,v){switch(i){case"focusin":return Es=pe(Es,s,i,l,f,v),!0;case"dragenter":return qs=pe(qs,s,i,l,f,v),!0;case"mouseover":return Ns=pe(Ns,s,i,l,f,v),!0;case"pointerover":var w=v.pointerId;return jr.set(w,pe(jr.get(w)||null,s,i,l,f,v)),!0;case"gotpointercapture":return w=v.pointerId,$r.set(w,pe($r.get(w)||null,s,i,l,f,v)),!0}return!1}function lt(s){var i=mi(s.target);if(i!==null){var l=ke(i);if(l!==null){if(i=l.tag,i===13){if(i=qt(l),i!==null){s.blockedOn=i,Gi(s.priority,function(){Qi(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Nt(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var l=Xi(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(l===null){l=s.nativeEvent;var f=new l.constructor(l.type,l);ht=f,l.target.dispatchEvent(f),ht=null}else return i=ha(l),i!==null&&Ki(i),s.blockedOn=l,!1;i.shift()}return!0}function fn(s,i,l){Nt(s)&&l.delete(i)}function sn(){ui=!1,Es!==null&&Nt(Es)&&(Es=null),qs!==null&&Nt(qs)&&(qs=null),Ns!==null&&Nt(Ns)&&(Ns=null),jr.forEach(fn),$r.forEach(fn)}function Ke(s,i){s.blockedOn===i&&(s.blockedOn=null,ui||(ui=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,sn)))}function Ot(s){function i(v){return Ke(v,s)}if(0<Hs.length){Ke(Hs[0],s);for(var l=1;l<Hs.length;l++){var f=Hs[l];f.blockedOn===s&&(f.blockedOn=null)}}for(Es!==null&&Ke(Es,s),qs!==null&&Ke(qs,s),Ns!==null&&Ke(Ns,s),jr.forEach(i),$r.forEach(i),l=0;l<A.length;l++)f=A[l],f.blockedOn===s&&(f.blockedOn=null);for(;0<A.length&&(l=A[0],l.blockedOn===null);)lt(l),l.blockedOn===null&&A.shift()}var kt=ie.ReactCurrentBatchConfig,Yt=!0;function ta(s,i,l,f){var v=vt,w=kt.transition;kt.transition=null;try{vt=1,Yi(s,i,l,f)}finally{vt=v,kt.transition=w}}function Xd(s,i,l,f){var v=vt,w=kt.transition;kt.transition=null;try{vt=4,Yi(s,i,l,f)}finally{vt=v,kt.transition=w}}function Yi(s,i,l,f){if(Yt){var v=Xi(s,i,l,f);if(v===null)Hc(s,i,f,na,l),Z(s,f);else if(Me(v,s,i,l,f))f.stopPropagation();else if(Z(s,f),i&4&&-1<z.indexOf(s)){for(;v!==null;){var w=ha(v);if(w!==null&&Zo(w),w=Xi(s,i,l,f),w===null&&Hc(s,i,f,na,l),w===v)break;v=w}v!==null&&f.stopPropagation()}else Hc(s,i,f,null,l)}}var na=null;function Xi(s,i,l,f){if(na=null,s=Vt(f),s=mi(s),s!==null)if(i=ke(s),i===null)s=null;else if(l=i.tag,l===13){if(s=qt(i),s!==null)return s;s=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return na=s,null}function di(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(oi()){case gr:return 1;case sr:return 4;case Vs:case Vi:return 16;case ai:return 536870912;default:return 16}default:return 16}}var ir=null,tl=null,nl=null;function Jd(){if(nl)return nl;var s,i=tl,l=i.length,f,v="value"in ir?ir.value:ir.textContent,w=v.length;for(s=0;s<l&&i[s]===v[s];s++);var S=l-s;for(f=1;f<=S&&i[l-f]===v[w-f];f++);return nl=v.slice(s,1<f?1-f:void 0)}function sa(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Ji(){return!0}function sl(){return!1}function Zn(s){function i(l,f,v,w,S){this._reactName=l,this._targetInst=v,this.type=f,this.nativeEvent=w,this.target=S,this.currentTarget=null;for(var j in s)s.hasOwnProperty(j)&&(l=s[j],this[j]=l?l(w):w[j]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Ji:sl,this.isPropagationStopped=sl,this}return ce(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ji)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ji)},persist:function(){},isPersistent:Ji}),i}var fi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rl=Zn(fi),Zi=ce({},fi,{view:0,detail:0}),Zd=Zn(Zi),il,ol,hi,ra=ce({},Zi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ll,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==hi&&(hi&&s.type==="mousemove"?(il=s.screenX-hi.screenX,ol=s.screenY-hi.screenY):ol=il=0,hi=s),il)},movementY:function(s){return"movementY"in s?s.movementY:ol}}),Pc=Zn(ra),ef=ce({},ra,{dataTransfer:0}),al=Zn(ef),Hm=ce({},Zi,{relatedTarget:0}),Ac=Zn(Hm),qm=ce({},fi,{animationName:0,elapsedTime:0,pseudoElement:0}),Km=Zn(qm),Qm=ce({},fi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Gm=Zn(Qm),Ym=ce({},fi,{data:0}),tf=Zn(Ym),Xm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rf(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=sf[s])?!!i[s]:!1}function ll(){return rf}var Jm=ce({},Zi,{key:function(s){if(s.key){var i=Xm[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=sa(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?nf[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ll,charCode:function(s){return s.type==="keypress"?sa(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?sa(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Zm=Zn(Jm),of=ce({},ra,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),af=Zn(of),lf=ce({},Zi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ll}),cf=Zn(lf),eg=ce({},fi,{propertyName:0,elapsedTime:0,pseudoElement:0}),uf=Zn(eg),cl=ce({},ra,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),df=Zn(cl),tg=[9,13,27,32],Rc=g&&"CompositionEvent"in window,eo=null;g&&"documentMode"in document&&(eo=document.documentMode);var ff=g&&"TextEvent"in window&&!eo,jc=g&&(!Rc||eo&&8<eo&&11>=eo),$c=" ",hf=!1;function pf(s,i){switch(s){case"keyup":return tg.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mf(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var to=!1;function ng(s,i){switch(s){case"compositionend":return mf(i);case"keypress":return i.which!==32?null:(hf=!0,$c);case"textInput":return s=i.data,s===$c&&hf?null:s;default:return null}}function sg(s,i){if(to)return s==="compositionend"||!Rc&&pf(s,i)?(s=Jd(),nl=tl=ir=null,to=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return jc&&i.locale!=="ko"?null:i.data;default:return null}}var rg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gf(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!rg[s.type]:i==="textarea"}function vf(s,i,l,f){bt(f),i=pl(i,"onChange"),0<i.length&&(l=new rl("onChange","change",null,l,f),s.push({event:l,listeners:i}))}var ia=null,oa=null;function yf(s){Mf(s,0)}function ul(s){var i=oo(s);if(En(i))return s}function ig(s,i){if(s==="change")return i}var wf=!1;if(g){var Oc;if(g){var Mc="oninput"in document;if(!Mc){var _f=document.createElement("div");_f.setAttribute("oninput","return;"),Mc=typeof _f.oninput=="function"}Oc=Mc}else Oc=!1;wf=Oc&&(!document.documentMode||9<document.documentMode)}function Dc(){ia&&(ia.detachEvent("onpropertychange",pi),oa=ia=null)}function pi(s){if(s.propertyName==="value"&&ul(oa)){var i=[];vf(i,oa,s,Vt(s)),V(yf,i)}}function xf(s,i,l){s==="focusin"?(Dc(),ia=i,oa=l,ia.attachEvent("onpropertychange",pi)):s==="focusout"&&Dc()}function bf(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return ul(oa)}function og(s,i){if(s==="click")return ul(i)}function Or(s,i){if(s==="input"||s==="change")return ul(i)}function fs(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Ts=typeof Object.is=="function"?Object.is:fs;function aa(s,i){if(Ts(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var l=Object.keys(s),f=Object.keys(i);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var v=l[f];if(!y.call(i,v)||!Ts(s[v],i[v]))return!1}return!0}function Cf(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function kf(s,i){var l=Cf(s);s=0;for(var f;l;){if(l.nodeType===3){if(f=s+l.textContent.length,s<=i&&f>=i)return{node:l,offset:i-s};s=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Cf(l)}}function Sf(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?Sf(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function Ef(){for(var s=window,i=bs();i instanceof s.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)s=i.contentWindow;else break;i=bs(s.document)}return i}function Lc(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function ag(s){var i=Ef(),l=s.focusedElem,f=s.selectionRange;if(i!==l&&l&&l.ownerDocument&&Sf(l.ownerDocument.documentElement,l)){if(f!==null&&Lc(l)){if(i=f.start,s=f.end,s===void 0&&(s=i),"selectionStart"in l)l.selectionStart=i,l.selectionEnd=Math.min(s,l.value.length);else if(s=(i=l.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var v=l.textContent.length,w=Math.min(f.start,v);f=f.end===void 0?w:Math.min(f.end,v),!s.extend&&w>f&&(v=f,f=w,w=v),v=kf(l,w);var S=kf(l,f);v&&S&&(s.rangeCount!==1||s.anchorNode!==v.node||s.anchorOffset!==v.offset||s.focusNode!==S.node||s.focusOffset!==S.offset)&&(i=i.createRange(),i.setStart(v.node,v.offset),s.removeAllRanges(),w>f?(s.addRange(i),s.extend(S.node,S.offset)):(i.setEnd(S.node,S.offset),s.addRange(i)))}}for(i=[],s=l;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<i.length;l++)s=i[l],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var lg=g&&"documentMode"in document&&11>=document.documentMode,no=null,Fc=null,la=null,Uc=!1;function Nf(s,i,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Uc||no==null||no!==bs(f)||(f=no,"selectionStart"in f&&Lc(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),la&&aa(la,f)||(la=f,f=pl(Fc,"onSelect"),0<f.length&&(i=new rl("onSelect","select",null,i,l),s.push({event:i,listeners:f}),i.target=no)))}function dl(s,i){var l={};return l[s.toLowerCase()]=i.toLowerCase(),l["Webkit"+s]="webkit"+i,l["Moz"+s]="moz"+i,l}var so={animationend:dl("Animation","AnimationEnd"),animationiteration:dl("Animation","AnimationIteration"),animationstart:dl("Animation","AnimationStart"),transitionend:dl("Transition","TransitionEnd")},zc={},Tf={};g&&(Tf=document.createElement("div").style,"AnimationEvent"in window||(delete so.animationend.animation,delete so.animationiteration.animation,delete so.animationstart.animation),"TransitionEvent"in window||delete so.transitionend.transition);function fl(s){if(zc[s])return zc[s];if(!so[s])return s;var i=so[s],l;for(l in i)if(i.hasOwnProperty(l)&&l in Tf)return zc[s]=i[l];return s}var If=fl("animationend"),Pf=fl("animationiteration"),Af=fl("animationstart"),Rf=fl("transitionend"),jf=new Map,$f="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mr(s,i){jf.set(s,i),d(i,[s])}for(var Bc=0;Bc<$f.length;Bc++){var Wc=$f[Bc],cg=Wc.toLowerCase(),ug=Wc[0].toUpperCase()+Wc.slice(1);Mr(cg,"on"+ug)}Mr(If,"onAnimationEnd"),Mr(Pf,"onAnimationIteration"),Mr(Af,"onAnimationStart"),Mr("dblclick","onDoubleClick"),Mr("focusin","onFocus"),Mr("focusout","onBlur"),Mr(Rf,"onTransitionEnd"),h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),d("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),d("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),d("onBeforeInput",["compositionend","keypress","textInput","paste"]),d("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ca="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dg=new Set("cancel close invalid load scroll toggle".split(" ").concat(ca));function Of(s,i,l){var f=s.type||"unknown-event";s.currentTarget=l,Ws(f,i,void 0,s),s.currentTarget=null}function Mf(s,i){i=(i&4)!==0;for(var l=0;l<s.length;l++){var f=s[l],v=f.event;f=f.listeners;e:{var w=void 0;if(i)for(var S=f.length-1;0<=S;S--){var j=f[S],L=j.instance,K=j.currentTarget;if(j=j.listener,L!==w&&v.isPropagationStopped())break e;Of(v,j,K),w=L}else for(S=0;S<f.length;S++){if(j=f[S],L=j.instance,K=j.currentTarget,j=j.listener,L!==w&&v.isPropagationStopped())break e;Of(v,j,K),w=L}}}if(_t)throw s=tr,_t=!1,tr=null,s}function Mt(s,i){var l=i[Xc];l===void 0&&(l=i[Xc]=new Set);var f=s+"__bubble";l.has(f)||(Df(i,s,2,!1),l.add(f))}function Vc(s,i,l){var f=0;i&&(f|=4),Df(l,s,f,i)}var hl="_reactListening"+Math.random().toString(36).slice(2);function ua(s){if(!s[hl]){s[hl]=!0,r.forEach(function(l){l!=="selectionchange"&&(dg.has(l)||Vc(l,!1,s),Vc(l,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[hl]||(i[hl]=!0,Vc("selectionchange",!1,i))}}function Df(s,i,l,f){switch(di(i)){case 1:var v=ta;break;case 4:v=Xd;break;default:v=Yi}l=v.bind(null,i,l,s),v=void 0,!Rt||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(v=!0),f?v!==void 0?s.addEventListener(i,l,{capture:!0,passive:v}):s.addEventListener(i,l,!0):v!==void 0?s.addEventListener(i,l,{passive:v}):s.addEventListener(i,l,!1)}function Hc(s,i,l,f,v){var w=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var j=f.stateNode.containerInfo;if(j===v||j.nodeType===8&&j.parentNode===v)break;if(S===4)for(S=f.return;S!==null;){var L=S.tag;if((L===3||L===4)&&(L=S.stateNode.containerInfo,L===v||L.nodeType===8&&L.parentNode===v))return;S=S.return}for(;j!==null;){if(S=mi(j),S===null)return;if(L=S.tag,L===5||L===6){f=w=S;continue e}j=j.parentNode}}f=f.return}V(function(){var K=w,ae=Vt(l),he=[];e:{var re=jf.get(s);if(re!==void 0){var Se=rl,Te=s;switch(s){case"keypress":if(sa(l)===0)break e;case"keydown":case"keyup":Se=Zm;break;case"focusin":Te="focus",Se=Ac;break;case"focusout":Te="blur",Se=Ac;break;case"beforeblur":case"afterblur":Se=Ac;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Se=Pc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Se=al;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Se=cf;break;case If:case Pf:case Af:Se=Km;break;case Rf:Se=uf;break;case"scroll":Se=Zd;break;case"wheel":Se=df;break;case"copy":case"cut":case"paste":Se=Gm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Se=af}var Pe=(i&4)!==0,en=!Pe&&s==="scroll",u=Pe?re!==null?re+"Capture":null:re;Pe=[];for(var E=K,W;E!==null;){W=E;var fe=W.stateNode;if(W.tag===5&&fe!==null&&(W=fe,u!==null&&(fe=Ht(E,u),fe!=null&&Pe.push(da(E,fe,W)))),en)break;E=E.return}0<Pe.length&&(re=new Se(re,Te,null,l,ae),he.push({event:re,listeners:Pe}))}}if((i&7)===0){e:{if(re=s==="mouseover"||s==="pointerover",Se=s==="mouseout"||s==="pointerout",re&&l!==ht&&(Te=l.relatedTarget||l.fromElement)&&(mi(Te)||Te[yr]))break e;if((Se||re)&&(re=ae.window===ae?ae:(re=ae.ownerDocument)?re.defaultView||re.parentWindow:window,Se?(Te=l.relatedTarget||l.toElement,Se=K,Te=Te?mi(Te):null,Te!==null&&(en=ke(Te),Te!==en||Te.tag!==5&&Te.tag!==6)&&(Te=null)):(Se=null,Te=K),Se!==Te)){if(Pe=Pc,fe="onMouseLeave",u="onMouseEnter",E="mouse",(s==="pointerout"||s==="pointerover")&&(Pe=af,fe="onPointerLeave",u="onPointerEnter",E="pointer"),en=Se==null?re:oo(Se),W=Te==null?re:oo(Te),re=new Pe(fe,E+"leave",Se,l,ae),re.target=en,re.relatedTarget=W,fe=null,mi(ae)===K&&(Pe=new Pe(u,E+"enter",Te,l,ae),Pe.target=W,Pe.relatedTarget=en,fe=Pe),en=fe,Se&&Te)t:{for(Pe=Se,u=Te,E=0,W=Pe;W;W=ro(W))E++;for(W=0,fe=u;fe;fe=ro(fe))W++;for(;0<E-W;)Pe=ro(Pe),E--;for(;0<W-E;)u=ro(u),W--;for(;E--;){if(Pe===u||u!==null&&Pe===u.alternate)break t;Pe=ro(Pe),u=ro(u)}Pe=null}else Pe=null;Se!==null&&Lf(he,re,Se,Pe,!1),Te!==null&&en!==null&&Lf(he,en,Te,Pe,!0)}}e:{if(re=K?oo(K):window,Se=re.nodeName&&re.nodeName.toLowerCase(),Se==="select"||Se==="input"&&re.type==="file")var Ae=ig;else if(gf(re))if(wf)Ae=Or;else{Ae=bf;var I=xf}else(Se=re.nodeName)&&Se.toLowerCase()==="input"&&(re.type==="checkbox"||re.type==="radio")&&(Ae=og);if(Ae&&(Ae=Ae(s,K))){vf(he,Ae,l,ae);break e}I&&I(s,re,K),s==="focusout"&&(I=re._wrapperState)&&I.controlled&&re.type==="number"&&zs(re,"number",re.value)}switch(I=K?oo(K):window,s){case"focusin":(gf(I)||I.contentEditable==="true")&&(no=I,Fc=K,la=null);break;case"focusout":la=Fc=no=null;break;case"mousedown":Uc=!0;break;case"contextmenu":case"mouseup":case"dragend":Uc=!1,Nf(he,l,ae);break;case"selectionchange":if(lg)break;case"keydown":case"keyup":Nf(he,l,ae)}var Ue;if(Rc)e:{switch(s){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else to?pf(s,l)&&(Ge="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Ge="onCompositionStart");Ge&&(jc&&l.locale!=="ko"&&(to||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&to&&(Ue=Jd()):(ir=ae,tl="value"in ir?ir.value:ir.textContent,to=!0)),I=pl(K,Ge),0<I.length&&(Ge=new tf(Ge,s,null,l,ae),he.push({event:Ge,listeners:I}),Ue?Ge.data=Ue:(Ue=mf(l),Ue!==null&&(Ge.data=Ue)))),(Ue=ff?ng(s,l):sg(s,l))&&(K=pl(K,"onBeforeInput"),0<K.length&&(ae=new tf("onBeforeInput","beforeinput",null,l,ae),he.push({event:ae,listeners:K}),ae.data=Ue))}Mf(he,i)})}function da(s,i,l){return{instance:s,listener:i,currentTarget:l}}function pl(s,i){for(var l=i+"Capture",f=[];s!==null;){var v=s,w=v.stateNode;v.tag===5&&w!==null&&(v=w,w=Ht(s,l),w!=null&&f.unshift(da(s,w,v)),w=Ht(s,i),w!=null&&f.push(da(s,w,v))),s=s.return}return f}function ro(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Lf(s,i,l,f,v){for(var w=i._reactName,S=[];l!==null&&l!==f;){var j=l,L=j.alternate,K=j.stateNode;if(L!==null&&L===f)break;j.tag===5&&K!==null&&(j=K,v?(L=Ht(l,w),L!=null&&S.unshift(da(l,L,j))):v||(L=Ht(l,w),L!=null&&S.push(da(l,L,j)))),l=l.return}S.length!==0&&s.push({event:i,listeners:S})}var fg=/\r\n?/g,hg=/\u0000|\uFFFD/g;function Ff(s){return(typeof s=="string"?s:""+s).replace(fg,`
`).replace(hg,"")}function ml(s,i,l){if(i=Ff(i),Ff(s)!==i&&l)throw Error(t(425))}function gl(){}var qc=null,Kc=null;function Qc(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Gc=typeof setTimeout=="function"?setTimeout:void 0,pg=typeof clearTimeout=="function"?clearTimeout:void 0,Uf=typeof Promise=="function"?Promise:void 0,mg=typeof queueMicrotask=="function"?queueMicrotask:typeof Uf<"u"?function(s){return Uf.resolve(null).then(s).catch(gg)}:Gc;function gg(s){setTimeout(function(){throw s})}function Yc(s,i){var l=i,f=0;do{var v=l.nextSibling;if(s.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(f===0){s.removeChild(v),Ot(i);return}f--}else l!=="$"&&l!=="$?"&&l!=="$!"||f++;l=v}while(l);Ot(i)}function Dr(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function zf(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(i===0)return s;i--}else l==="/$"&&i++}s=s.previousSibling}return null}var io=Math.random().toString(36).slice(2),or="__reactFiber$"+io,fa="__reactProps$"+io,yr="__reactContainer$"+io,Xc="__reactEvents$"+io,vg="__reactListeners$"+io,yg="__reactHandles$"+io;function mi(s){var i=s[or];if(i)return i;for(var l=s.parentNode;l;){if(i=l[yr]||l[or]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(s=zf(s);s!==null;){if(l=s[or])return l;s=zf(s)}return i}s=l,l=s.parentNode}return null}function ha(s){return s=s[or]||s[yr],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function oo(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function vl(s){return s[fa]||null}var Jc=[],ao=-1;function Lr(s){return{current:s}}function Dt(s){0>ao||(s.current=Jc[ao],Jc[ao]=null,ao--)}function Tt(s,i){ao++,Jc[ao]=s.current,s.current=i}var Fr={},In=Lr(Fr),es=Lr(!1),gi=Fr;function lo(s,i){var l=s.type.contextTypes;if(!l)return Fr;var f=s.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===i)return f.__reactInternalMemoizedMaskedChildContext;var v={},w;for(w in l)v[w]=i[w];return f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=v),v}function ts(s){return s=s.childContextTypes,s!=null}function yl(){Dt(es),Dt(In)}function Bf(s,i,l){if(In.current!==Fr)throw Error(t(168));Tt(In,i),Tt(es,l)}function Wf(s,i,l){var f=s.stateNode;if(i=i.childContextTypes,typeof f.getChildContext!="function")return l;f=f.getChildContext();for(var v in f)if(!(v in i))throw Error(t(108,qe(s)||"Unknown",v));return ce({},l,f)}function wl(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Fr,gi=In.current,Tt(In,s),Tt(es,es.current),!0}function Vf(s,i,l){var f=s.stateNode;if(!f)throw Error(t(169));l?(s=Wf(s,i,gi),f.__reactInternalMemoizedMergedChildContext=s,Dt(es),Dt(In),Tt(In,s)):Dt(es),Tt(es,l)}var wr=null,_l=!1,Zc=!1;function Hf(s){wr===null?wr=[s]:wr.push(s)}function wg(s){_l=!0,Hf(s)}function Ur(){if(!Zc&&wr!==null){Zc=!0;var s=0,i=vt;try{var l=wr;for(vt=1;s<l.length;s++){var f=l[s];do f=f(!0);while(f!==null)}wr=null,_l=!1}catch(v){throw wr!==null&&(wr=wr.slice(s+1)),si(gr,Ur),v}finally{vt=i,Zc=!1}}return null}var co=[],uo=0,xl=null,bl=0,Is=[],Ps=0,vi=null,_r=1,xr="";function yi(s,i){co[uo++]=bl,co[uo++]=xl,xl=s,bl=i}function qf(s,i,l){Is[Ps++]=_r,Is[Ps++]=xr,Is[Ps++]=vi,vi=s;var f=_r;s=xr;var v=32-B(f)-1;f&=~(1<<v),l+=1;var w=32-B(i)+v;if(30<w){var S=v-v%5;w=(f&(1<<S)-1).toString(32),f>>=S,v-=S,_r=1<<32-B(i)+v|l<<v|f,xr=w+s}else _r=1<<w|l<<v|f,xr=s}function eu(s){s.return!==null&&(yi(s,1),qf(s,1,0))}function tu(s){for(;s===xl;)xl=co[--uo],co[uo]=null,bl=co[--uo],co[uo]=null;for(;s===vi;)vi=Is[--Ps],Is[Ps]=null,xr=Is[--Ps],Is[Ps]=null,_r=Is[--Ps],Is[Ps]=null}var hs=null,ps=null,Ut=!1,Ks=null;function Kf(s,i){var l=Os(5,null,null,0);l.elementType="DELETED",l.stateNode=i,l.return=s,i=s.deletions,i===null?(s.deletions=[l],s.flags|=16):i.push(l)}function Qf(s,i){switch(s.tag){case 5:var l=s.type;return i=i.nodeType!==1||l.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,hs=s,ps=Dr(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,hs=s,ps=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(l=vi!==null?{id:_r,overflow:xr}:null,s.memoizedState={dehydrated:i,treeContext:l,retryLane:1073741824},l=Os(18,null,null,0),l.stateNode=i,l.return=s,s.child=l,hs=s,ps=null,!0):!1;default:return!1}}function nu(s){return(s.mode&1)!==0&&(s.flags&128)===0}function su(s){if(Ut){var i=ps;if(i){var l=i;if(!Qf(s,i)){if(nu(s))throw Error(t(418));i=Dr(l.nextSibling);var f=hs;i&&Qf(s,i)?Kf(f,l):(s.flags=s.flags&-4097|2,Ut=!1,hs=s)}}else{if(nu(s))throw Error(t(418));s.flags=s.flags&-4097|2,Ut=!1,hs=s}}}function Gf(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;hs=s}function Cl(s){if(s!==hs)return!1;if(!Ut)return Gf(s),Ut=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!Qc(s.type,s.memoizedProps)),i&&(i=ps)){if(nu(s))throw Yf(),Error(t(418));for(;i;)Kf(s,i),i=Dr(i.nextSibling)}if(Gf(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"){if(i===0){ps=Dr(s.nextSibling);break e}i--}else l!=="$"&&l!=="$!"&&l!=="$?"||i++}s=s.nextSibling}ps=null}}else ps=hs?Dr(s.stateNode.nextSibling):null;return!0}function Yf(){for(var s=ps;s;)s=Dr(s.nextSibling)}function fo(){ps=hs=null,Ut=!1}function ru(s){Ks===null?Ks=[s]:Ks.push(s)}var _g=ie.ReactCurrentBatchConfig;function pa(s,i,l){if(s=l.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(t(309));var f=l.stateNode}if(!f)throw Error(t(147,s));var v=f,w=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===w?i.ref:(i=function(S){var j=v.refs;S===null?delete j[w]:j[w]=S},i._stringRef=w,i)}if(typeof s!="string")throw Error(t(284));if(!l._owner)throw Error(t(290,s))}return s}function kl(s,i){throw s=Object.prototype.toString.call(i),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function Xf(s){var i=s._init;return i(s._payload)}function Jf(s){function i(u,E){if(s){var W=u.deletions;W===null?(u.deletions=[E],u.flags|=16):W.push(E)}}function l(u,E){if(!s)return null;for(;E!==null;)i(u,E),E=E.sibling;return null}function f(u,E){for(u=new Map;E!==null;)E.key!==null?u.set(E.key,E):u.set(E.index,E),E=E.sibling;return u}function v(u,E){return u=Yr(u,E),u.index=0,u.sibling=null,u}function w(u,E,W){return u.index=W,s?(W=u.alternate,W!==null?(W=W.index,W<E?(u.flags|=2,E):W):(u.flags|=2,E)):(u.flags|=1048576,E)}function S(u){return s&&u.alternate===null&&(u.flags|=2),u}function j(u,E,W,fe){return E===null||E.tag!==6?(E=Gu(W,u.mode,fe),E.return=u,E):(E=v(E,W),E.return=u,E)}function L(u,E,W,fe){var Ae=W.type;return Ae===de?ae(u,E,W.props.children,fe,W.key):E!==null&&(E.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===Y&&Xf(Ae)===E.type)?(fe=v(E,W.props),fe.ref=pa(u,E,W),fe.return=u,fe):(fe=Hl(W.type,W.key,W.props,null,u.mode,fe),fe.ref=pa(u,E,W),fe.return=u,fe)}function K(u,E,W,fe){return E===null||E.tag!==4||E.stateNode.containerInfo!==W.containerInfo||E.stateNode.implementation!==W.implementation?(E=Yu(W,u.mode,fe),E.return=u,E):(E=v(E,W.children||[]),E.return=u,E)}function ae(u,E,W,fe,Ae){return E===null||E.tag!==7?(E=Si(W,u.mode,fe,Ae),E.return=u,E):(E=v(E,W),E.return=u,E)}function he(u,E,W){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Gu(""+E,u.mode,W),E.return=u,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case c:return W=Hl(E.type,E.key,E.props,null,u.mode,W),W.ref=pa(u,null,E),W.return=u,W;case ze:return E=Yu(E,u.mode,W),E.return=u,E;case Y:var fe=E._init;return he(u,fe(E._payload),W)}if(zn(E)||X(E))return E=Si(E,u.mode,W,null),E.return=u,E;kl(u,E)}return null}function re(u,E,W,fe){var Ae=E!==null?E.key:null;if(typeof W=="string"&&W!==""||typeof W=="number")return Ae!==null?null:j(u,E,""+W,fe);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case c:return W.key===Ae?L(u,E,W,fe):null;case ze:return W.key===Ae?K(u,E,W,fe):null;case Y:return Ae=W._init,re(u,E,Ae(W._payload),fe)}if(zn(W)||X(W))return Ae!==null?null:ae(u,E,W,fe,null);kl(u,W)}return null}function Se(u,E,W,fe,Ae){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return u=u.get(W)||null,j(E,u,""+fe,Ae);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case c:return u=u.get(fe.key===null?W:fe.key)||null,L(E,u,fe,Ae);case ze:return u=u.get(fe.key===null?W:fe.key)||null,K(E,u,fe,Ae);case Y:var I=fe._init;return Se(u,E,W,I(fe._payload),Ae)}if(zn(fe)||X(fe))return u=u.get(W)||null,ae(E,u,fe,Ae,null);kl(E,fe)}return null}function Te(u,E,W,fe){for(var Ae=null,I=null,Ue=E,Ge=E=0,O=null;Ue!==null&&Ge<W.length;Ge++){Ue.index>Ge?(O=Ue,Ue=null):O=Ue.sibling;var st=re(u,Ue,W[Ge],fe);if(st===null){Ue===null&&(Ue=O);break}s&&Ue&&st.alternate===null&&i(u,Ue),E=w(st,E,Ge),I===null?Ae=st:I.sibling=st,I=st,Ue=O}if(Ge===W.length)return l(u,Ue),Ut&&yi(u,Ge),Ae;if(Ue===null){for(;Ge<W.length;Ge++)Ue=he(u,W[Ge],fe),Ue!==null&&(E=w(Ue,E,Ge),I===null?Ae=Ue:I.sibling=Ue,I=Ue);return Ut&&yi(u,Ge),Ae}for(Ue=f(u,Ue);Ge<W.length;Ge++)O=Se(Ue,u,Ge,W[Ge],fe),O!==null&&(s&&O.alternate!==null&&Ue.delete(O.key===null?Ge:O.key),E=w(O,E,Ge),I===null?Ae=O:I.sibling=O,I=O);return s&&Ue.forEach(function(Xr){return i(u,Xr)}),Ut&&yi(u,Ge),Ae}function Pe(u,E,W,fe){var Ae=X(W);if(typeof Ae!="function")throw Error(t(150));if(W=Ae.call(W),W==null)throw Error(t(151));for(var I=Ae=null,Ue=E,Ge=E=0,O=null,st=W.next();Ue!==null&&!st.done;Ge++,st=W.next()){Ue.index>Ge?(O=Ue,Ue=null):O=Ue.sibling;var Xr=re(u,Ue,st.value,fe);if(Xr===null){Ue===null&&(Ue=O);break}s&&Ue&&Xr.alternate===null&&i(u,Ue),E=w(Xr,E,Ge),I===null?Ae=Xr:I.sibling=Xr,I=Xr,Ue=O}if(st.done)return l(u,Ue),Ut&&yi(u,Ge),Ae;if(Ue===null){for(;!st.done;Ge++,st=W.next())st=he(u,st.value,fe),st!==null&&(E=w(st,E,Ge),I===null?Ae=st:I.sibling=st,I=st);return Ut&&yi(u,Ge),Ae}for(Ue=f(u,Ue);!st.done;Ge++,st=W.next())st=Se(Ue,u,Ge,st.value,fe),st!==null&&(s&&st.alternate!==null&&Ue.delete(st.key===null?Ge:st.key),E=w(st,E,Ge),I===null?Ae=st:I.sibling=st,I=st);return s&&Ue.forEach(function(Xg){return i(u,Xg)}),Ut&&yi(u,Ge),Ae}function en(u,E,W,fe){if(typeof W=="object"&&W!==null&&W.type===de&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case c:e:{for(var Ae=W.key,I=E;I!==null;){if(I.key===Ae){if(Ae=W.type,Ae===de){if(I.tag===7){l(u,I.sibling),E=v(I,W.props.children),E.return=u,u=E;break e}}else if(I.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===Y&&Xf(Ae)===I.type){l(u,I.sibling),E=v(I,W.props),E.ref=pa(u,I,W),E.return=u,u=E;break e}l(u,I);break}else i(u,I);I=I.sibling}W.type===de?(E=Si(W.props.children,u.mode,fe,W.key),E.return=u,u=E):(fe=Hl(W.type,W.key,W.props,null,u.mode,fe),fe.ref=pa(u,E,W),fe.return=u,u=fe)}return S(u);case ze:e:{for(I=W.key;E!==null;){if(E.key===I)if(E.tag===4&&E.stateNode.containerInfo===W.containerInfo&&E.stateNode.implementation===W.implementation){l(u,E.sibling),E=v(E,W.children||[]),E.return=u,u=E;break e}else{l(u,E);break}else i(u,E);E=E.sibling}E=Yu(W,u.mode,fe),E.return=u,u=E}return S(u);case Y:return I=W._init,en(u,E,I(W._payload),fe)}if(zn(W))return Te(u,E,W,fe);if(X(W))return Pe(u,E,W,fe);kl(u,W)}return typeof W=="string"&&W!==""||typeof W=="number"?(W=""+W,E!==null&&E.tag===6?(l(u,E.sibling),E=v(E,W),E.return=u,u=E):(l(u,E),E=Gu(W,u.mode,fe),E.return=u,u=E),S(u)):l(u,E)}return en}var ho=Jf(!0),Zf=Jf(!1),Sl=Lr(null),El=null,po=null,iu=null;function ou(){iu=po=El=null}function au(s){var i=Sl.current;Dt(Sl),s._currentValue=i}function lu(s,i,l){for(;s!==null;){var f=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),s===l)break;s=s.return}}function mo(s,i){El=s,iu=po=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(ns=!0),s.firstContext=null)}function As(s){var i=s._currentValue;if(iu!==s)if(s={context:s,memoizedValue:i,next:null},po===null){if(El===null)throw Error(t(308));po=s,El.dependencies={lanes:0,firstContext:s}}else po=po.next=s;return i}var wi=null;function cu(s){wi===null?wi=[s]:wi.push(s)}function eh(s,i,l,f){var v=i.interleaved;return v===null?(l.next=l,cu(i)):(l.next=v.next,v.next=l),i.interleaved=l,br(s,f)}function br(s,i){s.lanes|=i;var l=s.alternate;for(l!==null&&(l.lanes|=i),l=s,s=s.return;s!==null;)s.childLanes|=i,l=s.alternate,l!==null&&(l.childLanes|=i),l=s,s=s.return;return l.tag===3?l.stateNode:null}var zr=!1;function uu(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function th(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function ar(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function ms(s,i,l){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(mt&2)!==0){var v=f.pending;return v===null?i.next=i:(i.next=v.next,v.next=i),f.pending=i,br(s,l)}return v=f.interleaved,v===null?(i.next=i,cu(f)):(i.next=v.next,v.next=i),f.interleaved=i,br(s,l)}function ma(s,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194240)!==0)){var f=i.lanes;f&=s.pendingLanes,l|=f,i.lanes=l,ci(s,l)}}function du(s,i){var l=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var v=null,w=null;if(l=l.firstBaseUpdate,l!==null){do{var S={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};w===null?v=w=S:w=w.next=S,l=l.next}while(l!==null);w===null?v=w=i:w=w.next=i}else v=w=i;l={baseState:f.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:f.shared,effects:f.effects},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=i:s.next=i,l.lastBaseUpdate=i}function _i(s,i,l,f){var v=s.updateQueue;zr=!1;var w=v.firstBaseUpdate,S=v.lastBaseUpdate,j=v.shared.pending;if(j!==null){v.shared.pending=null;var L=j,K=L.next;L.next=null,S===null?w=K:S.next=K,S=L;var ae=s.alternate;ae!==null&&(ae=ae.updateQueue,j=ae.lastBaseUpdate,j!==S&&(j===null?ae.firstBaseUpdate=K:j.next=K,ae.lastBaseUpdate=L))}if(w!==null){var he=v.baseState;S=0,ae=K=L=null,j=w;do{var re=j.lane,Se=j.eventTime;if((f&re)===re){ae!==null&&(ae=ae.next={eventTime:Se,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var Te=s,Pe=j;switch(re=i,Se=l,Pe.tag){case 1:if(Te=Pe.payload,typeof Te=="function"){he=Te.call(Se,he,re);break e}he=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=Pe.payload,re=typeof Te=="function"?Te.call(Se,he,re):Te,re==null)break e;he=ce({},he,re);break e;case 2:zr=!0}}j.callback!==null&&j.lane!==0&&(s.flags|=64,re=v.effects,re===null?v.effects=[j]:re.push(j))}else Se={eventTime:Se,lane:re,tag:j.tag,payload:j.payload,callback:j.callback,next:null},ae===null?(K=ae=Se,L=he):ae=ae.next=Se,S|=re;if(j=j.next,j===null){if(j=v.shared.pending,j===null)break;re=j,j=re.next,re.next=null,v.lastBaseUpdate=re,v.shared.pending=null}}while(!0);if(ae===null&&(L=he),v.baseState=L,v.firstBaseUpdate=K,v.lastBaseUpdate=ae,i=v.shared.interleaved,i!==null){v=i;do S|=v.lane,v=v.next;while(v!==i)}else w===null&&(v.shared.lanes=0);Ci|=S,s.lanes=S,s.memoizedState=he}}function nh(s,i,l){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var f=s[i],v=f.callback;if(v!==null){if(f.callback=null,f=l,typeof v!="function")throw Error(t(191,v));v.call(f)}}}var go={},vn=Lr(go),Br=Lr(go),yn=Lr(go);function Rs(s){if(s===go)throw Error(t(174));return s}function ga(s,i){switch(Tt(yn,i),Tt(Br,s),Tt(vn,go),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:ls(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=ls(i,s)}Dt(vn),Tt(vn,i)}function xi(){Dt(vn),Dt(Br),Dt(yn)}function sh(s){Rs(yn.current);var i=Rs(vn.current),l=ls(i,s.type);i!==l&&(Tt(Br,s),Tt(vn,l))}function fu(s){Br.current===s&&(Dt(vn),Dt(Br))}var zt=Lr(0);function vo(s){for(var i=s;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var va=[];function Nl(){for(var s=0;s<va.length;s++)va[s]._workInProgressVersionPrimary=null;va.length=0}var Tl=ie.ReactCurrentDispatcher,hu=ie.ReactCurrentBatchConfig,bi=0,Lt=null,ln=null,hn=null,yo=!1,ya=!1,wa=0,rh=0;function wn(){throw Error(t(321))}function Il(s,i){if(i===null)return!1;for(var l=0;l<i.length&&l<s.length;l++)if(!Ts(s[l],i[l]))return!1;return!0}function wo(s,i,l,f,v,w){if(bi=w,Lt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Tl.current=s===null||s.memoizedState===null?kg:Sg,s=l(f,v),ya){w=0;do{if(ya=!1,wa=0,25<=w)throw Error(t(301));w+=1,hn=ln=null,i.updateQueue=null,Tl.current=Eg,s=l(f,v)}while(ya)}if(Tl.current=Al,i=ln!==null&&ln.next!==null,bi=0,hn=ln=Lt=null,yo=!1,i)throw Error(t(300));return s}function pu(){var s=wa!==0;return wa=0,s}function lr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hn===null?Lt.memoizedState=hn=s:hn=hn.next=s,hn}function js(){if(ln===null){var s=Lt.alternate;s=s!==null?s.memoizedState:null}else s=ln.next;var i=hn===null?Lt.memoizedState:hn.next;if(i!==null)hn=i,ln=s;else{if(s===null)throw Error(t(310));ln=s,s={memoizedState:ln.memoizedState,baseState:ln.baseState,baseQueue:ln.baseQueue,queue:ln.queue,next:null},hn===null?Lt.memoizedState=hn=s:hn=hn.next=s}return hn}function _a(s,i){return typeof i=="function"?i(s):i}function mu(s){var i=js(),l=i.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=s;var f=ln,v=f.baseQueue,w=l.pending;if(w!==null){if(v!==null){var S=v.next;v.next=w.next,w.next=S}f.baseQueue=v=w,l.pending=null}if(v!==null){w=v.next,f=f.baseState;var j=S=null,L=null,K=w;do{var ae=K.lane;if((bi&ae)===ae)L!==null&&(L=L.next={lane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),f=K.hasEagerState?K.eagerState:s(f,K.action);else{var he={lane:ae,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null};L===null?(j=L=he,S=f):L=L.next=he,Lt.lanes|=ae,Ci|=ae}K=K.next}while(K!==null&&K!==w);L===null?S=f:L.next=j,Ts(f,i.memoizedState)||(ns=!0),i.memoizedState=f,i.baseState=S,i.baseQueue=L,l.lastRenderedState=f}if(s=l.interleaved,s!==null){v=s;do w=v.lane,Lt.lanes|=w,Ci|=w,v=v.next;while(v!==s)}else v===null&&(l.lanes=0);return[i.memoizedState,l.dispatch]}function gu(s){var i=js(),l=i.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=s;var f=l.dispatch,v=l.pending,w=i.memoizedState;if(v!==null){l.pending=null;var S=v=v.next;do w=s(w,S.action),S=S.next;while(S!==v);Ts(w,i.memoizedState)||(ns=!0),i.memoizedState=w,i.baseQueue===null&&(i.baseState=w),l.lastRenderedState=w}return[w,f]}function ih(){}function oh(s,i){var l=Lt,f=js(),v=i(),w=!Ts(f.memoizedState,v);if(w&&(f.memoizedState=v,ns=!0),f=f.queue,vu(ch.bind(null,l,f,s),[s]),f.getSnapshot!==i||w||hn!==null&&hn.memoizedState.tag&1){if(l.flags|=2048,xa(9,lh.bind(null,l,f,v,i),void 0,null),pn===null)throw Error(t(349));(bi&30)!==0||ah(l,i,v)}return v}function ah(s,i,l){s.flags|=16384,s={getSnapshot:i,value:l},i=Lt.updateQueue,i===null?(i={lastEffect:null,stores:null},Lt.updateQueue=i,i.stores=[s]):(l=i.stores,l===null?i.stores=[s]:l.push(s))}function lh(s,i,l,f){i.value=l,i.getSnapshot=f,uh(i)&&dh(s)}function ch(s,i,l){return l(function(){uh(i)&&dh(s)})}function uh(s){var i=s.getSnapshot;s=s.value;try{var l=i();return!Ts(s,l)}catch{return!0}}function dh(s){var i=br(s,1);i!==null&&Xs(i,s,1,-1)}function fh(s){var i=lr();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_a,lastRenderedState:s},i.queue=s,s=s.dispatch=Cg.bind(null,Lt,s),[i.memoizedState,s]}function xa(s,i,l,f){return s={tag:s,create:i,destroy:l,deps:f,next:null},i=Lt.updateQueue,i===null?(i={lastEffect:null,stores:null},Lt.updateQueue=i,i.lastEffect=s.next=s):(l=i.lastEffect,l===null?i.lastEffect=s.next=s:(f=l.next,l.next=s,s.next=f,i.lastEffect=s)),s}function hh(){return js().memoizedState}function ba(s,i,l,f){var v=lr();Lt.flags|=s,v.memoizedState=xa(1|i,l,void 0,f===void 0?null:f)}function Pl(s,i,l,f){var v=js();f=f===void 0?null:f;var w=void 0;if(ln!==null){var S=ln.memoizedState;if(w=S.destroy,f!==null&&Il(f,S.deps)){v.memoizedState=xa(i,l,w,f);return}}Lt.flags|=s,v.memoizedState=xa(1|i,l,w,f)}function ph(s,i){return ba(8390656,8,s,i)}function vu(s,i){return Pl(2048,8,s,i)}function mh(s,i){return Pl(4,2,s,i)}function gh(s,i){return Pl(4,4,s,i)}function yu(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function vh(s,i,l){return l=l!=null?l.concat([s]):null,Pl(4,4,yu.bind(null,i,s),l)}function wu(){}function yh(s,i){var l=js();i=i===void 0?null:i;var f=l.memoizedState;return f!==null&&i!==null&&Il(i,f[1])?f[0]:(l.memoizedState=[s,i],s)}function wh(s,i){var l=js();i=i===void 0?null:i;var f=l.memoizedState;return f!==null&&i!==null&&Il(i,f[1])?f[0]:(s=s(),l.memoizedState=[s,i],s)}function _h(s,i,l){return(bi&21)===0?(s.baseState&&(s.baseState=!1,ns=!0),s.memoizedState=l):(Ts(l,i)||(l=Hi(),Lt.lanes|=l,Ci|=l,s.baseState=!0),i)}function xg(s,i){var l=vt;vt=l!==0&&4>l?l:4,s(!0);var f=hu.transition;hu.transition={};try{s(!1),i()}finally{vt=l,hu.transition=f}}function xh(){return js().memoizedState}function bg(s,i,l){var f=qr(s);if(l={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null},bh(s))Ch(i,l);else if(l=eh(s,i,l,f),l!==null){var v=Hn();Xs(l,s,f,v),kh(l,i,f)}}function Cg(s,i,l){var f=qr(s),v={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null};if(bh(s))Ch(i,v);else{var w=s.alternate;if(s.lanes===0&&(w===null||w.lanes===0)&&(w=i.lastRenderedReducer,w!==null))try{var S=i.lastRenderedState,j=w(S,l);if(v.hasEagerState=!0,v.eagerState=j,Ts(j,S)){var L=i.interleaved;L===null?(v.next=v,cu(i)):(v.next=L.next,L.next=v),i.interleaved=v;return}}catch{}finally{}l=eh(s,i,v,f),l!==null&&(v=Hn(),Xs(l,s,f,v),kh(l,i,f))}}function bh(s){var i=s.alternate;return s===Lt||i!==null&&i===Lt}function Ch(s,i){ya=yo=!0;var l=s.pending;l===null?i.next=i:(i.next=l.next,l.next=i),s.pending=i}function kh(s,i,l){if((l&4194240)!==0){var f=i.lanes;f&=s.pendingLanes,l|=f,i.lanes=l,ci(s,l)}}var Al={readContext:As,useCallback:wn,useContext:wn,useEffect:wn,useImperativeHandle:wn,useInsertionEffect:wn,useLayoutEffect:wn,useMemo:wn,useReducer:wn,useRef:wn,useState:wn,useDebugValue:wn,useDeferredValue:wn,useTransition:wn,useMutableSource:wn,useSyncExternalStore:wn,useId:wn,unstable_isNewReconciler:!1},kg={readContext:As,useCallback:function(s,i){return lr().memoizedState=[s,i===void 0?null:i],s},useContext:As,useEffect:ph,useImperativeHandle:function(s,i,l){return l=l!=null?l.concat([s]):null,ba(4194308,4,yu.bind(null,i,s),l)},useLayoutEffect:function(s,i){return ba(4194308,4,s,i)},useInsertionEffect:function(s,i){return ba(4,2,s,i)},useMemo:function(s,i){var l=lr();return i=i===void 0?null:i,s=s(),l.memoizedState=[s,i],s},useReducer:function(s,i,l){var f=lr();return i=l!==void 0?l(i):i,f.memoizedState=f.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},f.queue=s,s=s.dispatch=bg.bind(null,Lt,s),[f.memoizedState,s]},useRef:function(s){var i=lr();return s={current:s},i.memoizedState=s},useState:fh,useDebugValue:wu,useDeferredValue:function(s){return lr().memoizedState=s},useTransition:function(){var s=fh(!1),i=s[0];return s=xg.bind(null,s[1]),lr().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,l){var f=Lt,v=lr();if(Ut){if(l===void 0)throw Error(t(407));l=l()}else{if(l=i(),pn===null)throw Error(t(349));(bi&30)!==0||ah(f,i,l)}v.memoizedState=l;var w={value:l,getSnapshot:i};return v.queue=w,ph(ch.bind(null,f,w,s),[s]),f.flags|=2048,xa(9,lh.bind(null,f,w,l,i),void 0,null),l},useId:function(){var s=lr(),i=pn.identifierPrefix;if(Ut){var l=xr,f=_r;l=(f&~(1<<32-B(f)-1)).toString(32)+l,i=":"+i+"R"+l,l=wa++,0<l&&(i+="H"+l.toString(32)),i+=":"}else l=rh++,i=":"+i+"r"+l.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},Sg={readContext:As,useCallback:yh,useContext:As,useEffect:vu,useImperativeHandle:vh,useInsertionEffect:mh,useLayoutEffect:gh,useMemo:wh,useReducer:mu,useRef:hh,useState:function(){return mu(_a)},useDebugValue:wu,useDeferredValue:function(s){var i=js();return _h(i,ln.memoizedState,s)},useTransition:function(){var s=mu(_a)[0],i=js().memoizedState;return[s,i]},useMutableSource:ih,useSyncExternalStore:oh,useId:xh,unstable_isNewReconciler:!1},Eg={readContext:As,useCallback:yh,useContext:As,useEffect:vu,useImperativeHandle:vh,useInsertionEffect:mh,useLayoutEffect:gh,useMemo:wh,useReducer:gu,useRef:hh,useState:function(){return gu(_a)},useDebugValue:wu,useDeferredValue:function(s){var i=js();return ln===null?i.memoizedState=s:_h(i,ln.memoizedState,s)},useTransition:function(){var s=gu(_a)[0],i=js().memoizedState;return[s,i]},useMutableSource:ih,useSyncExternalStore:oh,useId:xh,unstable_isNewReconciler:!1};function Qs(s,i){if(s&&s.defaultProps){i=ce({},i),s=s.defaultProps;for(var l in s)i[l]===void 0&&(i[l]=s[l]);return i}return i}function _u(s,i,l,f){i=s.memoizedState,l=l(f,i),l=l==null?i:ce({},i,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Rl={isMounted:function(s){return(s=s._reactInternals)?ke(s)===s:!1},enqueueSetState:function(s,i,l){s=s._reactInternals;var f=Hn(),v=qr(s),w=ar(f,v);w.payload=i,l!=null&&(w.callback=l),i=ms(s,w,v),i!==null&&(Xs(i,s,v,f),ma(i,s,v))},enqueueReplaceState:function(s,i,l){s=s._reactInternals;var f=Hn(),v=qr(s),w=ar(f,v);w.tag=1,w.payload=i,l!=null&&(w.callback=l),i=ms(s,w,v),i!==null&&(Xs(i,s,v,f),ma(i,s,v))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var l=Hn(),f=qr(s),v=ar(l,f);v.tag=2,i!=null&&(v.callback=i),i=ms(s,v,f),i!==null&&(Xs(i,s,f,l),ma(i,s,f))}};function Sh(s,i,l,f,v,w,S){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,w,S):i.prototype&&i.prototype.isPureReactComponent?!aa(l,f)||!aa(v,w):!0}function Eh(s,i,l){var f=!1,v=Fr,w=i.contextType;return typeof w=="object"&&w!==null?w=As(w):(v=ts(i)?gi:In.current,f=i.contextTypes,w=(f=f!=null)?lo(s,v):Fr),i=new i(l,w),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Rl,s.stateNode=i,i._reactInternals=s,f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=v,s.__reactInternalMemoizedMaskedChildContext=w),i}function Nh(s,i,l,f){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,f),i.state!==s&&Rl.enqueueReplaceState(i,i.state,null)}function xu(s,i,l,f){var v=s.stateNode;v.props=l,v.state=s.memoizedState,v.refs={},uu(s);var w=i.contextType;typeof w=="object"&&w!==null?v.context=As(w):(w=ts(i)?gi:In.current,v.context=lo(s,w)),v.state=s.memoizedState,w=i.getDerivedStateFromProps,typeof w=="function"&&(_u(s,i,w,l),v.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(i=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),i!==v.state&&Rl.enqueueReplaceState(v,v.state,null),_i(s,l,v,f),v.state=s.memoizedState),typeof v.componentDidMount=="function"&&(s.flags|=4194308)}function _o(s,i){try{var l="",f=i;do l+=Re(f),f=f.return;while(f);var v=l}catch(w){v=`
Error generating stack: `+w.message+`
`+w.stack}return{value:s,source:i,stack:v,digest:null}}function bu(s,i,l){return{value:s,source:null,stack:l??null,digest:i??null}}function Cu(s,i){try{console.error(i.value)}catch(l){setTimeout(function(){throw l})}}var Ng=typeof WeakMap=="function"?WeakMap:Map;function Th(s,i,l){l=ar(-1,l),l.tag=3,l.payload={element:null};var f=i.value;return l.callback=function(){Fl||(Fl=!0,Uu=f),Cu(s,i)},l}function Ih(s,i,l){l=ar(-1,l),l.tag=3;var f=s.type.getDerivedStateFromError;if(typeof f=="function"){var v=i.value;l.payload=function(){return f(v)},l.callback=function(){Cu(s,i)}}var w=s.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(l.callback=function(){Cu(s,i),typeof f!="function"&&(Vr===null?Vr=new Set([this]):Vr.add(this));var S=i.stack;this.componentDidCatch(i.value,{componentStack:S!==null?S:""})}),l}function ku(s,i,l){var f=s.pingCache;if(f===null){f=s.pingCache=new Ng;var v=new Set;f.set(i,v)}else v=f.get(i),v===void 0&&(v=new Set,f.set(i,v));v.has(l)||(v.add(l),s=Ug.bind(null,s,i,l),i.then(s,s))}function Su(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Ph(s,i,l,f,v){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(i=ar(-1,1),i.tag=2,ms(l,i,1))),l.lanes|=1),s):(s.flags|=65536,s.lanes=v,s)}var Tg=ie.ReactCurrentOwner,ns=!1;function Pn(s,i,l,f){i.child=s===null?Zf(i,null,l,f):ho(i,s.child,l,f)}function Ah(s,i,l,f,v){l=l.render;var w=i.ref;return mo(i,v),f=wo(s,i,l,f,w,v),l=pu(),s!==null&&!ns?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~v,Cr(s,i,v)):(Ut&&l&&eu(i),i.flags|=1,Pn(s,i,f,v),i.child)}function Rh(s,i,l,f,v){if(s===null){var w=l.type;return typeof w=="function"&&!Qu(w)&&w.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(i.tag=15,i.type=w,jh(s,i,w,f,v)):(s=Hl(l.type,null,f,i,i.mode,v),s.ref=i.ref,s.return=i,i.child=s)}if(w=s.child,(s.lanes&v)===0){var S=w.memoizedProps;if(l=l.compare,l=l!==null?l:aa,l(S,f)&&s.ref===i.ref)return Cr(s,i,v)}return i.flags|=1,s=Yr(w,f),s.ref=i.ref,s.return=i,i.child=s}function jh(s,i,l,f,v){if(s!==null){var w=s.memoizedProps;if(aa(w,f)&&s.ref===i.ref)if(ns=!1,i.pendingProps=f=w,(s.lanes&v)!==0)(s.flags&131072)!==0&&(ns=!0);else return i.lanes=s.lanes,Cr(s,i,v)}return Eu(s,i,l,f,v)}function $h(s,i,l){var f=i.pendingProps,v=f.children,w=s!==null?s.memoizedState:null;if(f.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tt(bo,gs),gs|=l;else{if((l&1073741824)===0)return s=w!==null?w.baseLanes|l:l,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,Tt(bo,gs),gs|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=w!==null?w.baseLanes:l,Tt(bo,gs),gs|=f}else w!==null?(f=w.baseLanes|l,i.memoizedState=null):f=l,Tt(bo,gs),gs|=f;return Pn(s,i,v,l),i.child}function Oh(s,i){var l=i.ref;(s===null&&l!==null||s!==null&&s.ref!==l)&&(i.flags|=512,i.flags|=2097152)}function Eu(s,i,l,f,v){var w=ts(l)?gi:In.current;return w=lo(i,w),mo(i,v),l=wo(s,i,l,f,w,v),f=pu(),s!==null&&!ns?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~v,Cr(s,i,v)):(Ut&&f&&eu(i),i.flags|=1,Pn(s,i,l,v),i.child)}function Mh(s,i,l,f,v){if(ts(l)){var w=!0;wl(i)}else w=!1;if(mo(i,v),i.stateNode===null)$l(s,i),Eh(i,l,f),xu(i,l,f,v),f=!0;else if(s===null){var S=i.stateNode,j=i.memoizedProps;S.props=j;var L=S.context,K=l.contextType;typeof K=="object"&&K!==null?K=As(K):(K=ts(l)?gi:In.current,K=lo(i,K));var ae=l.getDerivedStateFromProps,he=typeof ae=="function"||typeof S.getSnapshotBeforeUpdate=="function";he||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(j!==f||L!==K)&&Nh(i,S,f,K),zr=!1;var re=i.memoizedState;S.state=re,_i(i,f,S,v),L=i.memoizedState,j!==f||re!==L||es.current||zr?(typeof ae=="function"&&(_u(i,l,ae,f),L=i.memoizedState),(j=zr||Sh(i,l,j,f,re,L,K))?(he||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(i.flags|=4194308)):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=L),S.props=f,S.state=L,S.context=K,f=j):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{S=i.stateNode,th(s,i),j=i.memoizedProps,K=i.type===i.elementType?j:Qs(i.type,j),S.props=K,he=i.pendingProps,re=S.context,L=l.contextType,typeof L=="object"&&L!==null?L=As(L):(L=ts(l)?gi:In.current,L=lo(i,L));var Se=l.getDerivedStateFromProps;(ae=typeof Se=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(j!==he||re!==L)&&Nh(i,S,f,L),zr=!1,re=i.memoizedState,S.state=re,_i(i,f,S,v);var Te=i.memoizedState;j!==he||re!==Te||es.current||zr?(typeof Se=="function"&&(_u(i,l,Se,f),Te=i.memoizedState),(K=zr||Sh(i,l,K,f,re,Te,L)||!1)?(ae||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(f,Te,L),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(f,Te,L)),typeof S.componentDidUpdate=="function"&&(i.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof S.componentDidUpdate!="function"||j===s.memoizedProps&&re===s.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&re===s.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=Te),S.props=f,S.state=Te,S.context=L,f=K):(typeof S.componentDidUpdate!="function"||j===s.memoizedProps&&re===s.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&re===s.memoizedState||(i.flags|=1024),f=!1)}return Nu(s,i,l,f,w,v)}function Nu(s,i,l,f,v,w){Oh(s,i);var S=(i.flags&128)!==0;if(!f&&!S)return v&&Vf(i,l,!1),Cr(s,i,w);f=i.stateNode,Tg.current=i;var j=S&&typeof l.getDerivedStateFromError!="function"?null:f.render();return i.flags|=1,s!==null&&S?(i.child=ho(i,s.child,null,w),i.child=ho(i,null,j,w)):Pn(s,i,j,w),i.memoizedState=f.state,v&&Vf(i,l,!0),i.child}function Dh(s){var i=s.stateNode;i.pendingContext?Bf(s,i.pendingContext,i.pendingContext!==i.context):i.context&&Bf(s,i.context,!1),ga(s,i.containerInfo)}function Lh(s,i,l,f,v){return fo(),ru(v),i.flags|=256,Pn(s,i,l,f),i.child}var Tu={dehydrated:null,treeContext:null,retryLane:0};function Iu(s){return{baseLanes:s,cachePool:null,transitions:null}}function Fh(s,i,l){var f=i.pendingProps,v=zt.current,w=!1,S=(i.flags&128)!==0,j;if((j=S)||(j=s!==null&&s.memoizedState===null?!1:(v&2)!==0),j?(w=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(v|=1),Tt(zt,v&1),s===null)return su(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(S=f.children,s=f.fallback,w?(f=i.mode,w=i.child,S={mode:"hidden",children:S},(f&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=S):w=ql(S,f,0,null),s=Si(s,f,l,null),w.return=i,s.return=i,w.sibling=s,i.child=w,i.child.memoizedState=Iu(l),i.memoizedState=Tu,s):Pu(i,S));if(v=s.memoizedState,v!==null&&(j=v.dehydrated,j!==null))return Ig(s,i,S,f,j,v,l);if(w){w=f.fallback,S=i.mode,v=s.child,j=v.sibling;var L={mode:"hidden",children:f.children};return(S&1)===0&&i.child!==v?(f=i.child,f.childLanes=0,f.pendingProps=L,i.deletions=null):(f=Yr(v,L),f.subtreeFlags=v.subtreeFlags&14680064),j!==null?w=Yr(j,w):(w=Si(w,S,l,null),w.flags|=2),w.return=i,f.return=i,f.sibling=w,i.child=f,f=w,w=i.child,S=s.child.memoizedState,S=S===null?Iu(l):{baseLanes:S.baseLanes|l,cachePool:null,transitions:S.transitions},w.memoizedState=S,w.childLanes=s.childLanes&~l,i.memoizedState=Tu,f}return w=s.child,s=w.sibling,f=Yr(w,{mode:"visible",children:f.children}),(i.mode&1)===0&&(f.lanes=l),f.return=i,f.sibling=null,s!==null&&(l=i.deletions,l===null?(i.deletions=[s],i.flags|=16):l.push(s)),i.child=f,i.memoizedState=null,f}function Pu(s,i){return i=ql({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function jl(s,i,l,f){return f!==null&&ru(f),ho(i,s.child,null,l),s=Pu(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function Ig(s,i,l,f,v,w,S){if(l)return i.flags&256?(i.flags&=-257,f=bu(Error(t(422))),jl(s,i,S,f)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(w=f.fallback,v=i.mode,f=ql({mode:"visible",children:f.children},v,0,null),w=Si(w,v,S,null),w.flags|=2,f.return=i,w.return=i,f.sibling=w,i.child=f,(i.mode&1)!==0&&ho(i,s.child,null,S),i.child.memoizedState=Iu(S),i.memoizedState=Tu,w);if((i.mode&1)===0)return jl(s,i,S,null);if(v.data==="$!"){if(f=v.nextSibling&&v.nextSibling.dataset,f)var j=f.dgst;return f=j,w=Error(t(419)),f=bu(w,f,void 0),jl(s,i,S,f)}if(j=(S&s.childLanes)!==0,ns||j){if(f=pn,f!==null){switch(S&-S){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(f.suspendedLanes|S))!==0?0:v,v!==0&&v!==w.retryLane&&(w.retryLane=v,br(s,v),Xs(f,s,v,-1))}return Ku(),f=bu(Error(t(421))),jl(s,i,S,f)}return v.data==="$?"?(i.flags|=128,i.child=s.child,i=zg.bind(null,s),v._reactRetry=i,null):(s=w.treeContext,ps=Dr(v.nextSibling),hs=i,Ut=!0,Ks=null,s!==null&&(Is[Ps++]=_r,Is[Ps++]=xr,Is[Ps++]=vi,_r=s.id,xr=s.overflow,vi=i),i=Pu(i,f.children),i.flags|=4096,i)}function Uh(s,i,l){s.lanes|=i;var f=s.alternate;f!==null&&(f.lanes|=i),lu(s.return,i,l)}function Au(s,i,l,f,v){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:v}:(w.isBackwards=i,w.rendering=null,w.renderingStartTime=0,w.last=f,w.tail=l,w.tailMode=v)}function zh(s,i,l){var f=i.pendingProps,v=f.revealOrder,w=f.tail;if(Pn(s,i,f.children,l),f=zt.current,(f&2)!==0)f=f&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Uh(s,l,i);else if(s.tag===19)Uh(s,l,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}if(Tt(zt,f),(i.mode&1)===0)i.memoizedState=null;else switch(v){case"forwards":for(l=i.child,v=null;l!==null;)s=l.alternate,s!==null&&vo(s)===null&&(v=l),l=l.sibling;l=v,l===null?(v=i.child,i.child=null):(v=l.sibling,l.sibling=null),Au(i,!1,v,l,w);break;case"backwards":for(l=null,v=i.child,i.child=null;v!==null;){if(s=v.alternate,s!==null&&vo(s)===null){i.child=v;break}s=v.sibling,v.sibling=l,l=v,v=s}Au(i,!0,l,null,w);break;case"together":Au(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function $l(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function Cr(s,i,l){if(s!==null&&(i.dependencies=s.dependencies),Ci|=i.lanes,(l&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(t(153));if(i.child!==null){for(s=i.child,l=Yr(s,s.pendingProps),i.child=l,l.return=i;s.sibling!==null;)s=s.sibling,l=l.sibling=Yr(s,s.pendingProps),l.return=i;l.sibling=null}return i.child}function Pg(s,i,l){switch(i.tag){case 3:Dh(i),fo();break;case 5:sh(i);break;case 1:ts(i.type)&&wl(i);break;case 4:ga(i,i.stateNode.containerInfo);break;case 10:var f=i.type._context,v=i.memoizedProps.value;Tt(Sl,f._currentValue),f._currentValue=v;break;case 13:if(f=i.memoizedState,f!==null)return f.dehydrated!==null?(Tt(zt,zt.current&1),i.flags|=128,null):(l&i.child.childLanes)!==0?Fh(s,i,l):(Tt(zt,zt.current&1),s=Cr(s,i,l),s!==null?s.sibling:null);Tt(zt,zt.current&1);break;case 19:if(f=(l&i.childLanes)!==0,(s.flags&128)!==0){if(f)return zh(s,i,l);i.flags|=128}if(v=i.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Tt(zt,zt.current),f)break;return null;case 22:case 23:return i.lanes=0,$h(s,i,l)}return Cr(s,i,l)}var Bh,Ru,Wh,Vh;Bh=function(s,i){for(var l=i.child;l!==null;){if(l.tag===5||l.tag===6)s.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},Ru=function(){},Wh=function(s,i,l,f){var v=s.memoizedProps;if(v!==f){s=i.stateNode,Rs(vn.current);var w=null;switch(l){case"input":v=Fn(s,v),f=Fn(s,f),w=[];break;case"select":v=ce({},v,{value:void 0}),f=ce({},f,{value:void 0}),w=[];break;case"textarea":v=Bn(s,v),f=Bn(s,f),w=[];break;default:typeof v.onClick!="function"&&typeof f.onClick=="function"&&(s.onclick=gl)}Ce(l,f);var S;l=null;for(K in v)if(!f.hasOwnProperty(K)&&v.hasOwnProperty(K)&&v[K]!=null)if(K==="style"){var j=v[K];for(S in j)j.hasOwnProperty(S)&&(l||(l={}),l[S]="")}else K!=="dangerouslySetInnerHTML"&&K!=="children"&&K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&K!=="autoFocus"&&(a.hasOwnProperty(K)?w||(w=[]):(w=w||[]).push(K,null));for(K in f){var L=f[K];if(j=v?.[K],f.hasOwnProperty(K)&&L!==j&&(L!=null||j!=null))if(K==="style")if(j){for(S in j)!j.hasOwnProperty(S)||L&&L.hasOwnProperty(S)||(l||(l={}),l[S]="");for(S in L)L.hasOwnProperty(S)&&j[S]!==L[S]&&(l||(l={}),l[S]=L[S])}else l||(w||(w=[]),w.push(K,l)),l=L;else K==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,j=j?j.__html:void 0,L!=null&&j!==L&&(w=w||[]).push(K,L)):K==="children"?typeof L!="string"&&typeof L!="number"||(w=w||[]).push(K,""+L):K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&(a.hasOwnProperty(K)?(L!=null&&K==="onScroll"&&Mt("scroll",s),w||j===L||(w=[])):(w=w||[]).push(K,L))}l&&(w=w||[]).push("style",l);var K=w;(i.updateQueue=K)&&(i.flags|=4)}},Vh=function(s,i,l,f){l!==f&&(i.flags|=4)};function Ca(s,i){if(!Ut)switch(s.tailMode){case"hidden":i=s.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function An(s){var i=s.alternate!==null&&s.alternate.child===s.child,l=0,f=0;if(i)for(var v=s.child;v!==null;)l|=v.lanes|v.childLanes,f|=v.subtreeFlags&14680064,f|=v.flags&14680064,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)l|=v.lanes|v.childLanes,f|=v.subtreeFlags,f|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=f,s.childLanes=l,i}function Ag(s,i,l){var f=i.pendingProps;switch(tu(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return An(i),null;case 1:return ts(i.type)&&yl(),An(i),null;case 3:return f=i.stateNode,xi(),Dt(es),Dt(In),Nl(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(Cl(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Ks!==null&&(Bu(Ks),Ks=null))),Ru(s,i),An(i),null;case 5:fu(i);var v=Rs(yn.current);if(l=i.type,s!==null&&i.stateNode!=null)Wh(s,i,l,f,v),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!f){if(i.stateNode===null)throw Error(t(166));return An(i),null}if(s=Rs(vn.current),Cl(i)){f=i.stateNode,l=i.type;var w=i.memoizedProps;switch(f[or]=i,f[fa]=w,s=(i.mode&1)!==0,l){case"dialog":Mt("cancel",f),Mt("close",f);break;case"iframe":case"object":case"embed":Mt("load",f);break;case"video":case"audio":for(v=0;v<ca.length;v++)Mt(ca[v],f);break;case"source":Mt("error",f);break;case"img":case"image":case"link":Mt("error",f),Mt("load",f);break;case"details":Mt("toggle",f);break;case"input":an(f,w),Mt("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!w.multiple},Mt("invalid",f);break;case"textarea":Yn(f,w),Mt("invalid",f)}Ce(l,w),v=null;for(var S in w)if(w.hasOwnProperty(S)){var j=w[S];S==="children"?typeof j=="string"?f.textContent!==j&&(w.suppressHydrationWarning!==!0&&ml(f.textContent,j,s),v=["children",j]):typeof j=="number"&&f.textContent!==""+j&&(w.suppressHydrationWarning!==!0&&ml(f.textContent,j,s),v=["children",""+j]):a.hasOwnProperty(S)&&j!=null&&S==="onScroll"&&Mt("scroll",f)}switch(l){case"input":un(f),At(f,w,!0);break;case"textarea":un(f),as(f);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(f.onclick=gl)}f=v,i.updateQueue=f,f!==null&&(i.flags|=4)}else{S=v.nodeType===9?v:v.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Cs(l)),s==="http://www.w3.org/1999/xhtml"?l==="script"?(s=S.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof f.is=="string"?s=S.createElement(l,{is:f.is}):(s=S.createElement(l),l==="select"&&(S=s,f.multiple?S.multiple=!0:f.size&&(S.size=f.size))):s=S.createElementNS(s,l),s[or]=i,s[fa]=f,Bh(s,i,!1,!1),i.stateNode=s;e:{switch(S=Le(l,f),l){case"dialog":Mt("cancel",s),Mt("close",s),v=f;break;case"iframe":case"object":case"embed":Mt("load",s),v=f;break;case"video":case"audio":for(v=0;v<ca.length;v++)Mt(ca[v],s);v=f;break;case"source":Mt("error",s),v=f;break;case"img":case"image":case"link":Mt("error",s),Mt("load",s),v=f;break;case"details":Mt("toggle",s),v=f;break;case"input":an(s,f),v=Fn(s,f),Mt("invalid",s);break;case"option":v=f;break;case"select":s._wrapperState={wasMultiple:!!f.multiple},v=ce({},f,{value:void 0}),Mt("invalid",s);break;case"textarea":Yn(s,f),v=Bn(s,f),Mt("invalid",s);break;default:v=f}Ce(l,v),j=v;for(w in j)if(j.hasOwnProperty(w)){var L=j[w];w==="style"?oe(s,L):w==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,L!=null&&mr(s,L)):w==="children"?typeof L=="string"?(l!=="textarea"||L!=="")&&Wn(s,L):typeof L=="number"&&Wn(s,""+L):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(a.hasOwnProperty(w)?L!=null&&w==="onScroll"&&Mt("scroll",s):L!=null&&C(s,w,L,S))}switch(l){case"input":un(s),At(s,f,!1);break;case"textarea":un(s),as(s);break;case"option":f.value!=null&&s.setAttribute("value",""+Be(f.value));break;case"select":s.multiple=!!f.multiple,w=f.value,w!=null?os(s,!!f.multiple,w,!1):f.defaultValue!=null&&os(s,!!f.multiple,f.defaultValue,!0);break;default:typeof v.onClick=="function"&&(s.onclick=gl)}switch(l){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return An(i),null;case 6:if(s&&i.stateNode!=null)Vh(s,i,s.memoizedProps,f);else{if(typeof f!="string"&&i.stateNode===null)throw Error(t(166));if(l=Rs(yn.current),Rs(vn.current),Cl(i)){if(f=i.stateNode,l=i.memoizedProps,f[or]=i,(w=f.nodeValue!==l)&&(s=hs,s!==null))switch(s.tag){case 3:ml(f.nodeValue,l,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ml(f.nodeValue,l,(s.mode&1)!==0)}w&&(i.flags|=4)}else f=(l.nodeType===9?l:l.ownerDocument).createTextNode(f),f[or]=i,i.stateNode=f}return An(i),null;case 13:if(Dt(zt),f=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Ut&&ps!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Yf(),fo(),i.flags|=98560,w=!1;else if(w=Cl(i),f!==null&&f.dehydrated!==null){if(s===null){if(!w)throw Error(t(318));if(w=i.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[or]=i}else fo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;An(i),w=!1}else Ks!==null&&(Bu(Ks),Ks=null),w=!0;if(!w)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=l,i):(f=f!==null,f!==(s!==null&&s.memoizedState!==null)&&f&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(zt.current&1)!==0?cn===0&&(cn=3):Ku())),i.updateQueue!==null&&(i.flags|=4),An(i),null);case 4:return xi(),Ru(s,i),s===null&&ua(i.stateNode.containerInfo),An(i),null;case 10:return au(i.type._context),An(i),null;case 17:return ts(i.type)&&yl(),An(i),null;case 19:if(Dt(zt),w=i.memoizedState,w===null)return An(i),null;if(f=(i.flags&128)!==0,S=w.rendering,S===null)if(f)Ca(w,!1);else{if(cn!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(S=vo(s),S!==null){for(i.flags|=128,Ca(w,!1),f=S.updateQueue,f!==null&&(i.updateQueue=f,i.flags|=4),i.subtreeFlags=0,f=l,l=i.child;l!==null;)w=l,s=f,w.flags&=14680066,S=w.alternate,S===null?(w.childLanes=0,w.lanes=s,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=S.childLanes,w.lanes=S.lanes,w.child=S.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=S.memoizedProps,w.memoizedState=S.memoizedState,w.updateQueue=S.updateQueue,w.type=S.type,s=S.dependencies,w.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),l=l.sibling;return Tt(zt,zt.current&1|2),i.child}s=s.sibling}w.tail!==null&&St()>Co&&(i.flags|=128,f=!0,Ca(w,!1),i.lanes=4194304)}else{if(!f)if(s=vo(S),s!==null){if(i.flags|=128,f=!0,l=s.updateQueue,l!==null&&(i.updateQueue=l,i.flags|=4),Ca(w,!0),w.tail===null&&w.tailMode==="hidden"&&!S.alternate&&!Ut)return An(i),null}else 2*St()-w.renderingStartTime>Co&&l!==1073741824&&(i.flags|=128,f=!0,Ca(w,!1),i.lanes=4194304);w.isBackwards?(S.sibling=i.child,i.child=S):(l=w.last,l!==null?l.sibling=S:i.child=S,w.last=S)}return w.tail!==null?(i=w.tail,w.rendering=i,w.tail=i.sibling,w.renderingStartTime=St(),i.sibling=null,l=zt.current,Tt(zt,f?l&1|2:l&1),i):(An(i),null);case 22:case 23:return Hu(),f=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==f&&(i.flags|=8192),f&&(i.mode&1)!==0?(gs&1073741824)!==0&&(An(i),i.subtreeFlags&6&&(i.flags|=8192)):An(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function Rg(s,i){switch(tu(i),i.tag){case 1:return ts(i.type)&&yl(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return xi(),Dt(es),Dt(In),Nl(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return fu(i),null;case 13:if(Dt(zt),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(t(340));fo()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return Dt(zt),null;case 4:return xi(),null;case 10:return au(i.type._context),null;case 22:case 23:return Hu(),null;case 24:return null;default:return null}}var Ol=!1,Rn=!1,jg=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function xo(s,i){var l=s.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(f){Xt(s,i,f)}else l.current=null}function ju(s,i,l){try{l()}catch(f){Xt(s,i,f)}}var Hh=!1;function $g(s,i){if(qc=Yt,s=Ef(),Lc(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var v=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{l.nodeType,w.nodeType}catch{l=null;break e}var S=0,j=-1,L=-1,K=0,ae=0,he=s,re=null;t:for(;;){for(var Se;he!==l||v!==0&&he.nodeType!==3||(j=S+v),he!==w||f!==0&&he.nodeType!==3||(L=S+f),he.nodeType===3&&(S+=he.nodeValue.length),(Se=he.firstChild)!==null;)re=he,he=Se;for(;;){if(he===s)break t;if(re===l&&++K===v&&(j=S),re===w&&++ae===f&&(L=S),(Se=he.nextSibling)!==null)break;he=re,re=he.parentNode}he=Se}l=j===-1||L===-1?null:{start:j,end:L}}else l=null}l=l||{start:0,end:0}}else l=null;for(Kc={focusedElem:s,selectionRange:l},Yt=!1,Ee=i;Ee!==null;)if(i=Ee,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,Ee=s;else for(;Ee!==null;){i=Ee;try{var Te=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Te!==null){var Pe=Te.memoizedProps,en=Te.memoizedState,u=i.stateNode,E=u.getSnapshotBeforeUpdate(i.elementType===i.type?Pe:Qs(i.type,Pe),en);u.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var W=i.stateNode.containerInfo;W.nodeType===1?W.textContent="":W.nodeType===9&&W.documentElement&&W.removeChild(W.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(fe){Xt(i,i.return,fe)}if(s=i.sibling,s!==null){s.return=i.return,Ee=s;break}Ee=i.return}return Te=Hh,Hh=!1,Te}function ka(s,i,l){var f=i.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var v=f=f.next;do{if((v.tag&s)===s){var w=v.destroy;v.destroy=void 0,w!==void 0&&ju(i,l,w)}v=v.next}while(v!==f)}}function Ml(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var l=i=i.next;do{if((l.tag&s)===s){var f=l.create;l.destroy=f()}l=l.next}while(l!==i)}}function $u(s){var i=s.ref;if(i!==null){var l=s.stateNode;switch(s.tag){case 5:s=l;break;default:s=l}typeof i=="function"?i(s):i.current=s}}function qh(s){var i=s.alternate;i!==null&&(s.alternate=null,qh(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[or],delete i[fa],delete i[Xc],delete i[vg],delete i[yg])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Kh(s){return s.tag===5||s.tag===3||s.tag===4}function Qh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Kh(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Ou(s,i,l){var f=s.tag;if(f===5||f===6)s=s.stateNode,i?l.nodeType===8?l.parentNode.insertBefore(s,i):l.insertBefore(s,i):(l.nodeType===8?(i=l.parentNode,i.insertBefore(s,l)):(i=l,i.appendChild(s)),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=gl));else if(f!==4&&(s=s.child,s!==null))for(Ou(s,i,l),s=s.sibling;s!==null;)Ou(s,i,l),s=s.sibling}function Mu(s,i,l){var f=s.tag;if(f===5||f===6)s=s.stateNode,i?l.insertBefore(s,i):l.appendChild(s);else if(f!==4&&(s=s.child,s!==null))for(Mu(s,i,l),s=s.sibling;s!==null;)Mu(s,i,l),s=s.sibling}var _n=null,Gs=!1;function Wr(s,i,l){for(l=l.child;l!==null;)Gh(s,i,l),l=l.sibling}function Gh(s,i,l){if(Vn&&typeof Vn.onCommitFiberUnmount=="function")try{Vn.onCommitFiberUnmount(rr,l)}catch{}switch(l.tag){case 5:Rn||xo(l,i);case 6:var f=_n,v=Gs;_n=null,Wr(s,i,l),_n=f,Gs=v,_n!==null&&(Gs?(s=_n,l=l.stateNode,s.nodeType===8?s.parentNode.removeChild(l):s.removeChild(l)):_n.removeChild(l.stateNode));break;case 18:_n!==null&&(Gs?(s=_n,l=l.stateNode,s.nodeType===8?Yc(s.parentNode,l):s.nodeType===1&&Yc(s,l),Ot(s)):Yc(_n,l.stateNode));break;case 4:f=_n,v=Gs,_n=l.stateNode.containerInfo,Gs=!0,Wr(s,i,l),_n=f,Gs=v;break;case 0:case 11:case 14:case 15:if(!Rn&&(f=l.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){v=f=f.next;do{var w=v,S=w.destroy;w=w.tag,S!==void 0&&((w&2)!==0||(w&4)!==0)&&ju(l,i,S),v=v.next}while(v!==f)}Wr(s,i,l);break;case 1:if(!Rn&&(xo(l,i),f=l.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=l.memoizedProps,f.state=l.memoizedState,f.componentWillUnmount()}catch(j){Xt(l,i,j)}Wr(s,i,l);break;case 21:Wr(s,i,l);break;case 22:l.mode&1?(Rn=(f=Rn)||l.memoizedState!==null,Wr(s,i,l),Rn=f):Wr(s,i,l);break;default:Wr(s,i,l)}}function Yh(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var l=s.stateNode;l===null&&(l=s.stateNode=new jg),i.forEach(function(f){var v=Bg.bind(null,s,f);l.has(f)||(l.add(f),f.then(v,v))})}}function Ys(s,i){var l=i.deletions;if(l!==null)for(var f=0;f<l.length;f++){var v=l[f];try{var w=s,S=i,j=S;e:for(;j!==null;){switch(j.tag){case 5:_n=j.stateNode,Gs=!1;break e;case 3:_n=j.stateNode.containerInfo,Gs=!0;break e;case 4:_n=j.stateNode.containerInfo,Gs=!0;break e}j=j.return}if(_n===null)throw Error(t(160));Gh(w,S,v),_n=null,Gs=!1;var L=v.alternate;L!==null&&(L.return=null),v.return=null}catch(K){Xt(v,i,K)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Xh(i,s),i=i.sibling}function Xh(s,i){var l=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Ys(i,s),cr(s),f&4){try{ka(3,s,s.return),Ml(3,s)}catch(Pe){Xt(s,s.return,Pe)}try{ka(5,s,s.return)}catch(Pe){Xt(s,s.return,Pe)}}break;case 1:Ys(i,s),cr(s),f&512&&l!==null&&xo(l,l.return);break;case 5:if(Ys(i,s),cr(s),f&512&&l!==null&&xo(l,l.return),s.flags&32){var v=s.stateNode;try{Wn(v,"")}catch(Pe){Xt(s,s.return,Pe)}}if(f&4&&(v=s.stateNode,v!=null)){var w=s.memoizedProps,S=l!==null?l.memoizedProps:w,j=s.type,L=s.updateQueue;if(s.updateQueue=null,L!==null)try{j==="input"&&w.type==="radio"&&w.name!=null&&Un(v,w),Le(j,S);var K=Le(j,w);for(S=0;S<L.length;S+=2){var ae=L[S],he=L[S+1];ae==="style"?oe(v,he):ae==="dangerouslySetInnerHTML"?mr(v,he):ae==="children"?Wn(v,he):C(v,ae,he,K)}switch(j){case"input":Us(v,w);break;case"textarea":Xn(v,w);break;case"select":var re=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!w.multiple;var Se=w.value;Se!=null?os(v,!!w.multiple,Se,!1):re!==!!w.multiple&&(w.defaultValue!=null?os(v,!!w.multiple,w.defaultValue,!0):os(v,!!w.multiple,w.multiple?[]:"",!1))}v[fa]=w}catch(Pe){Xt(s,s.return,Pe)}}break;case 6:if(Ys(i,s),cr(s),f&4){if(s.stateNode===null)throw Error(t(162));v=s.stateNode,w=s.memoizedProps;try{v.nodeValue=w}catch(Pe){Xt(s,s.return,Pe)}}break;case 3:if(Ys(i,s),cr(s),f&4&&l!==null&&l.memoizedState.isDehydrated)try{Ot(i.containerInfo)}catch(Pe){Xt(s,s.return,Pe)}break;case 4:Ys(i,s),cr(s);break;case 13:Ys(i,s),cr(s),v=s.child,v.flags&8192&&(w=v.memoizedState!==null,v.stateNode.isHidden=w,!w||v.alternate!==null&&v.alternate.memoizedState!==null||(Fu=St())),f&4&&Yh(s);break;case 22:if(ae=l!==null&&l.memoizedState!==null,s.mode&1?(Rn=(K=Rn)||ae,Ys(i,s),Rn=K):Ys(i,s),cr(s),f&8192){if(K=s.memoizedState!==null,(s.stateNode.isHidden=K)&&!ae&&(s.mode&1)!==0)for(Ee=s,ae=s.child;ae!==null;){for(he=Ee=ae;Ee!==null;){switch(re=Ee,Se=re.child,re.tag){case 0:case 11:case 14:case 15:ka(4,re,re.return);break;case 1:xo(re,re.return);var Te=re.stateNode;if(typeof Te.componentWillUnmount=="function"){f=re,l=re.return;try{i=f,Te.props=i.memoizedProps,Te.state=i.memoizedState,Te.componentWillUnmount()}catch(Pe){Xt(f,l,Pe)}}break;case 5:xo(re,re.return);break;case 22:if(re.memoizedState!==null){ep(he);continue}}Se!==null?(Se.return=re,Ee=Se):ep(he)}ae=ae.sibling}e:for(ae=null,he=s;;){if(he.tag===5){if(ae===null){ae=he;try{v=he.stateNode,K?(w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(j=he.stateNode,L=he.memoizedProps.style,S=L!=null&&L.hasOwnProperty("display")?L.display:null,j.style.display=Bs("display",S))}catch(Pe){Xt(s,s.return,Pe)}}}else if(he.tag===6){if(ae===null)try{he.stateNode.nodeValue=K?"":he.memoizedProps}catch(Pe){Xt(s,s.return,Pe)}}else if((he.tag!==22&&he.tag!==23||he.memoizedState===null||he===s)&&he.child!==null){he.child.return=he,he=he.child;continue}if(he===s)break e;for(;he.sibling===null;){if(he.return===null||he.return===s)break e;ae===he&&(ae=null),he=he.return}ae===he&&(ae=null),he.sibling.return=he.return,he=he.sibling}}break;case 19:Ys(i,s),cr(s),f&4&&Yh(s);break;case 21:break;default:Ys(i,s),cr(s)}}function cr(s){var i=s.flags;if(i&2){try{e:{for(var l=s.return;l!==null;){if(Kh(l)){var f=l;break e}l=l.return}throw Error(t(160))}switch(f.tag){case 5:var v=f.stateNode;f.flags&32&&(Wn(v,""),f.flags&=-33);var w=Qh(s);Mu(s,w,v);break;case 3:case 4:var S=f.stateNode.containerInfo,j=Qh(s);Ou(s,j,S);break;default:throw Error(t(161))}}catch(L){Xt(s,s.return,L)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Og(s,i,l){Ee=s,Jh(s)}function Jh(s,i,l){for(var f=(s.mode&1)!==0;Ee!==null;){var v=Ee,w=v.child;if(v.tag===22&&f){var S=v.memoizedState!==null||Ol;if(!S){var j=v.alternate,L=j!==null&&j.memoizedState!==null||Rn;j=Ol;var K=Rn;if(Ol=S,(Rn=L)&&!K)for(Ee=v;Ee!==null;)S=Ee,L=S.child,S.tag===22&&S.memoizedState!==null?tp(v):L!==null?(L.return=S,Ee=L):tp(v);for(;w!==null;)Ee=w,Jh(w),w=w.sibling;Ee=v,Ol=j,Rn=K}Zh(s)}else(v.subtreeFlags&8772)!==0&&w!==null?(w.return=v,Ee=w):Zh(s)}}function Zh(s){for(;Ee!==null;){var i=Ee;if((i.flags&8772)!==0){var l=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Rn||Ml(5,i);break;case 1:var f=i.stateNode;if(i.flags&4&&!Rn)if(l===null)f.componentDidMount();else{var v=i.elementType===i.type?l.memoizedProps:Qs(i.type,l.memoizedProps);f.componentDidUpdate(v,l.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var w=i.updateQueue;w!==null&&nh(i,w,f);break;case 3:var S=i.updateQueue;if(S!==null){if(l=null,i.child!==null)switch(i.child.tag){case 5:l=i.child.stateNode;break;case 1:l=i.child.stateNode}nh(i,S,l)}break;case 5:var j=i.stateNode;if(l===null&&i.flags&4){l=j;var L=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":L.autoFocus&&l.focus();break;case"img":L.src&&(l.src=L.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var K=i.alternate;if(K!==null){var ae=K.memoizedState;if(ae!==null){var he=ae.dehydrated;he!==null&&Ot(he)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Rn||i.flags&512&&$u(i)}catch(re){Xt(i,i.return,re)}}if(i===s){Ee=null;break}if(l=i.sibling,l!==null){l.return=i.return,Ee=l;break}Ee=i.return}}function ep(s){for(;Ee!==null;){var i=Ee;if(i===s){Ee=null;break}var l=i.sibling;if(l!==null){l.return=i.return,Ee=l;break}Ee=i.return}}function tp(s){for(;Ee!==null;){var i=Ee;try{switch(i.tag){case 0:case 11:case 15:var l=i.return;try{Ml(4,i)}catch(L){Xt(i,l,L)}break;case 1:var f=i.stateNode;if(typeof f.componentDidMount=="function"){var v=i.return;try{f.componentDidMount()}catch(L){Xt(i,v,L)}}var w=i.return;try{$u(i)}catch(L){Xt(i,w,L)}break;case 5:var S=i.return;try{$u(i)}catch(L){Xt(i,S,L)}}}catch(L){Xt(i,i.return,L)}if(i===s){Ee=null;break}var j=i.sibling;if(j!==null){j.return=i.return,Ee=j;break}Ee=i.return}}var Mg=Math.ceil,Dl=ie.ReactCurrentDispatcher,Du=ie.ReactCurrentOwner,$s=ie.ReactCurrentBatchConfig,mt=0,pn=null,Zt=null,xn=0,gs=0,bo=Lr(0),cn=0,Sa=null,Ci=0,Ll=0,Lu=0,Ea=null,ss=null,Fu=0,Co=1/0,kr=null,Fl=!1,Uu=null,Vr=null,Ul=!1,Hr=null,zl=0,Na=0,zu=null,Ta=-1,Bl=0;function Hn(){return(mt&6)!==0?St():Ta!==-1?Ta:Ta=St()}function qr(s){return(s.mode&1)===0?1:(mt&2)!==0&&xn!==0?xn&-xn:_g.transition!==null?(Bl===0&&(Bl=Hi()),Bl):(s=vt,s!==0||(s=window.event,s=s===void 0?16:di(s.type)),s)}function Xs(s,i,l,f){if(50<Na)throw Na=0,zu=null,Error(t(185));vr(s,l,f),((mt&2)===0||s!==pn)&&(s===pn&&((mt&2)===0&&(Ll|=l),cn===4&&Kr(s,xn)),qn(s,f),l===1&&mt===0&&(i.mode&1)===0&&(Co=St()+500,_l&&Ur()))}function qn(s,i){var l=s.callbackNode;Za(s,i);var f=$t(s,s===pn?xn:0);if(f===0)l!==null&&ri(l),s.callbackNode=null,s.callbackPriority=0;else if(i=f&-f,s.callbackPriority!==i){if(l!=null&&ri(l),i===1)s.tag===0?wg(Wu.bind(null,s)):Hf(Wu.bind(null,s)),mg(function(){(mt&6)===0&&Ur()}),l=null;else{switch(Jo(f)){case 1:l=gr;break;case 4:l=sr;break;case 16:l=Vs;break;case 536870912:l=ai;break;default:l=Vs}l=up(l,np.bind(null,s))}s.callbackPriority=i,s.callbackNode=l}}function np(s,i){if(Ta=-1,Bl=0,(mt&6)!==0)throw Error(t(327));var l=s.callbackNode;if(ko()&&s.callbackNode!==l)return null;var f=$t(s,s===pn?xn:0);if(f===0)return null;if((f&30)!==0||(f&s.expiredLanes)!==0||i)i=Vl(s,f);else{i=f;var v=mt;mt|=2;var w=qu();(pn!==s||xn!==i)&&(kr=null,Co=St()+500,Gr(s,i));do try{Lg();break}catch(j){rp(s,j)}while(!0);ou(),Dl.current=w,mt=v,Zt!==null?i=0:(pn=null,xn=0,i=cn)}if(i!==0){if(i===2&&(v=li(s),v!==0&&(f=v,i=Wl(s,v))),i===1)throw l=Sa,Gr(s,0),Kr(s,f),qn(s,St()),l;if(i===6)Kr(s,f);else{if(v=s.current.alternate,(f&30)===0&&!sp(v)&&(i=Vl(s,f),i===2&&(w=li(s),w!==0&&(f=w,i=Wl(s,w))),i===1))throw l=Sa,Gr(s,0),Kr(s,f),qn(s,St()),l;switch(s.finishedWork=v,s.finishedLanes=f,i){case 0:case 1:throw Error(t(345));case 2:ki(s,ss,kr);break;case 3:if(Kr(s,f),(f&130023424)===f&&(i=Fu+500-St(),10<i)){if($t(s,0)!==0)break;if(v=s.suspendedLanes,(v&f)!==f){Hn(),s.pingedLanes|=s.suspendedLanes&v;break}s.timeoutHandle=Gc(ki.bind(null,s,ss,kr),i);break}ki(s,ss,kr);break;case 4:if(Kr(s,f),(f&4194240)===f)break;for(i=s.eventTimes,v=-1;0<f;){var S=31-B(f);w=1<<S,S=i[S],S>v&&(v=S),f&=~w}if(f=v,f=St()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*Mg(f/1960))-f,10<f){s.timeoutHandle=Gc(ki.bind(null,s,ss,kr),f);break}ki(s,ss,kr);break;case 5:ki(s,ss,kr);break;default:throw Error(t(329))}}}return qn(s,St()),s.callbackNode===l?np.bind(null,s):null}function Wl(s,i){var l=Ea;return s.current.memoizedState.isDehydrated&&(Gr(s,i).flags|=256),s=Vl(s,i),s!==2&&(i=ss,ss=l,i!==null&&Bu(i)),s}function Bu(s){ss===null?ss=s:ss.push.apply(ss,s)}function sp(s){for(var i=s;;){if(i.flags&16384){var l=i.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var f=0;f<l.length;f++){var v=l[f],w=v.getSnapshot;v=v.value;try{if(!Ts(w(),v))return!1}catch{return!1}}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Kr(s,i){for(i&=~Lu,i&=~Ll,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var l=31-B(i),f=1<<l;s[l]=-1,i&=~f}}function Wu(s){if((mt&6)!==0)throw Error(t(327));ko();var i=$t(s,0);if((i&1)===0)return qn(s,St()),null;var l=Vl(s,i);if(s.tag!==0&&l===2){var f=li(s);f!==0&&(i=f,l=Wl(s,f))}if(l===1)throw l=Sa,Gr(s,0),Kr(s,i),qn(s,St()),l;if(l===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,ki(s,ss,kr),qn(s,St()),null}function Vu(s,i){var l=mt;mt|=1;try{return s(i)}finally{mt=l,mt===0&&(Co=St()+500,_l&&Ur())}}function Qr(s){Hr!==null&&Hr.tag===0&&(mt&6)===0&&ko();var i=mt;mt|=1;var l=$s.transition,f=vt;try{if($s.transition=null,vt=1,s)return s()}finally{vt=f,$s.transition=l,mt=i,(mt&6)===0&&Ur()}}function Hu(){gs=bo.current,Dt(bo)}function Gr(s,i){s.finishedWork=null,s.finishedLanes=0;var l=s.timeoutHandle;if(l!==-1&&(s.timeoutHandle=-1,pg(l)),Zt!==null)for(l=Zt.return;l!==null;){var f=l;switch(tu(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&yl();break;case 3:xi(),Dt(es),Dt(In),Nl();break;case 5:fu(f);break;case 4:xi();break;case 13:Dt(zt);break;case 19:Dt(zt);break;case 10:au(f.type._context);break;case 22:case 23:Hu()}l=l.return}if(pn=s,Zt=s=Yr(s.current,null),xn=gs=i,cn=0,Sa=null,Lu=Ll=Ci=0,ss=Ea=null,wi!==null){for(i=0;i<wi.length;i++)if(l=wi[i],f=l.interleaved,f!==null){l.interleaved=null;var v=f.next,w=l.pending;if(w!==null){var S=w.next;w.next=v,f.next=S}l.pending=f}wi=null}return s}function rp(s,i){do{var l=Zt;try{if(ou(),Tl.current=Al,yo){for(var f=Lt.memoizedState;f!==null;){var v=f.queue;v!==null&&(v.pending=null),f=f.next}yo=!1}if(bi=0,hn=ln=Lt=null,ya=!1,wa=0,Du.current=null,l===null||l.return===null){cn=1,Sa=i,Zt=null;break}e:{var w=s,S=l.return,j=l,L=i;if(i=xn,j.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){var K=L,ae=j,he=ae.tag;if((ae.mode&1)===0&&(he===0||he===11||he===15)){var re=ae.alternate;re?(ae.updateQueue=re.updateQueue,ae.memoizedState=re.memoizedState,ae.lanes=re.lanes):(ae.updateQueue=null,ae.memoizedState=null)}var Se=Su(S);if(Se!==null){Se.flags&=-257,Ph(Se,S,j,w,i),Se.mode&1&&ku(w,K,i),i=Se,L=K;var Te=i.updateQueue;if(Te===null){var Pe=new Set;Pe.add(L),i.updateQueue=Pe}else Te.add(L);break e}else{if((i&1)===0){ku(w,K,i),Ku();break e}L=Error(t(426))}}else if(Ut&&j.mode&1){var en=Su(S);if(en!==null){(en.flags&65536)===0&&(en.flags|=256),Ph(en,S,j,w,i),ru(_o(L,j));break e}}w=L=_o(L,j),cn!==4&&(cn=2),Ea===null?Ea=[w]:Ea.push(w),w=S;do{switch(w.tag){case 3:w.flags|=65536,i&=-i,w.lanes|=i;var u=Th(w,L,i);du(w,u);break e;case 1:j=L;var E=w.type,W=w.stateNode;if((w.flags&128)===0&&(typeof E.getDerivedStateFromError=="function"||W!==null&&typeof W.componentDidCatch=="function"&&(Vr===null||!Vr.has(W)))){w.flags|=65536,i&=-i,w.lanes|=i;var fe=Ih(w,j,i);du(w,fe);break e}}w=w.return}while(w!==null)}op(l)}catch(Ae){i=Ae,Zt===l&&l!==null&&(Zt=l=l.return);continue}break}while(!0)}function qu(){var s=Dl.current;return Dl.current=Al,s===null?Al:s}function Ku(){(cn===0||cn===3||cn===2)&&(cn=4),pn===null||(Ci&268435455)===0&&(Ll&268435455)===0||Kr(pn,xn)}function Vl(s,i){var l=mt;mt|=2;var f=qu();(pn!==s||xn!==i)&&(kr=null,Gr(s,i));do try{Dg();break}catch(v){rp(s,v)}while(!0);if(ou(),mt=l,Dl.current=f,Zt!==null)throw Error(t(261));return pn=null,xn=0,cn}function Dg(){for(;Zt!==null;)ip(Zt)}function Lg(){for(;Zt!==null&&!ds();)ip(Zt)}function ip(s){var i=cp(s.alternate,s,gs);s.memoizedProps=s.pendingProps,i===null?op(s):Zt=i,Du.current=null}function op(s){var i=s;do{var l=i.alternate;if(s=i.return,(i.flags&32768)===0){if(l=Ag(l,i,gs),l!==null){Zt=l;return}}else{if(l=Rg(l,i),l!==null){l.flags&=32767,Zt=l;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{cn=6,Zt=null;return}}if(i=i.sibling,i!==null){Zt=i;return}Zt=i=s}while(i!==null);cn===0&&(cn=5)}function ki(s,i,l){var f=vt,v=$s.transition;try{$s.transition=null,vt=1,Fg(s,i,l,f)}finally{$s.transition=v,vt=f}return null}function Fg(s,i,l,f){do ko();while(Hr!==null);if((mt&6)!==0)throw Error(t(327));l=s.finishedWork;var v=s.finishedLanes;if(l===null)return null;if(s.finishedWork=null,s.finishedLanes=0,l===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var w=l.lanes|l.childLanes;if(el(s,w),s===pn&&(Zt=pn=null,xn=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||Ul||(Ul=!0,up(Vs,function(){return ko(),null})),w=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||w){w=$s.transition,$s.transition=null;var S=vt;vt=1;var j=mt;mt|=4,Du.current=null,$g(s,l),Xh(l,s),ag(Kc),Yt=!!qc,Kc=qc=null,s.current=l,Og(l),ii(),mt=j,vt=S,$s.transition=w}else s.current=l;if(Ul&&(Ul=!1,Hr=s,zl=v),w=s.pendingLanes,w===0&&(Vr=null),nn(l.stateNode),qn(s,St()),i!==null)for(f=s.onRecoverableError,l=0;l<i.length;l++)v=i[l],f(v.value,{componentStack:v.stack,digest:v.digest});if(Fl)throw Fl=!1,s=Uu,Uu=null,s;return(zl&1)!==0&&s.tag!==0&&ko(),w=s.pendingLanes,(w&1)!==0?s===zu?Na++:(Na=0,zu=s):Na=0,Ur(),null}function ko(){if(Hr!==null){var s=Jo(zl),i=$s.transition,l=vt;try{if($s.transition=null,vt=16>s?16:s,Hr===null)var f=!1;else{if(s=Hr,Hr=null,zl=0,(mt&6)!==0)throw Error(t(331));var v=mt;for(mt|=4,Ee=s.current;Ee!==null;){var w=Ee,S=w.child;if((Ee.flags&16)!==0){var j=w.deletions;if(j!==null){for(var L=0;L<j.length;L++){var K=j[L];for(Ee=K;Ee!==null;){var ae=Ee;switch(ae.tag){case 0:case 11:case 15:ka(8,ae,w)}var he=ae.child;if(he!==null)he.return=ae,Ee=he;else for(;Ee!==null;){ae=Ee;var re=ae.sibling,Se=ae.return;if(qh(ae),ae===K){Ee=null;break}if(re!==null){re.return=Se,Ee=re;break}Ee=Se}}}var Te=w.alternate;if(Te!==null){var Pe=Te.child;if(Pe!==null){Te.child=null;do{var en=Pe.sibling;Pe.sibling=null,Pe=en}while(Pe!==null)}}Ee=w}}if((w.subtreeFlags&2064)!==0&&S!==null)S.return=w,Ee=S;else e:for(;Ee!==null;){if(w=Ee,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:ka(9,w,w.return)}var u=w.sibling;if(u!==null){u.return=w.return,Ee=u;break e}Ee=w.return}}var E=s.current;for(Ee=E;Ee!==null;){S=Ee;var W=S.child;if((S.subtreeFlags&2064)!==0&&W!==null)W.return=S,Ee=W;else e:for(S=E;Ee!==null;){if(j=Ee,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:Ml(9,j)}}catch(Ae){Xt(j,j.return,Ae)}if(j===S){Ee=null;break e}var fe=j.sibling;if(fe!==null){fe.return=j.return,Ee=fe;break e}Ee=j.return}}if(mt=v,Ur(),Vn&&typeof Vn.onPostCommitFiberRoot=="function")try{Vn.onPostCommitFiberRoot(rr,s)}catch{}f=!0}return f}finally{vt=l,$s.transition=i}}return!1}function ap(s,i,l){i=_o(l,i),i=Th(s,i,1),s=ms(s,i,1),i=Hn(),s!==null&&(vr(s,1,i),qn(s,i))}function Xt(s,i,l){if(s.tag===3)ap(s,s,l);else for(;i!==null;){if(i.tag===3){ap(i,s,l);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Vr===null||!Vr.has(f))){s=_o(l,s),s=Ih(i,s,1),i=ms(i,s,1),s=Hn(),i!==null&&(vr(i,1,s),qn(i,s));break}}i=i.return}}function Ug(s,i,l){var f=s.pingCache;f!==null&&f.delete(i),i=Hn(),s.pingedLanes|=s.suspendedLanes&l,pn===s&&(xn&l)===l&&(cn===4||cn===3&&(xn&130023424)===xn&&500>St()-Fu?Gr(s,0):Lu|=l),qn(s,i)}function lp(s,i){i===0&&((s.mode&1)===0?i=1:(i=Fe,Fe<<=1,(Fe&130023424)===0&&(Fe=4194304)));var l=Hn();s=br(s,i),s!==null&&(vr(s,i,l),qn(s,l))}function zg(s){var i=s.memoizedState,l=0;i!==null&&(l=i.retryLane),lp(s,l)}function Bg(s,i){var l=0;switch(s.tag){case 13:var f=s.stateNode,v=s.memoizedState;v!==null&&(l=v.retryLane);break;case 19:f=s.stateNode;break;default:throw Error(t(314))}f!==null&&f.delete(i),lp(s,l)}var cp;cp=function(s,i,l){if(s!==null)if(s.memoizedProps!==i.pendingProps||es.current)ns=!0;else{if((s.lanes&l)===0&&(i.flags&128)===0)return ns=!1,Pg(s,i,l);ns=(s.flags&131072)!==0}else ns=!1,Ut&&(i.flags&1048576)!==0&&qf(i,bl,i.index);switch(i.lanes=0,i.tag){case 2:var f=i.type;$l(s,i),s=i.pendingProps;var v=lo(i,In.current);mo(i,l),v=wo(null,i,f,s,v,l);var w=pu();return i.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,ts(f)?(w=!0,wl(i)):w=!1,i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,uu(i),v.updater=Rl,i.stateNode=v,v._reactInternals=i,xu(i,f,s,l),i=Nu(null,i,f,!0,w,l)):(i.tag=0,Ut&&w&&eu(i),Pn(null,i,v,l),i=i.child),i;case 16:f=i.elementType;e:{switch($l(s,i),s=i.pendingProps,v=f._init,f=v(f._payload),i.type=f,v=i.tag=Vg(f),s=Qs(f,s),v){case 0:i=Eu(null,i,f,s,l);break e;case 1:i=Mh(null,i,f,s,l);break e;case 11:i=Ah(null,i,f,s,l);break e;case 14:i=Rh(null,i,f,Qs(f.type,s),l);break e}throw Error(t(306,f,""))}return i;case 0:return f=i.type,v=i.pendingProps,v=i.elementType===f?v:Qs(f,v),Eu(s,i,f,v,l);case 1:return f=i.type,v=i.pendingProps,v=i.elementType===f?v:Qs(f,v),Mh(s,i,f,v,l);case 3:e:{if(Dh(i),s===null)throw Error(t(387));f=i.pendingProps,w=i.memoizedState,v=w.element,th(s,i),_i(i,f,null,l);var S=i.memoizedState;if(f=S.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},i.updateQueue.baseState=w,i.memoizedState=w,i.flags&256){v=_o(Error(t(423)),i),i=Lh(s,i,f,l,v);break e}else if(f!==v){v=_o(Error(t(424)),i),i=Lh(s,i,f,l,v);break e}else for(ps=Dr(i.stateNode.containerInfo.firstChild),hs=i,Ut=!0,Ks=null,l=Zf(i,null,f,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(fo(),f===v){i=Cr(s,i,l);break e}Pn(s,i,f,l)}i=i.child}return i;case 5:return sh(i),s===null&&su(i),f=i.type,v=i.pendingProps,w=s!==null?s.memoizedProps:null,S=v.children,Qc(f,v)?S=null:w!==null&&Qc(f,w)&&(i.flags|=32),Oh(s,i),Pn(s,i,S,l),i.child;case 6:return s===null&&su(i),null;case 13:return Fh(s,i,l);case 4:return ga(i,i.stateNode.containerInfo),f=i.pendingProps,s===null?i.child=ho(i,null,f,l):Pn(s,i,f,l),i.child;case 11:return f=i.type,v=i.pendingProps,v=i.elementType===f?v:Qs(f,v),Ah(s,i,f,v,l);case 7:return Pn(s,i,i.pendingProps,l),i.child;case 8:return Pn(s,i,i.pendingProps.children,l),i.child;case 12:return Pn(s,i,i.pendingProps.children,l),i.child;case 10:e:{if(f=i.type._context,v=i.pendingProps,w=i.memoizedProps,S=v.value,Tt(Sl,f._currentValue),f._currentValue=S,w!==null)if(Ts(w.value,S)){if(w.children===v.children&&!es.current){i=Cr(s,i,l);break e}}else for(w=i.child,w!==null&&(w.return=i);w!==null;){var j=w.dependencies;if(j!==null){S=w.child;for(var L=j.firstContext;L!==null;){if(L.context===f){if(w.tag===1){L=ar(-1,l&-l),L.tag=2;var K=w.updateQueue;if(K!==null){K=K.shared;var ae=K.pending;ae===null?L.next=L:(L.next=ae.next,ae.next=L),K.pending=L}}w.lanes|=l,L=w.alternate,L!==null&&(L.lanes|=l),lu(w.return,l,i),j.lanes|=l;break}L=L.next}}else if(w.tag===10)S=w.type===i.type?null:w.child;else if(w.tag===18){if(S=w.return,S===null)throw Error(t(341));S.lanes|=l,j=S.alternate,j!==null&&(j.lanes|=l),lu(S,l,i),S=w.sibling}else S=w.child;if(S!==null)S.return=w;else for(S=w;S!==null;){if(S===i){S=null;break}if(w=S.sibling,w!==null){w.return=S.return,S=w;break}S=S.return}w=S}Pn(s,i,v.children,l),i=i.child}return i;case 9:return v=i.type,f=i.pendingProps.children,mo(i,l),v=As(v),f=f(v),i.flags|=1,Pn(s,i,f,l),i.child;case 14:return f=i.type,v=Qs(f,i.pendingProps),v=Qs(f.type,v),Rh(s,i,f,v,l);case 15:return jh(s,i,i.type,i.pendingProps,l);case 17:return f=i.type,v=i.pendingProps,v=i.elementType===f?v:Qs(f,v),$l(s,i),i.tag=1,ts(f)?(s=!0,wl(i)):s=!1,mo(i,l),Eh(i,f,v),xu(i,f,v,l),Nu(null,i,f,!0,s,l);case 19:return zh(s,i,l);case 22:return $h(s,i,l)}throw Error(t(156,i.tag))};function up(s,i){return si(s,i)}function Wg(s,i,l,f){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Os(s,i,l,f){return new Wg(s,i,l,f)}function Qu(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Vg(s){if(typeof s=="function")return Qu(s)?1:0;if(s!=null){if(s=s.$$typeof,s===$e)return 11;if(s===ee)return 14}return 2}function Yr(s,i){var l=s.alternate;return l===null?(l=Os(s.tag,i,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=i,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&14680064,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,i=s.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l}function Hl(s,i,l,f,v,w){var S=2;if(f=s,typeof s=="function")Qu(s)&&(S=1);else if(typeof s=="string")S=5;else e:switch(s){case de:return Si(l.children,v,w,i);case Ie:S=8,v|=8;break;case Je:return s=Os(12,l,i,v|2),s.elementType=Je,s.lanes=w,s;case be:return s=Os(13,l,i,v),s.elementType=be,s.lanes=w,s;case te:return s=Os(19,l,i,v),s.elementType=te,s.lanes=w,s;case we:return ql(l,v,w,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Qe:S=10;break e;case Ve:S=9;break e;case $e:S=11;break e;case ee:S=14;break e;case Y:S=16,f=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return i=Os(S,l,i,v),i.elementType=s,i.type=f,i.lanes=w,i}function Si(s,i,l,f){return s=Os(7,s,f,i),s.lanes=l,s}function ql(s,i,l,f){return s=Os(22,s,f,i),s.elementType=we,s.lanes=l,s.stateNode={isHidden:!1},s}function Gu(s,i,l){return s=Os(6,s,null,i),s.lanes=l,s}function Yu(s,i,l){return i=Os(4,s.children!==null?s.children:[],s.key,i),i.lanes=l,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function Hg(s,i,l,f,v){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qi(0),this.expirationTimes=qi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qi(0),this.identifierPrefix=f,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function Xu(s,i,l,f,v,w,S,j,L){return s=new Hg(s,i,l,j,L),i===1?(i=1,w===!0&&(i|=8)):i=0,w=Os(3,null,null,i),s.current=w,w.stateNode=s,w.memoizedState={element:f,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},uu(w),s}function qg(s,i,l){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ze,key:f==null?null:""+f,children:s,containerInfo:i,implementation:l}}function dp(s){if(!s)return Fr;s=s._reactInternals;e:{if(ke(s)!==s||s.tag!==1)throw Error(t(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(ts(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(s.tag===1){var l=s.type;if(ts(l))return Wf(s,l,i)}return i}function fp(s,i,l,f,v,w,S,j,L){return s=Xu(l,f,!0,s,v,w,S,j,L),s.context=dp(null),l=s.current,f=Hn(),v=qr(l),w=ar(f,v),w.callback=i??null,ms(l,w,v),s.current.lanes=v,vr(s,v,f),qn(s,f),s}function Kl(s,i,l,f){var v=i.current,w=Hn(),S=qr(v);return l=dp(l),i.context===null?i.context=l:i.pendingContext=l,i=ar(w,S),i.payload={element:s},f=f===void 0?null:f,f!==null&&(i.callback=f),s=ms(v,i,S),s!==null&&(Xs(s,v,S,w),ma(s,v,S)),S}function Ql(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function hp(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<i?l:i}}function Ju(s,i){hp(s,i),(s=s.alternate)&&hp(s,i)}function Kg(){return null}var pp=typeof reportError=="function"?reportError:function(s){console.error(s)};function Zu(s){this._internalRoot=s}Gl.prototype.render=Zu.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(t(409));Kl(s,i,null,null)},Gl.prototype.unmount=Zu.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Qr(function(){Kl(null,s,null,null)}),i[yr]=null}};function Gl(s){this._internalRoot=s}Gl.prototype.unstable_scheduleHydration=function(s){if(s){var i=ea();s={blockedOn:null,target:s,priority:i};for(var l=0;l<A.length&&i!==0&&i<A[l].priority;l++);A.splice(l,0,s),l===0&&lt(s)}};function ed(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Yl(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function mp(){}function Qg(s,i,l,f,v){if(v){if(typeof f=="function"){var w=f;f=function(){var K=Ql(S);w.call(K)}}var S=fp(i,f,s,0,null,!1,!1,"",mp);return s._reactRootContainer=S,s[yr]=S.current,ua(s.nodeType===8?s.parentNode:s),Qr(),S}for(;v=s.lastChild;)s.removeChild(v);if(typeof f=="function"){var j=f;f=function(){var K=Ql(L);j.call(K)}}var L=Xu(s,0,!1,null,null,!1,!1,"",mp);return s._reactRootContainer=L,s[yr]=L.current,ua(s.nodeType===8?s.parentNode:s),Qr(function(){Kl(i,L,l,f)}),L}function Xl(s,i,l,f,v){var w=l._reactRootContainer;if(w){var S=w;if(typeof v=="function"){var j=v;v=function(){var L=Ql(S);j.call(L)}}Kl(i,S,s,v)}else S=Qg(l,i,s,v,f);return Ql(S)}Zo=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var l=dn(i.pendingLanes);l!==0&&(ci(i,l|1),qn(i,St()),(mt&6)===0&&(Co=St()+500,Ur()))}break;case 13:Qr(function(){var f=br(s,1);if(f!==null){var v=Hn();Xs(f,s,1,v)}}),Ju(s,1)}},Ki=function(s){if(s.tag===13){var i=br(s,134217728);if(i!==null){var l=Hn();Xs(i,s,134217728,l)}Ju(s,134217728)}},Qi=function(s){if(s.tag===13){var i=qr(s),l=br(s,i);if(l!==null){var f=Hn();Xs(l,s,i,f)}Ju(s,i)}},ea=function(){return vt},Gi=function(s,i){var l=vt;try{return vt=s,i()}finally{vt=l}},Ft=function(s,i,l){switch(i){case"input":if(Us(s,l),i=l.name,l.type==="radio"&&i!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<l.length;i++){var f=l[i];if(f!==s&&f.form===s.form){var v=vl(f);if(!v)throw Error(t(90));En(f),Us(f,v)}}}break;case"textarea":Xn(s,l);break;case"select":i=l.value,i!=null&&os(s,!!l.multiple,i,!1)}},Jt=Vu,Ct=Qr;var Gg={usingClientEntryPoint:!1,Events:[ha,oo,vl,bt,wt,Vu]},Ia={findFiberByHostInstance:mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Yg={bundleType:Ia.bundleType,version:Ia.version,rendererPackageName:Ia.rendererPackageName,rendererConfig:Ia.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ie.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=nr(s),s===null?null:s.stateNode},findFiberByHostInstance:Ia.findFiberByHostInstance||Kg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jl.isDisabled&&Jl.supportsFiber)try{rr=Jl.inject(Yg),Vn=Jl}catch{}}return Ds.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gg,Ds.createPortal=function(s,i){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ed(i))throw Error(t(200));return qg(s,i,null,l)},Ds.createRoot=function(s,i){if(!ed(s))throw Error(t(299));var l=!1,f="",v=pp;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onRecoverableError!==void 0&&(v=i.onRecoverableError)),i=Xu(s,1,!1,null,null,l,!1,f,v),s[yr]=i.current,ua(s.nodeType===8?s.parentNode:s),new Zu(i)},Ds.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=nr(i),s=s===null?null:s.stateNode,s},Ds.flushSync=function(s){return Qr(s)},Ds.hydrate=function(s,i,l){if(!Yl(i))throw Error(t(200));return Xl(null,s,i,!0,l)},Ds.hydrateRoot=function(s,i,l){if(!ed(s))throw Error(t(405));var f=l!=null&&l.hydratedSources||null,v=!1,w="",S=pp;if(l!=null&&(l.unstable_strictMode===!0&&(v=!0),l.identifierPrefix!==void 0&&(w=l.identifierPrefix),l.onRecoverableError!==void 0&&(S=l.onRecoverableError)),i=fp(i,null,s,1,l??null,v,!1,w,S),s[yr]=i.current,ua(s),f)for(s=0;s<f.length;s++)l=f[s],v=l._getVersion,v=v(l._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[l,v]:i.mutableSourceEagerHydrationData.push(l,v);return new Gl(i)},Ds.render=function(s,i,l){if(!Yl(i))throw Error(t(200));return Xl(null,s,i,!1,l)},Ds.unmountComponentAtNode=function(s){if(!Yl(s))throw Error(t(40));return s._reactRootContainer?(Qr(function(){Xl(null,null,s,!1,function(){s._reactRootContainer=null,s[yr]=null})}),!0):!1},Ds.unstable_batchedUpdates=Vu,Ds.unstable_renderSubtreeIntoContainer=function(s,i,l,f){if(!Yl(l))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Xl(s,i,l,!1,f)},Ds.version="18.3.1-next-f1338f8080-20240426",Ds}var Uw;function lS(){if(Uw)return fv.exports;Uw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),fv.exports=aS(),fv.exports}var zw;function cS(){if(zw)return xp;zw=1;var n=lS();return xp.createRoot=n.createRoot,xp.hydrateRoot=n.hydrateRoot,xp}var uS=cS();const dS=W1(uS);var wc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(n){return this.listeners.add(n),this.onSubscribe(),()=>{this.listeners.delete(n),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},fS={setTimeout:(n,e)=>setTimeout(n,e),clearTimeout:n=>clearTimeout(n),setInterval:(n,e)=>setInterval(n,e),clearInterval:n=>clearInterval(n)},hS=class{#e=fS;#t=!1;setTimeoutProvider(n){this.#e=n}setTimeout(n,e){return this.#e.setTimeout(n,e)}clearTimeout(n){this.#e.clearTimeout(n)}setInterval(n,e){return this.#e.setInterval(n,e)}clearInterval(n){this.#e.clearInterval(n)}},Oa=new hS;function pS(n){setTimeout(n,0)}var za=typeof window>"u"||"Deno"in globalThis;function ys(){}function mS(n,e){return typeof n=="function"?n(e):n}function Uv(n){return typeof n=="number"&&n>=0&&n!==1/0}function H1(n,e){return Math.max(n+(e||0)-Date.now(),0)}function Lo(n,e){return typeof n=="function"?n(e):n}function ur(n,e){return typeof n=="function"?n(e):n}function Bw(n,e){const{type:t="all",exact:r,fetchStatus:a,predicate:d,queryKey:h,stale:g}=n;if(h){if(r){if(e.queryHash!==C0(h,e.options))return!1}else if(!bd(e.queryKey,h))return!1}if(t!=="all"){const y=e.isActive();if(t==="active"&&!y||t==="inactive"&&y)return!1}return!(typeof g=="boolean"&&e.isStale()!==g||a&&a!==e.state.fetchStatus||d&&!d(e))}function Ww(n,e){const{exact:t,status:r,predicate:a,mutationKey:d}=n;if(d){if(!e.options.mutationKey)return!1;if(t){if(Ba(e.options.mutationKey)!==Ba(d))return!1}else if(!bd(e.options.mutationKey,d))return!1}return!(r&&e.state.status!==r||a&&!a(e))}function C0(n,e){return(e?.queryKeyHashFn||Ba)(n)}function Ba(n){return JSON.stringify(n,(e,t)=>zv(t)?Object.keys(t).sort().reduce((r,a)=>(r[a]=t[a],r),{}):t)}function bd(n,e){return n===e?!0:typeof n!=typeof e?!1:n&&e&&typeof n=="object"&&typeof e=="object"?Object.keys(e).every(t=>bd(n[t],e[t])):!1}var gS=Object.prototype.hasOwnProperty;function q1(n,e){if(n===e)return n;const t=Vw(n)&&Vw(e);if(!t&&!(zv(n)&&zv(e)))return e;const a=(t?n:Object.keys(n)).length,d=t?e:Object.keys(e),h=d.length,g=t?new Array(h):{};let y=0;for(let _=0;_<h;_++){const N=t?_:d[_],T=n[N],k=e[N];if(T===k){g[N]=T,(t?_<a:gS.call(n,N))&&y++;continue}if(T===null||k===null||typeof T!="object"||typeof k!="object"){g[N]=k;continue}const $=q1(T,k);g[N]=$,$===T&&y++}return a===h&&y===a?n:g}function qp(n,e){if(!e||Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(n[t]!==e[t])return!1;return!0}function Vw(n){return Array.isArray(n)&&n.length===Object.keys(n).length}function zv(n){if(!Hw(n))return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!Hw(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(n)!==Object.prototype)}function Hw(n){return Object.prototype.toString.call(n)==="[object Object]"}function vS(n){return new Promise(e=>{Oa.setTimeout(e,n)})}function Bv(n,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(n,e):t.structuralSharing!==!1?q1(n,e):e}function yS(n,e,t=0){const r=[...n,e];return t&&r.length>t?r.slice(1):r}function wS(n,e,t=0){const r=[e,...n];return t&&r.length>t?r.slice(0,-1):r}var k0=Symbol();function K1(n,e){return!n.queryFn&&e?.initialPromise?()=>e.initialPromise:!n.queryFn||n.queryFn===k0?()=>Promise.reject(new Error(`Missing queryFn: '${n.queryHash}'`)):n.queryFn}function Q1(n,e){return typeof n=="function"?n(...e):!!n}var _S=class extends wc{#e;#t;#n;constructor(){super(),this.#n=n=>{if(!za&&window.addEventListener){const e=()=>n();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(n){this.#n=n,this.#t?.(),this.#t=n(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(n){this.#e!==n&&(this.#e=n,this.onFocus())}onFocus(){const n=this.isFocused();this.listeners.forEach(e=>{e(n)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},S0=new _S;function Wv(){let n,e;const t=new Promise((a,d)=>{n=a,e=d});t.status="pending",t.catch(()=>{});function r(a){Object.assign(t,a),delete t.resolve,delete t.reject}return t.resolve=a=>{r({status:"fulfilled",value:a}),n(a)},t.reject=a=>{r({status:"rejected",reason:a}),e(a)},t}var xS=pS;function bS(){let n=[],e=0,t=g=>{g()},r=g=>{g()},a=xS;const d=g=>{e?n.push(g):a(()=>{t(g)})},h=()=>{const g=n;n=[],g.length&&a(()=>{r(()=>{g.forEach(y=>{t(y)})})})};return{batch:g=>{let y;e++;try{y=g()}finally{e--,e||h()}return y},batchCalls:g=>(...y)=>{d(()=>{g(...y)})},schedule:d,setNotifyFunction:g=>{t=g},setBatchNotifyFunction:g=>{r=g},setScheduler:g=>{a=g}}}var Cn=bS(),CS=class extends wc{#e=!0;#t;#n;constructor(){super(),this.#n=n=>{if(!za&&window.addEventListener){const e=()=>n(!0),t=()=>n(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(n){this.#n=n,this.#t?.(),this.#t=n(this.setOnline.bind(this))}setOnline(n){this.#e!==n&&(this.#e=n,this.listeners.forEach(t=>{t(n)}))}isOnline(){return this.#e}},Kp=new CS;function kS(n){return Math.min(1e3*2**n,3e4)}function G1(n){return(n??"online")==="online"?Kp.isOnline():!0}var Vv=class extends Error{constructor(n){super("CancelledError"),this.revert=n?.revert,this.silent=n?.silent}};function Y1(n){let e=!1,t=0,r;const a=Wv(),d=()=>a.status!=="pending",h=F=>{if(!d()){const H=new Vv(F);k(H),n.onCancel?.(H)}},g=()=>{e=!0},y=()=>{e=!1},_=()=>S0.isFocused()&&(n.networkMode==="always"||Kp.isOnline())&&n.canRun(),N=()=>G1(n.networkMode)&&n.canRun(),T=F=>{d()||(r?.(),a.resolve(F))},k=F=>{d()||(r?.(),a.reject(F))},$=()=>new Promise(F=>{r=H=>{(d()||_())&&F(H)},n.onPause?.()}).then(()=>{r=void 0,d()||n.onContinue?.()}),M=()=>{if(d())return;let F;const H=t===0?n.initialPromise:void 0;try{F=H??n.fn()}catch(ye){F=Promise.reject(ye)}Promise.resolve(F).then(T).catch(ye=>{if(d())return;const le=n.retry??(za?0:3),C=n.retryDelay??kS,ie=typeof C=="function"?C(t,ye):C,c=le===!0||typeof le=="number"&&t<le||typeof le=="function"&&le(t,ye);if(e||!c){k(ye);return}t++,n.onFail?.(t,ye),vS(ie).then(()=>_()?void 0:$()).then(()=>{e?k(ye):M()})})};return{promise:a,status:()=>a.status,cancel:h,continue:()=>(r?.(),a),cancelRetry:g,continueRetry:y,canStart:N,start:()=>(N()?M():$().then(M),a)}}var X1=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Uv(this.gcTime)&&(this.#e=Oa.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(n){this.gcTime=Math.max(this.gcTime||0,n??(za?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Oa.clearTimeout(this.#e),this.#e=void 0)}},SS=class extends X1{#e;#t;#n;#r;#s;#o;#a;constructor(n){super(),this.#a=!1,this.#o=n.defaultOptions,this.setOptions(n.options),this.observers=[],this.#r=n.client,this.#n=this.#r.getQueryCache(),this.queryKey=n.queryKey,this.queryHash=n.queryHash,this.#e=Kw(this.options),this.state=n.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(n){if(this.options={...this.#o,...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=Kw(this.options);e.data!==void 0&&(this.setState(qw(e.data,e.dataUpdatedAt)),this.#e=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(n,e){const t=Bv(this.state.data,n,this.options);return this.#i({data:t,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),t}setState(n,e){this.#i({type:"setState",state:n,setStateOptions:e})}cancel(n){const e=this.#s?.promise;return this.#s?.cancel(n),e?e.then(ys).catch(ys):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(n=>ur(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===k0||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>Lo(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!H1(this.state.dataUpdatedAt,n)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(e=>e!==n),this.observers.length||(this.#s&&(this.#a?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}async fetch(n,e){if(this.state.fetchStatus!=="idle"&&this.#s?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(n&&this.setOptions(n),!this.options.queryFn){const g=this.observers.find(y=>y.options.queryFn);g&&this.setOptions(g.options)}const t=new AbortController,r=g=>{Object.defineProperty(g,"signal",{enumerable:!0,get:()=>(this.#a=!0,t.signal)})},a=()=>{const g=K1(this.options,e),_=(()=>{const N={client:this.#r,queryKey:this.queryKey,meta:this.meta};return r(N),N})();return this.#a=!1,this.options.persister?this.options.persister(g,_,this):g(_)},h=(()=>{const g={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#r,state:this.state,fetchFn:a};return r(g),g})();this.options.behavior?.onFetch(h,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==h.fetchOptions?.meta)&&this.#i({type:"fetch",meta:h.fetchOptions?.meta}),this.#s=Y1({initialPromise:e?.initialPromise,fn:h.fetchFn,onCancel:g=>{g instanceof Vv&&g.revert&&this.setState({...this.#t,fetchStatus:"idle"}),t.abort()},onFail:(g,y)=>{this.#i({type:"failed",failureCount:g,error:y})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay,networkMode:h.options.networkMode,canRun:()=>!0});try{const g=await this.#s.start();if(g===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(g),this.#n.config.onSuccess?.(g,this),this.#n.config.onSettled?.(g,this.state.error,this),g}catch(g){if(g instanceof Vv){if(g.silent)return this.#s.promise;if(g.revert){if(this.state.data===void 0)throw g;return this.state.data}}throw this.#i({type:"error",error:g}),this.#n.config.onError?.(g,this),this.#n.config.onSettled?.(this.state.data,g,this),g}finally{this.scheduleGc()}}#i(n){const e=t=>{switch(n.type){case"failed":return{...t,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...J1(t.data,this.options),fetchMeta:n.meta??null};case"success":const r={...t,...qw(n.data,n.dataUpdatedAt),dataUpdateCount:t.dataUpdateCount+1,...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=n.manual?r:void 0,r;case"error":const a=n.error;return{...t,error:a,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...n.state}}};this.state=e(this.state),Cn.batch(()=>{this.observers.forEach(t=>{t.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:n})})}};function J1(n,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:G1(e.networkMode)?"fetching":"paused",...n===void 0&&{error:null,status:"pending"}}}function qw(n,e){return{data:n,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Kw(n){const e=typeof n.initialData=="function"?n.initialData():n.initialData,t=e!==void 0,r=t?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var ES=class extends wc{constructor(n,e){super(),this.options=e,this.#e=n,this.#i=null,this.#a=Wv(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#r=void 0;#s;#o;#a;#i;#m;#f;#h;#c;#u;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Qw(this.#t,this.options)?this.#d():this.updateResult(),this.#w())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Hv(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Hv(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#_(),this.#x(),this.#t.removeObserver(this)}setOptions(n){const e=this.options,t=this.#t;if(this.options=this.#e.defaultQueryOptions(n),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ur(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#b(),this.#t.setOptions(this.options),e._defaulted&&!qp(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const r=this.hasListeners();r&&Gw(this.#t,t,this.options,e)&&this.#d(),this.updateResult(),r&&(this.#t!==t||ur(this.options.enabled,this.#t)!==ur(e.enabled,this.#t)||Lo(this.options.staleTime,this.#t)!==Lo(e.staleTime,this.#t))&&this.#g();const a=this.#v();r&&(this.#t!==t||ur(this.options.enabled,this.#t)!==ur(e.enabled,this.#t)||a!==this.#l)&&this.#y(a)}getOptimisticResult(n){const e=this.#e.getQueryCache().build(this.#e,n),t=this.createResult(e,n);return TS(this,t)&&(this.#r=t,this.#o=this.options,this.#s=this.#t.state),t}getCurrentResult(){return this.#r}trackResult(n,e){return new Proxy(n,{get:(t,r)=>(this.trackProp(r),e?.(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(t,r))})}trackProp(n){this.#p.add(n)}getCurrentQuery(){return this.#t}refetch({...n}={}){return this.fetch({...n})}fetchOptimistic(n){const e=this.#e.defaultQueryOptions(n),t=this.#e.getQueryCache().build(this.#e,e);return t.fetch().then(()=>this.createResult(t,e))}fetch(n){return this.#d({...n,cancelRefetch:n.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#d(n){this.#b();let e=this.#t.fetch(this.options,n);return n?.throwOnError||(e=e.catch(ys)),e}#g(){this.#_();const n=Lo(this.options.staleTime,this.#t);if(za||this.#r.isStale||!Uv(n))return;const t=H1(this.#r.dataUpdatedAt,n)+1;this.#c=Oa.setTimeout(()=>{this.#r.isStale||this.updateResult()},t)}#v(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#y(n){this.#x(),this.#l=n,!(za||ur(this.options.enabled,this.#t)===!1||!Uv(this.#l)||this.#l===0)&&(this.#u=Oa.setInterval(()=>{(this.options.refetchIntervalInBackground||S0.isFocused())&&this.#d()},this.#l))}#w(){this.#g(),this.#y(this.#v())}#_(){this.#c&&(Oa.clearTimeout(this.#c),this.#c=void 0)}#x(){this.#u&&(Oa.clearInterval(this.#u),this.#u=void 0)}createResult(n,e){const t=this.#t,r=this.options,a=this.#r,d=this.#s,h=this.#o,y=n!==t?n.state:this.#n,{state:_}=n;let N={..._},T=!1,k;if(e._optimisticResults){const Ie=this.hasListeners(),Je=!Ie&&Qw(n,e),Qe=Ie&&Gw(n,t,e,r);(Je||Qe)&&(N={...N,...J1(_.data,n.options)}),e._optimisticResults==="isRestoring"&&(N.fetchStatus="idle")}let{error:$,errorUpdatedAt:M,status:F}=N;k=N.data;let H=!1;if(e.placeholderData!==void 0&&k===void 0&&F==="pending"){let Ie;a?.isPlaceholderData&&e.placeholderData===h?.placeholderData?(Ie=a.data,H=!0):Ie=typeof e.placeholderData=="function"?e.placeholderData(this.#h?.state.data,this.#h):e.placeholderData,Ie!==void 0&&(F="success",k=Bv(a?.data,Ie,e),T=!0)}if(e.select&&k!==void 0&&!H)if(a&&k===d?.data&&e.select===this.#m)k=this.#f;else try{this.#m=e.select,k=e.select(k),k=Bv(a?.data,k,e),this.#f=k,this.#i=null}catch(Ie){this.#i=Ie}this.#i&&($=this.#i,k=this.#f,M=Date.now(),F="error");const ye=N.fetchStatus==="fetching",le=F==="pending",C=F==="error",ie=le&&ye,c=k!==void 0,de={status:F,fetchStatus:N.fetchStatus,isPending:le,isSuccess:F==="success",isError:C,isInitialLoading:ie,isLoading:ie,data:k,dataUpdatedAt:N.dataUpdatedAt,error:$,errorUpdatedAt:M,failureCount:N.fetchFailureCount,failureReason:N.fetchFailureReason,errorUpdateCount:N.errorUpdateCount,isFetched:N.dataUpdateCount>0||N.errorUpdateCount>0,isFetchedAfterMount:N.dataUpdateCount>y.dataUpdateCount||N.errorUpdateCount>y.errorUpdateCount,isFetching:ye,isRefetching:ye&&!le,isLoadingError:C&&!c,isPaused:N.fetchStatus==="paused",isPlaceholderData:T,isRefetchError:C&&c,isStale:E0(n,e),refetch:this.refetch,promise:this.#a,isEnabled:ur(e.enabled,n)!==!1};if(this.options.experimental_prefetchInRender){const Ie=Ve=>{de.status==="error"?Ve.reject(de.error):de.data!==void 0&&Ve.resolve(de.data)},Je=()=>{const Ve=this.#a=de.promise=Wv();Ie(Ve)},Qe=this.#a;switch(Qe.status){case"pending":n.queryHash===t.queryHash&&Ie(Qe);break;case"fulfilled":(de.status==="error"||de.data!==Qe.value)&&Je();break;case"rejected":(de.status!=="error"||de.error!==Qe.reason)&&Je();break}}return de}updateResult(){const n=this.#r,e=this.createResult(this.#t,this.options);if(this.#s=this.#t.state,this.#o=this.options,this.#s.data!==void 0&&(this.#h=this.#t),qp(e,n))return;this.#r=e;const t=()=>{if(!n)return!0;const{notifyOnChangeProps:r}=this.options,a=typeof r=="function"?r():r;if(a==="all"||!a&&!this.#p.size)return!0;const d=new Set(a??this.#p);return this.options.throwOnError&&d.add("error"),Object.keys(this.#r).some(h=>{const g=h;return this.#r[g]!==n[g]&&d.has(g)})};this.#C({listeners:t()})}#b(){const n=this.#e.getQueryCache().build(this.#e,this.options);if(n===this.#t)return;const e=this.#t;this.#t=n,this.#n=n.state,this.hasListeners()&&(e?.removeObserver(this),n.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#w()}#C(n){Cn.batch(()=>{n.listeners&&this.listeners.forEach(e=>{e(this.#r)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function NS(n,e){return ur(e.enabled,n)!==!1&&n.state.data===void 0&&!(n.state.status==="error"&&e.retryOnMount===!1)}function Qw(n,e){return NS(n,e)||n.state.data!==void 0&&Hv(n,e,e.refetchOnMount)}function Hv(n,e,t){if(ur(e.enabled,n)!==!1&&Lo(e.staleTime,n)!=="static"){const r=typeof t=="function"?t(n):t;return r==="always"||r!==!1&&E0(n,e)}return!1}function Gw(n,e,t,r){return(n!==e||ur(r.enabled,n)===!1)&&(!t.suspense||n.state.status!=="error")&&E0(n,t)}function E0(n,e){return ur(e.enabled,n)!==!1&&n.isStaleByTime(Lo(e.staleTime,n))}function TS(n,e){return!qp(n.getCurrentResult(),e)}function Yw(n){return{onFetch:(e,t)=>{const r=e.options,a=e.fetchOptions?.meta?.fetchMore?.direction,d=e.state.data?.pages||[],h=e.state.data?.pageParams||[];let g={pages:[],pageParams:[]},y=0;const _=async()=>{let N=!1;const T=M=>{Object.defineProperty(M,"signal",{enumerable:!0,get:()=>(e.signal.aborted?N=!0:e.signal.addEventListener("abort",()=>{N=!0}),e.signal)})},k=K1(e.options,e.fetchOptions),$=async(M,F,H)=>{if(N)return Promise.reject();if(F==null&&M.pages.length)return Promise.resolve(M);const le=(()=>{const ze={client:e.client,queryKey:e.queryKey,pageParam:F,direction:H?"backward":"forward",meta:e.options.meta};return T(ze),ze})(),C=await k(le),{maxPages:ie}=e.options,c=H?wS:yS;return{pages:c(M.pages,C,ie),pageParams:c(M.pageParams,F,ie)}};if(a&&d.length){const M=a==="backward",F=M?IS:Xw,H={pages:d,pageParams:h},ye=F(r,H);g=await $(H,ye,M)}else{const M=n??d.length;do{const F=y===0?h[0]??r.initialPageParam:Xw(r,g);if(y>0&&F==null)break;g=await $(g,F),y++}while(y<M)}return g};e.options.persister?e.fetchFn=()=>e.options.persister?.(_,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t):e.fetchFn=_}}}function Xw(n,{pages:e,pageParams:t}){const r=e.length-1;return e.length>0?n.getNextPageParam(e[r],e,t[r],t):void 0}function IS(n,{pages:e,pageParams:t}){return e.length>0?n.getPreviousPageParam?.(e[0],e,t[0],t):void 0}var PS=class extends X1{#e;#t;#n;#r;constructor(n){super(),this.#e=n.client,this.mutationId=n.mutationId,this.#n=n.mutationCache,this.#t=[],this.state=n.state||Z1(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){this.#t.includes(n)||(this.#t.push(n),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){this.#t=this.#t.filter(e=>e!==n),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#r?.continue()??this.execute(this.state.variables)}async execute(n){const e=()=>{this.#s({type:"continue"})},t={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#r=Y1({fn:()=>this.options.mutationFn?this.options.mutationFn(n,t):Promise.reject(new Error("No mutationFn found")),onFail:(d,h)=>{this.#s({type:"failed",failureCount:d,error:h})},onPause:()=>{this.#s({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const r=this.state.status==="pending",a=!this.#r.canStart();try{if(r)e();else{this.#s({type:"pending",variables:n,isPaused:a}),await this.#n.config.onMutate?.(n,this,t);const h=await this.options.onMutate?.(n,t);h!==this.state.context&&this.#s({type:"pending",context:h,variables:n,isPaused:a})}const d=await this.#r.start();return await this.#n.config.onSuccess?.(d,n,this.state.context,this,t),await this.options.onSuccess?.(d,n,this.state.context,t),await this.#n.config.onSettled?.(d,null,this.state.variables,this.state.context,this,t),await this.options.onSettled?.(d,null,n,this.state.context,t),this.#s({type:"success",data:d}),d}catch(d){try{throw await this.#n.config.onError?.(d,n,this.state.context,this,t),await this.options.onError?.(d,n,this.state.context,t),await this.#n.config.onSettled?.(void 0,d,this.state.variables,this.state.context,this,t),await this.options.onSettled?.(void 0,d,n,this.state.context,t),d}finally{this.#s({type:"error",error:d})}}finally{this.#n.runNext(this)}}#s(n){const e=t=>{switch(n.type){case"failed":return{...t,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...t,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:n.error,failureCount:t.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=e(this.state),Cn.batch(()=>{this.#t.forEach(t=>{t.onMutationUpdate(n)}),this.#n.notify({mutation:this,type:"updated",action:n})})}};function Z1(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var AS=class extends wc{constructor(n={}){super(),this.config=n,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(n,e,t){const r=new PS({client:n,mutationCache:this,mutationId:++this.#n,options:n.defaultMutationOptions(e),state:t});return this.add(r),r}add(n){this.#e.add(n);const e=bp(n);if(typeof e=="string"){const t=this.#t.get(e);t?t.push(n):this.#t.set(e,[n])}this.notify({type:"added",mutation:n})}remove(n){if(this.#e.delete(n)){const e=bp(n);if(typeof e=="string"){const t=this.#t.get(e);if(t)if(t.length>1){const r=t.indexOf(n);r!==-1&&t.splice(r,1)}else t[0]===n&&this.#t.delete(e)}}this.notify({type:"removed",mutation:n})}canRun(n){const e=bp(n);if(typeof e=="string"){const r=this.#t.get(e)?.find(a=>a.state.status==="pending");return!r||r===n}else return!0}runNext(n){const e=bp(n);return typeof e=="string"?this.#t.get(e)?.find(r=>r!==n&&r.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Cn.batch(()=>{this.#e.forEach(n=>{this.notify({type:"removed",mutation:n})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(n){const e={exact:!0,...n};return this.getAll().find(t=>Ww(e,t))}findAll(n={}){return this.getAll().filter(e=>Ww(n,e))}notify(n){Cn.batch(()=>{this.listeners.forEach(e=>{e(n)})})}resumePausedMutations(){const n=this.getAll().filter(e=>e.state.isPaused);return Cn.batch(()=>Promise.all(n.map(e=>e.continue().catch(ys))))}};function bp(n){return n.options.scope?.id}var RS=class extends wc{#e;#t=void 0;#n;#r;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const t=this.options;this.options=this.#e.defaultMutationOptions(e),qp(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),t?.mutationKey&&this.options.mutationKey&&Ba(t.mutationKey)!==Ba(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#s(),this.#o(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#s(),this.#o()}mutate(e,t){return this.#r=t,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#s(){const e=this.#n?.state??Z1();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#o(e){Cn.batch(()=>{if(this.#r&&this.hasListeners()){const t=this.#t.variables,r=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#r.onSuccess?.(e.data,t,r,a),this.#r.onSettled?.(e.data,null,t,r,a)):e?.type==="error"&&(this.#r.onError?.(e.error,t,r,a),this.#r.onSettled?.(void 0,e.error,t,r,a))}this.listeners.forEach(t=>{t(this.#t)})})}},jS=class extends wc{constructor(n={}){super(),this.config=n,this.#e=new Map}#e;build(n,e,t){const r=e.queryKey,a=e.queryHash??C0(r,e);let d=this.get(a);return d||(d=new SS({client:n,queryKey:r,queryHash:a,options:n.defaultQueryOptions(e),state:t,defaultOptions:n.getQueryDefaults(r)}),this.add(d)),d}add(n){this.#e.has(n.queryHash)||(this.#e.set(n.queryHash,n),this.notify({type:"added",query:n}))}remove(n){const e=this.#e.get(n.queryHash);e&&(n.destroy(),e===n&&this.#e.delete(n.queryHash),this.notify({type:"removed",query:n}))}clear(){Cn.batch(()=>{this.getAll().forEach(n=>{this.remove(n)})})}get(n){return this.#e.get(n)}getAll(){return[...this.#e.values()]}find(n){const e={exact:!0,...n};return this.getAll().find(t=>Bw(e,t))}findAll(n={}){const e=this.getAll();return Object.keys(n).length>0?e.filter(t=>Bw(n,t)):e}notify(n){Cn.batch(()=>{this.listeners.forEach(e=>{e(n)})})}onFocus(){Cn.batch(()=>{this.getAll().forEach(n=>{n.onFocus()})})}onOnline(){Cn.batch(()=>{this.getAll().forEach(n=>{n.onOnline()})})}},$S=class{#e;#t;#n;#r;#s;#o;#a;#i;constructor(n={}){this.#e=n.queryCache||new jS,this.#t=n.mutationCache||new AS,this.#n=n.defaultOptions||{},this.#r=new Map,this.#s=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#a=S0.subscribe(async n=>{n&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#i=Kp.subscribe(async n=>{n&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#a?.(),this.#a=void 0,this.#i?.(),this.#i=void 0)}isFetching(n){return this.#e.findAll({...n,fetchStatus:"fetching"}).length}isMutating(n){return this.#t.findAll({...n,status:"pending"}).length}getQueryData(n){const e=this.defaultQueryOptions({queryKey:n});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(n){const e=this.defaultQueryOptions(n),t=this.#e.build(this,e),r=t.state.data;return r===void 0?this.fetchQuery(n):(n.revalidateIfStale&&t.isStaleByTime(Lo(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(n){return this.#e.findAll(n).map(({queryKey:e,state:t})=>{const r=t.data;return[e,r]})}setQueryData(n,e,t){const r=this.defaultQueryOptions({queryKey:n}),d=this.#e.get(r.queryHash)?.state.data,h=mS(e,d);if(h!==void 0)return this.#e.build(this,r).setData(h,{...t,manual:!0})}setQueriesData(n,e,t){return Cn.batch(()=>this.#e.findAll(n).map(({queryKey:r})=>[r,this.setQueryData(r,e,t)]))}getQueryState(n){const e=this.defaultQueryOptions({queryKey:n});return this.#e.get(e.queryHash)?.state}removeQueries(n){const e=this.#e;Cn.batch(()=>{e.findAll(n).forEach(t=>{e.remove(t)})})}resetQueries(n,e){const t=this.#e;return Cn.batch(()=>(t.findAll(n).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...n},e)))}cancelQueries(n,e={}){const t={revert:!0,...e},r=Cn.batch(()=>this.#e.findAll(n).map(a=>a.cancel(t)));return Promise.all(r).then(ys).catch(ys)}invalidateQueries(n,e={}){return Cn.batch(()=>(this.#e.findAll(n).forEach(t=>{t.invalidate()}),n?.refetchType==="none"?Promise.resolve():this.refetchQueries({...n,type:n?.refetchType??n?.type??"active"},e)))}refetchQueries(n,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},r=Cn.batch(()=>this.#e.findAll(n).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let d=a.fetch(void 0,t);return t.throwOnError||(d=d.catch(ys)),a.state.fetchStatus==="paused"?Promise.resolve():d}));return Promise.all(r).then(ys)}fetchQuery(n){const e=this.defaultQueryOptions(n);e.retry===void 0&&(e.retry=!1);const t=this.#e.build(this,e);return t.isStaleByTime(Lo(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(n){return this.fetchQuery(n).then(ys).catch(ys)}fetchInfiniteQuery(n){return n.behavior=Yw(n.pages),this.fetchQuery(n)}prefetchInfiniteQuery(n){return this.fetchInfiniteQuery(n).then(ys).catch(ys)}ensureInfiniteQueryData(n){return n.behavior=Yw(n.pages),this.ensureQueryData(n)}resumePausedMutations(){return Kp.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(n){this.#n=n}setQueryDefaults(n,e){this.#r.set(Ba(n),{queryKey:n,defaultOptions:e})}getQueryDefaults(n){const e=[...this.#r.values()],t={};return e.forEach(r=>{bd(n,r.queryKey)&&Object.assign(t,r.defaultOptions)}),t}setMutationDefaults(n,e){this.#s.set(Ba(n),{mutationKey:n,defaultOptions:e})}getMutationDefaults(n){const e=[...this.#s.values()],t={};return e.forEach(r=>{bd(n,r.mutationKey)&&Object.assign(t,r.defaultOptions)}),t}defaultQueryOptions(n){if(n._defaulted)return n;const e={...this.#n.queries,...this.getQueryDefaults(n.queryKey),...n,_defaulted:!0};return e.queryHash||(e.queryHash=C0(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===k0&&(e.enabled=!1),e}defaultMutationOptions(n){return n?._defaulted?n:{...this.#n.mutations,...n?.mutationKey&&this.getMutationDefaults(n.mutationKey),...n,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},ex=D.createContext(void 0),km=n=>{const e=D.useContext(ex);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},OS=({client:n,children:e})=>(D.useEffect(()=>(n.mount(),()=>{n.unmount()}),[n]),p.jsx(ex.Provider,{value:n,children:e})),tx=D.createContext(!1),MS=()=>D.useContext(tx);tx.Provider;function DS(){let n=!1;return{clearReset:()=>{n=!1},reset:()=>{n=!0},isReset:()=>n}}var LS=D.createContext(DS()),FS=()=>D.useContext(LS),US=(n,e)=>{(n.suspense||n.throwOnError||n.experimental_prefetchInRender)&&(e.isReset()||(n.retryOnMount=!1))},zS=n=>{D.useEffect(()=>{n.clearReset()},[n])},BS=({result:n,errorResetBoundary:e,throwOnError:t,query:r,suspense:a})=>n.isError&&!e.isReset()&&!n.isFetching&&r&&(a&&n.data===void 0||Q1(t,[n.error,r])),WS=n=>{if(n.suspense){const t=a=>a==="static"?a:Math.max(a??1e3,1e3),r=n.staleTime;n.staleTime=typeof r=="function"?(...a)=>t(r(...a)):t(r),typeof n.gcTime=="number"&&(n.gcTime=Math.max(n.gcTime,1e3))}},VS=(n,e)=>n.isLoading&&n.isFetching&&!e,HS=(n,e)=>n?.suspense&&e.isPending,Jw=(n,e,t)=>e.fetchOptimistic(n).catch(()=>{t.clearReset()});function qS(n,e,t){const r=MS(),a=FS(),d=km(),h=d.defaultQueryOptions(n);d.getDefaultOptions().queries?._experimental_beforeQuery?.(h),h._optimisticResults=r?"isRestoring":"optimistic",WS(h),US(h,a),zS(a);const g=!d.getQueryCache().get(h.queryHash),[y]=D.useState(()=>new e(d,h)),_=y.getOptimisticResult(h),N=!r&&n.subscribed!==!1;if(D.useSyncExternalStore(D.useCallback(T=>{const k=N?y.subscribe(Cn.batchCalls(T)):ys;return y.updateResult(),k},[y,N]),()=>y.getCurrentResult(),()=>y.getCurrentResult()),D.useEffect(()=>{y.setOptions(h)},[h,y]),HS(h,_))throw Jw(h,y,a);if(BS({result:_,errorResetBoundary:a,throwOnError:h.throwOnError,query:d.getQueryCache().get(h.queryHash),suspense:h.suspense}))throw _.error;return d.getDefaultOptions().queries?._experimental_afterQuery?.(h,_),h.experimental_prefetchInRender&&!za&&VS(_,r)&&(g?Jw(h,y,a):d.getQueryCache().get(h.queryHash)?.promise)?.catch(ys).finally(()=>{y.updateResult()}),h.notifyOnChangeProps?_:y.trackResult(_)}function Cd(n,e){return qS(n,ES)}function Op(n,e){const t=km(),[r]=D.useState(()=>new RS(t,n));D.useEffect(()=>{r.setOptions(n)},[r,n]);const a=D.useSyncExternalStore(D.useCallback(h=>r.subscribe(Cn.batchCalls(h)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),d=D.useCallback((h,g)=>{r.mutate(h,g).catch(ys)},[r]);if(a.error&&Q1(r.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:d,mutateAsync:a.mutate}}function KS(n,e){if(n instanceof RegExp)return{keys:!1,pattern:n};var t,r,a,d,h=[],g="",y=n.split("/");for(y[0]||y.shift();a=y.shift();)t=a[0],t==="*"?(h.push(t),g+=a[1]==="?"?"(?:/(.*))?":"/(.*)"):t===":"?(r=a.indexOf("?",1),d=a.indexOf(".",1),h.push(a.substring(1,~r?r:~d?d:a.length)),g+=~r&&!~d?"(?:/([^/]+?))?":"/([^/]+?)",~d&&(g+=(~r?"?":"")+"\\"+a.substring(d))):g+="/"+a;return{keys:h,pattern:new RegExp("^"+g+(e?"(?=$|/)":"/?$"),"i")}}var mv={exports:{}},gv={};var Zw;function QS(){if(Zw)return gv;Zw=1;var n=Cm();function e(T,k){return T===k&&(T!==0||1/T===1/k)||T!==T&&k!==k}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,a=n.useEffect,d=n.useLayoutEffect,h=n.useDebugValue;function g(T,k){var $=k(),M=r({inst:{value:$,getSnapshot:k}}),F=M[0].inst,H=M[1];return d(function(){F.value=$,F.getSnapshot=k,y(F)&&H({inst:F})},[T,$,k]),a(function(){return y(F)&&H({inst:F}),T(function(){y(F)&&H({inst:F})})},[T]),h($),$}function y(T){var k=T.getSnapshot;T=T.value;try{var $=k();return!t(T,$)}catch{return!0}}function _(T,k){return k()}var N=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_:g;return gv.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:N,gv}var e_;function GS(){return e_||(e_=1,mv.exports=QS()),mv.exports}var YS=GS();const XS=rS.useInsertionEffect,JS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ZS=JS?D.useLayoutEffect:D.useEffect,eE=XS||ZS,nx=n=>{const e=D.useRef([n,(...t)=>e[0](...t)]).current;return eE(()=>{e[0]=n}),e[1]},tE="popstate",N0="pushState",T0="replaceState",nE="hashchange",t_=[tE,N0,T0,nE],sE=n=>{for(const e of t_)addEventListener(e,n);return()=>{for(const e of t_)removeEventListener(e,n)}},sx=(n,e)=>YS.useSyncExternalStore(sE,n,e),n_=()=>location.search,rE=({ssrSearch:n}={})=>sx(n_,n!=null?()=>n:n_),s_=()=>location.pathname,iE=({ssrPath:n}={})=>sx(s_,n!=null?()=>n:s_),oE=(n,{replace:e=!1,state:t=null}={})=>history[e?T0:N0](t,"",n),aE=(n={})=>[iE(n),oE],r_=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[r_]>"u"){for(const n of[N0,T0]){const e=history[n];history[n]=function(){const t=e.apply(this,arguments),r=new Event(n);return r.arguments=arguments,dispatchEvent(r),t}}Object.defineProperty(window,r_,{value:!0})}const lE=(n,e)=>e.toLowerCase().indexOf(n.toLowerCase())?"~"+e:e.slice(n.length)||"/",rx=(n="")=>n==="/"?"":n,cE=(n,e)=>n[0]==="~"?n.slice(1):rx(e)+n,uE=(n="",e)=>lE(i_(rx(n)),i_(e)),i_=n=>{try{return decodeURI(n)}catch{return n}},ix={hook:aE,searchHook:rE,parser:KS,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:n=>n},ox=D.createContext(ix),Md=()=>D.useContext(ox),ax={},lx=D.createContext(ax),dE=()=>D.useContext(lx),Sm=n=>{const[e,t]=n.hook(n);return[uE(n.base,e),nx((r,a)=>t(cE(r,n.base),a))]},Ko=()=>Sm(Md()),cx=(n,e,t,r)=>{const{pattern:a,keys:d}=e instanceof RegExp?{keys:!1,pattern:e}:n(e||"*",r),h=a.exec(t)||[],[g,...y]=h;return g!==void 0?[!0,(()=>{const _=d!==!1?Object.fromEntries(d.map((T,k)=>[T,y[k]])):h.groups;let N={...y};return _&&Object.assign(N,_),N})(),...r?[g]:[]]:[!1,null]},fE=({children:n,...e})=>{const t=Md(),r=e.hook?ix:t;let a=r;const[d,h]=e.ssrPath?.split("?")??[];h&&(e.ssrSearch=h,e.ssrPath=d),e.hrefs=e.hrefs??e.hook?.hrefs,e.searchHook=e.searchHook??e.hook?.searchHook;let g=D.useRef({}),y=g.current,_=y;for(let N in r){const T=N==="base"?r[N]+(e[N]||""):e[N]||r[N];y===_&&T!==_[N]&&(g.current=_={..._}),_[N]=T,(T!==r[N]||T!==a[N])&&(a=_)}return D.createElement(ox.Provider,{value:a,children:n})},o_=({children:n,component:e},t)=>e?D.createElement(e,{params:t}):typeof n=="function"?n(t):n,hE=n=>{let e=D.useRef(ax);const t=e.current;return e.current=Object.keys(n).length!==Object.keys(t).length||Object.entries(n).some(([r,a])=>a!==t[r])?n:t},Ls=({path:n,nest:e,match:t,...r})=>{const a=Md(),[d]=Sm(a),[h,g,y]=t??cx(a.parser,n,d,e),_=hE({...dE(),...g});if(!h)return null;const N=y?D.createElement(fE,{base:y},o_(r,_)):o_(r,_);return D.createElement(lx.Provider,{value:_,children:N})},a_=D.forwardRef((n,e)=>{const t=Md(),[r,a]=Sm(t),{to:d="",href:h=d,onClick:g,asChild:y,children:_,className:N,replace:T,state:k,...$}=n,M=nx(H=>{H.ctrlKey||H.metaKey||H.altKey||H.shiftKey||H.button!==0||(g?.(H),H.defaultPrevented||(H.preventDefault(),a(h,n)))}),F=t.hrefs(h[0]==="~"?h.slice(1):t.base+h,t);return y&&D.isValidElement(_)?D.cloneElement(_,{onClick:M,href:F}):D.createElement("a",{...$,onClick:M,href:F,className:N?.call?N(r===h):N,children:_,ref:e})}),ux=n=>Array.isArray(n)?n.flatMap(e=>ux(e&&e.type===D.Fragment?e.props.children:e)):[n],pE=({children:n,location:e})=>{const t=Md(),[r]=Sm(t);for(const a of ux(n)){let d=0;if(D.isValidElement(a)&&(d=cx(t.parser,a.props.path,e||r,a.props.nest))[0])return D.cloneElement(a,{match:d})}return null};const mE=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),dx=(...n)=>n.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ");var gE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const vE=D.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:d,iconNode:h,...g},y)=>D.createElement("svg",{ref:y,...gE,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:dx("lucide",a),...g},[...h.map(([_,N])=>D.createElement(_,N)),...Array.isArray(d)?d:[d]]));const nt=(n,e)=>{const t=D.forwardRef(({className:r,...a},d)=>D.createElement(vE,{ref:d,iconNode:e,className:dx(`lucide-${mE(n)}`,r),...a}));return t.displayName=`${n}`,t};const yE=nt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const wE=nt("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);const _E=nt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const fx=nt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const xE=nt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const bE=nt("Chrome",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["line",{x1:"21.17",x2:"12",y1:"8",y2:"8",key:"a0cw5f"}],["line",{x1:"3.95",x2:"8.54",y1:"6.06",y2:"14",key:"1kftof"}],["line",{x1:"10.88",x2:"15.46",y1:"21.94",y2:"14",key:"1ymyh8"}]]);const I0=nt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const CE=nt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const kE=nt("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);const SE=nt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);const EE=nt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);const NE=nt("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);const TE=nt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);const IE=nt("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);const PE=nt("LayoutList",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);const AE=nt("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);const hx=nt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const RE=nt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);const qv=nt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const px=nt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const jE=nt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);const $E=nt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);const mx=nt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);const OE=nt("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);const P0=nt("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);const gx=nt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);const vx=nt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const ME=nt("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);const DE=nt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);const LE=nt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const FE=nt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const UE=nt("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);const zE=nt("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);const yx=nt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);const BE=nt("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]);const WE=nt("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);const VE=nt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);const A0=nt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const wx=nt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);const _x=nt("UserRound",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]);const HE=nt("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);const qE=nt("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);const KE=nt("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);const La=nt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);const QE=nt("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Kv="/assets/Pawn%20Point%20Icon-C6jPZUFy.png";function GE(){const[,n]=Ko(),[e,t]=D.useState(!1),r=()=>t(a=>!a);return p.jsxs("div",{className:`min-h-screen relative overflow-hidden ${e?"bg-[#f7f7fb] text-slate-900":"bg-[#0b0f1c] text-white"}`,children:[p.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[p.jsx("div",{className:`absolute -left-24 top-24 h-72 w-72 ${e?"bg-pink-300/30":"bg-pink-500/20"} blur-[120px]`}),p.jsx("div",{className:`absolute right-0 top-10 h-96 w-96 ${e?"bg-purple-300/30":"bg-purple-500/25"} blur-[160px]`})]}),p.jsx("div",{className:`relative ${e?"bg-white/90 border-b border-slate-200":"bg-[#0b0f1c]/90 border-b border-white/5"}`,children:p.jsxs("div",{className:"max-w-6xl mx-auto px-6 h-16 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"h-10 w-10 rounded-xl bg-white flex items-center justify-center shadow-[0_12px_30px_rgba(0,0,0,0.25)] overflow-hidden",children:p.jsx("img",{src:Kv,alt:"Pawn Point logo",className:"h-full w-full object-cover"})}),p.jsx("span",{className:"text-2xl font-extrabold tracking-tight",children:"Pawn Point"})]}),p.jsxs("div",{className:`hidden md:flex items-center gap-4 text-base font-semibold md:translate-x-[-8px] ${e?"text-slate-700":"text-white/80"}`,children:[p.jsxs("button",{onClick:()=>n("/login"),className:`transition flex items-center gap-2 ${e?"hover:text-slate-900":"hover:text-white"}`,children:[p.jsx(RE,{className:"h-5 w-5",strokeWidth:2.5}),"Log in"]}),p.jsx("button",{onClick:r,className:`h-9 w-9 rounded-full border flex items-center justify-center transition ${e?"bg-slate-100 border-slate-300 text-slate-800 hover:bg-slate-200":"bg-white/5 border-white/10 text-white hover:bg-white/10"}`,"aria-label":"Toggle theme",children:e?p.jsx(mx,{className:"h-4 w-4"}):p.jsx(yx,{className:"h-4 w-4"})})]})]})}),p.jsx("main",{className:"relative max-w-6xl mx-auto px-6 pb-24 pt-12 min-h-[calc(100vh-64px)] flex items-center",children:p.jsxs("section",{className:"w-full grid md:grid-cols-2 gap-12 items-center",children:[p.jsxs("div",{className:"space-y-6 relative flex flex-col items-center text-center",children:[p.jsx("div",{className:"absolute -left-10 -top-6 h-20 w-20 rounded-full bg-pink-500/20 blur-3xl"}),p.jsx("h1",{className:"text-5xl md:text-6xl font-extrabold leading-tight text-[#ff0fb3] drop-shadow-[0_10px_35px_rgba(255,15,179,0.35)]",children:"Become the Player You Were Meant to Be"}),p.jsx("p",{className:`text-lg leading-relaxed ${e?"text-slate-700":"text-white/80"}`,children:"Pawn Point gives you the roadmap to real improvement. Learn smarter, train efficient, and develop the skills that actually win games."})]}),p.jsxs("div",{className:"relative flex justify-center items-center",children:[p.jsx("div",{className:"absolute -inset-10 bg-gradient-to-br from-[#ff0fb3]/25 via-[#7c3aed]/20 to-[#0ea5e9]/25 blur-[140px]"}),p.jsx("div",{className:`relative w-[360px] h-[360px] overflow-hidden rounded-[32px] border ${e?"border-slate-200 bg-white":"border-white/10 bg-white/5"} shadow-[0_20px_60px_rgba(0,0,0,0.45)]`,children:p.jsx("img",{src:Kv,alt:"Pawn Point icon",className:"h-full w-full object-cover"})})]})]})})]})}function xx(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var a=n.length;for(e=0;e<a;e++)n[e]&&(t=xx(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function _c(){for(var n,e,t=0,r="",a=arguments.length;t<a;t++)(n=arguments[t])&&(e=xx(n))&&(r&&(r+=" "),r+=e);return r}const it=D.forwardRef(function({className:e,variant:t="primary",...r},a){const d="inline-flex items-center justify-center rounded-full px-4 py-2 text-sm font-semibold transition",h={primary:"bg-brand.pink hover:bg-pink-500 text-white shadow-glow",ghost:"bg-transparent hover:bg-white/10 text-white",outline:"border border-white/30 text-white hover:bg-white/10"};return p.jsx("button",{ref:a,className:_c(d,h[t],e),...r})}),YE=()=>{};var l_={};const bx={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};const _e=function(n,e){if(!n)throw xc(e)},xc=function(n){return new Error("Firebase Database ("+bx.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};const Cx=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let a=n.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},XE=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const a=n[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const d=n[t++];e[r++]=String.fromCharCode((a&31)<<6|d&63)}else if(a>239&&a<365){const d=n[t++],h=n[t++],g=n[t++],y=((a&7)<<18|(d&63)<<12|(h&63)<<6|g&63)-65536;e[r++]=String.fromCharCode(55296+(y>>10)),e[r++]=String.fromCharCode(56320+(y&1023))}else{const d=n[t++],h=n[t++];e[r++]=String.fromCharCode((a&15)<<12|(d&63)<<6|h&63)}}return e.join("")},R0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<n.length;a+=3){const d=n[a],h=a+1<n.length,g=h?n[a+1]:0,y=a+2<n.length,_=y?n[a+2]:0,N=d>>2,T=(d&3)<<4|g>>4;let k=(g&15)<<2|_>>6,$=_&63;y||($=64,h||(k=64)),r.push(t[N],t[T],t[k],t[$])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Cx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):XE(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<n.length;){const d=t[n.charAt(a++)],g=a<n.length?t[n.charAt(a)]:0;++a;const _=a<n.length?t[n.charAt(a)]:64;++a;const T=a<n.length?t[n.charAt(a)]:64;if(++a,d==null||g==null||_==null||T==null)throw new JE;const k=d<<2|g>>4;if(r.push(k),_!==64){const $=g<<4&240|_>>2;if(r.push($),T!==64){const M=_<<6&192|T;r.push(M)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class JE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kx=function(n){const e=Cx(n);return R0.encodeByteArray(e,!0)},Qp=function(n){return kx(n).replace(/\./g,"")},Gp=function(n){try{return R0.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ZE(n){return Sx(void 0,n)}function Sx(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!eN(t)||(n[t]=Sx(n[t],e[t]));return n}function eN(n){return n!=="__proto__"}function tN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const nN=()=>tN().__FIREBASE_DEFAULTS__,sN=()=>{if(typeof process>"u"||typeof l_>"u")return;const n=l_.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},rN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Gp(n[1]);return e&&JSON.parse(e)},j0=()=>{try{return YE()||nN()||sN()||rN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ex=n=>j0()?.emulatorHosts?.[n],iN=n=>{const e=Ex(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Nx=()=>j0()?.config,Tx=n=>j0()?.[`_${n}`];class Dd{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function bc(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ix(n){return(await fetch(n,{credentials:"include"})).ok}function oN(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",a=n.iat||0,d=n.sub||n.user_id;if(!d)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h={iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:d,user_id:d,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Qp(JSON.stringify(t)),Qp(JSON.stringify(h)),""].join(".")}const md={};function aN(){const n={prod:[],emulator:[]};for(const e of Object.keys(md))md[e]?n.emulator.push(e):n.prod.push(e);return n}function lN(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let c_=!1;function Px(n,e){if(typeof window>"u"||typeof document>"u"||!bc(window.location.host)||md[n]===e||md[n]||c_)return;md[n]=e;function t(k){return`__firebase__banner__${k}`}const r="__firebase__banner",d=aN().prod.length>0;function h(){const k=document.getElementById(r);k&&k.remove()}function g(k){k.style.display="flex",k.style.background="#7faaf0",k.style.position="fixed",k.style.bottom="5px",k.style.left="5px",k.style.padding=".5em",k.style.borderRadius="5px",k.style.alignItems="center"}function y(k,$){k.setAttribute("width","24"),k.setAttribute("id",$),k.setAttribute("height","24"),k.setAttribute("viewBox","0 0 24 24"),k.setAttribute("fill","none"),k.style.marginLeft="-6px"}function _(){const k=document.createElement("span");return k.style.cursor="pointer",k.style.marginLeft="16px",k.style.fontSize="24px",k.innerHTML=" &times;",k.onclick=()=>{c_=!0,h()},k}function N(k,$){k.setAttribute("id",$),k.innerText="Learn more",k.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",k.setAttribute("target","__blank"),k.style.paddingLeft="5px",k.style.textDecoration="underline"}function T(){const k=lN(r),$=t("text"),M=document.getElementById($)||document.createElement("span"),F=t("learnmore"),H=document.getElementById(F)||document.createElement("a"),ye=t("preprendIcon"),le=document.getElementById(ye)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(k.created){const C=k.element;g(C),N(H,F);const ie=_();y(le,ye),C.append(le,M,H,ie),document.body.appendChild(C)}d?(M.innerText="Preview backend disconnected.",le.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(le.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,M.innerText="Preview backend running in this workspace."),M.setAttribute("id",$)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}function xs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $0(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xs())}function cN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function uN(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Ax(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dN(){const n=xs();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function fN(){return bx.NODE_ADMIN===!0}function hN(){try{return typeof indexedDB=="object"}catch{return!1}}function pN(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(t){e(t)}})}const mN="FirebaseError";class Qo extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=mN,Object.setPrototypeOf(this,Qo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ld.prototype.create)}}class Ld{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,d=this.errors[e],h=d?gN(d,r):"Error",g=`${this.serviceName}: ${h} (${a}).`;return new Qo(a,g,r)}}function gN(n,e){return n.replace(vN,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const vN=/\{\$([^}]+)}/g;function kd(n){return JSON.parse(n)}function Sn(n){return JSON.stringify(n)}const Rx=function(n){let e={},t={},r={},a="";try{const d=n.split(".");e=kd(Gp(d[0])||""),t=kd(Gp(d[1])||""),a=d[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:a}},yN=function(n){const e=Rx(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},wN=function(n){const e=Rx(n).claims;return typeof e=="object"&&e.admin===!0};function ei(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function cc(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Qv(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Yp(n,e,t){const r={};for(const a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=e.call(t,n[a],a,n));return r}function Wa(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const d=n[a],h=e[a];if(u_(d)&&u_(h)){if(!Wa(d,h))return!1}else if(d!==h)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function u_(n){return n!==null&&typeof n=="object"}function Cc(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function dd(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[a,d]=r.split("=");e[decodeURIComponent(a)]=decodeURIComponent(d)}}),e}function fd(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}class _N{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if(typeof e=="string")for(let T=0;T<16;T++)r[T]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let T=0;T<16;T++)r[T]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let T=16;T<80;T++){const k=r[T-3]^r[T-8]^r[T-14]^r[T-16];r[T]=(k<<1|k>>>31)&4294967295}let a=this.chain_[0],d=this.chain_[1],h=this.chain_[2],g=this.chain_[3],y=this.chain_[4],_,N;for(let T=0;T<80;T++){T<40?T<20?(_=g^d&(h^g),N=1518500249):(_=d^h^g,N=1859775393):T<60?(_=d&h|g&(d|h),N=2400959708):(_=d^h^g,N=3395469782);const k=(a<<5|a>>>27)+_+y+N+r[T]&4294967295;y=g,g=h,h=(d<<30|d>>>2)&4294967295,d=a,a=k}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+d&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+g&4294967295,this.chain_[4]=this.chain_[4]+y&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const r=t-this.blockSize;let a=0;const d=this.buf_;let h=this.inbuf_;for(;a<t;){if(h===0)for(;a<=r;)this.compress_(e,a),a+=this.blockSize;if(typeof e=="string"){for(;a<t;)if(d[h]=e.charCodeAt(a),++h,++a,h===this.blockSize){this.compress_(d),h=0;break}}else for(;a<t;)if(d[h]=e[a],++h,++a,h===this.blockSize){this.compress_(d),h=0;break}}this.inbuf_=h,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let a=this.blockSize-1;a>=56;a--)this.buf_[a]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let a=0;a<5;a++)for(let d=24;d>=0;d-=8)e[r]=this.chain_[a]>>d&255,++r;return e}}function xN(n,e){const t=new bN(n,e);return t.subscribe.bind(t)}class bN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");CN(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:r},a.next===void 0&&(a.next=vv),a.error===void 0&&(a.error=vv),a.complete===void 0&&(a.complete=vv);const d=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),d}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function CN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function vv(){}function Em(n,e){return`${n} failed: ${e} argument `}const kN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let a=n.charCodeAt(r);if(a>=55296&&a<=56319){const d=a-55296;r++,_e(r<n.length,"Surrogate pair missing trail surrogate.");const h=n.charCodeAt(r)-56320;a=65536+(d<<10)+h}a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):a<65536?(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},Nm=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};function is(n){return n&&n._delegate?n._delegate:n}class Va{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ja="[DEFAULT]";class SN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Dd;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(r)return null;throw a}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(NN(e))try{this.getOrInitializeService({instanceIdentifier:ja})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const d=this.getOrInitializeService({instanceIdentifier:a});r.resolve(d)}catch{}}}}clearInstance(e=ja){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ja){return this.instances.has(e)}getOptions(e=ja){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[d,h]of this.instancesDeferred.entries()){const g=this.normalizeInstanceIdentifier(d);r===g&&h.resolve(a)}return a}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(r)??new Set;a.add(e),this.onInitCallbacks.set(r,a);const d=this.instances.get(r);return d&&e(d,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:EN(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ja){return this.component?this.component.multipleInstances?e:ja:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function EN(n){return n===ja?void 0:n}function NN(n){return n.instantiationMode==="EAGER"}class TN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new SN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var It;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(It||(It={}));const IN={debug:It.DEBUG,verbose:It.VERBOSE,info:It.INFO,warn:It.WARN,error:It.ERROR,silent:It.SILENT},PN=It.INFO,AN={[It.DEBUG]:"log",[It.VERBOSE]:"log",[It.INFO]:"info",[It.WARN]:"warn",[It.ERROR]:"error"},RN=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),a=AN[e];if(a)console[a](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class O0{constructor(e){this.name=e,this._logLevel=PN,this._logHandler=RN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in It))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?IN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,It.DEBUG,...e),this._logHandler(this,It.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,It.VERBOSE,...e),this._logHandler(this,It.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,It.INFO,...e),this._logHandler(this,It.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,It.WARN,...e),this._logHandler(this,It.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,It.ERROR,...e),this._logHandler(this,It.ERROR,...e)}}const jN=(n,e)=>e.some(t=>n instanceof t);let d_,f_;function $N(){return d_||(d_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ON(){return f_||(f_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jx=new WeakMap,Gv=new WeakMap,$x=new WeakMap,yv=new WeakMap,M0=new WeakMap;function MN(n){const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("success",d),n.removeEventListener("error",h)},d=()=>{t(Fo(n.result)),a()},h=()=>{r(n.error),a()};n.addEventListener("success",d),n.addEventListener("error",h)});return e.then(t=>{t instanceof IDBCursor&&jx.set(t,n)}).catch(()=>{}),M0.set(e,n),e}function DN(n){if(Gv.has(n))return;const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("complete",d),n.removeEventListener("error",h),n.removeEventListener("abort",h)},d=()=>{t(),a()},h=()=>{r(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",d),n.addEventListener("error",h),n.addEventListener("abort",h)});Gv.set(n,e)}let Yv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Gv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||$x.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function LN(n){Yv=n(Yv)}function FN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(wv(this),e,...t);return $x.set(r,e.sort?e.sort():[e]),Fo(r)}:ON().includes(n)?function(...e){return n.apply(wv(this),e),Fo(jx.get(this))}:function(...e){return Fo(n.apply(wv(this),e))}}function UN(n){return typeof n=="function"?FN(n):(n instanceof IDBTransaction&&DN(n),jN(n,$N())?new Proxy(n,Yv):n)}function Fo(n){if(n instanceof IDBRequest)return MN(n);if(yv.has(n))return yv.get(n);const e=UN(n);return e!==n&&(yv.set(n,e),M0.set(e,n)),e}const wv=n=>M0.get(n);function zN(n,e,{blocked:t,upgrade:r,blocking:a,terminated:d}={}){const h=indexedDB.open(n,e),g=Fo(h);return r&&h.addEventListener("upgradeneeded",y=>{r(Fo(h.result),y.oldVersion,y.newVersion,Fo(h.transaction),y)}),t&&h.addEventListener("blocked",y=>t(y.oldVersion,y.newVersion,y)),g.then(y=>{d&&y.addEventListener("close",()=>d()),a&&y.addEventListener("versionchange",_=>a(_.oldVersion,_.newVersion,_))}).catch(()=>{}),g}const BN=["get","getKey","getAll","getAllKeys","count"],WN=["put","add","delete","clear"],_v=new Map;function h_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(_v.get(e))return _v.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=WN.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||BN.includes(t)))return;const d=async function(h,...g){const y=this.transaction(h,a?"readwrite":"readonly");let _=y.store;return r&&(_=_.index(g.shift())),(await Promise.all([_[t](...g),a&&y.done]))[0]};return _v.set(e,d),d}LN(n=>({...n,get:(e,t,r)=>h_(e,t)||n.get(e,t,r),has:(e,t)=>!!h_(e,t)||n.has(e,t)}));class VN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(HN(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function HN(n){return n.getComponent()?.type==="VERSION"}const Xv="@firebase/app",p_="0.14.6";const Li=new O0("@firebase/app"),qN="@firebase/app-compat",KN="@firebase/analytics-compat",QN="@firebase/analytics",GN="@firebase/app-check-compat",YN="@firebase/app-check",XN="@firebase/auth",JN="@firebase/auth-compat",ZN="@firebase/database",e2="@firebase/data-connect",t2="@firebase/database-compat",n2="@firebase/functions",s2="@firebase/functions-compat",r2="@firebase/installations",i2="@firebase/installations-compat",o2="@firebase/messaging",a2="@firebase/messaging-compat",l2="@firebase/performance",c2="@firebase/performance-compat",u2="@firebase/remote-config",d2="@firebase/remote-config-compat",f2="@firebase/storage",h2="@firebase/storage-compat",p2="@firebase/firestore",m2="@firebase/ai",g2="@firebase/firestore-compat",v2="firebase",y2="12.6.0";const Jv="[DEFAULT]",w2={[Xv]:"fire-core",[qN]:"fire-core-compat",[QN]:"fire-analytics",[KN]:"fire-analytics-compat",[YN]:"fire-app-check",[GN]:"fire-app-check-compat",[XN]:"fire-auth",[JN]:"fire-auth-compat",[ZN]:"fire-rtdb",[e2]:"fire-data-connect",[t2]:"fire-rtdb-compat",[n2]:"fire-fn",[s2]:"fire-fn-compat",[r2]:"fire-iid",[i2]:"fire-iid-compat",[o2]:"fire-fcm",[a2]:"fire-fcm-compat",[l2]:"fire-perf",[c2]:"fire-perf-compat",[u2]:"fire-rc",[d2]:"fire-rc-compat",[f2]:"fire-gcs",[h2]:"fire-gcs-compat",[p2]:"fire-fst",[g2]:"fire-fst-compat",[m2]:"fire-vertex","fire-js":"fire-js",[v2]:"fire-js-all"};const Xp=new Map,_2=new Map,Zv=new Map;function m_(n,e){try{n.container.addComponent(e)}catch(t){Li.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function uc(n){const e=n.name;if(Zv.has(e))return Li.debug(`There were multiple attempts to register component ${e}.`),!1;Zv.set(e,n);for(const t of Xp.values())m_(t,n);for(const t of _2.values())m_(t,n);return!0}function D0(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Zs(n){return n==null?!1:n.settings!==void 0}const x2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Uo=new Ld("app","Firebase",x2);class b2{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Va("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Uo.create("app-deleted",{appName:this._name})}}const kc=y2;function Ox(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Jv,automaticDataCollectionEnabled:!0,...e},a=r.name;if(typeof a!="string"||!a)throw Uo.create("bad-app-name",{appName:String(a)});if(t||(t=Nx()),!t)throw Uo.create("no-options");const d=Xp.get(a);if(d){if(Wa(t,d.options)&&Wa(r,d.config))return d;throw Uo.create("duplicate-app",{appName:a})}const h=new TN(a);for(const y of Zv.values())h.addComponent(y);const g=new b2(t,r,h);return Xp.set(a,g),g}function Mx(n=Jv){const e=Xp.get(n);if(!e&&n===Jv&&Nx())return Ox();if(!e)throw Uo.create("no-app",{appName:n});return e}function zo(n,e,t){let r=w2[n]??n;t&&(r+=`-${t}`);const a=r.match(/\s|\//),d=e.match(/\s|\//);if(a||d){const h=[`Unable to register library "${r}" with version "${e}":`];a&&h.push(`library name "${r}" contains illegal characters (whitespace or "/")`),a&&d&&h.push("and"),d&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Li.warn(h.join(" "));return}uc(new Va(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const C2="firebase-heartbeat-database",k2=1,Sd="firebase-heartbeat-store";let xv=null;function Dx(){return xv||(xv=zN(C2,k2,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Sd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Uo.create("idb-open",{originalErrorMessage:n.message})})),xv}async function S2(n){try{const t=(await Dx()).transaction(Sd),r=await t.objectStore(Sd).get(Lx(n));return await t.done,r}catch(e){if(e instanceof Qo)Li.warn(e.message);else{const t=Uo.create("idb-get",{originalErrorMessage:e?.message});Li.warn(t.message)}}}async function g_(n,e){try{const r=(await Dx()).transaction(Sd,"readwrite");await r.objectStore(Sd).put(e,Lx(n)),await r.done}catch(t){if(t instanceof Qo)Li.warn(t.message);else{const r=Uo.create("idb-set",{originalErrorMessage:t?.message});Li.warn(r.message)}}}function Lx(n){return`${n.name}!${n.options.appId}`}const E2=1024,N2=30;class T2{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new P2(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=v_();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(a=>a.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>N2){const a=A2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Li.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=v_(),{heartbeatsToSend:t,unsentEntries:r}=I2(this._heartbeatsCache.heartbeats),a=Qp(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Li.warn(e),""}}}function v_(){return new Date().toISOString().substring(0,10)}function I2(n,e=E2){const t=[];let r=n.slice();for(const a of n){const d=t.find(h=>h.agent===a.agent);if(d){if(d.dates.push(a.date),y_(t)>e){d.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),y_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class P2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return hN()?pN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await S2(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return g_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return g_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function y_(n){return Qp(JSON.stringify({version:2,heartbeats:n})).length}function A2(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function R2(n){uc(new Va("platform-logger",e=>new VN(e),"PRIVATE")),uc(new Va("heartbeat",e=>new T2(e),"PRIVATE")),zo(Xv,p_,n),zo(Xv,p_,"esm2020"),zo("fire-js","")}R2("");function Fx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const j2=Fx,Ux=new Ld("auth","Firebase",Fx());const Jp=new O0("@firebase/auth");function $2(n,...e){Jp.logLevel<=It.WARN&&Jp.warn(`Auth (${kc}): ${n}`,...e)}function Mp(n,...e){Jp.logLevel<=It.ERROR&&Jp.error(`Auth (${kc}): ${n}`,...e)}function fr(n,...e){throw F0(n,...e)}function Ir(n,...e){return F0(n,...e)}function L0(n,e,t){const r={...j2(),[e]:t};return new Ld("auth","Firebase",r).create(e,{appName:n.name})}function ji(n){return L0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function O2(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&fr(n,"argument-error"),L0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function F0(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Ux.create(n,...e)}function Ye(n,e,...t){if(!n)throw F0(e,...t)}function Ti(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Mp(e),new Error(e)}function Fi(n,e){n||Ti(e)}function e0(){return typeof self<"u"&&self.location?.href||""}function M2(){return w_()==="http:"||w_()==="https:"}function w_(){return typeof self<"u"&&self.location?.protocol||null}function D2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(M2()||uN()||"connection"in navigator)?navigator.onLine:!0}function L2(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Fd{constructor(e,t){this.shortDelay=e,this.longDelay=t,Fi(t>e,"Short delay should be less than long delay!"),this.isMobile=$0()||Ax()}get(){return D2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function U0(n,e){Fi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class zx{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ti("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ti("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ti("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const F2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const U2=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],z2=new Fd(3e4,6e4);function Go(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Bi(n,e,t,r,a={}){return Bx(n,a,async()=>{let d={},h={};r&&(e==="GET"?h=r:d={body:JSON.stringify(r)});const g=Cc({key:n.config.apiKey,...h}).slice(1),y=await n._getAdditionalHeaders();y["Content-Type"]="application/json",n.languageCode&&(y["X-Firebase-Locale"]=n.languageCode);const _={method:e,headers:y,...d};return cN()||(_.referrerPolicy="no-referrer"),n.emulatorConfig&&bc(n.emulatorConfig.host)&&(_.credentials="include"),zx.fetch()(await Wx(n,n.config.apiHost,t,g),_)})}async function Bx(n,e,t){n._canInitEmulator=!1;const r={...F2,...e};try{const a=new W2(n),d=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const h=await d.json();if("needConfirmation"in h)throw Cp(n,"account-exists-with-different-credential",h);if(d.ok&&!("errorMessage"in h))return h;{const g=d.ok?h.errorMessage:h.error.message,[y,_]=g.split(" : ");if(y==="FEDERATED_USER_ID_ALREADY_LINKED")throw Cp(n,"credential-already-in-use",h);if(y==="EMAIL_EXISTS")throw Cp(n,"email-already-in-use",h);if(y==="USER_DISABLED")throw Cp(n,"user-disabled",h);const N=r[y]||y.toLowerCase().replace(/[_\s]+/g,"-");if(_)throw L0(n,N,_);fr(n,N)}}catch(a){if(a instanceof Qo)throw a;fr(n,"network-request-failed",{message:String(a)})}}async function Ud(n,e,t,r,a={}){const d=await Bi(n,e,t,r,a);return"mfaPendingCredential"in d&&fr(n,"multi-factor-auth-required",{_serverResponse:d}),d}async function Wx(n,e,t,r){const a=`${e}${t}?${r}`,d=n,h=d.config.emulator?U0(n.config,a):`${n.config.apiScheme}://${a}`;return U2.includes(t)&&(await d._persistenceManagerAvailable,d._getPersistenceType()==="COOKIE")?d._getPersistence()._getFinalTarget(h).toString():h}function B2(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class W2{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ir(this.auth,"network-request-failed")),z2.get())})}}function Cp(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const a=Ir(n,e,r);return a.customData._tokenResponse=t,a}function __(n){return n!==void 0&&n.enterprise!==void 0}class V2{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return B2(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function H2(n,e){return Bi(n,"GET","/v2/recaptchaConfig",Go(n,e))}async function q2(n,e){return Bi(n,"POST","/v1/accounts:delete",e)}async function Zp(n,e){return Bi(n,"POST","/v1/accounts:lookup",e)}function gd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function K2(n,e=!1){const t=is(n),r=await t.getIdToken(e),a=z0(r);Ye(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const d=typeof a.firebase=="object"?a.firebase:void 0,h=d?.sign_in_provider;return{claims:a,token:r,authTime:gd(bv(a.auth_time)),issuedAtTime:gd(bv(a.iat)),expirationTime:gd(bv(a.exp)),signInProvider:h||null,signInSecondFactor:d?.sign_in_second_factor||null}}function bv(n){return Number(n)*1e3}function z0(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Mp("JWT malformed, contained fewer than 3 sections"),null;try{const a=Gp(t);return a?JSON.parse(a):(Mp("Failed to decode base64 JWT payload"),null)}catch(a){return Mp("Caught error parsing JWT payload as JSON",a?.toString()),null}}function x_(n){const e=z0(n);return Ye(e,"internal-error"),Ye(typeof e.exp<"u","internal-error"),Ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function dc(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Qo&&Q2(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Q2({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class G2{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class t0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=gd(this.lastLoginAt),this.creationTime=gd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function em(n){const e=n.auth,t=await n.getIdToken(),r=await dc(n,Zp(e,{idToken:t}));Ye(r?.users.length,e,"internal-error");const a=r.users[0];n._notifyReloadListener(a);const d=a.providerUserInfo?.length?Vx(a.providerUserInfo):[],h=X2(n.providerData,d),g=n.isAnonymous,y=!(n.email&&a.passwordHash)&&!h?.length,_=g?y:!1,N={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:h,metadata:new t0(a.createdAt,a.lastLoginAt),isAnonymous:_};Object.assign(n,N)}async function Y2(n){const e=is(n);await em(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function X2(n,e){return[...n.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function Vx(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function J2(n,e){const t=await Bx(n,{},async()=>{const r=Cc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:d}=n.config,h=await Wx(n,a,"/v1/token",`key=${d}`),g=await n._getAdditionalHeaders();g["Content-Type"]="application/x-www-form-urlencoded";const y={method:"POST",headers:g,body:r};return n.emulatorConfig&&bc(n.emulatorConfig.host)&&(y.credentials="include"),zx.fetch()(h,y)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Z2(n,e){return Bi(n,"POST","/v2/accounts:revokeToken",Go(n,e))}class nc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ye(e.idToken,"internal-error"),Ye(typeof e.idToken<"u","internal-error"),Ye(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):x_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ye(e.length!==0,"internal-error");const t=x_(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:d}=await J2(e,t);this.updateTokensAndExpiration(r,a,Number(d))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:d}=t,h=new nc;return r&&(Ye(typeof r=="string","internal-error",{appName:e}),h.refreshToken=r),a&&(Ye(typeof a=="string","internal-error",{appName:e}),h.accessToken=a),d&&(Ye(typeof d=="number","internal-error",{appName:e}),h.expirationTime=d),h}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new nc,this.toJSON())}_performRefresh(){return Ti("not implemented")}}function Po(n,e){Ye(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Nr{constructor({uid:e,auth:t,stsTokenManager:r,...a}){this.providerId="firebase",this.proactiveRefresh=new G2(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new t0(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await dc(this,this.stsTokenManager.getToken(this.auth,e));return Ye(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return K2(this,e)}reload(){return Y2(this)}_assign(e){this!==e&&(Ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Nr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await em(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Zs(this.auth.app))return Promise.reject(ji(this.auth));const e=await this.getIdToken();return await dc(this,q2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,a=t.email??void 0,d=t.phoneNumber??void 0,h=t.photoURL??void 0,g=t.tenantId??void 0,y=t._redirectEventId??void 0,_=t.createdAt??void 0,N=t.lastLoginAt??void 0,{uid:T,emailVerified:k,isAnonymous:$,providerData:M,stsTokenManager:F}=t;Ye(T&&F,e,"internal-error");const H=nc.fromJSON(this.name,F);Ye(typeof T=="string",e,"internal-error"),Po(r,e.name),Po(a,e.name),Ye(typeof k=="boolean",e,"internal-error"),Ye(typeof $=="boolean",e,"internal-error"),Po(d,e.name),Po(h,e.name),Po(g,e.name),Po(y,e.name),Po(_,e.name),Po(N,e.name);const ye=new Nr({uid:T,auth:e,email:a,emailVerified:k,displayName:r,isAnonymous:$,photoURL:h,phoneNumber:d,tenantId:g,stsTokenManager:H,createdAt:_,lastLoginAt:N});return M&&Array.isArray(M)&&(ye.providerData=M.map(le=>({...le}))),y&&(ye._redirectEventId=y),ye}static async _fromIdTokenResponse(e,t,r=!1){const a=new nc;a.updateFromServerResponse(t);const d=new Nr({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await em(d),d}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];Ye(a.localId!==void 0,"internal-error");const d=a.providerUserInfo!==void 0?Vx(a.providerUserInfo):[],h=!(a.email&&a.passwordHash)&&!d?.length,g=new nc;g.updateFromIdToken(r);const y=new Nr({uid:a.localId,auth:e,stsTokenManager:g,isAnonymous:h}),_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:d,metadata:new t0(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!d?.length};return Object.assign(y,_),y}}const b_=new Map;function Ii(n){Fi(n instanceof Function,"Expected a class definition");let e=b_.get(n);return e?(Fi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,b_.set(n,e),e)}class Hx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Hx.type="NONE";const C_=Hx;function Dp(n,e,t){return`firebase:${n}:${e}:${t}`}class sc{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:d}=this.auth;this.fullUserKey=Dp(this.userKey,a.apiKey,d),this.fullPersistenceKey=Dp("persistence",a.apiKey,d),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Zp(this.auth,{idToken:e}).catch(()=>{});return t?Nr._fromGetAccountInfoResponse(this.auth,t,e):null}return Nr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new sc(Ii(C_),e,r);const a=(await Promise.all(t.map(async _=>{if(await _._isAvailable())return _}))).filter(_=>_);let d=a[0]||Ii(C_);const h=Dp(r,e.config.apiKey,e.name);let g=null;for(const _ of t)try{const N=await _._get(h);if(N){let T;if(typeof N=="string"){const k=await Zp(e,{idToken:N}).catch(()=>{});if(!k)break;T=await Nr._fromGetAccountInfoResponse(e,k,N)}else T=Nr._fromJSON(e,N);_!==d&&(g=T),d=_;break}}catch{}const y=a.filter(_=>_._shouldAllowMigration);return!d._shouldAllowMigration||!y.length?new sc(d,e,r):(d=y[0],g&&await d._set(h,g.toJSON()),await Promise.all(t.map(async _=>{if(_!==d)try{await _._remove(h)}catch{}})),new sc(d,e,r))}}function k_(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Gx(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Xx(e))return"Blackberry";if(Jx(e))return"Webos";if(Kx(e))return"Safari";if((e.includes("chrome/")||Qx(e))&&!e.includes("edge/"))return"Chrome";if(Yx(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function qx(n=xs()){return/firefox\//i.test(n)}function Kx(n=xs()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Qx(n=xs()){return/crios\//i.test(n)}function Gx(n=xs()){return/iemobile/i.test(n)}function Yx(n=xs()){return/android/i.test(n)}function Xx(n=xs()){return/blackberry/i.test(n)}function Jx(n=xs()){return/webos/i.test(n)}function B0(n=xs()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function eT(n=xs()){return B0(n)&&!!window.navigator?.standalone}function tT(){return dN()&&document.documentMode===10}function Zx(n=xs()){return B0(n)||Yx(n)||Jx(n)||Xx(n)||/windows phone/i.test(n)||Gx(n)}function eb(n,e=[]){let t;switch(n){case"Browser":t=k_(xs());break;case"Worker":t=`${k_(xs())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${kc}/${r}`}class nT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=d=>new Promise((h,g)=>{try{const y=e(d);h(y)}catch(y){g(y)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function sT(n,e={}){return Bi(n,"GET","/v2/passwordPolicy",Go(n,e))}const rT=6;class iT{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??rT,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,d){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=d))}}class oT{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new S_(this),this.idTokenSubscription=new S_(this),this.beforeStateQueue=new nT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ux,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(d=>this._resolvePersistenceManagerAvailable=d)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ii(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await sc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Zp(this,{idToken:e}),r=await Nr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Zs(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(h,h))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=this.redirectUser?._redirectEventId,h=r?._redirectEventId,g=await this.tryRedirectSignIn(e);(!d||d===h)&&g?.user&&(r=g.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(d){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await em(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=L2()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Zs(this.app))return Promise.reject(ji(this));const t=e?is(e):null;return t&&Ye(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Zs(this.app)?Promise.reject(ji(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Zs(this.app)?Promise.reject(ji(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ii(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await sT(this),t=new iT(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ld("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Z2(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ii(e)||this._popupRedirectResolver;Ye(t,this,"argument-error"),this.redirectPersistenceManager=await sc.create(this,[Ii(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const d=typeof t=="function"?t:t.next.bind(t);let h=!1;const g=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ye(g,this,"internal-error"),g.then(()=>{h||d(this.currentUser)}),typeof t=="function"){const y=e.addObserver(t,r,a);return()=>{h=!0,y()}}else{const y=e.addObserver(t);return()=>{h=!0,y()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=eb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Zs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&$2(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Yo(n){return is(n)}class S_{constructor(e){this.auth=e,this.observer=null,this.addObserver=xN(t=>this.observer=t)}get next(){return Ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Tm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function aT(n){Tm=n}function tb(n){return Tm.loadJS(n)}function lT(){return Tm.recaptchaEnterpriseScript}function cT(){return Tm.gapiScript}function uT(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class dT{constructor(){this.enterprise=new fT}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class fT{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const hT="recaptcha-enterprise",nb="NO_RECAPTCHA";class pT{constructor(e){this.type=hT,this.auth=Yo(e)}async verify(e="verify",t=!1){async function r(d){if(!t){if(d.tenantId==null&&d._agentRecaptchaConfig!=null)return d._agentRecaptchaConfig.siteKey;if(d.tenantId!=null&&d._tenantRecaptchaConfigs[d.tenantId]!==void 0)return d._tenantRecaptchaConfigs[d.tenantId].siteKey}return new Promise(async(h,g)=>{H2(d,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(y=>{if(y.recaptchaKey===void 0)g(new Error("recaptcha Enterprise site key undefined"));else{const _=new V2(y);return d.tenantId==null?d._agentRecaptchaConfig=_:d._tenantRecaptchaConfigs[d.tenantId]=_,h(_.siteKey)}}).catch(y=>{g(y)})})}function a(d,h,g){const y=window.grecaptcha;__(y)?y.enterprise.ready(()=>{y.enterprise.execute(d,{action:e}).then(_=>{h(_)}).catch(()=>{h(nb)})}):g(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new dT().execute("siteKey",{action:"verify"}):new Promise((d,h)=>{r(this.auth).then(g=>{if(!t&&__(window.grecaptcha))a(g,d,h);else{if(typeof window>"u"){h(new Error("RecaptchaVerifier is only supported in browser"));return}let y=lT();y.length!==0&&(y+=g),tb(y).then(()=>{a(g,d,h)}).catch(_=>{h(_)})}}).catch(g=>{h(g)})})}}async function E_(n,e,t,r=!1,a=!1){const d=new pT(n);let h;if(a)h=nb;else try{h=await d.verify(t)}catch{h=await d.verify(t,!0)}const g={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in g){const y=g.phoneEnrollmentInfo.phoneNumber,_=g.phoneEnrollmentInfo.recaptchaToken;Object.assign(g,{phoneEnrollmentInfo:{phoneNumber:y,recaptchaToken:_,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in g){const y=g.phoneSignInInfo.recaptchaToken;Object.assign(g,{phoneSignInInfo:{recaptchaToken:y,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return g}return r?Object.assign(g,{captchaResp:h}):Object.assign(g,{captchaResponse:h}),Object.assign(g,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(g,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),g}async function n0(n,e,t,r,a){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await E_(n,e,t,t==="getOobCode");return r(n,d)}else return r(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await E_(n,e,t,t==="getOobCode");return r(n,h)}else return Promise.reject(d)})}function mT(n,e){const t=D0(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),d=t.getOptions();if(Wa(d,e??{}))return a;fr(a,"already-initialized")}return t.initialize({options:e})}function gT(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Ii);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function vT(n,e,t){const r=Yo(n);Ye(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!1,d=sb(e),{host:h,port:g}=yT(e),y=g===null?"":`:${g}`,_={url:`${d}//${h}${y}/`},N=Object.freeze({host:h,port:g,protocol:d.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator){Ye(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ye(Wa(_,r.config.emulator)&&Wa(N,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=_,r.emulatorConfig=N,r.settings.appVerificationDisabledForTesting=!0,bc(h)?(Ix(`${d}//${h}${y}`),Px("Auth",!0)):wT()}function sb(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function yT(n){const e=sb(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const d=a[1];return{host:d,port:N_(r.substr(d.length+1))}}else{const[d,h]=r.split(":");return{host:d,port:N_(h)}}}function N_(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function wT(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class W0{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ti("not implemented")}_getIdTokenResponse(e){return Ti("not implemented")}_linkToIdToken(e,t){return Ti("not implemented")}_getReauthenticationResolver(e){return Ti("not implemented")}}async function _T(n,e){return Bi(n,"POST","/v1/accounts:signUp",e)}async function xT(n,e){return Ud(n,"POST","/v1/accounts:signInWithPassword",Go(n,e))}async function bT(n,e){return Ud(n,"POST","/v1/accounts:signInWithEmailLink",Go(n,e))}async function CT(n,e){return Ud(n,"POST","/v1/accounts:signInWithEmailLink",Go(n,e))}class Ed extends W0{constructor(e,t,r,a=null){super("password",r),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Ed(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Ed(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return n0(e,t,"signInWithPassword",xT);case"emailLink":return bT(e,{email:this._email,oobCode:this._password});default:fr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return n0(e,r,"signUpPassword",_T);case"emailLink":return CT(e,{idToken:t,email:this._email,oobCode:this._password});default:fr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function rc(n,e){return Ud(n,"POST","/v1/accounts:signInWithIdp",Go(n,e))}const kT="http://localhost";class Ha extends W0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ha(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):fr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,...d}=t;if(!r||!a)return null;const h=new Ha(r,a);return h.idToken=d.idToken||void 0,h.accessToken=d.accessToken||void 0,h.secret=d.secret,h.nonce=d.nonce,h.pendingToken=d.pendingToken||null,h}_getIdTokenResponse(e){const t=this.buildRequest();return rc(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,rc(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,rc(e,t)}buildRequest(){const e={requestUri:kT,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Cc(t)}return e}}function ST(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ET(n){const e=dd(fd(n)).link,t=e?dd(fd(e)).deep_link_id:null,r=dd(fd(n)).deep_link_id;return(r?dd(fd(r)).link:null)||r||t||e||n}class V0{constructor(e){const t=dd(fd(e)),r=t.apiKey??null,a=t.oobCode??null,d=ST(t.mode??null);Ye(r&&a&&d,"argument-error"),this.apiKey=r,this.operation=d,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=ET(e);try{return new V0(t)}catch{return null}}}class Sc{constructor(){this.providerId=Sc.PROVIDER_ID}static credential(e,t){return Ed._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=V0.parseLink(t);return Ye(r,"argument-error"),Ed._fromEmailAndCode(e,r.code,r.tenantId)}}Sc.PROVIDER_ID="password";Sc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Sc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class H0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class zd extends H0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class $o extends zd{constructor(){super("facebook.com")}static credential(e){return Ha._fromParams({providerId:$o.PROVIDER_ID,signInMethod:$o.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $o.credentialFromTaggedObject(e)}static credentialFromError(e){return $o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $o.credential(e.oauthAccessToken)}catch{return null}}}$o.FACEBOOK_SIGN_IN_METHOD="facebook.com";$o.PROVIDER_ID="facebook.com";class Ni extends zd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ha._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ni.credential(t,r)}catch{return null}}}Ni.GOOGLE_SIGN_IN_METHOD="google.com";Ni.PROVIDER_ID="google.com";class Oo extends zd{constructor(){super("github.com")}static credential(e){return Ha._fromParams({providerId:Oo.PROVIDER_ID,signInMethod:Oo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Oo.credentialFromTaggedObject(e)}static credentialFromError(e){return Oo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Oo.credential(e.oauthAccessToken)}catch{return null}}}Oo.GITHUB_SIGN_IN_METHOD="github.com";Oo.PROVIDER_ID="github.com";class Mo extends zd{constructor(){super("twitter.com")}static credential(e,t){return Ha._fromParams({providerId:Mo.PROVIDER_ID,signInMethod:Mo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Mo.credentialFromTaggedObject(e)}static credentialFromError(e){return Mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Mo.credential(t,r)}catch{return null}}}Mo.TWITTER_SIGN_IN_METHOD="twitter.com";Mo.PROVIDER_ID="twitter.com";async function NT(n,e){return Ud(n,"POST","/v1/accounts:signUp",Go(n,e))}class qa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,a=!1){const d=await Nr._fromIdTokenResponse(e,r,a),h=T_(r);return new qa({user:d,providerId:h,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=T_(r);return new qa({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function T_(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class tm extends Qo{constructor(e,t,r,a){super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,tm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new tm(e,t,r,a)}}function rb(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(d=>{throw d.code==="auth/multi-factor-auth-required"?tm._fromErrorAndOperation(n,d,e,r):d})}async function TT(n,e,t=!1){const r=await dc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return qa._forOperation(n,"link",r)}async function IT(n,e,t=!1){const{auth:r}=n;if(Zs(r.app))return Promise.reject(ji(r));const a="reauthenticate";try{const d=await dc(n,rb(r,a,e,n),t);Ye(d.idToken,r,"internal-error");const h=z0(d.idToken);Ye(h,r,"internal-error");const{sub:g}=h;return Ye(n.uid===g,r,"user-mismatch"),qa._forOperation(n,a,d)}catch(d){throw d?.code==="auth/user-not-found"&&fr(r,"user-mismatch"),d}}async function ib(n,e,t=!1){if(Zs(n.app))return Promise.reject(ji(n));const r="signIn",a=await rb(n,r,e),d=await qa._fromIdTokenResponse(n,r,a);return t||await n._updateCurrentUser(d.user),d}async function PT(n,e){return ib(Yo(n),e)}async function ob(n){const e=Yo(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function AT(n,e,t){if(Zs(n.app))return Promise.reject(ji(n));const r=Yo(n),h=await n0(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",NT).catch(y=>{throw y.code==="auth/password-does-not-meet-requirements"&&ob(n),y}),g=await qa._fromIdTokenResponse(r,"signIn",h);return await r._updateCurrentUser(g.user),g}function RT(n,e,t){return Zs(n.app)?Promise.reject(ji(n)):PT(is(n),Sc.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ob(n),r})}async function jT(n,e){return Bi(n,"POST","/v1/accounts:update",e)}async function $T(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=is(n),d={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},h=await dc(r,jT(r.auth,d));r.displayName=h.displayName||null,r.photoURL=h.photoUrl||null;const g=r.providerData.find(({providerId:y})=>y==="password");g&&(g.displayName=r.displayName,g.photoURL=r.photoURL),await r._updateTokensIfNecessary(h)}function OT(n,e,t,r){return is(n).onIdTokenChanged(e,t,r)}function MT(n,e,t){return is(n).beforeAuthStateChanged(e,t)}function DT(n,e,t,r){return is(n).onAuthStateChanged(e,t,r)}function LT(n){return is(n).signOut()}const nm="__sak";class ab{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(nm,"1"),this.storage.removeItem(nm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const FT=1e3,UT=10;class lb extends ab{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Zx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((h,g,y)=>{this.notifyListeners(h,y)});return}const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const h=this.storage.getItem(r);!t&&this.localCache[r]===h||this.notifyListeners(r,h)},d=this.storage.getItem(r);tT()&&d!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,UT):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},FT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}lb.type="LOCAL";const zT=lb;class cb extends ab{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}cb.type="SESSION";const ub=cb;function BT(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Im{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const r=new Im(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:d}=t.data,h=this.handlersMap[a];if(!h?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const g=Array.from(h).map(async _=>_(t.origin,d)),y=await BT(g);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:y})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Im.receivers=[];function q0(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class WT{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let d,h;return new Promise((g,y)=>{const _=q0("",20);a.port1.start();const N=setTimeout(()=>{y(new Error("unsupported_event"))},r);h={messageChannel:a,onMessage(T){const k=T;if(k.data.eventId===_)switch(k.data.status){case"ack":clearTimeout(N),d=setTimeout(()=>{y(new Error("timeout"))},3e3);break;case"done":clearTimeout(d),g(k.data.response);break;default:clearTimeout(N),clearTimeout(d),y(new Error("invalid_response"));break}}},this.handlers.add(h),a.port1.addEventListener("message",h.onMessage),this.target.postMessage({eventType:e,eventId:_,data:t},[a.port2])}).finally(()=>{h&&this.removeMessageHandler(h)})}}function Jr(){return window}function VT(n){Jr().location.href=n}function db(){return typeof Jr().WorkerGlobalScope<"u"&&typeof Jr().importScripts=="function"}async function HT(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function qT(){return navigator?.serviceWorker?.controller||null}function KT(){return db()?self:null}const fb="firebaseLocalStorageDb",QT=1,sm="firebaseLocalStorage",hb="fbase_key";class Bd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Pm(n,e){return n.transaction([sm],e?"readwrite":"readonly").objectStore(sm)}function GT(){const n=indexedDB.deleteDatabase(fb);return new Bd(n).toPromise()}function s0(){const n=indexedDB.open(fb,QT);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(sm,{keyPath:hb})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(sm)?e(r):(r.close(),await GT(),e(await s0()))})})}async function I_(n,e,t){const r=Pm(n,!0).put({[hb]:e,value:t});return new Bd(r).toPromise()}async function YT(n,e){const t=Pm(n,!1).get(e),r=await new Bd(t).toPromise();return r===void 0?null:r.value}function P_(n,e){const t=Pm(n,!0).delete(e);return new Bd(t).toPromise()}const XT=800,JT=3;class pb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await s0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>JT)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return db()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Im._getInstance(KT()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await HT(),!this.activeServiceWorker)return;this.sender=new WT(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||qT()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await s0();return await I_(e,nm,"1"),await P_(e,nm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>I_(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>YT(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>P_(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const d=Pm(a,!1).getAll();return new Bd(d).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:d}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(d)&&(this.notifyListeners(a,d),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),XT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}pb.type="LOCAL";const ZT=pb;new Fd(3e4,6e4);function mb(n,e){return e?Ii(e):(Ye(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class K0 extends W0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return rc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return rc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return rc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function eI(n){return ib(n.auth,new K0(n),n.bypassAuthState)}function tI(n){const{auth:e,user:t}=n;return Ye(t,e,"internal-error"),IT(t,new K0(n),n.bypassAuthState)}async function nI(n){const{auth:e,user:t}=n;return Ye(t,e,"internal-error"),TT(t,new K0(n),n.bypassAuthState)}class gb{constructor(e,t,r,a,d=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=d,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:d,error:h,type:g}=e;if(h){this.reject(h);return}const y={auth:this.auth,requestUri:t,sessionId:r,tenantId:d||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(g)(y))}catch(_){this.reject(_)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eI;case"linkViaPopup":case"linkViaRedirect":return nI;case"reauthViaPopup":case"reauthViaRedirect":return tI;default:fr(this.auth,"internal-error")}}resolve(e){Fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const sI=new Fd(2e3,1e4);async function rI(n,e,t){if(Zs(n.app))return Promise.reject(Ir(n,"operation-not-supported-in-this-environment"));const r=Yo(n);O2(n,e,H0);const a=mb(r,t);return new Ma(r,"signInViaPopup",e,a).executeNotNull()}class Ma extends gb{constructor(e,t,r,a,d){super(e,t,a,d),this.provider=r,this.authWindow=null,this.pollId=null,Ma.currentPopupAction&&Ma.currentPopupAction.cancel(),Ma.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ye(e,this.auth,"internal-error"),e}async onExecution(){Fi(this.filter.length===1,"Popup operations only handle one event");const e=q0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ir(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ir(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ma.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ir(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,sI.get())};e()}}Ma.currentPopupAction=null;const iI="pendingRedirect",Lp=new Map;class oI extends gb{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Lp.get(this.auth._key());if(!e){try{const r=await aI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Lp.set(this.auth._key(),e)}return this.bypassAuthState||Lp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function aI(n,e){const t=uI(e),r=cI(n);if(!await r._isAvailable())return!1;const a=await r._get(t)==="true";return await r._remove(t),a}function lI(n,e){Lp.set(n._key(),e)}function cI(n){return Ii(n._redirectPersistence)}function uI(n){return Dp(iI,n.config.apiKey,n.name)}async function dI(n,e,t=!1){if(Zs(n.app))return Promise.reject(ji(n));const r=Yo(n),a=mb(r,e),h=await new oI(r,a,t).execute();return h&&!t&&(delete h.user._redirectEventId,await r._persistUserIfCurrent(h.user),await r._setRedirectUser(null,e)),h}const fI=600*1e3;class hI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!pI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!vb(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ir(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=fI&&this.cachedEventUids.clear(),this.cachedEventUids.has(A_(e))}saveEventToCache(e){this.cachedEventUids.add(A_(e)),this.lastProcessedEventTime=Date.now()}}function A_(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function vb({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function pI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vb(n);default:return!1}}async function mI(n,e={}){return Bi(n,"GET","/v1/projects",e)}const gI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vI=/^https?/;async function yI(n){if(n.config.emulator)return;const{authorizedDomains:e}=await mI(n);for(const t of e)try{if(wI(t))return}catch{}fr(n,"unauthorized-domain")}function wI(n){const e=e0(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const h=new URL(n);return h.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&h.hostname===r}if(!vI.test(t))return!1;if(gI.test(n))return r===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const _I=new Fd(3e4,6e4);function R_(){const n=Jr().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function xI(n){return new Promise((e,t)=>{function r(){R_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{R_(),t(Ir(n,"network-request-failed"))},timeout:_I.get()})}if(Jr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Jr().gapi?.load)r();else{const a=uT("iframefcb");return Jr()[a]=()=>{gapi.load?r():t(Ir(n,"network-request-failed"))},tb(`${cT()}?onload=${a}`).catch(d=>t(d))}}).catch(e=>{throw Fp=null,e})}let Fp=null;function bI(n){return Fp=Fp||xI(n),Fp}const CI=new Fd(5e3,15e3),kI="__/auth/iframe",SI="emulator/auth/iframe",EI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},NI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function TI(n){const e=n.config;Ye(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?U0(e,SI):`https://${n.config.authDomain}/${kI}`,r={apiKey:e.apiKey,appName:n.name,v:kc},a=NI.get(n.config.apiHost);a&&(r.eid=a);const d=n._getFrameworks();return d.length&&(r.fw=d.join(",")),`${t}?${Cc(r).slice(1)}`}async function II(n){const e=await bI(n),t=Jr().gapi;return Ye(t,n,"internal-error"),e.open({where:document.body,url:TI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:EI,dontclear:!0},r=>new Promise(async(a,d)=>{await r.restyle({setHideOnLeave:!1});const h=Ir(n,"network-request-failed"),g=Jr().setTimeout(()=>{d(h)},CI.get());function y(){Jr().clearTimeout(g),a(r)}r.ping(y).then(y,()=>{d(h)})}))}const PI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},AI=500,RI=600,jI="_blank",$I="http://localhost";class j_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function OI(n,e,t,r=AI,a=RI){const d=Math.max((window.screen.availHeight-a)/2,0).toString(),h=Math.max((window.screen.availWidth-r)/2,0).toString();let g="";const y={...PI,width:r.toString(),height:a.toString(),top:d,left:h},_=xs().toLowerCase();t&&(g=Qx(_)?jI:t),qx(_)&&(e=e||$I,y.scrollbars="yes");const N=Object.entries(y).reduce((k,[$,M])=>`${k}${$}=${M},`,"");if(eT(_)&&g!=="_self")return MI(e||"",g),new j_(null);const T=window.open(e||"",g,N);Ye(T,n,"popup-blocked");try{T.focus()}catch{}return new j_(T)}function MI(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const DI="__/auth/handler",LI="emulator/auth/handler",FI=encodeURIComponent("fac");async function $_(n,e,t,r,a,d){Ye(n.config.authDomain,n,"auth-domain-config-required"),Ye(n.config.apiKey,n,"invalid-api-key");const h={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:kc,eventId:a};if(e instanceof H0){e.setDefaultLanguage(n.languageCode),h.providerId=e.providerId||"",Qv(e.getCustomParameters())||(h.customParameters=JSON.stringify(e.getCustomParameters()));for(const[N,T]of Object.entries({}))h[N]=T}if(e instanceof zd){const N=e.getScopes().filter(T=>T!=="");N.length>0&&(h.scopes=N.join(","))}n.tenantId&&(h.tid=n.tenantId);const g=h;for(const N of Object.keys(g))g[N]===void 0&&delete g[N];const y=await n._getAppCheckToken(),_=y?`#${FI}=${encodeURIComponent(y)}`:"";return`${UI(n)}?${Cc(g).slice(1)}${_}`}function UI({config:n}){return n.emulator?U0(n,LI):`https://${n.authDomain}/${DI}`}const Cv="webStorageSupport";class zI{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ub,this._completeRedirectFn=dI,this._overrideRedirectResult=lI}async _openPopup(e,t,r,a){Fi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const d=await $_(e,t,r,e0(),a);return OI(e,d,q0())}async _openRedirect(e,t,r,a){await this._originValidation(e);const d=await $_(e,t,r,e0(),a);return VT(d),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:d}=this.eventManagers[t];return a?Promise.resolve(a):(Fi(d,"If manager is not set, promise should be"),d)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await II(e),r=new hI(e);return t.register("authEvent",a=>(Ye(a?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Cv,{type:Cv},a=>{const d=a?.[0]?.[Cv];d!==void 0&&t(!!d),fr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=yI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Zx()||Kx()||B0()}}const BI=zI;var O_="@firebase/auth",M_="1.11.1";class WI{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function VI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function HI(n){uc(new Va("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),d=e.getProvider("app-check-internal"),{apiKey:h,authDomain:g}=r.options;Ye(h&&!h.includes(":"),"invalid-api-key",{appName:r.name});const y={apiKey:h,authDomain:g,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:eb(n)},_=new oT(r,a,d,y);return gT(_,t),_},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),uc(new Va("auth-internal",e=>{const t=Yo(e.getProvider("auth").getImmediate());return(r=>new WI(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),zo(O_,M_,VI(n)),zo(O_,M_,"esm2020")}const qI=300,KI=Tx("authIdTokenMaxAge")||qI;let D_=null;const QI=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>KI)return;const a=t?.token;D_!==a&&(D_=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function GI(n=Mx()){const e=D0(n,"auth");if(e.isInitialized())return e.getImmediate();const t=mT(n,{popupRedirectResolver:BI,persistence:[ZT,zT,ub]}),r=Tx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const d=new URL(r,location.origin);if(location.origin===d.origin){const h=QI(d.toString());MT(t,h,()=>h(t.currentUser)),OT(t,g=>h(g))}}const a=Ex("auth");return a&&vT(t,`http://${a}`),t}function YI(){return document.getElementsByTagName("head")?.[0]??document}aT({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=a=>{const d=Ir("internal-error");d.customData=a,t(d)},r.type="text/javascript",r.charset="UTF-8",YI().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});HI("Browser");var XI="firebase",JI="12.6.0";zo(XI,JI,"app");var L_={};const F_="@firebase/database",U_="1.1.0";let yb="";function ZI(n){yb=n}class eP{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Sn(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:kd(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class tP{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return ei(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const wb=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new eP(e)}}catch{}return new tP},Da=wb("localStorage"),nP=wb("sessionStorage");const ic=new O0("@firebase/database"),sP=(function(){let n=1;return function(){return n++}})(),_b=function(n){const e=kN(n),t=new _N;t.update(e);const r=t.digest();return R0.encodeByteArray(r)},Wd=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Wd.apply(null,r):typeof r=="object"?e+=Sn(r):e+=r,e+=" "}return e};let vd=null,z_=!0;const rP=function(n,e){_e(!0,"Can't turn on custom loggers persistently."),ic.logLevel=It.VERBOSE,vd=ic.log.bind(ic)},Qn=function(...n){if(z_===!0&&(z_=!1,vd===null&&nP.get("logging_enabled")===!0&&rP()),vd){const e=Wd.apply(null,n);vd(e)}},Vd=function(n){return function(...e){Qn(n,...e)}},r0=function(...n){const e="FIREBASE INTERNAL ERROR: "+Wd(...n);ic.error(e)},Ui=function(...n){const e=`FIREBASE FATAL ERROR: ${Wd(...n)}`;throw ic.error(e),new Error(e)},_s=function(...n){const e="FIREBASE WARNING: "+Wd(...n);ic.warn(e)},iP=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&_s("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Q0=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},oP=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},fc="[MIN_NAME]",Ka="[MAX_NAME]",Ya=function(n,e){if(n===e)return 0;if(n===fc||e===Ka)return-1;if(e===fc||n===Ka)return 1;{const t=B_(n),r=B_(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},aP=function(n,e){return n===e?0:n<e?-1:1},id=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Sn(e))},G0=function(n){if(typeof n!="object"||n===null)return Sn(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Sn(e[r]),t+=":",t+=G0(n[e[r]]);return t+="}",t},xb=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let a=0;a<t;a+=e)a+e>t?r.push(n.substring(a,t)):r.push(n.substring(a,a+e));return r};function Gn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const bb=function(n){_e(!Q0(n),"Invalid JSON number");const e=11,t=52,r=(1<<e-1)-1;let a,d,h,g,y;n===0?(d=0,h=0,a=1/n===-1/0?1:0):(a=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(g=Math.min(Math.floor(Math.log(n)/Math.LN2),r),d=g+r,h=Math.round(n*Math.pow(2,t-g)-Math.pow(2,t))):(d=0,h=Math.round(n/Math.pow(2,1-r-t))));const _=[];for(y=t;y;y-=1)_.push(h%2?1:0),h=Math.floor(h/2);for(y=e;y;y-=1)_.push(d%2?1:0),d=Math.floor(d/2);_.push(a?1:0),_.reverse();const N=_.join("");let T="";for(y=0;y<64;y+=8){let k=parseInt(N.substr(y,8),2).toString(16);k.length===1&&(k="0"+k),T=T+k}return T.toLowerCase()},lP=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},cP=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function uP(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}const dP=new RegExp("^-?(0*)\\d{1,10}$"),fP=-2147483648,hP=2147483647,B_=function(n){if(dP.test(n)){const e=Number(n);if(e>=fP&&e<=hP)return e}return null},Ec=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw _s("Exception was thrown by user callback.",t),e},Math.floor(0))}},pP=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},yd=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};class mP{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Zs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){_s(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}class gP{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(a=>this.auth_=a)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Qn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',_s(e)}}class Up{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Up.OWNER="owner";const Y0="5",Cb="v",kb="s",Sb="r",Eb="f",Nb=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Tb="ls",Ib="p",i0="ac",Pb="websocket",Ab="long_polling";class Rb{constructor(e,t,r,a,d=!1,h="",g=!1,y=!1,_=null){this.secure=t,this.namespace=r,this.webSocketOnly=a,this.nodeAdmin=d,this.persistenceKey=h,this.includeNamespaceInQueryParams=g,this.isUsingEmulator=y,this.emulatorOptions=_,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Da.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Da.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function vP(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function jb(n,e,t){_e(typeof e=="string","typeof type must == string"),_e(typeof t=="object","typeof params must == object");let r;if(e===Pb)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Ab)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);vP(n)&&(t.ns=n.namespace);const a=[];return Gn(t,(d,h)=>{a.push(d+"="+h)}),r+a.join("&")}class yP{constructor(){this.counters_={}}incrementCounter(e,t=1){ei(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return ZE(this.counters_)}}const kv={},Sv={};function X0(n){const e=n.toString();return kv[e]||(kv[e]=new yP),kv[e]}function wP(n,e){const t=n.toString();return Sv[t]||(Sv[t]=e()),Sv[t]}class _P{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let a=0;a<r.length;++a)r[a]&&Ec(()=>{this.onMessage_(r[a])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const W_="start",xP="close",bP="pLPCommand",CP="pRTLPCB",$b="id",Ob="pw",Mb="ser",kP="cb",SP="seg",EP="ts",NP="d",TP="dframe",Db=1870,Lb=30,IP=Db-Lb,PP=25e3,AP=3e4;class tc{constructor(e,t,r,a,d,h,g){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=a,this.authToken=d,this.transportSessionId=h,this.lastSessionId=g,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Vd(e),this.stats_=X0(t),this.urlFn=y=>(this.appCheckToken&&(y[i0]=this.appCheckToken),jb(t,Ab,y))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new _P(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(AP)),oP(()=>{if(this.isClosed_)return;this.scriptTagHolder=new J0((...d)=>{const[h,g,y,_,N]=d;if(this.incrementIncomingBytes_(d),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,h===W_)this.id=g,this.password=y;else if(h===xP)g?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(g,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+h)},(...d)=>{const[h,g]=d;this.incrementIncomingBytes_(d),this.myPacketOrderer.handleResponse(h,g)},()=>{this.onClosed_()},this.urlFn);const r={};r[W_]="t",r[Mb]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[kP]=this.scriptTagHolder.uniqueCallbackIdentifier),r[Cb]=Y0,this.transportSessionId&&(r[kb]=this.transportSessionId),this.lastSessionId&&(r[Tb]=this.lastSessionId),this.applicationId&&(r[Ib]=this.applicationId),this.appCheckToken&&(r[i0]=this.appCheckToken),typeof location<"u"&&location.hostname&&Nb.test(location.hostname)&&(r[Sb]=Eb);const a=this.urlFn(r);this.log_("Connecting via long-poll to "+a),this.scriptTagHolder.addTag(a,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){tc.forceAllow_=!0}static forceDisallow(){tc.forceDisallow_=!0}static isAvailable(){return tc.forceAllow_?!0:!tc.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!lP()&&!cP()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Sn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=kx(t),a=xb(r,IP);for(let d=0;d<a.length;d++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,a.length,a[d]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={};r[TP]="t",r[$b]=e,r[Ob]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Sn(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class J0{constructor(e,t,r,a){this.onDisconnect=r,this.urlFn=a,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=sP(),window[bP+this.uniqueCallbackIdentifier]=e,window[CP+this.uniqueCallbackIdentifier]=t,this.myIFrame=J0.createIFrame_();let d="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(d='<script>document.domain="'+document.domain+'";<\/script>');const h="<html><body>"+d+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(h),this.myIFrame.doc.close()}catch(g){Qn("frame writing exception"),g.stack&&Qn(g.stack),Qn(g)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Qn("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[$b]=this.myID,e[Ob]=this.myPW,e[Mb]=this.currentSerial;let t=this.urlFn(e),r="",a=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Lb+r.length<=Db;){const h=this.pendingSegs.shift();r=r+"&"+SP+a+"="+h.seg+"&"+EP+a+"="+h.ts+"&"+NP+a+"="+h.d,a++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},a=setTimeout(r,Math.floor(PP)),d=()=>{clearTimeout(a),r()};this.addTag(e,d)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const a=r.readyState;(!a||a==="loaded"||a==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Qn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}const RP=16384,jP=45e3;let rm=null;typeof MozWebSocket<"u"?rm=MozWebSocket:typeof WebSocket<"u"&&(rm=WebSocket);class Er{constructor(e,t,r,a,d,h,g){this.connId=e,this.applicationId=r,this.appCheckToken=a,this.authToken=d,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Vd(this.connId),this.stats_=X0(t),this.connURL=Er.connectionURL_(t,h,g,a,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,a,d){const h={};return h[Cb]=Y0,typeof location<"u"&&location.hostname&&Nb.test(location.hostname)&&(h[Sb]=Eb),t&&(h[kb]=t),r&&(h[Tb]=r),a&&(h[i0]=a),d&&(h[Ib]=d),jb(e,Pb,h)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Da.set("previous_websocket_failure",!0);try{let r;fN(),this.mySock=new rm(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const a=r.message||r.data;a&&this.log_(a),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const a=r.message||r.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){Er.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&rm!==null&&!Er.forceDisallow_}static previouslyFailed(){return Da.isInMemoryStorage||Da.get("previous_websocket_failure")===!0}markConnectionHealthy(){Da.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const r=kd(t);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(_e(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const r=this.extractFrameCount_(t);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const t=Sn(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=xb(t,RP);r.length>1&&this.sendString_(String(r.length));for(let a=0;a<r.length;a++)this.sendString_(r[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(jP))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Er.responsesRequiredToBeHealthy=2;Er.healthyTimeout=3e4;class Nd{static get ALL_TRANSPORTS(){return[tc,Er]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=Er&&Er.isAvailable();let r=t&&!Er.previouslyFailed();if(e.webSocketOnly&&(t||_s("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Er];else{const a=this.transports_=[];for(const d of Nd.ALL_TRANSPORTS)d&&d.isAvailable()&&a.push(d);Nd.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Nd.globalTransportInitialized_=!1;const $P=6e4,OP=5e3,MP=10*1024,DP=100*1024,Ev="t",V_="d",LP="s",H_="r",FP="e",q_="o",K_="a",Q_="n",G_="p",UP="h";class zP{constructor(e,t,r,a,d,h,g,y,_,N){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=a,this.authToken_=d,this.onMessage_=h,this.onReady_=g,this.onDisconnect_=y,this.onKill_=_,this.lastSessionId=N,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Vd("c:"+this.id+":"),this.transportManager_=new Nd(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const a=e.healthyTimeout||0;a>0&&(this.healthyTimeout_=yd(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>DP?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>MP?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(a)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ev in e){const t=e[Ev];t===K_?this.upgradeIfSecondaryHealthy_():t===H_?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===q_&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=id("t",e),r=id("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:G_,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:K_,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Q_,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=id("t",e),r=id("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=id(Ev,e);if(V_ in e){const r=e[V_];if(t===UP){const a={...r};this.repoInfo_.isUsingEmulator&&(a.h=this.repoInfo_.host),this.onHandshake_(a)}else if(t===Q_){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let a=0;a<this.pendingDataMessages.length;++a)this.onDataMessage_(this.pendingDataMessages[a]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===LP?this.onConnectionShutdown_(r):t===H_?this.onReset_(r):t===FP?r0("Server Error: "+r):t===q_?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):r0("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,a=e.h;this.sessionId=e.s,this.repoInfo_.host=a,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Y0!==r&&_s("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),yd(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor($P))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):yd(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(OP))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:G_,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Da.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Fb{put(e,t,r,a){}merge(e,t,r,a){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class Ub{constructor(e){this.allowedEvents_=e,this.listeners_={},_e(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let a=0;a<r.length;a++)r[a].callback.apply(r[a].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const a=this.getInitialEvent(e);a&&t.apply(r,a)}off(e,t,r){this.validateEventType_(e);const a=this.listeners_[e]||[];for(let d=0;d<a.length;d++)if(a[d].callback===t&&(!r||r===a[d].context)){a.splice(d,1);return}}validateEventType_(e){_e(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class im extends Ub{static getInstance(){return new im}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!$0()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return _e(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const Y_=32,X_=768;class Pt{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let a=0;a<this.pieces_.length;a++)this.pieces_[a].length>0&&(this.pieces_[r]=this.pieces_[a],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function xt(){return new Pt("")}function dt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Vo(n){return n.pieces_.length-n.pieceNum_}function Wt(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Pt(n.pieces_,e)}function Z0(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function BP(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Td(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function zb(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Pt(e,0)}function rn(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Pt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let a=0;a<r.length;a++)r[a].length>0&&t.push(r[a])}return new Pt(t,0)}function pt(n){return n.pieceNum_>=n.pieces_.length}function ws(n,e){const t=dt(n),r=dt(e);if(t===null)return e;if(t===r)return ws(Wt(n),Wt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function WP(n,e){const t=Td(n,0),r=Td(e,0);for(let a=0;a<t.length&&a<r.length;a++){const d=Ya(t[a],r[a]);if(d!==0)return d}return t.length===r.length?0:t.length<r.length?-1:1}function ey(n,e){if(Vo(n)!==Vo(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function dr(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Vo(n)>Vo(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class VP{constructor(e,t){this.errorPrefix_=t,this.parts_=Td(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Nm(this.parts_[r]);Bb(this)}}function HP(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Nm(e),Bb(n)}function qP(n){const e=n.parts_.pop();n.byteLength_-=Nm(e),n.parts_.length>0&&(n.byteLength_-=1)}function Bb(n){if(n.byteLength_>X_)throw new Error(n.errorPrefix_+"has a key path longer than "+X_+" bytes ("+n.byteLength_+").");if(n.parts_.length>Y_)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Y_+") or object contains a cycle "+$a(n))}function $a(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}class ty extends Ub{static getInstance(){return new ty}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return _e(e==="visible","Unknown event type: "+e),[this.visible_]}}const od=1e3,KP=300*1e3,J_=30*1e3,QP=1.3,GP=3e4,YP="server_kill",Z_=3;class $i extends Fb{constructor(e,t,r,a,d,h,g,y){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=a,this.onServerInfoUpdate_=d,this.authTokenProvider_=h,this.appCheckTokenProvider_=g,this.authOverride_=y,this.id=$i.nextPersistentConnectionId_++,this.log_=Vd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=od,this.maxReconnectDelay_=KP,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,y)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ty.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&im.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const a=++this.requestNumber_,d={r:a,a:e,b:t};this.log_(Sn(d)),_e(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(d),r&&(this.requestCBHash_[a]=r)}get(e){this.initConnection_();const t=new Dd,a={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:h=>{const g=h.d;h.s==="ok"?t.resolve(g):t.reject(g)}};this.outstandingGets_.push(a),this.outstandingGetCount_++;const d=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(d),t.promise}listen(e,t,r,a){this.initConnection_();const d=e._queryIdentifier,h=e._path.toString();this.log_("Listen called for "+h+" "+d),this.listens.has(h)||this.listens.set(h,new Map),_e(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),_e(!this.listens.get(h).has(d),"listen() called twice for same path/queryId.");const g={onComplete:a,hashFn:t,query:e,tag:r};this.listens.get(h).set(d,g),this.connected_&&this.sendListen_(g)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)})}sendListen_(e){const t=e.query,r=t._path.toString(),a=t._queryIdentifier;this.log_("Listen on "+r+" for "+a);const d={p:r},h="q";e.tag&&(d.q=t._queryObject,d.t=e.tag),d.h=e.hashFn(),this.sendRequest(h,d,g=>{const y=g.d,_=g.s;$i.warnOnListenWarnings_(y,t),(this.listens.get(r)&&this.listens.get(r).get(a))===e&&(this.log_("listen response",g),_!=="ok"&&this.removeListen_(r,a),e.onComplete&&e.onComplete(_,y))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&ei(e,"w")){const r=cc(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const a='".indexOn": "'+t._queryParams.getIndex().toString()+'"',d=t._path.toString();_s(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${d} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||wN(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=J_)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=yN(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(t,r,a=>{const d=a.s,h=a.d||"error";this.authToken_===e&&(d==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(d,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,r=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)})}unlisten(e,t){const r=e._path.toString(),a=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+a),_e(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,a)&&this.connected_&&this.sendUnlisten_(r,a,e._queryObject,t)}sendUnlisten_(e,t,r,a){this.log_("Unlisten on "+e+" for "+t);const d={p:e},h="n";a&&(d.q=r,d.t=a),this.sendRequest(h,d)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,a){const d={p:t,d:r};this.log_("onDisconnect "+e,d),this.sendRequest(e,d,h=>{a&&setTimeout(()=>{a(h.s,h.d)},Math.floor(0))})}put(e,t,r,a){this.putInternal("p",e,t,r,a)}merge(e,t,r,a){this.putInternal("m",e,t,r,a)}putInternal(e,t,r,a,d){this.initConnection_();const h={p:t,d:r};d!==void 0&&(h.h=d),this.outstandingPuts_.push({action:e,request:h,onComplete:a}),this.outstandingPutCount_++;const g=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(g):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,a=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,d=>{this.log_(t+" response",d),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),a&&a(d.s,d.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,r=>{if(r.s!=="ok"){const d=r.d;this.log_("reportStats","Error sending stats: "+d)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Sn(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):r0("Unrecognized action received from server: "+Sn(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){_e(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=od,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=od,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>GP&&(this.reconnectDelay_=od),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*QP)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+$i.nextConnectionId_++,d=this.lastSessionId;let h=!1,g=null;const y=function(){g?g.close():(h=!0,r())},_=function(T){_e(g,"sendRequest call when we're not connected not allowed."),g.sendRequest(T)};this.realtime_={close:y,sendRequest:_};const N=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[T,k]=await Promise.all([this.authTokenProvider_.getToken(N),this.appCheckTokenProvider_.getToken(N)]);h?Qn("getToken() completed but was canceled"):(Qn("getToken() completed. Creating connection."),this.authToken_=T&&T.accessToken,this.appCheckToken_=k&&k.token,g=new zP(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,$=>{_s($+" ("+this.repoInfo_.toString()+")"),this.interrupt(YP)},d))}catch(T){this.log_("Failed to get token: "+T),h||(this.repoInfo_.nodeAdmin&&_s(T),y())}}}interrupt(e){Qn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Qn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Qv(this.interruptReasons_)&&(this.reconnectDelay_=od,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;t?r=t.map(d=>G0(d)).join("$"):r="default";const a=this.removeListen_(e,r);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(e,t){const r=new Pt(e).toString();let a;if(this.listens.has(r)){const d=this.listens.get(r);a=d.get(t),d.delete(t),d.size===0&&this.listens.delete(r)}else a=void 0;return a}onAuthRevoked_(e,t){Qn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Z_&&(this.reconnectDelay_=J_,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Qn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Z_&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+yb.replace(/\./g,"-")]=1,$0()?e["framework.cordova"]=1:Ax()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=im.getInstance().currentlyOnline();return Qv(this.interruptReasons_)&&e}}$i.nextPersistentConnectionId_=0;$i.nextConnectionId_=0;class ft{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new ft(e,t)}}class Am{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new ft(fc,e),a=new ft(fc,t);return this.compare(r,a)!==0}minPost(){return ft.MIN}}let kp;class Wb extends Am{static get __EMPTY_NODE(){return kp}static set __EMPTY_NODE(e){kp=e}compare(e,t){return Ya(e.name,t.name)}isDefinedOn(e){throw xc("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ft.MIN}maxPost(){return new ft(Ka,kp)}makePost(e,t){return _e(typeof e=="string","KeyIndex indexValue must always be a string."),new ft(e,kp)}toString(){return".key"}}const oc=new Wb;class Sp{constructor(e,t,r,a,d=null){this.isReverse_=a,this.resultGenerator_=d,this.nodeStack_=[];let h=1;for(;!e.isEmpty();)if(e=e,h=t?r(e.key,t):1,a&&(h*=-1),h<0)this.isReverse_?e=e.left:e=e.right;else if(h===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Mn{constructor(e,t,r,a,d){this.key=e,this.value=t,this.color=r??Mn.RED,this.left=a??Fs.EMPTY_NODE,this.right=d??Fs.EMPTY_NODE}copy(e,t,r,a,d){return new Mn(e??this.key,t??this.value,r??this.color,a??this.left,d??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const d=r(e,a.key);return d<0?a=a.copy(null,null,null,a.left.insert(e,t,r),null):d===0?a=a.copy(null,t,null,null,null):a=a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return Fs.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,a;if(r=this,t(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),t(e,r.key)===0){if(r.right.isEmpty())return Fs.EMPTY_NODE;a=r.right.min_(),r=r.copy(a.key,a.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Mn.RED=!0;Mn.BLACK=!1;class XP{copy(e,t,r,a,d){return this}insert(e,t,r){return new Mn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Fs{constructor(e,t=Fs.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Fs(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Mn.BLACK,null,null))}remove(e){return new Fs(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Mn.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,a=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return a?a.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(a=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Sp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Sp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Sp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Sp(this.root_,null,this.comparator_,!0,e)}}Fs.EMPTY_NODE=new XP;function JP(n,e){return Ya(n.name,e.name)}function ny(n,e){return Ya(n,e)}let o0;function ZP(n){o0=n}const Vb=function(n){return typeof n=="number"?"number:"+bb(n):"string:"+n},Hb=function(n){if(n.isLeafNode()){const e=n.val();_e(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ei(e,".sv"),"Priority must be a string or number.")}else _e(n===o0||n.isEmpty(),"priority of unexpected type.");_e(n===o0||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let e1;class On{static set __childrenNodeConstructor(e){e1=e}static get __childrenNodeConstructor(){return e1}constructor(e,t=On.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,_e(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Hb(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new On(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:On.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return pt(e)?this:dt(e)===".priority"?this.priorityNode_:On.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:On.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=dt(e);return r===null?t:t.isEmpty()&&r!==".priority"?this:(_e(r!==".priority"||Vo(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,On.__childrenNodeConstructor.EMPTY_NODE.updateChild(Wt(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Vb(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=bb(this.value_):e+=this.value_,this.lazyHash_=_b(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===On.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof On.__childrenNodeConstructor?-1:(_e(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,a=On.VALUE_TYPE_ORDER.indexOf(t),d=On.VALUE_TYPE_ORDER.indexOf(r);return _e(a>=0,"Unknown leaf type: "+t),_e(d>=0,"Unknown leaf type: "+r),a===d?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:d-a}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}On.VALUE_TYPE_ORDER=["object","boolean","number","string"];let qb,Kb;function eA(n){qb=n}function tA(n){Kb=n}class nA extends Am{compare(e,t){const r=e.node.getPriority(),a=t.node.getPriority(),d=r.compareTo(a);return d===0?Ya(e.name,t.name):d}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ft.MIN}maxPost(){return new ft(Ka,new On("[PRIORITY-POST]",Kb))}makePost(e,t){const r=qb(e);return new ft(t,new On("[PRIORITY-POST]",r))}toString(){return".priority"}}const on=new nA;const sA=Math.log(2);class rA{constructor(e){const t=d=>parseInt(Math.log(d)/sA,10),r=d=>parseInt(Array(d+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const a=r(this.count);this.bits_=e+1&a}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const om=function(n,e,t,r){n.sort(e);const a=function(y,_){const N=_-y;let T,k;if(N===0)return null;if(N===1)return T=n[y],k=t?t(T):T,new Mn(k,T.node,Mn.BLACK,null,null);{const $=parseInt(N/2,10)+y,M=a(y,$),F=a($+1,_);return T=n[$],k=t?t(T):T,new Mn(k,T.node,Mn.BLACK,M,F)}},d=function(y){let _=null,N=null,T=n.length;const k=function(M,F){const H=T-M,ye=T;T-=M;const le=a(H+1,ye),C=n[H],ie=t?t(C):C;$(new Mn(ie,C.node,F,null,le))},$=function(M){_?(_.left=M,_=M):(N=M,_=M)};for(let M=0;M<y.count;++M){const F=y.nextBitIsOne(),H=Math.pow(2,y.count-(M+1));F?k(H,Mn.BLACK):(k(H,Mn.BLACK),k(H,Mn.RED))}return N},h=new rA(n.length),g=d(h);return new Fs(r||e,g)};let Nv;const ec={};class Pi{static get Default(){return _e(ec&&on,"ChildrenNode.ts has not been loaded"),Nv=Nv||new Pi({".priority":ec},{".priority":on}),Nv}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=cc(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Fs?t:null}hasIndex(e){return ei(this.indexSet_,e.toString())}addIndex(e,t){_e(e!==oc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let a=!1;const d=t.getIterator(ft.Wrap);let h=d.getNext();for(;h;)a=a||e.isDefinedOn(h.node),r.push(h),h=d.getNext();let g;a?g=om(r,e.getCompare()):g=ec;const y=e.toString(),_={...this.indexSet_};_[y]=e;const N={...this.indexes_};return N[y]=g,new Pi(N,_)}addToIndexes(e,t){const r=Yp(this.indexes_,(a,d)=>{const h=cc(this.indexSet_,d);if(_e(h,"Missing index implementation for "+d),a===ec)if(h.isDefinedOn(e.node)){const g=[],y=t.getIterator(ft.Wrap);let _=y.getNext();for(;_;)_.name!==e.name&&g.push(_),_=y.getNext();return g.push(e),om(g,h.getCompare())}else return ec;else{const g=t.get(e.name);let y=a;return g&&(y=y.remove(new ft(e.name,g))),y.insert(e,e.node)}});return new Pi(r,this.indexSet_)}removeFromIndexes(e,t){const r=Yp(this.indexes_,a=>{if(a===ec)return a;{const d=t.get(e.name);return d?a.remove(new ft(e.name,d)):a}});return new Pi(r,this.indexSet_)}}let ad;class Xe{static get EMPTY_NODE(){return ad||(ad=new Xe(new Fs(ny),null,Pi.Default))}constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Hb(this.priorityNode_),this.children_.isEmpty()&&_e(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ad}updatePriority(e){return this.children_.isEmpty()?this:new Xe(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?ad:t}}getChild(e){const t=dt(e);return t===null?this:this.getImmediateChild(t).getChild(Wt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(_e(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const r=new ft(e,t);let a,d;t.isEmpty()?(a=this.children_.remove(e),d=this.indexMap_.removeFromIndexes(r,this.children_)):(a=this.children_.insert(e,t),d=this.indexMap_.addToIndexes(r,this.children_));const h=a.isEmpty()?ad:this.priorityNode_;return new Xe(a,h,d)}}updateChild(e,t){const r=dt(e);if(r===null)return t;{_e(dt(e)!==".priority"||Vo(e)===1,".priority must be the last token in a path");const a=this.getImmediateChild(r).updateChild(Wt(e),t);return this.updateImmediateChild(r,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,a=0,d=!0;if(this.forEachChild(on,(h,g)=>{t[h]=g.val(e),r++,d&&Xe.INTEGER_REGEXP_.test(h)?a=Math.max(a,Number(h)):d=!1}),!e&&d&&a<2*r){const h=[];for(const g in t)h[g]=t[g];return h}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Vb(this.getPriority().val())+":"),this.forEachChild(on,(t,r)=>{const a=r.hash();a!==""&&(e+=":"+t+":"+a)}),this.lazyHash_=e===""?"":_b(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const a=this.resolveIndex_(r);if(a){const d=a.getPredecessorKey(new ft(e,t));return d?d.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new ft(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const r=t.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new ft(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal(a=>t(a.name,a.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,a=>a);{const a=this.children_.getIteratorFrom(e.name,ft.Wrap);let d=a.peek();for(;d!=null&&t.compare(d,e)<0;)a.getNext(),d=a.peek();return a}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,a=>a);{const a=this.children_.getReverseIteratorFrom(e.name,ft.Wrap);let d=a.peek();for(;d!=null&&t.compare(d,e)>0;)a.getNext(),d=a.peek();return a}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Hd?-1:0}withIndex(e){if(e===oc||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Xe(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===oc||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const r=this.getIterator(on),a=t.getIterator(on);let d=r.getNext(),h=a.getNext();for(;d&&h;){if(d.name!==h.name||!d.node.equals(h.node))return!1;d=r.getNext(),h=a.getNext()}return d===null&&h===null}else return!1;else return!1}}resolveIndex_(e){return e===oc?null:this.indexMap_.get(e.toString())}}Xe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class iA extends Xe{constructor(){super(new Fs(ny),Xe.EMPTY_NODE,Pi.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Xe.EMPTY_NODE}isEmpty(){return!1}}const Hd=new iA;Object.defineProperties(ft,{MIN:{value:new ft(fc,Xe.EMPTY_NODE)},MAX:{value:new ft(Ka,Hd)}});Wb.__EMPTY_NODE=Xe.EMPTY_NODE;On.__childrenNodeConstructor=Xe;ZP(Hd);tA(Hd);const oA=!0;function kn(n,e=null){if(n===null)return Xe.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),_e(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new On(t,kn(e))}if(!(n instanceof Array)&&oA){const t=[];let r=!1;if(Gn(n,(h,g)=>{if(h.substring(0,1)!=="."){const y=kn(g);y.isEmpty()||(r=r||!y.getPriority().isEmpty(),t.push(new ft(h,y)))}}),t.length===0)return Xe.EMPTY_NODE;const d=om(t,JP,h=>h.name,ny);if(r){const h=om(t,on.getCompare());return new Xe(d,kn(e),new Pi({".priority":h},{".priority":on}))}else return new Xe(d,kn(e),Pi.Default)}else{let t=Xe.EMPTY_NODE;return Gn(n,(r,a)=>{if(ei(n,r)&&r.substring(0,1)!=="."){const d=kn(a);(d.isLeafNode()||!d.isEmpty())&&(t=t.updateImmediateChild(r,d))}}),t.updatePriority(kn(e))}}eA(kn);class aA extends Am{constructor(e){super(),this.indexPath_=e,_e(!pt(e)&&dt(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),a=this.extractChild(t.node),d=r.compareTo(a);return d===0?Ya(e.name,t.name):d}makePost(e,t){const r=kn(e),a=Xe.EMPTY_NODE.updateChild(this.indexPath_,r);return new ft(t,a)}maxPost(){const e=Xe.EMPTY_NODE.updateChild(this.indexPath_,Hd);return new ft(Ka,e)}toString(){return Td(this.indexPath_,0).join("/")}}class lA extends Am{compare(e,t){const r=e.node.compareTo(t.node);return r===0?Ya(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ft.MIN}maxPost(){return ft.MAX}makePost(e,t){const r=kn(e);return new ft(t,r)}toString(){return".value"}}const cA=new lA;function Qb(n){return{type:"value",snapshotNode:n}}function hc(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Id(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Pd(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function uA(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}class sy{constructor(e){this.index_=e}updateChild(e,t,r,a,d,h){_e(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const g=e.getImmediateChild(t);return g.getChild(a).equals(r.getChild(a))&&g.isEmpty()===r.isEmpty()||(h!=null&&(r.isEmpty()?e.hasChild(t)?h.trackChildChange(Id(t,g)):_e(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):g.isEmpty()?h.trackChildChange(hc(t,r)):h.trackChildChange(Pd(t,r,g))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(on,(a,d)=>{t.hasChild(a)||r.trackChildChange(Id(a,d))}),t.isLeafNode()||t.forEachChild(on,(a,d)=>{if(e.hasChild(a)){const h=e.getImmediateChild(a);h.equals(d)||r.trackChildChange(Pd(a,d,h))}else r.trackChildChange(hc(a,d))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Xe.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Ad{constructor(e){this.indexedFilter_=new sy(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Ad.getStartPost_(e),this.endPost_=Ad.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,a,d,h){return this.matches(new ft(t,r))||(r=Xe.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,a,d,h)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Xe.EMPTY_NODE);let a=t.withIndex(this.index_);a=a.updatePriority(Xe.EMPTY_NODE);const d=this;return t.forEachChild(on,(h,g)=>{d.matches(new ft(h,g))||(a=a.updateImmediateChild(h,Xe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,a,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}class dA{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Ad(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,a,d,h){return this.rangedFilter_.matches(new ft(t,r))||(r=Xe.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,a,d,h):this.fullLimitUpdateChild_(e,t,r,d,h)}updateFullNode(e,t,r){let a;if(t.isLeafNode()||t.isEmpty())a=Xe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){a=Xe.EMPTY_NODE.withIndex(this.index_);let d;this.reverse_?d=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):d=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let h=0;for(;d.hasNext()&&h<this.limit_;){const g=d.getNext();if(this.withinDirectionalStart(g))if(this.withinDirectionalEnd(g))a=a.updateImmediateChild(g.name,g.node),h++;else break;else continue}}else{a=t.withIndex(this.index_),a=a.updatePriority(Xe.EMPTY_NODE);let d;this.reverse_?d=a.getReverseIterator(this.index_):d=a.getIterator(this.index_);let h=0;for(;d.hasNext();){const g=d.getNext();h<this.limit_&&this.withinDirectionalStart(g)&&this.withinDirectionalEnd(g)?h++:a=a.updateImmediateChild(g.name,Xe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,a,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,a,d){let h;if(this.reverse_){const T=this.index_.getCompare();h=(k,$)=>T($,k)}else h=this.index_.getCompare();const g=e;_e(g.numChildren()===this.limit_,"");const y=new ft(t,r),_=this.reverse_?g.getFirstChild(this.index_):g.getLastChild(this.index_),N=this.rangedFilter_.matches(y);if(g.hasChild(t)){const T=g.getImmediateChild(t);let k=a.getChildAfterChild(this.index_,_,this.reverse_);for(;k!=null&&(k.name===t||g.hasChild(k.name));)k=a.getChildAfterChild(this.index_,k,this.reverse_);const $=k==null?1:h(k,y);if(N&&!r.isEmpty()&&$>=0)return d?.trackChildChange(Pd(t,r,T)),g.updateImmediateChild(t,r);{d?.trackChildChange(Id(t,T));const F=g.updateImmediateChild(t,Xe.EMPTY_NODE);return k!=null&&this.rangedFilter_.matches(k)?(d?.trackChildChange(hc(k.name,k.node)),F.updateImmediateChild(k.name,k.node)):F}}else return r.isEmpty()?e:N&&h(_,y)>=0?(d!=null&&(d.trackChildChange(Id(_.name,_.node)),d.trackChildChange(hc(t,r))),g.updateImmediateChild(t,r).updateImmediateChild(_.name,Xe.EMPTY_NODE)):e}}class ry{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=on}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return _e(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return _e(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:fc}hasEnd(){return this.endSet_}getIndexEndValue(){return _e(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return _e(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ka}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return _e(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===on}copy(){const e=new ry;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function fA(n){return n.loadsAllData()?new sy(n.getIndex()):n.hasLimit()?new dA(n):new Ad(n)}function t1(n){const e={};if(n.isDefault())return e;let t;if(n.index_===on?t="$priority":n.index_===cA?t="$value":n.index_===oc?t="$key":(_e(n.index_ instanceof aA,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Sn(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=Sn(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Sn(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Sn(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Sn(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function n1(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==on&&(e.i=n.index_.toString()),e}class am extends Fb{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(_e(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,a){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=a,this.log_=Vd("p:rest:"),this.listens_={}}listen(e,t,r,a){const d=e._path.toString();this.log_("Listen called for "+d+" "+e._queryIdentifier);const h=am.getListenId_(e,r),g={};this.listens_[h]=g;const y=t1(e._queryParams);this.restRequest_(d+".json",y,(_,N)=>{let T=N;if(_===404&&(T=null,_=null),_===null&&this.onDataUpdate_(d,T,!1,r),cc(this.listens_,h)===g){let k;_?_===401?k="permission_denied":k="rest_error:"+_:k="ok",a(k,null)}})}unlisten(e,t){const r=am.getListenId_(e,t);delete this.listens_[r]}get(e){const t=t1(e._queryParams),r=e._path.toString(),a=new Dd;return this.restRequest_(r+".json",t,(d,h)=>{let g=h;d===404&&(g=null,d=null),d===null?(this.onDataUpdate_(r,g,!1,null),a.resolve(g)):a.reject(new Error(g))}),a.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([a,d])=>{a&&a.accessToken&&(t.auth=a.accessToken),d&&d.token&&(t.ac=d.token);const h=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Cc(t);this.log_("Sending REST request for "+h);const g=new XMLHttpRequest;g.onreadystatechange=()=>{if(r&&g.readyState===4){this.log_("REST Response for "+h+" received. status:",g.status,"response:",g.responseText);let y=null;if(g.status>=200&&g.status<300){try{y=kd(g.responseText)}catch{_s("Failed to parse JSON response for "+h+": "+g.responseText)}r(null,y)}else g.status!==401&&g.status!==404&&_s("Got unsuccessful REST response for "+h+" Status: "+g.status),r(g.status);r=null}},g.open("GET",h,!0),g.send()})}}class hA{constructor(){this.rootNode_=Xe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function lm(){return{value:null,children:new Map}}function Gb(n,e,t){if(pt(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const r=dt(e);n.children.has(r)||n.children.set(r,lm());const a=n.children.get(r);e=Wt(e),Gb(a,e,t)}}function a0(n,e,t){n.value!==null?t(e,n.value):pA(n,(r,a)=>{const d=new Pt(e.toString()+"/"+r);a0(a,d,t)})}function pA(n,e){n.children.forEach((t,r)=>{e(r,t)})}class mA{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t={...e};return this.last_&&Gn(this.last_,(r,a)=>{t[r]=t[r]-a}),this.last_=e,t}}const s1=10*1e3,gA=30*1e3,vA=300*1e3;class yA{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new mA(e);const r=s1+(gA-s1)*Math.random();yd(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Gn(e,(a,d)=>{d>0&&ei(this.statsToReport_,a)&&(t[a]=d,r=!0)}),r&&this.server_.reportStats(t),yd(this.reportStats_.bind(this),Math.floor(Math.random()*2*vA))}}var Tr;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Tr||(Tr={}));function iy(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function oy(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ay(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class cm{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Tr.ACK_USER_WRITE,this.source=iy()}operationForChild(e){if(pt(this.path)){if(this.affectedTree.value!=null)return _e(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Pt(e));return new cm(xt(),t,this.revert)}}else return _e(dt(this.path)===e,"operationForChild called for unrelated child."),new cm(Wt(this.path),this.affectedTree,this.revert)}}class Rd{constructor(e,t){this.source=e,this.path=t,this.type=Tr.LISTEN_COMPLETE}operationForChild(e){return pt(this.path)?new Rd(this.source,xt()):new Rd(this.source,Wt(this.path))}}class Qa{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Tr.OVERWRITE}operationForChild(e){return pt(this.path)?new Qa(this.source,xt(),this.snap.getImmediateChild(e)):new Qa(this.source,Wt(this.path),this.snap)}}class pc{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Tr.MERGE}operationForChild(e){if(pt(this.path)){const t=this.children.subtree(new Pt(e));return t.isEmpty()?null:t.value?new Qa(this.source,xt(),t.value):new pc(this.source,xt(),t)}else return _e(dt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new pc(this.source,Wt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Ho{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pt(e))return this.isFullyInitialized()&&!this.filtered_;const t=dt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class wA{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function _A(n,e,t,r){const a=[],d=[];return e.forEach(h=>{h.type==="child_changed"&&n.index_.indexedValueChanged(h.oldSnap,h.snapshotNode)&&d.push(uA(h.childName,h.snapshotNode))}),ld(n,a,"child_removed",e,r,t),ld(n,a,"child_added",e,r,t),ld(n,a,"child_moved",d,r,t),ld(n,a,"child_changed",e,r,t),ld(n,a,"value",e,r,t),a}function ld(n,e,t,r,a,d){const h=r.filter(g=>g.type===t);h.sort((g,y)=>bA(n,g,y)),h.forEach(g=>{const y=xA(n,g,d);a.forEach(_=>{_.respondsTo(g.type)&&e.push(_.createEvent(y,n.query_))})})}function xA(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function bA(n,e,t){if(e.childName==null||t.childName==null)throw xc("Should only compare child_ events.");const r=new ft(e.childName,e.snapshotNode),a=new ft(t.childName,t.snapshotNode);return n.index_.compare(r,a)}function Rm(n,e){return{eventCache:n,serverCache:e}}function wd(n,e,t,r){return Rm(new Ho(e,t,r),n.serverCache)}function Yb(n,e,t,r){return Rm(n.eventCache,new Ho(e,t,r))}function um(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Ga(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let Tv;const CA=()=>(Tv||(Tv=new Fs(aP)),Tv);class Bt{static fromObject(e){let t=new Bt(null);return Gn(e,(r,a)=>{t=t.set(new Pt(r),a)}),t}constructor(e,t=CA()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:xt(),value:this.value};if(pt(e))return null;{const r=dt(e),a=this.children.get(r);if(a!==null){const d=a.findRootMostMatchingPathAndValue(Wt(e),t);return d!=null?{path:rn(new Pt(r),d.path),value:d.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pt(e))return this;{const t=dt(e),r=this.children.get(t);return r!==null?r.subtree(Wt(e)):new Bt(null)}}set(e,t){if(pt(e))return new Bt(t,this.children);{const r=dt(e),d=(this.children.get(r)||new Bt(null)).set(Wt(e),t),h=this.children.insert(r,d);return new Bt(this.value,h)}}remove(e){if(pt(e))return this.children.isEmpty()?new Bt(null):new Bt(null,this.children);{const t=dt(e),r=this.children.get(t);if(r){const a=r.remove(Wt(e));let d;return a.isEmpty()?d=this.children.remove(t):d=this.children.insert(t,a),this.value===null&&d.isEmpty()?new Bt(null):new Bt(this.value,d)}else return this}}get(e){if(pt(e))return this.value;{const t=dt(e),r=this.children.get(t);return r?r.get(Wt(e)):null}}setTree(e,t){if(pt(e))return t;{const r=dt(e),d=(this.children.get(r)||new Bt(null)).setTree(Wt(e),t);let h;return d.isEmpty()?h=this.children.remove(r):h=this.children.insert(r,d),new Bt(this.value,h)}}fold(e){return this.fold_(xt(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((a,d)=>{r[a]=d.fold_(rn(e,a),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,xt(),t)}findOnPath_(e,t,r){const a=this.value?r(t,this.value):!1;if(a)return a;if(pt(e))return null;{const d=dt(e),h=this.children.get(d);return h?h.findOnPath_(Wt(e),rn(t,d),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,xt(),t)}foreachOnPath_(e,t,r){if(pt(e))return this;{this.value&&r(t,this.value);const a=dt(e),d=this.children.get(a);return d?d.foreachOnPath_(Wt(e),rn(t,a),r):new Bt(null)}}foreach(e){this.foreach_(xt(),e)}foreach_(e,t){this.children.inorderTraversal((r,a)=>{a.foreach_(rn(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class Pr{constructor(e){this.writeTree_=e}static empty(){return new Pr(new Bt(null))}}function _d(n,e,t){if(pt(e))return new Pr(new Bt(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){const a=r.path;let d=r.value;const h=ws(a,e);return d=d.updateChild(h,t),new Pr(n.writeTree_.set(a,d))}else{const a=new Bt(t),d=n.writeTree_.setTree(e,a);return new Pr(d)}}}function l0(n,e,t){let r=n;return Gn(t,(a,d)=>{r=_d(r,rn(e,a),d)}),r}function r1(n,e){if(pt(e))return Pr.empty();{const t=n.writeTree_.setTree(e,new Bt(null));return new Pr(t)}}function c0(n,e){return Xa(n,e)!=null}function Xa(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(ws(t.path,e)):null}function i1(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(on,(r,a)=>{e.push(new ft(r,a))}):n.writeTree_.children.inorderTraversal((r,a)=>{a.value!=null&&e.push(new ft(r,a.value))}),e}function Bo(n,e){if(pt(e))return n;{const t=Xa(n,e);return t!=null?new Pr(new Bt(t)):new Pr(n.writeTree_.subtree(e))}}function u0(n){return n.writeTree_.isEmpty()}function mc(n,e){return Xb(xt(),n.writeTree_,e)}function Xb(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((a,d)=>{a===".priority"?(_e(d.value!==null,"Priority writes must always be leaf nodes"),r=d.value):t=Xb(rn(n,a),d,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(rn(n,".priority"),r)),t}}function jm(n,e){return tC(e,n)}function kA(n,e,t,r,a){_e(r>n.lastWriteId,"Stacking an older write on top of newer ones"),a===void 0&&(a=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:a}),a&&(n.visibleWrites=_d(n.visibleWrites,e,t)),n.lastWriteId=r}function SA(n,e,t,r){_e(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=l0(n.visibleWrites,e,t),n.lastWriteId=r}function EA(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}function NA(n,e){const t=n.allWrites.findIndex(g=>g.writeId===e);_e(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let a=r.visible,d=!1,h=n.allWrites.length-1;for(;a&&h>=0;){const g=n.allWrites[h];g.visible&&(h>=t&&TA(g,r.path)?a=!1:dr(r.path,g.path)&&(d=!0)),h--}if(a){if(d)return IA(n),!0;if(r.snap)n.visibleWrites=r1(n.visibleWrites,r.path);else{const g=r.children;Gn(g,y=>{n.visibleWrites=r1(n.visibleWrites,rn(r.path,y))})}return!0}else return!1}function TA(n,e){if(n.snap)return dr(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&dr(rn(n.path,t),e))return!0;return!1}function IA(n){n.visibleWrites=Jb(n.allWrites,PA,xt()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function PA(n){return n.visible}function Jb(n,e,t){let r=Pr.empty();for(let a=0;a<n.length;++a){const d=n[a];if(e(d)){const h=d.path;let g;if(d.snap)dr(t,h)?(g=ws(t,h),r=_d(r,g,d.snap)):dr(h,t)&&(g=ws(h,t),r=_d(r,xt(),d.snap.getChild(g)));else if(d.children){if(dr(t,h))g=ws(t,h),r=l0(r,g,d.children);else if(dr(h,t))if(g=ws(h,t),pt(g))r=l0(r,xt(),d.children);else{const y=cc(d.children,dt(g));if(y){const _=y.getChild(Wt(g));r=_d(r,xt(),_)}}}else throw xc("WriteRecord should have .snap or .children")}}return r}function Zb(n,e,t,r,a){if(!r&&!a){const d=Xa(n.visibleWrites,e);if(d!=null)return d;{const h=Bo(n.visibleWrites,e);if(u0(h))return t;if(t==null&&!c0(h,xt()))return null;{const g=t||Xe.EMPTY_NODE;return mc(h,g)}}}else{const d=Bo(n.visibleWrites,e);if(!a&&u0(d))return t;if(!a&&t==null&&!c0(d,xt()))return null;{const h=function(_){return(_.visible||a)&&(!r||!~r.indexOf(_.writeId))&&(dr(_.path,e)||dr(e,_.path))},g=Jb(n.allWrites,h,e),y=t||Xe.EMPTY_NODE;return mc(g,y)}}}function AA(n,e,t){let r=Xe.EMPTY_NODE;const a=Xa(n.visibleWrites,e);if(a)return a.isLeafNode()||a.forEachChild(on,(d,h)=>{r=r.updateImmediateChild(d,h)}),r;if(t){const d=Bo(n.visibleWrites,e);return t.forEachChild(on,(h,g)=>{const y=mc(Bo(d,new Pt(h)),g);r=r.updateImmediateChild(h,y)}),i1(d).forEach(h=>{r=r.updateImmediateChild(h.name,h.node)}),r}else{const d=Bo(n.visibleWrites,e);return i1(d).forEach(h=>{r=r.updateImmediateChild(h.name,h.node)}),r}}function RA(n,e,t,r,a){_e(r||a,"Either existingEventSnap or existingServerSnap must exist");const d=rn(e,t);if(c0(n.visibleWrites,d))return null;{const h=Bo(n.visibleWrites,d);return u0(h)?a.getChild(t):mc(h,a.getChild(t))}}function jA(n,e,t,r){const a=rn(e,t),d=Xa(n.visibleWrites,a);if(d!=null)return d;if(r.isCompleteForChild(t)){const h=Bo(n.visibleWrites,a);return mc(h,r.getNode().getImmediateChild(t))}else return null}function $A(n,e){return Xa(n.visibleWrites,e)}function OA(n,e,t,r,a,d,h){let g;const y=Bo(n.visibleWrites,e),_=Xa(y,xt());if(_!=null)g=_;else if(t!=null)g=mc(y,t);else return[];if(g=g.withIndex(h),!g.isEmpty()&&!g.isLeafNode()){const N=[],T=h.getCompare(),k=d?g.getReverseIteratorFrom(r,h):g.getIteratorFrom(r,h);let $=k.getNext();for(;$&&N.length<a;)T($,r)!==0&&N.push($),$=k.getNext();return N}else return[]}function MA(){return{visibleWrites:Pr.empty(),allWrites:[],lastWriteId:-1}}function dm(n,e,t,r){return Zb(n.writeTree,n.treePath,e,t,r)}function ly(n,e){return AA(n.writeTree,n.treePath,e)}function o1(n,e,t,r){return RA(n.writeTree,n.treePath,e,t,r)}function fm(n,e){return $A(n.writeTree,rn(n.treePath,e))}function DA(n,e,t,r,a,d){return OA(n.writeTree,n.treePath,e,t,r,a,d)}function cy(n,e,t){return jA(n.writeTree,n.treePath,e,t)}function eC(n,e){return tC(rn(n.treePath,e),n.writeTree)}function tC(n,e){return{treePath:n,writeTree:e}}class LA{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;_e(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),_e(r!==".priority","Only non-priority child changes can be tracked.");const a=this.changeMap.get(r);if(a){const d=a.type;if(t==="child_added"&&d==="child_removed")this.changeMap.set(r,Pd(r,e.snapshotNode,a.snapshotNode));else if(t==="child_removed"&&d==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&d==="child_changed")this.changeMap.set(r,Id(r,a.oldSnap));else if(t==="child_changed"&&d==="child_added")this.changeMap.set(r,hc(r,e.snapshotNode));else if(t==="child_changed"&&d==="child_changed")this.changeMap.set(r,Pd(r,e.snapshotNode,a.oldSnap));else throw xc("Illegal combination of changes: "+e+" occurred after "+a)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}class FA{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}}const nC=new FA;class uy{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Ho(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return cy(this.writes_,e,r)}}getChildAfterChild(e,t,r){const a=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Ga(this.viewCache_),d=DA(this.writes_,a,t,1,r,e);return d.length===0?null:d[0]}}function UA(n){return{filter:n}}function zA(n,e){_e(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),_e(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function BA(n,e,t,r,a){const d=new LA;let h,g;if(t.type===Tr.OVERWRITE){const _=t;_.source.fromUser?h=d0(n,e,_.path,_.snap,r,a,d):(_e(_.source.fromServer,"Unknown source."),g=_.source.tagged||e.serverCache.isFiltered()&&!pt(_.path),h=hm(n,e,_.path,_.snap,r,a,g,d))}else if(t.type===Tr.MERGE){const _=t;_.source.fromUser?h=VA(n,e,_.path,_.children,r,a,d):(_e(_.source.fromServer,"Unknown source."),g=_.source.tagged||e.serverCache.isFiltered(),h=f0(n,e,_.path,_.children,r,a,g,d))}else if(t.type===Tr.ACK_USER_WRITE){const _=t;_.revert?h=KA(n,e,_.path,r,a,d):h=HA(n,e,_.path,_.affectedTree,r,a,d)}else if(t.type===Tr.LISTEN_COMPLETE)h=qA(n,e,t.path,r,d);else throw xc("Unknown operation type: "+t.type);const y=d.getChanges();return WA(e,h,y),{viewCache:h,changes:y}}function WA(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const a=r.getNode().isLeafNode()||r.getNode().isEmpty(),d=um(n);(t.length>0||!n.eventCache.isFullyInitialized()||a&&!r.getNode().equals(d)||!r.getNode().getPriority().equals(d.getPriority()))&&t.push(Qb(um(e)))}}function sC(n,e,t,r,a,d){const h=e.eventCache;if(fm(r,t)!=null)return e;{let g,y;if(pt(t))if(_e(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const _=Ga(e),N=_ instanceof Xe?_:Xe.EMPTY_NODE,T=ly(r,N);g=n.filter.updateFullNode(e.eventCache.getNode(),T,d)}else{const _=dm(r,Ga(e));g=n.filter.updateFullNode(e.eventCache.getNode(),_,d)}else{const _=dt(t);if(_===".priority"){_e(Vo(t)===1,"Can't have a priority with additional path components");const N=h.getNode();y=e.serverCache.getNode();const T=o1(r,t,N,y);T!=null?g=n.filter.updatePriority(N,T):g=h.getNode()}else{const N=Wt(t);let T;if(h.isCompleteForChild(_)){y=e.serverCache.getNode();const k=o1(r,t,h.getNode(),y);k!=null?T=h.getNode().getImmediateChild(_).updateChild(N,k):T=h.getNode().getImmediateChild(_)}else T=cy(r,_,e.serverCache);T!=null?g=n.filter.updateChild(h.getNode(),_,T,N,a,d):g=h.getNode()}}return wd(e,g,h.isFullyInitialized()||pt(t),n.filter.filtersNodes())}}function hm(n,e,t,r,a,d,h,g){const y=e.serverCache;let _;const N=h?n.filter:n.filter.getIndexedFilter();if(pt(t))_=N.updateFullNode(y.getNode(),r,null);else if(N.filtersNodes()&&!y.isFiltered()){const $=y.getNode().updateChild(t,r);_=N.updateFullNode(y.getNode(),$,null)}else{const $=dt(t);if(!y.isCompleteForPath(t)&&Vo(t)>1)return e;const M=Wt(t),H=y.getNode().getImmediateChild($).updateChild(M,r);$===".priority"?_=N.updatePriority(y.getNode(),H):_=N.updateChild(y.getNode(),$,H,M,nC,null)}const T=Yb(e,_,y.isFullyInitialized()||pt(t),N.filtersNodes()),k=new uy(a,T,d);return sC(n,T,t,a,k,g)}function d0(n,e,t,r,a,d,h){const g=e.eventCache;let y,_;const N=new uy(a,e,d);if(pt(t))_=n.filter.updateFullNode(e.eventCache.getNode(),r,h),y=wd(e,_,!0,n.filter.filtersNodes());else{const T=dt(t);if(T===".priority")_=n.filter.updatePriority(e.eventCache.getNode(),r),y=wd(e,_,g.isFullyInitialized(),g.isFiltered());else{const k=Wt(t),$=g.getNode().getImmediateChild(T);let M;if(pt(k))M=r;else{const F=N.getCompleteChild(T);F!=null?Z0(k)===".priority"&&F.getChild(zb(k)).isEmpty()?M=F:M=F.updateChild(k,r):M=Xe.EMPTY_NODE}if($.equals(M))y=e;else{const F=n.filter.updateChild(g.getNode(),T,M,k,N,h);y=wd(e,F,g.isFullyInitialized(),n.filter.filtersNodes())}}}return y}function a1(n,e){return n.eventCache.isCompleteForChild(e)}function VA(n,e,t,r,a,d,h){let g=e;return r.foreach((y,_)=>{const N=rn(t,y);a1(e,dt(N))&&(g=d0(n,g,N,_,a,d,h))}),r.foreach((y,_)=>{const N=rn(t,y);a1(e,dt(N))||(g=d0(n,g,N,_,a,d,h))}),g}function l1(n,e,t){return t.foreach((r,a)=>{e=e.updateChild(r,a)}),e}function f0(n,e,t,r,a,d,h,g){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let y=e,_;pt(t)?_=r:_=new Bt(null).setTree(t,r);const N=e.serverCache.getNode();return _.children.inorderTraversal((T,k)=>{if(N.hasChild(T)){const $=e.serverCache.getNode().getImmediateChild(T),M=l1(n,$,k);y=hm(n,y,new Pt(T),M,a,d,h,g)}}),_.children.inorderTraversal((T,k)=>{const $=!e.serverCache.isCompleteForChild(T)&&k.value===null;if(!N.hasChild(T)&&!$){const M=e.serverCache.getNode().getImmediateChild(T),F=l1(n,M,k);y=hm(n,y,new Pt(T),F,a,d,h,g)}}),y}function HA(n,e,t,r,a,d,h){if(fm(a,t)!=null)return e;const g=e.serverCache.isFiltered(),y=e.serverCache;if(r.value!=null){if(pt(t)&&y.isFullyInitialized()||y.isCompleteForPath(t))return hm(n,e,t,y.getNode().getChild(t),a,d,g,h);if(pt(t)){let _=new Bt(null);return y.getNode().forEachChild(oc,(N,T)=>{_=_.set(new Pt(N),T)}),f0(n,e,t,_,a,d,g,h)}else return e}else{let _=new Bt(null);return r.foreach((N,T)=>{const k=rn(t,N);y.isCompleteForPath(k)&&(_=_.set(N,y.getNode().getChild(k)))}),f0(n,e,t,_,a,d,g,h)}}function qA(n,e,t,r,a){const d=e.serverCache,h=Yb(e,d.getNode(),d.isFullyInitialized()||pt(t),d.isFiltered());return sC(n,h,t,r,nC,a)}function KA(n,e,t,r,a,d){let h;if(fm(r,t)!=null)return e;{const g=new uy(r,e,a),y=e.eventCache.getNode();let _;if(pt(t)||dt(t)===".priority"){let N;if(e.serverCache.isFullyInitialized())N=dm(r,Ga(e));else{const T=e.serverCache.getNode();_e(T instanceof Xe,"serverChildren would be complete if leaf node"),N=ly(r,T)}N=N,_=n.filter.updateFullNode(y,N,d)}else{const N=dt(t);let T=cy(r,N,e.serverCache);T==null&&e.serverCache.isCompleteForChild(N)&&(T=y.getImmediateChild(N)),T!=null?_=n.filter.updateChild(y,N,T,Wt(t),g,d):e.eventCache.getNode().hasChild(N)?_=n.filter.updateChild(y,N,Xe.EMPTY_NODE,Wt(t),g,d):_=y,_.isEmpty()&&e.serverCache.isFullyInitialized()&&(h=dm(r,Ga(e)),h.isLeafNode()&&(_=n.filter.updateFullNode(_,h,d)))}return h=e.serverCache.isFullyInitialized()||fm(r,xt())!=null,wd(e,_,h,n.filter.filtersNodes())}}class QA{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,a=new sy(r.getIndex()),d=fA(r);this.processor_=UA(d);const h=t.serverCache,g=t.eventCache,y=a.updateFullNode(Xe.EMPTY_NODE,h.getNode(),null),_=d.updateFullNode(Xe.EMPTY_NODE,g.getNode(),null),N=new Ho(y,h.isFullyInitialized(),a.filtersNodes()),T=new Ho(_,g.isFullyInitialized(),d.filtersNodes());this.viewCache_=Rm(T,N),this.eventGenerator_=new wA(this.query_)}get query(){return this.query_}}function GA(n){return n.viewCache_.serverCache.getNode()}function YA(n){return um(n.viewCache_)}function XA(n,e){const t=Ga(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!pt(e)&&!t.getImmediateChild(dt(e)).isEmpty())?t.getChild(e):null}function c1(n){return n.eventRegistrations_.length===0}function JA(n,e){n.eventRegistrations_.push(e)}function u1(n,e,t){const r=[];if(t){_e(e==null,"A cancel should cancel all event registrations.");const a=n.query._path;n.eventRegistrations_.forEach(d=>{const h=d.createCancelEvent(t,a);h&&r.push(h)})}if(e){let a=[];for(let d=0;d<n.eventRegistrations_.length;++d){const h=n.eventRegistrations_[d];if(!h.matches(e))a.push(h);else if(e.hasAnyCallback()){a=a.concat(n.eventRegistrations_.slice(d+1));break}}n.eventRegistrations_=a}else n.eventRegistrations_=[];return r}function d1(n,e,t,r){e.type===Tr.MERGE&&e.source.queryId!==null&&(_e(Ga(n.viewCache_),"We should always have a full cache before handling merges"),_e(um(n.viewCache_),"Missing event cache, even though we have a server cache"));const a=n.viewCache_,d=BA(n.processor_,a,e,t,r);return zA(n.processor_,d.viewCache),_e(d.viewCache.serverCache.isFullyInitialized()||!a.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=d.viewCache,rC(n,d.changes,d.viewCache.eventCache.getNode(),null)}function ZA(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(on,(d,h)=>{r.push(hc(d,h))}),t.isFullyInitialized()&&r.push(Qb(t.getNode())),rC(n,r,t.getNode(),e)}function rC(n,e,t,r){const a=r?[r]:n.eventRegistrations_;return _A(n.eventGenerator_,e,t,a)}let pm;class iC{constructor(){this.views=new Map}}function eR(n){_e(!pm,"__referenceConstructor has already been defined"),pm=n}function tR(){return _e(pm,"Reference.ts has not been loaded"),pm}function nR(n){return n.views.size===0}function dy(n,e,t,r){const a=e.source.queryId;if(a!==null){const d=n.views.get(a);return _e(d!=null,"SyncTree gave us an op for an invalid query."),d1(d,e,t,r)}else{let d=[];for(const h of n.views.values())d=d.concat(d1(h,e,t,r));return d}}function oC(n,e,t,r,a){const d=e._queryIdentifier,h=n.views.get(d);if(!h){let g=dm(t,a?r:null),y=!1;g?y=!0:r instanceof Xe?(g=ly(t,r),y=!1):(g=Xe.EMPTY_NODE,y=!1);const _=Rm(new Ho(g,y,!1),new Ho(r,a,!1));return new QA(e,_)}return h}function sR(n,e,t,r,a,d){const h=oC(n,e,r,a,d);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,h),JA(h,t),ZA(h,t)}function rR(n,e,t,r){const a=e._queryIdentifier,d=[];let h=[];const g=qo(n);if(a==="default")for(const[y,_]of n.views.entries())h=h.concat(u1(_,t,r)),c1(_)&&(n.views.delete(y),_.query._queryParams.loadsAllData()||d.push(_.query));else{const y=n.views.get(a);y&&(h=h.concat(u1(y,t,r)),c1(y)&&(n.views.delete(a),y.query._queryParams.loadsAllData()||d.push(y.query)))}return g&&!qo(n)&&d.push(new(tR())(e._repo,e._path)),{removed:d,events:h}}function aC(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Wo(n,e){let t=null;for(const r of n.views.values())t=t||XA(r,e);return t}function lC(n,e){if(e._queryParams.loadsAllData())return $m(n);{const r=e._queryIdentifier;return n.views.get(r)}}function cC(n,e){return lC(n,e)!=null}function qo(n){return $m(n)!=null}function $m(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let mm;function iR(n){_e(!mm,"__referenceConstructor has already been defined"),mm=n}function oR(){return _e(mm,"Reference.ts has not been loaded"),mm}let aR=1;class f1{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Bt(null),this.pendingWriteTree_=MA(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function uC(n,e,t,r,a){return kA(n.pendingWriteTree_,e,t,r,a),a?Nc(n,new Qa(iy(),e,t)):[]}function lR(n,e,t,r){SA(n.pendingWriteTree_,e,t,r);const a=Bt.fromObject(t);return Nc(n,new pc(iy(),e,a))}function Do(n,e,t=!1){const r=EA(n.pendingWriteTree_,e);if(NA(n.pendingWriteTree_,e)){let d=new Bt(null);return r.snap!=null?d=d.set(xt(),!0):Gn(r.children,h=>{d=d.set(new Pt(h),!0)}),Nc(n,new cm(r.path,d,t))}else return[]}function qd(n,e,t){return Nc(n,new Qa(oy(),e,t))}function cR(n,e,t){const r=Bt.fromObject(t);return Nc(n,new pc(oy(),e,r))}function uR(n,e){return Nc(n,new Rd(oy(),e))}function dR(n,e,t){const r=hy(n,t);if(r){const a=py(r),d=a.path,h=a.queryId,g=ws(d,e),y=new Rd(ay(h),g);return my(n,d,y)}else return[]}function gm(n,e,t,r,a=!1){const d=e._path,h=n.syncPointTree_.get(d);let g=[];if(h&&(e._queryIdentifier==="default"||cC(h,e))){const y=rR(h,e,t,r);nR(h)&&(n.syncPointTree_=n.syncPointTree_.remove(d));const _=y.removed;if(g=y.events,!a){const N=_.findIndex(k=>k._queryParams.loadsAllData())!==-1,T=n.syncPointTree_.findOnPath(d,(k,$)=>qo($));if(N&&!T){const k=n.syncPointTree_.subtree(d);if(!k.isEmpty()){const $=pR(k);for(let M=0;M<$.length;++M){const F=$[M],H=F.query,ye=pC(n,F);n.listenProvider_.startListening(xd(H),jd(n,H),ye.hashFn,ye.onComplete)}}}!T&&_.length>0&&!r&&(N?n.listenProvider_.stopListening(xd(e),null):_.forEach(k=>{const $=n.queryToTagMap.get(Om(k));n.listenProvider_.stopListening(xd(k),$)}))}mR(n,_)}return g}function dC(n,e,t,r){const a=hy(n,r);if(a!=null){const d=py(a),h=d.path,g=d.queryId,y=ws(h,e),_=new Qa(ay(g),y,t);return my(n,h,_)}else return[]}function fR(n,e,t,r){const a=hy(n,r);if(a){const d=py(a),h=d.path,g=d.queryId,y=ws(h,e),_=Bt.fromObject(t),N=new pc(ay(g),y,_);return my(n,h,N)}else return[]}function h0(n,e,t,r=!1){const a=e._path;let d=null,h=!1;n.syncPointTree_.foreachOnPath(a,(k,$)=>{const M=ws(k,a);d=d||Wo($,M),h=h||qo($)});let g=n.syncPointTree_.get(a);g?(h=h||qo(g),d=d||Wo(g,xt())):(g=new iC,n.syncPointTree_=n.syncPointTree_.set(a,g));let y;d!=null?y=!0:(y=!1,d=Xe.EMPTY_NODE,n.syncPointTree_.subtree(a).foreachChild(($,M)=>{const F=Wo(M,xt());F&&(d=d.updateImmediateChild($,F))}));const _=cC(g,e);if(!_&&!e._queryParams.loadsAllData()){const k=Om(e);_e(!n.queryToTagMap.has(k),"View does not exist, but we have a tag");const $=gR();n.queryToTagMap.set(k,$),n.tagToQueryMap.set($,k)}const N=jm(n.pendingWriteTree_,a);let T=sR(g,e,t,N,d,y);if(!_&&!h&&!r){const k=lC(g,e);T=T.concat(vR(n,e,k))}return T}function fy(n,e,t){const a=n.pendingWriteTree_,d=n.syncPointTree_.findOnPath(e,(h,g)=>{const y=ws(h,e),_=Wo(g,y);if(_)return _});return Zb(a,e,d,t,!0)}function hR(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(_,N)=>{const T=ws(_,t);r=r||Wo(N,T)});let a=n.syncPointTree_.get(t);a?r=r||Wo(a,xt()):(a=new iC,n.syncPointTree_=n.syncPointTree_.set(t,a));const d=r!=null,h=d?new Ho(r,!0,!1):null,g=jm(n.pendingWriteTree_,e._path),y=oC(a,e,g,d?h.getNode():Xe.EMPTY_NODE,d);return YA(y)}function Nc(n,e){return fC(e,n.syncPointTree_,null,jm(n.pendingWriteTree_,xt()))}function fC(n,e,t,r){if(pt(n.path))return hC(n,e,t,r);{const a=e.get(xt());t==null&&a!=null&&(t=Wo(a,xt()));let d=[];const h=dt(n.path),g=n.operationForChild(h),y=e.children.get(h);if(y&&g){const _=t?t.getImmediateChild(h):null,N=eC(r,h);d=d.concat(fC(g,y,_,N))}return a&&(d=d.concat(dy(a,n,r,t))),d}}function hC(n,e,t,r){const a=e.get(xt());t==null&&a!=null&&(t=Wo(a,xt()));let d=[];return e.children.inorderTraversal((h,g)=>{const y=t?t.getImmediateChild(h):null,_=eC(r,h),N=n.operationForChild(h);N&&(d=d.concat(hC(N,g,y,_)))}),a&&(d=d.concat(dy(a,n,r,t))),d}function pC(n,e){const t=e.query,r=jd(n,t);return{hashFn:()=>(GA(e)||Xe.EMPTY_NODE).hash(),onComplete:a=>{if(a==="ok")return r?dR(n,t._path,r):uR(n,t._path);{const d=uP(a,t);return gm(n,t,null,d)}}}}function jd(n,e){const t=Om(e);return n.queryToTagMap.get(t)}function Om(n){return n._path.toString()+"$"+n._queryIdentifier}function hy(n,e){return n.tagToQueryMap.get(e)}function py(n){const e=n.indexOf("$");return _e(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Pt(n.substr(0,e))}}function my(n,e,t){const r=n.syncPointTree_.get(e);_e(r,"Missing sync point for query tag that we're tracking");const a=jm(n.pendingWriteTree_,e);return dy(r,t,a,null)}function pR(n){return n.fold((e,t,r)=>{if(t&&qo(t))return[$m(t)];{let a=[];return t&&(a=aC(t)),Gn(r,(d,h)=>{a=a.concat(h)}),a}})}function xd(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(oR())(n._repo,n._path):n}function mR(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const a=Om(r),d=n.queryToTagMap.get(a);n.queryToTagMap.delete(a),n.tagToQueryMap.delete(d)}}}function gR(){return aR++}function vR(n,e,t){const r=e._path,a=jd(n,e),d=pC(n,t),h=n.listenProvider_.startListening(xd(e),a,d.hashFn,d.onComplete),g=n.syncPointTree_.subtree(r);if(a)_e(!qo(g.value),"If we're adding a query, it shouldn't be shadowed");else{const y=g.fold((_,N,T)=>{if(!pt(_)&&N&&qo(N))return[$m(N).query];{let k=[];return N&&(k=k.concat(aC(N).map($=>$.query))),Gn(T,($,M)=>{k=k.concat(M)}),k}});for(let _=0;_<y.length;++_){const N=y[_];n.listenProvider_.stopListening(xd(N),jd(n,N))}}return h}class gy{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new gy(t)}node(){return this.node_}}class vy{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=rn(this.path_,e);return new vy(this.syncTree_,t)}node(){return fy(this.syncTree_,this.path_)}}const yR=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},h1=function(n,e,t){if(!n||typeof n!="object")return n;if(_e(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return wR(n[".sv"],e,t);if(typeof n[".sv"]=="object")return _R(n[".sv"],e);_e(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},wR=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:_e(!1,"Unexpected server value: "+n)}},_R=function(n,e,t){n.hasOwnProperty("increment")||_e(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;typeof r!="number"&&_e(!1,"Unexpected increment value: "+r);const a=e.node();if(_e(a!==null&&typeof a<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!a.isLeafNode())return r;const h=a.getValue();return typeof h!="number"?r:h+r},mC=function(n,e,t,r){return yy(e,new vy(t,n),r)},gC=function(n,e,t){return yy(n,new gy(e),t)};function yy(n,e,t){const r=n.getPriority().val(),a=h1(r,e.getImmediateChild(".priority"),t);let d;if(n.isLeafNode()){const h=n,g=h1(h.getValue(),e,t);return g!==h.getValue()||a!==h.getPriority().val()?new On(g,kn(a)):n}else{const h=n;return d=h,a!==h.getPriority().val()&&(d=d.updatePriority(new On(a))),h.forEachChild(on,(g,y)=>{const _=yy(y,e.getImmediateChild(g),t);_!==y&&(d=d.updateImmediateChild(g,_))}),d}}class wy{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function _y(n,e){let t=e instanceof Pt?e:new Pt(e),r=n,a=dt(t);for(;a!==null;){const d=cc(r.node.children,a)||{children:{},childCount:0};r=new wy(a,r,d),t=Wt(t),a=dt(t)}return r}function Tc(n){return n.node.value}function vC(n,e){n.node.value=e,p0(n)}function yC(n){return n.node.childCount>0}function xR(n){return Tc(n)===void 0&&!yC(n)}function Mm(n,e){Gn(n.node.children,(t,r)=>{e(new wy(t,n,r))})}function wC(n,e,t,r){t&&e(n),Mm(n,a=>{wC(a,e,!0)})}function bR(n,e,t){let r=n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Kd(n){return new Pt(n.parent===null?n.name:Kd(n.parent)+"/"+n.name)}function p0(n){n.parent!==null&&CR(n.parent,n.name,n)}function CR(n,e,t){const r=xR(t),a=ei(n.node.children,e);r&&a?(delete n.node.children[e],n.node.childCount--,p0(n)):!r&&!a&&(n.node.children[e]=t.node,n.node.childCount++,p0(n))}const kR=/[\[\].#$\/\u0000-\u001F\u007F]/,SR=/[\[\].#$\u0000-\u001F\u007F]/,Iv=10*1024*1024,xy=function(n){return typeof n=="string"&&n.length!==0&&!kR.test(n)},_C=function(n){return typeof n=="string"&&n.length!==0&&!SR.test(n)},ER=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),_C(n)},NR=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!Q0(n)||n&&typeof n=="object"&&ei(n,".sv")},TR=function(n,e,t,r){Dm(Em(n,"value"),e,t)},Dm=function(n,e,t){const r=t instanceof Pt?new VP(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+$a(r));if(typeof e=="function")throw new Error(n+"contains a function "+$a(r)+" with contents = "+e.toString());if(Q0(e))throw new Error(n+"contains "+e.toString()+" "+$a(r));if(typeof e=="string"&&e.length>Iv/3&&Nm(e)>Iv)throw new Error(n+"contains a string greater than "+Iv+" utf8 bytes "+$a(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let a=!1,d=!1;if(Gn(e,(h,g)=>{if(h===".value")a=!0;else if(h!==".priority"&&h!==".sv"&&(d=!0,!xy(h)))throw new Error(n+" contains an invalid key ("+h+") "+$a(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);HP(r,h),Dm(n,g,r),qP(r)}),a&&d)throw new Error(n+' contains ".value" child '+$a(r)+" in addition to actual children.")}},IR=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const d=Td(r);for(let h=0;h<d.length;h++)if(!(d[h]===".priority"&&h===d.length-1)){if(!xy(d[h]))throw new Error(n+"contains an invalid key ("+d[h]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(WP);let a=null;for(t=0;t<e.length;t++){if(r=e[t],a!==null&&dr(a,r))throw new Error(n+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}},PR=function(n,e,t,r){const a=Em(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(a+" must be an object containing the children to replace.");const d=[];Gn(e,(h,g)=>{const y=new Pt(h);if(Dm(a,g,rn(t,y)),Z0(y)===".priority"&&!NR(g))throw new Error(a+"contains an invalid value for '"+y.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");d.push(y)}),IR(a,d)},xC=function(n,e,t,r){if(!_C(t))throw new Error(Em(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},AR=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),xC(n,e,t)},RR=function(n,e){if(dt(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},jR=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!xy(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!ER(t))throw new Error(Em(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};class $R{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Lm(n,e){let t=null;for(let r=0;r<e.length;r++){const a=e[r],d=a.getPath();t!==null&&!ey(d,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:d}),t.events.push(a)}t&&n.eventLists_.push(t)}function bC(n,e,t){Lm(n,t),CC(n,r=>ey(r,e))}function hr(n,e,t){Lm(n,t),CC(n,r=>dr(r,e)||dr(e,r))}function CC(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const a=n.eventLists_[r];if(a){const d=a.path;e(d)?(OR(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function OR(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const r=t.getEventRunner();vd&&Qn("event: "+t.toString()),Ec(r)}}}const MR="repo_interrupt",DR=25;class LR{constructor(e,t,r,a){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=a,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new $R,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=lm(),this.transactionQueueTree_=new wy,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function FR(n,e,t){if(n.stats_=X0(n.repoInfo_),n.forceRestClient_||pP())n.server_=new am(n.repoInfo_,(r,a,d,h)=>{p1(n,r,a,d,h)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>m1(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Sn(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new $i(n.repoInfo_,e,(r,a,d,h)=>{p1(n,r,a,d,h)},r=>{m1(n,r)},r=>{zR(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=wP(n.repoInfo_,()=>new yA(n.stats_,n.server_)),n.infoData_=new hA,n.infoSyncTree_=new f1({startListening:(r,a,d,h)=>{let g=[];const y=n.infoData_.getNode(r._path);return y.isEmpty()||(g=qd(n.infoSyncTree_,r._path,y),setTimeout(()=>{h("ok")},0)),g},stopListening:()=>{}}),by(n,"connected",!1),n.serverSyncTree_=new f1({startListening:(r,a,d,h)=>(n.server_.listen(r,d,a,(g,y)=>{const _=h(g,y);hr(n.eventQueue_,r._path,_)}),[]),stopListening:(r,a)=>{n.server_.unlisten(r,a)}})}function UR(n){const t=n.infoData_.getNode(new Pt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Fm(n){return yR({timestamp:UR(n)})}function p1(n,e,t,r,a){n.dataUpdateCount++;const d=new Pt(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let h=[];if(a)if(r){const y=Yp(t,_=>kn(_));h=fR(n.serverSyncTree_,d,y,a)}else{const y=kn(t);h=dC(n.serverSyncTree_,d,y,a)}else if(r){const y=Yp(t,_=>kn(_));h=cR(n.serverSyncTree_,d,y)}else{const y=kn(t);h=qd(n.serverSyncTree_,d,y)}let g=d;h.length>0&&(g=gc(n,d)),hr(n.eventQueue_,g,h)}function m1(n,e){by(n,"connected",e),e===!1&&HR(n)}function zR(n,e){Gn(e,(t,r)=>{by(n,t,r)})}function by(n,e,t){const r=new Pt("/.info/"+e),a=kn(t);n.infoData_.updateSnapshot(r,a);const d=qd(n.infoSyncTree_,r,a);hr(n.eventQueue_,r,d)}function Cy(n){return n.nextWriteId_++}function BR(n,e,t){const r=hR(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(a=>{const d=kn(a).withIndex(e._queryParams.getIndex());h0(n.serverSyncTree_,e,t,!0);let h;if(e._queryParams.loadsAllData())h=qd(n.serverSyncTree_,e._path,d);else{const g=jd(n.serverSyncTree_,e);h=dC(n.serverSyncTree_,e._path,d,g)}return hr(n.eventQueue_,e._path,h),gm(n.serverSyncTree_,e,t,null,!0),d},a=>(Qd(n,"get for query "+Sn(e)+" failed: "+a),Promise.reject(new Error(a))))}function WR(n,e,t,r,a){Qd(n,"set",{path:e.toString(),value:t,priority:r});const d=Fm(n),h=kn(t,r),g=fy(n.serverSyncTree_,e),y=gC(h,g,d),_=Cy(n),N=uC(n.serverSyncTree_,e,y,_,!0);Lm(n.eventQueue_,N),n.server_.put(e.toString(),h.val(!0),(k,$)=>{const M=k==="ok";M||_s("set at "+e+" failed: "+k);const F=Do(n.serverSyncTree_,_,!M);hr(n.eventQueue_,e,F),m0(n,a,k,$)});const T=Sy(n,e);gc(n,T),hr(n.eventQueue_,T,[])}function VR(n,e,t,r){Qd(n,"update",{path:e.toString(),value:t});let a=!0;const d=Fm(n),h={};if(Gn(t,(g,y)=>{a=!1,h[g]=mC(rn(e,g),kn(y),n.serverSyncTree_,d)}),a)Qn("update() called with empty data.  Don't do anything."),m0(n,r,"ok",void 0);else{const g=Cy(n),y=lR(n.serverSyncTree_,e,h,g);Lm(n.eventQueue_,y),n.server_.merge(e.toString(),t,(_,N)=>{const T=_==="ok";T||_s("update at "+e+" failed: "+_);const k=Do(n.serverSyncTree_,g,!T),$=k.length>0?gc(n,e):e;hr(n.eventQueue_,$,k),m0(n,r,_,N)}),Gn(t,_=>{const N=Sy(n,rn(e,_));gc(n,N)}),hr(n.eventQueue_,e,[])}}function HR(n){Qd(n,"onDisconnectEvents");const e=Fm(n),t=lm();a0(n.onDisconnect_,xt(),(a,d)=>{const h=mC(a,d,n.serverSyncTree_,e);Gb(t,a,h)});let r=[];a0(t,xt(),(a,d)=>{r=r.concat(qd(n.serverSyncTree_,a,d));const h=Sy(n,a);gc(n,h)}),n.onDisconnect_=lm(),hr(n.eventQueue_,xt(),r)}function qR(n,e,t){let r;dt(e._path)===".info"?r=h0(n.infoSyncTree_,e,t):r=h0(n.serverSyncTree_,e,t),bC(n.eventQueue_,e._path,r)}function g1(n,e,t){let r;dt(e._path)===".info"?r=gm(n.infoSyncTree_,e,t):r=gm(n.serverSyncTree_,e,t),bC(n.eventQueue_,e._path,r)}function KR(n){n.persistentConnection_&&n.persistentConnection_.interrupt(MR)}function Qd(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Qn(t,...e)}function m0(n,e,t,r){e&&Ec(()=>{if(t==="ok")e(null);else{const a=(t||"error").toUpperCase();let d=a;r&&(d+=": "+r);const h=new Error(d);h.code=a,e(h)}})}function kC(n,e,t){return fy(n.serverSyncTree_,e,t)||Xe.EMPTY_NODE}function ky(n,e=n.transactionQueueTree_){if(e||Um(n,e),Tc(e)){const t=EC(n,e);_e(t.length>0,"Sending zero length transaction queue"),t.every(a=>a.status===0)&&QR(n,Kd(e),t)}else yC(e)&&Mm(e,t=>{ky(n,t)})}function QR(n,e,t){const r=t.map(_=>_.currentWriteId),a=kC(n,e,r);let d=a;const h=a.hash();for(let _=0;_<t.length;_++){const N=t[_];_e(N.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),N.status=1,N.retryCount++;const T=ws(e,N.path);d=d.updateChild(T,N.currentOutputSnapshotRaw)}const g=d.val(!0),y=e;n.server_.put(y.toString(),g,_=>{Qd(n,"transaction put response",{path:y.toString(),status:_});let N=[];if(_==="ok"){const T=[];for(let k=0;k<t.length;k++)t[k].status=2,N=N.concat(Do(n.serverSyncTree_,t[k].currentWriteId)),t[k].onComplete&&T.push(()=>t[k].onComplete(null,!0,t[k].currentOutputSnapshotResolved)),t[k].unwatcher();Um(n,_y(n.transactionQueueTree_,e)),ky(n,n.transactionQueueTree_),hr(n.eventQueue_,e,N);for(let k=0;k<T.length;k++)Ec(T[k])}else{if(_==="datastale")for(let T=0;T<t.length;T++)t[T].status===3?t[T].status=4:t[T].status=0;else{_s("transaction at "+y.toString()+" failed: "+_);for(let T=0;T<t.length;T++)t[T].status=4,t[T].abortReason=_}gc(n,e)}},h)}function gc(n,e){const t=SC(n,e),r=Kd(t),a=EC(n,t);return GR(n,a,r),r}function GR(n,e,t){if(e.length===0)return;const r=[];let a=[];const h=e.filter(g=>g.status===0).map(g=>g.currentWriteId);for(let g=0;g<e.length;g++){const y=e[g],_=ws(t,y.path);let N=!1,T;if(_e(_!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),y.status===4)N=!0,T=y.abortReason,a=a.concat(Do(n.serverSyncTree_,y.currentWriteId,!0));else if(y.status===0)if(y.retryCount>=DR)N=!0,T="maxretry",a=a.concat(Do(n.serverSyncTree_,y.currentWriteId,!0));else{const k=kC(n,y.path,h);y.currentInputSnapshot=k;const $=e[g].update(k.val());if($!==void 0){Dm("transaction failed: Data returned ",$,y.path);let M=kn($);typeof $=="object"&&$!=null&&ei($,".priority")||(M=M.updatePriority(k.getPriority()));const H=y.currentWriteId,ye=Fm(n),le=gC(M,k,ye);y.currentOutputSnapshotRaw=M,y.currentOutputSnapshotResolved=le,y.currentWriteId=Cy(n),h.splice(h.indexOf(H),1),a=a.concat(uC(n.serverSyncTree_,y.path,le,y.currentWriteId,y.applyLocally)),a=a.concat(Do(n.serverSyncTree_,H,!0))}else N=!0,T="nodata",a=a.concat(Do(n.serverSyncTree_,y.currentWriteId,!0))}hr(n.eventQueue_,t,a),a=[],N&&(e[g].status=2,(function(k){setTimeout(k,Math.floor(0))})(e[g].unwatcher),e[g].onComplete&&(T==="nodata"?r.push(()=>e[g].onComplete(null,!1,e[g].currentInputSnapshot)):r.push(()=>e[g].onComplete(new Error(T),!1,null))))}Um(n,n.transactionQueueTree_);for(let g=0;g<r.length;g++)Ec(r[g]);ky(n,n.transactionQueueTree_)}function SC(n,e){let t,r=n.transactionQueueTree_;for(t=dt(e);t!==null&&Tc(r)===void 0;)r=_y(r,t),e=Wt(e),t=dt(e);return r}function EC(n,e){const t=[];return NC(n,e,t),t.sort((r,a)=>r.order-a.order),t}function NC(n,e,t){const r=Tc(e);if(r)for(let a=0;a<r.length;a++)t.push(r[a]);Mm(e,a=>{NC(n,a,t)})}function Um(n,e){const t=Tc(e);if(t){let r=0;for(let a=0;a<t.length;a++)t[a].status!==2&&(t[r]=t[a],r++);t.length=r,vC(e,t.length>0?t:void 0)}Mm(e,r=>{Um(n,r)})}function Sy(n,e){const t=Kd(SC(n,e)),r=_y(n.transactionQueueTree_,e);return bR(r,a=>{Pv(n,a)}),Pv(n,r),wC(r,a=>{Pv(n,a)}),t}function Pv(n,e){const t=Tc(e);if(t){const r=[];let a=[],d=-1;for(let h=0;h<t.length;h++)t[h].status===3||(t[h].status===1?(_e(d===h-1,"All SENT items should be at beginning of queue."),d=h,t[h].status=3,t[h].abortReason="set"):(_e(t[h].status===0,"Unexpected transaction status in abort"),t[h].unwatcher(),a=a.concat(Do(n.serverSyncTree_,t[h].currentWriteId,!0)),t[h].onComplete&&r.push(t[h].onComplete.bind(null,new Error("set"),!1,null))));d===-1?vC(e,void 0):t.length=d+1,hr(n.eventQueue_,Kd(e),a);for(let h=0;h<r.length;h++)Ec(r[h])}}function YR(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let a=t[r];try{a=decodeURIComponent(a.replace(/\+/g," "))}catch{}e+="/"+a}return e}function XR(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):_s(`Invalid query segment '${t}' in query '${n}'`)}return e}const v1=function(n,e){const t=JR(n),r=t.namespace;t.domain==="firebase.com"&&Ui(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Ui("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||iP();const a=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Rb(t.host,t.secure,r,a,e,"",r!==t.subdomain),path:new Pt(t.pathString)}},JR=function(n){let e="",t="",r="",a="",d="",h=!0,g="https",y=443;if(typeof n=="string"){let _=n.indexOf("//");_>=0&&(g=n.substring(0,_-1),n=n.substring(_+2));let N=n.indexOf("/");N===-1&&(N=n.length);let T=n.indexOf("?");T===-1&&(T=n.length),e=n.substring(0,Math.min(N,T)),N<T&&(a=YR(n.substring(N,T)));const k=XR(n.substring(Math.min(n.length,T)));_=e.indexOf(":"),_>=0?(h=g==="https"||g==="wss",y=parseInt(e.substring(_+1),10)):_=e.length;const $=e.slice(0,_);if($.toLowerCase()==="localhost")t="localhost";else if($.split(".").length<=2)t=$;else{const M=e.indexOf(".");r=e.substring(0,M).toLowerCase(),t=e.substring(M+1),d=r}"ns"in k&&(d=k.ns)}return{host:e,port:y,domain:t,subdomain:r,secure:h,scheme:g,pathString:a,namespace:d}};class ZR{constructor(e,t,r,a){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=a}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Sn(this.snapshot.exportVal())}}class ej{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class TC{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return _e(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Ey{constructor(e,t,r,a){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=a}get key(){return pt(this._path)?null:Z0(this._path)}get ref(){return new Wi(this._repo,this._path)}get _queryIdentifier(){const e=n1(this._queryParams),t=G0(e);return t==="{}"?"default":t}get _queryObject(){return n1(this._queryParams)}isEqual(e){if(e=is(e),!(e instanceof Ey))return!1;const t=this._repo===e._repo,r=ey(this._path,e._path),a=this._queryIdentifier===e._queryIdentifier;return t&&r&&a}toJSON(){return this.toString()}toString(){return this._repo.toString()+BP(this._path)}}class Wi extends Ey{constructor(e,t){super(e,t,new ry,!1)}get parent(){const e=zb(this._path);return e===null?null:new Wi(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class $d{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Pt(e),r=g0(this.ref,e);return new $d(this._node.getChild(t),r,on)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,a)=>e(new $d(a,g0(this.ref,r),on)))}hasChild(e){const t=new Pt(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Dn(n,e){return n=is(n),n._checkNotDeleted("ref"),e!==void 0?g0(n._root,e):n._root}function g0(n,e){return n=is(n),dt(n._path)===null?AR("child","path",e):xC("child","path",e),new Wi(n._repo,rn(n._path,e))}function vc(n,e){n=is(n),RR("set",n._path),TR("set",e,n._path);const t=new Dd;return WR(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function Gd(n,e){PR("update",e,n._path);const t=new Dd;return VR(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function Ic(n){n=is(n);const e=new TC(()=>{}),t=new zm(e);return BR(n._repo,n,t).then(r=>new $d(r,new Wi(n._repo,n._path),n._queryParams.getIndex()))}class zm{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const r=t._queryParams.getIndex();return new ZR("value",this,new $d(e.snapshotNode,new Wi(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new ej(this,e,t):null}matches(e){return e instanceof zm?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function tj(n,e,t,r,a){let d;if(typeof r=="object"&&(d=void 0,a=r),typeof r=="function"&&(d=r),a&&a.onlyOnce){const y=t,_=(N,T)=>{g1(n._repo,n,g),y(N,T)};_.userCallback=t.userCallback,_.context=t.context,t=_}const h=new TC(t,d||void 0),g=new zm(h);return qR(n._repo,n,g),()=>g1(n._repo,n,g)}function IC(n,e,t,r){return tj(n,"value",e,t,r)}eR(Wi);iR(Wi);const nj="FIREBASE_DATABASE_EMULATOR_HOST",v0={};let sj=!1;function rj(n,e,t,r){const a=e.lastIndexOf(":"),d=e.substring(0,a),h=bc(d);n.repoInfo_=new Rb(e,h,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),r&&(n.authTokenProvider_=r)}function ij(n,e,t,r,a){let d=r||n.options.databaseURL;d===void 0&&(n.options.projectId||Ui("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Qn("Using default host for project ",n.options.projectId),d=`${n.options.projectId}-default-rtdb.firebaseio.com`);let h=v1(d,a),g=h.repoInfo,y;typeof process<"u"&&L_&&(y=L_[nj]),y?(d=`http://${y}?ns=${g.namespace}`,h=v1(d,a),g=h.repoInfo):h.repoInfo.secure;const _=new gP(n.name,n.options,e);jR("Invalid Firebase Database URL",h),pt(h.path)||Ui("Database URL must point to the root of a Firebase Database (not including a child path).");const N=aj(g,n,_,new mP(n,t));return new lj(N,n)}function oj(n,e){const t=v0[e];(!t||t[n.key]!==n)&&Ui(`Database ${e}(${n.repoInfo_}) has already been deleted.`),KR(n),delete t[n.key]}function aj(n,e,t,r){let a=v0[e.name];a||(a={},v0[e.name]=a);let d=a[n.toURLString()];return d&&Ui("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),d=new LR(n,sj,t,r),a[n.toURLString()]=d,d}class lj{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(FR(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Wi(this._repo,xt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(oj(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ui("Cannot call "+e+" on a deleted database.")}}function cj(n=Mx(),e){const t=D0(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const r=iN("database");r&&uj(t,...r)}return t}function uj(n,e,t,r={}){n=is(n),n._checkNotDeleted("useEmulator");const a=`${e}:${t}`,d=n._repoInternal;if(n._instanceStarted){if(a===n._repoInternal.repoInfo_.host&&Wa(r,d.repoInfo_.emulatorOptions))return;Ui("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let h;if(d.repoInfo_.nodeAdmin)r.mockUserToken&&Ui('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),h=new Up(Up.OWNER);else if(r.mockUserToken){const g=typeof r.mockUserToken=="string"?r.mockUserToken:oN(r.mockUserToken,n.app.options.projectId);h=new Up(g)}bc(e)&&(Ix(e),Px("Database",!0)),rj(d,a,r,h)}function dj(n){ZI(kc),uc(new Va("database",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("auth-internal"),d=e.getProvider("app-check-internal");return ij(r,a,d,t)},"PUBLIC").setMultipleInstances(!0)),zo(F_,U_,n),zo(F_,U_,"esm2020")}$i.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};$i.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};dj();const fj={apiKey:"AIzaSyApZcKZtqIkR1lMF4Ynavf0AJJb-rjNYBg",authDomain:"flowbuddy-vi7rt.firebaseapp.com",databaseURL:"https://flowbuddy-vi7rt-default-rtdb.firebaseio.com",projectId:"flowbuddy-vi7rt",storageBucket:"flowbuddy-vi7rt.firebasestorage.app",messagingSenderId:"885170360423",appId:"1:885170360423:web:e94217a42c9c6eaac184c2"},PC=Ox(fj),cd=GI(PC),Ln=cj(PC);function Zr(n=12){const e="abcdefghijklmnopqrstuvwxyz0123456789";let t="";return crypto.getRandomValues(new Uint8Array(n)).forEach(r=>{t+=e[r%e.length]}),t}const vm={brown:{light:"#f4e3c7",dark:"#b87b46"},blue:{light:"#e2ecf7",dark:"#5b6f8c"},green:{light:"#e5f2e0",dark:"#6a8b6a"}},AC="brown";function Oi(n){const e=n&&vm[n]?n:AC;return{key:e,colors:vm[e]}}const Rr={user:"pawnpoint_user",progress:"pawnpoint_progress",courses:"pawnpoint_courses",subscription:"pawnpoint_subscription",suggestions:"pawnpoint_suggestions",xpHistory:"pawnpoint_xp_history"},Fa="/pieces/wQ.png",ym="courses",RC="xpHistory",Ep=["/pieces/wB.png","/pieces/bQ.png","/pieces/wN.png","/pieces/bK.png"],y1=[{id:"course-london",title:"The London System",description:"Club-ready white repertoire that keeps pressure and teaches universal plans.",category:"white_opening",difficulty:"beginner",thumbnailUrl:Ep[0],accentColor:"#ec4899",lessons:[{id:"l1",title:"Why Play the London",summary:"Principles and key themes."},{id:"l2",title:"Typical Structures",summary:"Plans in classical pawn chains."},{id:"l3",title:"Model Game Review",summary:"Club-level example with blunders fixed."}]},{id:"course-dragon",title:"The Sicilian Dragon",description:"Dynamic counter-attacking weapon with clear tactical motifs.",category:"black_opening",difficulty:"intermediate",thumbnailUrl:Ep[1],accentColor:"#34d399",lessons:[{id:"l4",title:"Move Order Basics",summary:"How to reach the Dragon safely."},{id:"l5",title:"Yugoslav Plans",summary:"Attacking setups and typical breaks."},{id:"l6",title:"Dragon Tactics Pack",summary:"Tactical drills you must know."}]},{id:"course-skills",title:"Pawn Point Skills Lab",description:"Short drills to sharpen calculation, pattern spotting, and endgame instincts.",category:"skills",difficulty:"beginner",thumbnailUrl:Ep[2],accentColor:"#a855f7",lessons:[{id:"l7",title:"Tactics Warmup",summary:"Pins, forks, and mates-in-two."},{id:"l8",title:"Endgame Basics",summary:"King activity and pawn races."},{id:"l9",title:"Defense Builder",summary:"Finding resources under pressure."}]},{id:"course-endgame",title:"Endgame Essentials",description:"Build confidence in simplified positions with practical club scenarios.",category:"endgame",difficulty:"beginner",thumbnailUrl:Ep[3],accentColor:"#06b6d4",lessons:[{id:"l10",title:"Opposition and Shouldering",summary:"King activity fundamentals."},{id:"l11",title:"Rook Endgame Traps",summary:"Practical drawing tricks."},{id:"l12",title:"Converting Small Edges",summary:"Technique at +1."}]}];function zi(){const n=localStorage.getItem(Rr.user);if(!n)return null;try{const e=JSON.parse(n);return e.isAdmin===void 0&&(e.isAdmin=!1,er(e)),e.createdAt===void 0&&(e.createdAt=Date.now(),er(e)),e.pawns===void 0&&(e.pawns=0,er(e)),e.unlockedPfps=e.unlockedPfps||[],e.unlockedTaglines=e.unlockedTaglines||[],e.unlockedVideos=e.unlockedVideos||[],e.unlockedSets=e.unlockedSets||[],e.taglinesEnabled=e.taglinesEnabled??!0,e.selectedTagline=e.selectedTagline??"",e.boardTheme=Oi(e.boardTheme).key,er(e),e.xpReachedAt===void 0&&(e.xpReachedAt=e.createdAt??Date.now(),er(e)),e}catch{return null}}function er(n){localStorage.setItem(Rr.user,JSON.stringify(n))}function hj(){try{const n=localStorage.getItem(Rr.suggestions);if(!n)return null;const e=JSON.parse(n);return Array.isArray(e?.courseIds)?{courseIds:e.courseIds,source:e.source}:null}catch{return null}}function pj(n,e){localStorage.setItem(Rr.suggestions,JSON.stringify({courseIds:n.slice(0,5),source:e||"manual"}))}function Ny(n){if(!n)return Fa;const e=n.trim();return e&&(e.startsWith("/")||e.startsWith("data:"))?e:Fa}function y0(n){const e={...n};if("trainerNote"in e){const t=typeof e.trainerNote=="string"?e.trainerNote.trim():"";t?e.trainerNote=t:delete e.trainerNote}return Object.keys(e).forEach(t=>{e[t]===void 0&&delete e[t]}),e}function Ai(n){const e={};return Object.entries(n||{}).forEach(([t,r])=>{if(!r)return;const a={};Object.entries(r.chapters||{}).forEach(([d,h])=>{if(!h)return;const g={};Object.entries(h.subsections||{}).forEach(([y,_])=>{_&&(g[y]=y0(_))}),a[d]={...h,subsections:g}}),e[t]={...r,thumbnailUrl:Ny(r.thumbnailUrl),chapters:a}}),e}function Ri(n){return Array.isArray(n)?n.map(e=>Ri(e)):n&&typeof n=="object"?Object.entries(n).reduce((t,[r,a])=>(a===void 0||(t[r]=Ri(a)),t),{}):n}function zp(n){return n.reduce((e,t)=>(e[t.id]=t,e),{})}function mj(n){return Object.values(n||{})}function jC(){const n=localStorage.getItem(Rr.courses);if(!n)return{};try{const e=JSON.parse(n);return Array.isArray(e)?Ai(zp(e.filter(Boolean))):Ai(e||{})}catch{return{}}}function wm(n){try{const e=Ai(n),t=Ri(e);localStorage.setItem(Rr.courses,JSON.stringify(t))}catch{}}async function ti(){try{const n=await Ic(Dn(Ln,ym));if(n.exists()){const t=n.val(),r=Array.isArray(t)?zp(t.filter(Boolean)):t||{};return Ri(Ai(r))}const e=Ri(Ai(zp(y1)));return await vc(Dn(Ln,ym),e),wm(e),e}catch(n){const e=Ri(Ai(jC()));if(Object.keys(e).length)return e;console.warn("Failed to fetch courses from Firebase, using samples.",n);const t=Ri(Ai(zp(y1)));return wm(t),t}}async function Xo(n){const e=Ai(n),t=Ri(e);try{await vc(Dn(Ln,ym),t),wm(t)}catch(r){throw wm(t),console.error("Failed to write courses to Firebase; saved locally instead.",r),new Error("Cloud save failed. Check network/Firebase rules.")}}function gj(n,e){const t=Dn(Ln,`${ym}/${n}`),r=IC(t,a=>{const d=a.val(),h=d&&d.id?Ri(Ai({[d.id]:d})[d.id]):d?{...d,thumbnailUrl:Fa}:null;e(h||null)},()=>{const a=jC();e(a[n]||null)});return()=>r()}function $C(){const n=localStorage.getItem(Rr.progress);if(!n)return{};try{return JSON.parse(n)}catch{return{}}}function vj(n){localStorage.setItem(Rr.progress,JSON.stringify(n))}const yj=7;function wj(n){const e=new Date(n);return e.setHours(0,0,0,0),e.getTime()}function Bm(n,e=yj){const t=Date.now()-e*24*60*60*1e3;return(n||[]).filter(r=>(r?.ts||0)>=t&&typeof r.amount=="number")}function OC(n){try{const e=localStorage.getItem(`${Rr.xpHistory}:${n}`);if(!e)return[];const t=JSON.parse(e);return Bm(Array.isArray(t)?t:[])}catch{return[]}}function MC(n,e){try{localStorage.setItem(`${Rr.xpHistory}:${n}`,JSON.stringify(Bm(e)))}catch{}}async function DC(n,e){const t=e.ts||Date.now(),r={...e,ts:t,amount:Math.max(0,e.amount)},a=Zr();try{await vc(Dn(Ln,`${RC}/${n}/${a}`),r)}catch(g){console.warn("Failed to write XP event to Firebase; keeping local only",g)}const d=OC(n),h=Bm([...d,{...r,id:a}]);MC(n,h)}async function w0(n,e){const t=Date.now(),r=Math.floor(e/100)+1,a={totalXp:e,level:r,xpReachedAt:t},d=Dn(Ln,`users/${n}`);try{await Gd(d,a)}catch(g){console.warn("Failed to update XP in Firebase",g)}const h=zi();if(h&&h.id===n){const g={...h,...a};er(g)}return a}async function LC(n,e,t){const r=Math.max(0,e);if(!r)return;const a=Dn(Ln,`users/${n}`);try{const g=(((await Ic(a)).val()||{}).totalXp||0)+r;await w0(n,g)}catch(d){console.warn("Failed to update XP in Firebase, continuing locally",d);const h=zi(),g=h&&h.id===n&&h.totalXp||0;await w0(n,g+r)}try{await DC(n,{amount:r,courseId:t?.courseId,subsectionId:t?.subsectionId,type:t?.type,source:t?.source||"general"})}catch(d){console.warn("Failed to log XP event",d)}}async function _j(n){const e=zi();if(!e||e.id!==n)return null;const t=Math.floor((e.totalXp||0)/25);if(t<=0)return{pawnsAdded:0,remainingXp:e.totalXp};const r=t*25,a=Math.max(0,(e.totalXp||0)-r),d=(e.pawns||0)+t;await w0(n,a);const h=zi(),g=h&&h.id===n?{...h,pawns:d}:{...e,pawns:d};er(g);const y=Dn(Ln,`users/${n}`);try{await Gd(y,{pawns:d})}catch(_){console.warn("Failed to update pawns/XP in Firebase",_)}try{await DC(n,{amount:0,courseId:void 0,subsectionId:"xp_to_pawn_claim",source:"xp_to_pawns",type:void 0})}catch(_){console.warn("Failed to log XP-to-pawn claim",_)}return{pawnsAdded:t,remainingXp:a}}async function xj(n){const e=()=>OC(n);try{const t=await Ic(Dn(Ln,`${RC}/${n}`));if(t.exists()){const r=t.val(),a=Object.entries(r||{}).map(([h,g])=>({...g,id:h,ts:g&&g.ts||g&&g.timestamp||0,amount:(g&&g.amount)??0})),d=Bm(a);return MC(n,d),d}return e()}catch(t){return console.warn("Failed to fetch XP history, using local cache",t),e()}}function bj(n,e){const t=new Date;t.setHours(0,0,0,0);const r=t.getTime(),a=r-8640*60*1e3,d=Math.min(r,Math.max(a,e?.startFrom??a)),h=[];let g=d;for(;g<=r;){const N=new Date(g).toLocaleDateString("en-US",{weekday:"short"});h.push({key:g,label:N,total:0}),g+=1440*60*1e3}if(!h.length){const _=t.toLocaleDateString("en-US",{weekday:"short"});h.push({key:r,label:_,total:0})}const y=new Map(h.map((_,N)=>[_.key,N]));return(n||[]).forEach(_=>{if(!_?.ts)return;const N=wj(new Date(_.ts)),T=y.get(N);T!==void 0&&(h[T].total+=Math.max(0,_.amount))}),h.map(_=>({day:_.label,label:_.label,total:Math.round(_.total)}))}function Cj(n){const e={};(n||[]).forEach(r=>{if(!r?.amount)return;const a=r.type,d=(r.source||"").toLowerCase();let h="Other";a==="quiz"||d.includes("quiz")?h="Quizzes":a==="video"||d.includes("video")?h="Videos":d.includes("game")||d.includes("practice")||d.includes("match")?h="Games":(d.includes("course")||a==="study")&&(h="Courses"),e[h]=(e[h]||0)+r.amount});const t={Quizzes:"#60a5fa",Videos:"#a855f7",Games:"#f59e0b",Courses:"#22d3ee",Other:"#94a3b8"};return Object.entries(e).map(([r,a])=>({label:r,value:Math.round(a),color:t[r]||"#94a3b8"}))}async function Wm(n){try{const e=await Ic(Dn(Ln,`progress/${n}`));return e.exists()?e.val():{}}catch{const e=$C(),t={};return Object.entries(e).forEach(([r,a])=>{const[d]=r.split(":").slice(-1);t[d]={completedSubsections:a.completedLessonIds.reduce((h,g)=>({...h,[g]:!0}),{}),percent:a.progressPercent}}),t}}async function FC(n,e){try{await vc(Dn(Ln,`progress/${n}`),e)}catch(t){console.error("Failed to write progress to Firebase",t)}}function Ty(n){return n?.chapters?Object.values(n.chapters).reduce((e,t)=>e+Object.keys(t.subsections||{}).length,0):0}function kj(n){return n==="video"?100:n==="study"?150:200}async function Np(n,e,t){const r=zi(),a=r&&r.email===n?{...r,isAdmin:r.isAdmin??!1,chessUsername:r.chessUsername||r.displayName||r.email.split("@")[0],createdAt:r.createdAt??Date.now(),xpReachedAt:r.xpReachedAt??r.createdAt??Date.now(),unlockedPfps:r.unlockedPfps||[],unlockedTaglines:r.unlockedTaglines||[],unlockedVideos:r.unlockedVideos||[],unlockedSets:r.unlockedSets||[],selectedTagline:r.selectedTagline??"",taglinesEnabled:r.taglinesEnabled??!0,boardTheme:Oi(r.boardTheme).key}:{id:t||Zr(),email:n,displayName:e||n.split("@")[0],chessUsername:e||n.split("@")[0],avatarUrl:void 0,subscriptionPlan:"free",subscriptionActive:!1,totalXp:120,level:2,streak:1,pawns:0,isAdmin:!1,createdAt:Date.now(),xpReachedAt:Date.now(),unlockedPfps:[],unlockedTaglines:[],unlockedVideos:[],unlockedSets:[],selectedTagline:"",taglinesEnabled:!0,boardTheme:AC},d=Dn(Ln,`users/${a.id}`);try{const g=(await Ic(d)).val(),y={...a,...g||{},email:a.email,displayName:a.displayName||g?.displayName||a.email.split("@")[0],chessUsername:a.chessUsername||g?.chessUsername||a.displayName||a.email.split("@")[0],createdAt:g?.createdAt??a.createdAt,xpReachedAt:g?.xpReachedAt??a.xpReachedAt??a.createdAt??Date.now(),pawns:g?.pawns??a.pawns??0,totalXp:g?.totalXp??a.totalXp,level:g?.level??a.level,subscriptionActive:g?.subscriptionActive??a.subscriptionActive,subscriptionPlan:g?.subscriptionPlan??a.subscriptionPlan,unlockedPfps:g?.unlockedPfps||a.unlockedPfps||[],unlockedTaglines:g?.unlockedTaglines||a.unlockedTaglines||[],unlockedVideos:g?.unlockedVideos||a.unlockedVideos||[],unlockedSets:g?.unlockedSets||a.unlockedSets||[],selectedTagline:g?.selectedTagline??a.selectedTagline??"",taglinesEnabled:g?.taglinesEnabled??a.taglinesEnabled??!0,boardTheme:Oi(g?.boardTheme||a.boardTheme).key};return er(y),await Gd(d,y),y}catch(h){return console.warn("Failed to sync profile with Firebase, using local only",h),er(a),a}}async function w1(n){const e=zi();if(!e)return null;const t={...e,isAdmin:n};return er(t),t}async function Sj(n){const e=zi();if(!e)return null;const t={...e,chessUsername:n,displayName:e.displayName||n};return er(t),t}async function Ej(n){const e=zi();if(!e)return null;const t=Oi(n).key,r={...e,boardTheme:t};er(r);try{await Gd(Dn(Ln,`users/${e.id}`),{boardTheme:t})}catch(a){console.warn("Failed to sync board theme",a)}return r}async function Nj(){localStorage.removeItem(Rr.user)}async function _m(n,e){const t=await ti();let r=mj(t);if(e&&e!=="all"&&(r=r.filter(a=>a.category===e)),n){const a=n.toLowerCase();r=r.filter(d=>d.title.toLowerCase().includes(a))}return r}async function Yd(n){return(await ti())[n]||null}async function Tj(n){const e=await ti(),t={...n,id:n.id||Zr(),lessons:n.lessons.map(a=>({...a,id:a.id||Zr()}))},r={...t,thumbnailUrl:Ny(t.thumbnailUrl)};return e[r.id]=r,await Xo(e),r}async function Ij(n){const e=await ti(),t={...n,thumbnailUrl:Ny(n.thumbnailUrl)};return e[t.id]=t,await Xo(e),e[n.id]}async function Pj(n){const e=await ti();delete e[n],await Xo(e)}async function Aj(n,e,t){const r=await ti(),a=r[n];if(!a)return null;const d=Zr(),h={id:d,title:e,index:t,subsections:{}},g=a.chapters||{};return g[d]=h,r[n]={...a,chapters:g},await Xo(r),h}async function Rj(n,e){const t=await ti(),r=t[n];r?.chapters&&(delete r.chapters[e],t[n]={...r},await Xo(t))}async function jj(n,e,t){const r=await ti(),a=r[n];if(!a?.chapters?.[e])return null;const d={...a.chapters[e],...t};return a.chapters[e]=d,r[n]={...a},await Xo(r),d}async function $j(n,e,t){const r=await ti(),a=r[n];if(!a)return null;const d=a.chapters||{},h=d[e];if(!h)return null;const g=h.subsections||{},y=Object.fromEntries(Object.entries(g).map(([N,T])=>[N,y0(T)])),_=t.id||Zr();return y[_]=y0({...t,id:_}),d[e]={...h,subsections:y},r[n]={...a,chapters:d},await Xo(r),y[_]}async function Oj(n,e,t){const r=await ti(),a=r[n];a?.chapters?.[e]?.subsections&&(delete a.chapters[e].subsections[t],r[n]={...a},await Xo(r))}async function Mj(n){const e=await Wm(n),t={};return await Promise.all(Object.entries(e).map(async([r,a])=>{const d=await Yd(r),h=Ty(d)||1,g=Object.keys(a.completedSubsections||{});t[r]={courseId:r,completedLessonIds:g,progressPercent:a.percent??Math.round(g.length/h*100),lastLessonId:g[g.length-1]}})),t}async function UC(n,e){const r=(await Wm(n))[e],a=await Yd(e),d=Ty(a)||1;if(!r)return null;const h=Object.keys(r.completedSubsections||{});return{courseId:e,completedLessonIds:h,progressPercent:r.percent??Math.round(h.length/d*100),lastLessonId:h[h.length-1]}}async function Dj(n,e){const t=await Wm(n);t[e]&&(delete t[e],await FC(n,t));const r=$C();r[e]&&(delete r[e],vj(r))}function Lj(n){return{...n,unlockedPfps:n.unlockedPfps||[],unlockedTaglines:n.unlockedTaglines||[],unlockedVideos:n.unlockedVideos||[],unlockedSets:n.unlockedSets||[],selectedTagline:n.selectedTagline??"",taglinesEnabled:n.taglinesEnabled??!0}}async function Fj(n,e){const t=zi();if(!t||t.id!==n)return null;const r=Lj(t);e.type==="pfp"?r.unlockedPfps.includes(e.value)||r.unlockedPfps.push(e.value):e.type==="tagline"?e.value&&!r.unlockedTaglines.includes(e.value)&&r.unlockedTaglines.push(e.value):e.type==="video"?e.value&&!r.unlockedVideos.includes(e.value)&&r.unlockedVideos.push(e.value):e.type==="piece"&&e.value&&!r.unlockedSets.includes(e.value)&&r.unlockedSets.push(e.value),er(r);try{await Gd(Dn(Ln,`users/${n}`),{unlockedPfps:r.unlockedPfps,unlockedTaglines:r.unlockedTaglines,unlockedVideos:r.unlockedVideos,unlockedSets:r.unlockedSets})}catch(a){console.warn("Failed to sync unlocked gifts",a)}return r}async function Uj(n,e,t){return _0(n,e,t,"study")}async function zC(n){const e=await xj(n.id),t=bj(e,{startFrom:n.createdAt}),r=Cj(e),a=await _m(),d=hj();let h=a.slice(0,3);if(d?.courseIds?.length){const g=d.courseIds.map(y=>a.find(_=>_.id===y)).filter(Boolean);g.length&&(h=g.slice(0,3))}return{profile:n,xpHistory:t,xpDistribution:r,suggested:h}}function zj(n,e){pj(n,e)}async function _0(n,e,t,r){const a=await Wm(n),d=await Yd(e),h=Ty(d)||1,g=a[e]||{completedSubsections:{},percent:0},y=!!g.completedSubsections[t];g.completedSubsections[t]=!0;const _=Object.keys(g.completedSubsections).length;if(g.percent=Math.min(100,Math.round(_/h*100)),g.lastUpdated=Date.now(),a[e]=g,await FC(n,a),!y){const N=kj(r);await LC(n,N,{source:"course_progress",courseId:e,subsectionId:t,type:r})}return{courseId:e,completedLessonIds:Object.keys(g.completedSubsections),progressPercent:g.percent,lastLessonId:t}}const BC=D.createContext(void 0),Bj={user:null,loading:!1,login:async()=>{},loginWithGoogle:async()=>{},logout:async()=>{},setUser:()=>{}};function Wj({children:n}){const[e,t]=D.useState(null),[r,a]=D.useState(!0),d=new Ni,h=new Date().toDateString(),g=T=>{if(!T||localStorage.getItem("pawnpoint_last_login_day")===h)return T;const $={...T,streak:(T.streak||0)+1};return localStorage.setItem("pawnpoint_last_login_day",h),localStorage.setItem("pawnpoint_user",JSON.stringify($)),$};D.useEffect(()=>{const T=DT(cd,async k=>{if(k?.email){const $=await Np(k.email,k.displayName||k.email.split("@")[0],k.uid),M=g($);t(M)}else t(null);a(!1)});return()=>T()},[h]);const y=async(T,k,$,M="login")=>{if(a(!0),M==="signup"){const F=await AT(cd,T,k);$&&await $T(F.user,{displayName:$});const H=await Np(F.user.email||T,$||F.user.displayName||T.split("@")[0],F.user.uid),ye=g(H);t(ye)}else{const F=await RT(cd,T,k),H=await Np(F.user.email||T,F.user.displayName||$||T.split("@")[0],F.user.uid),ye=g(H);t(ye)}a(!1)},_=async()=>{a(!0);try{const T=await rI(cd,d),k=T.user.email||"",$=await Np(k,T.user.displayName||k.split("@")[0],T.user.uid),M=g($);t(M)}finally{a(!1)}},N=async()=>{await LT(cd),await Nj(),t(null)};return p.jsx(BC.Provider,{value:{user:e,loading:r,login:y,loginWithGoogle:_,logout:N,setUser:t},children:n})}function pr(){const n=D.useContext(BC);return n||(console.error("useAuth must be used inside AuthProvider. Falling back to a safe default context."),Bj)}const WC="/assets/Login%20screen-3VPFw6PG.png";function _1({mode:n}){const{user:e,login:t,loginWithGoogle:r}=pr(),[,a]=Ko(),[d,h]=D.useState(""),[g,y]=D.useState(""),[_,N]=D.useState(""),T=n==="login";D.useEffect(()=>{e&&a("/dashboard")},[e,a]);const k=async()=>{if(!(!d||!T&&!g||!_))try{await t(d,_,g||d.split("@")[0],T?"login":"signup"),a("/dashboard")}catch(M){console.error("Auth error",M)}},$=async()=>{try{await r(),a("/dashboard")}catch(M){console.error("Google auth error",M)}};return p.jsxs("div",{className:"min-h-screen relative bg-slate-950 text-white flex items-center justify-center px-4",children:[p.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-40",style:{backgroundImage:`url(${WC})`}}),p.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-slate-900/40 via-slate-950/50 to-black/60"}),p.jsxs("div",{className:"relative z-10 w-full max-w-lg rounded-3xl p-8 shadow-2xl border border-white/10 bg-white/5 backdrop-blur-xl",children:[p.jsxs("div",{className:"text-center mb-6 space-y-2",children:[p.jsxs("div",{className:"pill glass inline-flex items-center gap-2 border-white/10",children:[p.jsx("div",{className:"h-2 w-2 rounded-full bg-brand.pink"}),p.jsx("span",{children:"Pawn Point"})]}),p.jsx("h1",{className:"text-3xl font-semibold",children:T?"Log In":"Create Account"}),p.jsx("p",{className:"text-white/70 text-sm",children:"Train, track XP, and climb the club leaderboard."})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs(it,{variant:"outline",className:"w-full justify-center",onClick:$,children:[p.jsx(bE,{className:"h-4 w-4 mr-2"}),"Continue with Google"]}),p.jsxs("div",{className:"flex items-center gap-3 text-xs text-white/60",children:[p.jsx("span",{className:"h-px flex-1 bg-white/10"}),"or",p.jsx("span",{className:"h-px flex-1 bg-white/10"})]}),!T&&p.jsxs("div",{children:[p.jsx("label",{className:"text-sm text-white/80",children:"Display name"}),p.jsx("div",{className:"mt-1 relative",children:p.jsx("input",{className:"w-full rounded-xl bg-white/10 border border-white/10 px-3 py-3 focus:outline-none focus:ring-2 focus:ring-brand.pink",placeholder:"Chess Shark",value:g,onChange:M=>y(M.target.value)})})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-sm text-white/80",children:"Email"}),p.jsxs("div",{className:"mt-1 relative",children:[p.jsx(px,{className:"absolute left-3 top-3 h-4 w-4 text-white/50"}),p.jsx("input",{type:"email",className:"w-full rounded-xl bg-white/10 border border-white/10 px-10 py-3 focus:outline-none focus:ring-2 focus:ring-brand.pink",placeholder:"you@example.com",value:d,onChange:M=>h(M.target.value)})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-sm text-white/80",children:"Password"}),p.jsxs("div",{className:"mt-1 relative",children:[p.jsx(hx,{className:"absolute left-3 top-3 h-4 w-4 text-white/50"}),p.jsx("input",{type:"password",className:"w-full rounded-xl bg-white/10 border border-white/10 px-10 py-3 focus:outline-none focus:ring-2 focus:ring-brand.pink",placeholder:"",value:_,onChange:M=>N(M.target.value)})]})]}),p.jsx(it,{className:"w-full justify-center",onClick:k,children:T?"Log In":"Create Account"}),p.jsxs("div",{className:"text-sm text-white/70 text-center",children:[T?"New to Pawn Point?":"Already have an account?"," ",p.jsx("button",{className:"text-brand.pink underline",onClick:()=>a(T?"/signup":"/login"),children:T?"Create account":"Log in"})]})]})]})]})}function Mi({children:n,className:e}){return p.jsx("div",{className:_c("glass rounded-2xl",e),children:n})}function ac({children:n,className:e}){return p.jsx("div",{className:_c("px-5 py-4 border-b border-white/10",e),children:n})}function Di({children:n,className:e}){return p.jsx("div",{className:_c("px-5 py-4 space-y-3",e),children:n})}function lc({children:n,className:e}){return p.jsx("div",{className:_c("text-lg font-semibold",e),children:n})}function Iy({value:n,className:e}){return p.jsx("div",{className:_c("w-full h-2 rounded-full bg-white/10 overflow-hidden",e),children:p.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-brand.pink to-brand.purple transition-all",style:{width:`${Math.min(Math.max(n,0),100)}%`}})})}const x1=[{label:"Home",href:"/dashboard",icon:NE},{label:"All Courses",href:"/courses",icon:wE},{label:"Leaderboards",href:"/leaderboard",icon:wx},{label:"Practice",href:"/practice",icon:VE}];function Ar({children:n}){const{user:e,logout:t,setUser:r}=pr(),[,a]=Ko(),[d,h]=D.useState(!1),[g,y]=D.useState(!1),[_,N]=D.useState(!1),[T,k]=D.useState(!1),[$,M]=D.useState("Meh"),[F,H]=D.useState(""),[ye,le]=D.useState(""),C=e?.chessUsername||e?.displayName||e?.email?.split("@")[0]||"Player",ie=C?.split(" ").map(ee=>ee[0]).join("").slice(0,2).toUpperCase()||"PP",c=e?.level??1,ze=e?.totalXp??0,de=[{label:"Angry",emoji:""},{label:"Dislike",emoji:""},{label:"Meh",emoji:""},{label:"Happy",emoji:""},{label:"Excited",emoji:""}],Ie=_?"bg-slate-50 text-slate-900":"bg-slate-950 text-white",Je=_?"border-slate-200 bg-white/90":"border-white/10 bg-slate-950/80",Qe=_?"text-slate-700":"text-white/80",Ve=$==="Meh",$e=F.trim().length>0,be=()=>{k(!1),M("Meh"),H(""),le("")},te=async()=>{if(!$e)return;const ee=F.trim(),Y=ee==="TSEC0ADMIN",we=ee==="TSEC0STANDARD";if(!Ve&&(Y||we)){le("Admin keys only work when MEH is selected.");return}if(Ve&&(Y||we)){if(Y){const ne=await w1(!0);ne?(r(ne),le("Admin privileges unlocked. Editing tools are now visible.")):le("Key rejected. No status change applied.")}else if(we){const ne=await w1(!1);ne?(r(ne),le("Admin privileges removed. You are back to standard access.")):le("Key rejected. No status change applied.")}H("");return}F.trim()&&be()};return p.jsxs("div",{className:`min-h-screen ${Ie}`,children:[p.jsxs("header",{className:`sticky top-0 z-20 border-b ${Je} backdrop-blur`,children:[p.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-4 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"h-10 w-10 rounded-xl bg-white flex items-center justify-center shadow-[0_12px_30px_rgba(0,0,0,0.25)] overflow-hidden",children:p.jsx("img",{src:Kv,alt:"Pawn Point logo",className:"h-full w-full object-cover"})}),p.jsx("span",{className:"text-2xl font-extrabold tracking-tight",children:"Pawn Point"})]}),p.jsx("nav",{className:`hidden md:flex items-center gap-6 text-sm ${Qe}`,children:x1.map(({href:ee,label:Y,icon:we})=>p.jsxs(a_,{href:ee,className:`flex items-center gap-2 hover:text-white ${_?"hover:text-slate-900":""}`,children:[p.jsx(we,{className:"h-4 w-4"}),Y]},ee))}),p.jsxs("div",{className:"hidden md:flex items-center gap-3 relative",children:[p.jsxs("button",{onClick:()=>y(ee=>!ee),className:`relative flex items-center gap-3 rounded-full border px-3 py-2 hover:bg-white/10 transition ${_?"border-slate-200 bg-white text-slate-900":"border-white/10 bg-white/5 text-white"}`,"aria-haspopup":"menu","aria-expanded":g,children:[e?.avatarUrl?p.jsx("div",{className:"h-9 w-9 rounded-full overflow-hidden border border-white/20 shadow-glow",children:p.jsx("img",{src:e.avatarUrl,alt:"Profile avatar",className:"h-full w-full object-cover"})}):p.jsx("div",{className:"h-9 w-9 rounded-full bg-gradient-to-br from-pink-500 to-purple-500 flex items-center justify-center text-sm font-bold text-white shadow-glow",children:ie}),p.jsxs("div",{className:"text-left",children:[p.jsxs("div",{className:"text-xs text-white/60",children:["Level ",c]}),p.jsxs("div",{className:"text-sm font-semibold text-white/90",children:[ze," XP"]})]})]}),g&&p.jsxs("div",{className:"absolute right-0 top-14 w-56 rounded-2xl bg-slate-800 shadow-2xl border border-white/10 py-3",children:[p.jsx("div",{className:"px-4 pb-3",children:p.jsxs("div",{className:"flex items-center gap-3",children:[e?.avatarUrl?p.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden border border-white/20 shadow-glow",children:p.jsx("img",{src:e.avatarUrl,alt:"Profile avatar",className:"h-full w-full object-cover"})}):p.jsx("div",{className:"h-8 w-8 rounded-full bg-slate-700 flex items-center justify-center text-xs font-bold text-white",children:ie}),p.jsxs("div",{children:[p.jsx("div",{className:"text-sm font-semibold text-white",children:C}),p.jsxs("div",{className:"text-xs text-emerald-300 font-semibold",children:["LVL ",c," | ",ze," XP"]})]})]})}),p.jsxs("div",{className:"px-2 space-y-1 text-sm text-white/80",children:[p.jsxs("button",{className:"w-full flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-white/10 text-left",onClick:()=>{a("/profile"),y(!1)},children:[p.jsx(_x,{className:"h-4 w-4"}),"My Profile"]}),p.jsxs("button",{className:"w-full flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-white/10 text-left",onClick:()=>{a("/settings"),y(!1)},children:[p.jsx(FE,{className:"h-4 w-4"}),"Settings"]}),p.jsxs("button",{className:"w-full flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-white/10 text-left",onClick:()=>{k(!0),M("Meh"),H(""),le("")},children:[p.jsx($E,{className:"h-4 w-4"}),"Feedback"]}),p.jsxs("button",{className:"w-full flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-white/10 text-left",onClick:()=>{t(),a("/login")},children:[p.jsx(qv,{className:"h-4 w-4"}),"Sign out"]})]}),p.jsxs("div",{className:"flex items-center justify-between px-4 pt-3 text-xs text-white/60",children:[p.jsx("span",{children:"Theme"}),p.jsx("button",{className:"flex items-center gap-2 rounded-full bg-white/10 px-2 py-1 text-white hover:bg-white/20 transition",onClick:()=>N(ee=>!ee),children:_?p.jsx(yx,{className:"h-4 w-4 text-amber-300"}):p.jsx(mx,{className:"h-4 w-4 text-amber-300"})})]})]})]}),p.jsx("button",{className:"md:hidden text-white/80",onClick:()=>h(ee=>!ee),"aria-label":"Toggle navigation",children:d?p.jsx(La,{}):p.jsx(jE,{})})]}),d&&p.jsx("div",{className:"md:hidden border-t border-white/10 bg-slate-900/90",children:p.jsxs("div",{className:"px-4 py-3 space-y-3",children:[x1.map(({href:ee,label:Y,icon:we})=>p.jsxs(a_,{href:ee,className:"flex items-center gap-2 text-sm text-white/80 hover:text-white",onClick:()=>h(!1),children:[p.jsx(we,{className:"h-4 w-4"}),Y]},ee)),p.jsxs(it,{variant:"ghost",onClick:()=>{t(),a("/login")},className:"w-full",children:[p.jsx(qv,{className:"h-4 w-4 mr-2"}),"Log out"]})]})})]}),p.jsx("main",{className:"max-w-6xl mx-auto px-4 py-8",children:n}),T&&p.jsx("div",{className:"fixed inset-0 z-30 flex items-center justify-center bg-black/60 px-4",children:p.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-slate-800 text-white shadow-2xl border border-white/10 p-6",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h2",{className:"text-xl font-semibold",children:"Feedback"}),p.jsx("button",{onClick:be,className:"p-1 rounded-full hover:bg-white/10 text-white/70",children:p.jsx(CE,{className:"h-5 w-5"})})]}),p.jsx("div",{className:"mt-4 text-sm text-white/80",children:"How do you feel about Pawn Point?"}),p.jsx("div",{className:"mt-3 grid grid-cols-5 gap-2",children:de.map(({label:ee,emoji:Y})=>{const we=$===ee;return p.jsxs("button",{onClick:()=>{M(ee),le("")},className:`flex flex-col items-center gap-1 rounded-xl border px-3 py-2 text-xs ${we?"border-blue-400 bg-blue-500/20 text-white":"border-white/10 bg-white/5 text-white/80 hover:bg-white/10"}`,children:[p.jsx("span",{className:"text-lg",children:Y}),p.jsx("span",{children:ee})]},ee)})}),p.jsx("div",{className:"mt-4 text-sm text-white/80",children:"Tell us why"}),p.jsxs("div",{className:"mt-2",children:[p.jsx("textarea",{value:F,onChange:ee=>H(ee.target.value.slice(0,500)),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm text-white outline-none focus:ring-2 focus:ring-pink-400",rows:4,placeholder:"Share your thoughts..."}),p.jsxs("div",{className:"text-right text-xs text-white/60",children:[F.length,"/500"]})]}),p.jsx(it,{className:`w-full mt-4 justify-center ${$e?"":"bg-white/10 text-white/50 shadow-none pointer-events-none"}`,onClick:te,children:"Submit Feedback"}),ye&&p.jsx("div",{className:"mt-3 text-sm text-emerald-200 bg-emerald-500/10 border border-emerald-300/30 rounded-xl px-3 py-2",children:ye})]})})]})}const xm="/assets/The%20South%20Knight-BIvptcHK.png";function Vj(){const{user:n}=pr(),[,e]=Ko();D.useEffect(()=>{n||e("/login")},[n,e]);const{data:t}=Cd({queryKey:["dashboard",n?.id],enabled:!!n,queryFn:()=>zC(n)});return n?p.jsx(Ar,{children:p.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[p.jsxs(Mi,{className:"lg:col-span-1",children:[p.jsxs(ac,{children:[p.jsxs(lc,{children:["Hi, ",n.chessUsername||n.displayName]}),p.jsxs("div",{className:"flex items-center gap-2 text-sm text-white/70",children:[p.jsxs("div",{className:"px-3 py-1 rounded-full bg-emerald-500/20 text-emerald-200 border border-emerald-400/30",children:["Level ",n.level]}),p.jsx("div",{className:"px-3 py-1 rounded-full bg-brand.pink/20 text-white border border-white/20",children:n.subscriptionActive?n.subscriptionPlan:"Free"})]})]}),p.jsx(Di,{className:"flex flex-col",children:p.jsxs("div",{className:"space-y-2",children:[p.jsxs("div",{className:"flex items-center justify-between text-sm text-white/70",children:[p.jsx("span",{children:"Total XP"}),p.jsx("span",{className:"text-white font-semibold",children:n.totalXp})]}),p.jsx(Iy,{value:n.totalXp%100}),p.jsxs("div",{className:"text-xs text-white/60",children:[100-n.totalXp%100," XP to next level"]})]})})]}),p.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[p.jsxs(Mi,{children:[p.jsxs(ac,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[p.jsx(lc,{children:"Suggested Courses"}),p.jsx(it,{variant:"outline",onClick:()=>e("/courses"),children:"Browse all"})]}),p.jsxs(Di,{className:"grid md:grid-cols-3 gap-4",children:[(t?.suggested||[]).map(r=>p.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 overflow-hidden",children:[p.jsx("img",{src:r.thumbnailUrl,alt:r.title,className:"h-28 w-full object-cover"}),p.jsxs("div",{className:"p-4 space-y-2",children:[p.jsx("div",{className:"text-sm text-brand.pink uppercase tracking-wide",children:"Suggested"}),p.jsx("div",{className:"font-semibold",children:r.title}),p.jsx("p",{className:"text-sm text-white/70 line-clamp-3",children:r.description}),p.jsx(it,{className:"w-full",onClick:()=>e(`/lesson/${r.id}`),children:"Continue"})]})]},r.id)),!t&&p.jsx("div",{className:"text-white/70 text-sm",children:"Loading dashboard..."})]})]}),p.jsxs(Mi,{children:[p.jsxs(ac,{className:"flex flex-col gap-2",children:[p.jsxs(lc,{className:"flex items-center gap-2",children:[p.jsx(gx,{className:"h-5 w-5 text-emerald-300"}),"AI Practice"]}),p.jsx("p",{className:"text-white/75 text-sm",children:"Sharpen openings, tactics, and endgames with adaptive difficulty and live XP tracking."})]}),p.jsxs(Di,{className:"grid md:grid-cols-[1fr_auto] gap-4 items-center",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:"h-20 w-20 rounded-full overflow-hidden border border-white/10 shadow-lg",children:p.jsx("img",{src:xm,alt:"The South Knight",className:"h-full w-full object-cover"})}),p.jsxs("div",{className:"space-y-1",children:[p.jsx("div",{className:"text-sm text-white/70",children:"Train with the South Knight"}),p.jsx("div",{className:"text-base font-semibold text-white",children:"Custom sparring sessions, instant XP."})]})]}),p.jsx("div",{className:"flex flex-col gap-3 w-full md:w-auto",children:p.jsx(it,{size:"lg",onClick:()=>e("/practice"),children:"Play Training Bot"})})]})]})]})]})}):null}const Av=[{key:"all",label:"All"},{key:"white_opening",label:"White Openings"},{key:"black_opening",label:"Black Openings"},{key:"beginner",label:"Beginners"},{key:"middlegame",label:"Middlegame"},{key:"endgame",label:"Endgame"},{key:"skills",label:"Skills"}],Rv=()=>({title:"",description:"",category:"beginner",difficulty:"beginner",thumbnailUrl:Fa,accentColor:"#ec4899",lessons:[{id:Zr(),title:"Lesson 1",summary:"Add content inside the course."},{id:Zr(),title:"Lesson 2",summary:"Add content inside the course."}]});function Hj(){const[,n]=Ko(),e=km(),{user:t}=pr(),r=!!t?.isAdmin,[a,d]=D.useState(""),[h,g]=D.useState("all"),[y,_]=D.useState(!1),[N,T]=D.useState(null),[k,$]=D.useState(Rv()),[M,F]=D.useState(!1),[H,ye]=D.useState(!1),[le,C]=D.useState(""),ie=5e6,{data:c=[]}=Cd({queryKey:["courses",a,h],queryFn:()=>_m(a,h)}),ze=()=>{e.invalidateQueries({queryKey:["courses"]}),e.invalidateQueries({queryKey:["course"]}),e.invalidateQueries({queryKey:["dashboard"]})},de=Op({mutationFn:Tj,onSuccess:()=>{C(""),ze(),Qe()},onError:Y=>{const we=Y instanceof Error?Y.message:"Could not save the course. Try again or clear some data and retry.";C(we)}}),Ie=Op({mutationFn:Ij,onSuccess:()=>{C(""),ze(),Qe()},onError:Y=>{const we=Y instanceof Error?Y.message:"Could not save the course. Try again or clear some data and retry.";C(we)}}),Je=Op({mutationFn:Pj,onSuccess:(Y,we)=>{ze(),N&&N.id===we&&Qe()}}),Qe=()=>{_(!1),T(null),$(Rv()),C(""),F(!1),ye(!1)},Ve=Y=>{T(null),$(Rv()),_(!0),C(""),F(!1),ye(!1)},$e=()=>{if(!r)return;if(C(""),F(!1),ye(!1),k.thumbnailUrl.startsWith("data:image/")&&k.thumbnailUrl.length>ie){C("Thumbnail too large. Try a smaller PNG or a hosted link under ~5MB.");return}const Y=(k.lessons||[]).length>0?k.lessons:[{id:Zr(),title:"Lesson 1",summary:"Add content inside the course."}],we={id:N?.id||k.id||Zr(),title:k.title.trim()||"Untitled Course",description:k.description.trim()||"No description yet.",category:k.category,difficulty:k.difficulty,thumbnailUrl:k.thumbnailUrl.trim()||Fa,accentColor:k.accentColor||"#ec4899",lessons:Y};N?Ie.mutate(we):de.mutate(we)},be=Y=>{!r||!window.confirm(`Delete "${Y.title}"? This cannot be undone.`)||Je.mutate(Y.id)},te=de.isPending||Ie.isPending,ee=Je.isPending;return p.jsx(Ar,{children:p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[p.jsxs("div",{children:[p.jsx("h1",{className:"text-2xl font-semibold",children:"All Courses"}),p.jsx("p",{className:"text-white/70 text-sm",children:"Search, filter, and pick up where you left off."})]}),p.jsxs("div",{className:"flex items-center gap-2 text-white/70 text-sm",children:[p.jsx(EE,{className:"h-4 w-4"}),"Club catalog"]})]}),r&&p.jsxs("div",{className:"rounded-xl border border-emerald-400/30 bg-emerald-500/10 px-4 py-3 flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-sm font-semibold text-emerald-100",children:"Admin mode active"}),p.jsx("div",{className:"text-xs text-emerald-50/80",children:"Add, edit, delete courses, and update thumbnails directly from the catalog."})]}),p.jsx("div",{className:"flex items-center gap-2",children:p.jsxs(it,{variant:"outline",onClick:()=>Ve(),children:[p.jsx(vx,{className:"h-4 w-4 mr-2"}),"Add course"]})})]}),p.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 lg:items-center",children:[p.jsxs("div",{className:"relative flex-1",children:[p.jsx(LE,{className:"absolute left-3 top-3 h-4 w-4 text-white/50"}),p.jsx("input",{placeholder:"Search courses",value:a,onChange:Y=>d(Y.target.value),className:"w-full rounded-xl bg-white/5 border border-white/10 px-10 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-brand.pink"})]}),p.jsx("div",{className:"flex flex-wrap gap-2",children:Av.map(Y=>p.jsx(it,{variant:h===Y.key?"primary":"outline",onClick:()=>g(Y.key),children:Y.label},Y.key))})]}),p.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:c.map(Y=>p.jsx(qj,{course:Y,onOpen:()=>n(`/lesson/${Y.id}`),isAdmin:r,onDelete:be},Y.id))}),y&&p.jsx("div",{className:"fixed inset-0 z-30 flex items-center justify-center bg-black/70 px-4",children:p.jsxs("div",{className:"w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-2xl bg-slate-900 text-white border border-white/10 shadow-2xl",children:[p.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/10",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-lg font-semibold",children:N?"Edit course":"Add new course"}),p.jsx("div",{className:"text-xs text-white/60",children:"Admin-only course management"})]}),p.jsx("button",{onClick:Qe,className:"p-2 rounded-full hover:bg-white/10 text-white/70","aria-label":"Close editor",children:p.jsx(La,{className:"h-4 w-4"})})]}),p.jsxs("div",{className:"p-5 space-y-4",children:[p.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"Title"}),p.jsx("input",{value:k.title,onChange:Y=>$(we=>({...we,title:Y.target.value})),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",placeholder:"Course title"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"Thumbnail URL or PNG upload"}),p.jsx("input",{value:k.thumbnailUrl,onChange:Y=>$(we=>({...we,thumbnailUrl:Y.target.value})),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",placeholder:"Paste a link to the cover image"}),p.jsx("input",{type:"file",accept:"image/png",onChange:Y=>{const we=Y.target.files?.[0];if(!we)return;const ne=new FileReader;ne.onload=X=>{const ce=X.target?.result;typeof ce=="string"&&$(R=>({...R,thumbnailUrl:ce}))},ne.readAsDataURL(we)},className:"w-full text-sm text-white/80 file:mr-3 file:rounded-lg file:border-none file:bg-white/10 file:px-3 file:py-2 file:text-white hover:file:bg-white/20"}),p.jsx("div",{className:"text-xs text-white/60",children:"Use a link or upload a PNG to show on the card."})]})]}),p.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"Category"}),p.jsxs("div",{className:"relative",children:[p.jsxs("button",{type:"button",onClick:()=>F(Y=>!Y),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none hover:border-white/20 flex items-center justify-between",children:[p.jsx("span",{children:Av.find(Y=>Y.key===k.category)?.label||"Select category"}),p.jsx("span",{className:"text-xs text-white/60",children:M?"Hide":"Show"})]}),M&&p.jsx("div",{className:"absolute z-20 mt-2 w-full rounded-2xl bg-slate-800 border border-white/10 shadow-2xl overflow-hidden",children:Av.filter(Y=>Y.key!=="all").map(Y=>p.jsx("button",{onClick:()=>{$(we=>({...we,category:Y.key})),F(!1)},className:"w-full text-left px-4 py-2 text-sm text-white hover:bg-white/10",children:Y.label},Y.key))})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"Difficulty"}),p.jsxs("div",{className:"relative",children:[p.jsxs("button",{type:"button",onClick:()=>ye(Y=>!Y),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none hover:border-white/20 flex items-center justify-between",children:[p.jsx("span",{className:"capitalize",children:k.difficulty}),p.jsx("span",{className:"text-xs text-white/60",children:H?"Hide":"Show"})]}),H&&p.jsx("div",{className:"absolute z-20 mt-2 w-full rounded-2xl bg-slate-800 border border-white/10 shadow-2xl overflow-hidden",children:["beginner","intermediate","advanced"].map(Y=>p.jsx("button",{onClick:()=>{$(we=>({...we,difficulty:Y})),ye(!1)},className:"w-full text-left px-4 py-2 text-sm text-white hover:bg-white/10 capitalize",children:Y},Y))})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsxs("label",{className:"text-sm text-white/80 flex items-center justify-between",children:[p.jsx("span",{children:"Accent color"}),p.jsx("span",{className:"text-xs text-white/60",children:k.accentColor})]}),p.jsx("input",{type:"color",value:k.accentColor,onChange:Y=>$(we=>({...we,accentColor:Y.target.value})),className:"h-[44px] w-full rounded-xl border border-white/10 bg-white/5"})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"Description"}),p.jsx("textarea",{value:k.description,onChange:Y=>$(we=>({...we,description:Y.target.value})),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",rows:3,placeholder:"What will learners get from this course?"})]}),p.jsxs("div",{className:"flex items-center justify-between pt-2",children:[N&&p.jsxs(it,{variant:"ghost",onClick:()=>be(N),className:ee?"opacity-50 pointer-events-none":"text-red-200 hover:text-red-100",disabled:ee,children:[p.jsx(A0,{className:"h-4 w-4 mr-2"}),"Delete course"]}),p.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[p.jsx(it,{variant:"outline",onClick:Qe,children:"Cancel"}),p.jsx(it,{onClick:$e,className:te?"opacity-60 pointer-events-none":"",disabled:te,children:te?"Saving...":"Save course"})]})]}),le&&p.jsx("div",{className:"text-sm text-red-200 bg-red-500/10 border border-red-400/40 rounded-xl px-3 py-2",children:le})]})]})})]})})}function qj({course:n,onOpen:e,isAdmin:t,onDelete:r}){const a=n.thumbnailUrl||Fa;return p.jsxs(Mi,{className:"relative overflow-hidden hover:border-white/20 transition border border-white/10",children:[t&&p.jsx("div",{className:"absolute right-2 top-2 z-10 flex items-center gap-1 rounded-full bg-black/50 px-2 py-1",children:p.jsx("button",{onClick:()=>r(n),className:"p-1 rounded-md hover:bg-white/10 text-red-200","aria-label":"Delete course",children:p.jsx(A0,{className:"h-4 w-4"})})}),p.jsx("img",{src:a,alt:n.title,className:"h-32 w-full object-cover"}),p.jsxs(Di,{className:"space-y-3",children:[p.jsx("div",{className:"text-sm text-brand.pink uppercase tracking-wide",children:n.category.replace("_"," ")}),p.jsx("div",{className:"font-semibold",children:n.title}),p.jsx("p",{className:"text-sm text-white/70 line-clamp-3",children:n.description}),p.jsx(Iy,{value:0}),p.jsx(it,{className:"w-full",onClick:e,children:"Start Course"})]})]})}function Kj({id:n}){const{user:e}=pr(),[,t]=Ko(),r=km(),{data:a}=Cd({queryKey:["course",n],queryFn:()=>Yd(n)}),{data:d}=Cd({queryKey:["progress",n],enabled:!!e,queryFn:()=>UC(e.id,n)}),h=Op({mutationFn:y=>Uj(e.id,n,y),onSuccess:()=>{r.invalidateQueries({queryKey:["course",n]}),r.invalidateQueries({queryKey:["progress",n]}),r.invalidateQueries({queryKey:["dashboard"]})}});if(!a)return p.jsx(Ar,{children:p.jsx("div",{className:"text-white/70 text-sm",children:"Loading course..."})});const g=new Set(d?.completedLessonIds||[]);return p.jsxs(Ar,{children:[p.jsxs("button",{onClick:()=>t("/courses"),className:"text-white/70 hover:text-white flex items-center gap-2 mb-4 text-sm",children:[p.jsx(yE,{className:"h-4 w-4"}),"Back to courses"]}),p.jsxs(Mi,{children:[p.jsxs(ac,{children:[p.jsx(lc,{className:"text-2xl",children:a.title}),p.jsx("p",{className:"text-white/70 text-sm",children:a.description})]}),p.jsxs(Di,{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsxs("div",{className:"flex items-center justify-between text-sm text-white/70",children:[p.jsx("span",{children:"Progress"}),p.jsxs("span",{className:"text-white font-semibold",children:[d?.progressPercent??0,"%"]})]}),p.jsx(Iy,{value:d?.progressPercent??0})]}),p.jsx("div",{className:"space-y-3",children:a.lessons.map(y=>p.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-white/10 bg-white/5 p-3",children:[p.jsxs("div",{children:[p.jsx("div",{className:"font-semibold",children:y.title}),p.jsx("div",{className:"text-white/70 text-sm",children:y.summary})]}),p.jsx(it,{variant:g.has(y.id)?"outline":"primary",onClick:()=>h.mutate(y.id),disabled:h.isPending,children:g.has(y.id)?p.jsxs("span",{className:"flex items-center gap-1",children:[p.jsx(I0,{className:"h-4 w-4"}),"Completed"]}):"Mark done"})]},y.id))})]})]})]})}function Qj(){const{user:n}=pr(),[e,t]=D.useState([]),[r,a]=D.useState(!0);return D.useEffect(()=>{if(!n)return;const d=Dn(Ln,"users"),h=IC(d,g=>{const y=g.val()||{},N=Object.values(y||{}).filter(T=>typeof T?.totalXp=="number").sort((T,k)=>{const $=(k.totalXp||0)-(T.totalXp||0);if($!==0)return $;const M=T.xpReachedAt??T.createdAt??0,F=k.xpReachedAt??k.createdAt??0;return M-F});t(N),a(!1)},()=>a(!1));return()=>h()},[n]),!n||r?p.jsx(Ar,{children:p.jsx("div",{className:"text-white/70 text-sm",children:"Loading leaderboard..."})}):p.jsx(Ar,{children:p.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[p.jsxs(Mi,{children:[p.jsxs(ac,{className:"flex flex-col items-center gap-3",children:[p.jsxs("div",{className:"relative h-28 w-28",children:[p.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-tr from-emerald-400 via-blue-400 to-purple-500 opacity-80"}),p.jsx("div",{className:"relative h-full w-full rounded-full bg-slate-900 p-1",children:p.jsx("div",{className:"h-full w-full rounded-full overflow-hidden bg-slate-800 border border-white/10",children:n.avatarUrl?p.jsx("img",{src:n.avatarUrl,alt:"Avatar",className:"h-full w-full object-cover"}):p.jsx("div",{className:"h-full w-full flex items-center justify-center text-2xl font-bold text-white",children:(n.chessUsername||n.displayName||"Player").slice(0,2).toUpperCase()})})})]}),p.jsx(lc,{className:"text-3xl font-extrabold text-white text-center",children:n.chessUsername||n.displayName})]}),p.jsxs(Di,{className:"grid grid-cols-2 gap-3 text-sm text-white/80 items-stretch",children:[p.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/5 px-3 py-2",children:[p.jsx(QE,{className:"h-5 w-5 text-emerald-300"}),p.jsxs("div",{children:[p.jsx("div",{className:"text-lg font-semibold text-white",children:n.totalXp}),p.jsx("div",{className:"text-xs text-white/70",children:"Total XP"})]})]}),p.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/5 px-3 py-2",children:[p.jsx(wx,{className:"h-5 w-5 text-emerald-300"}),p.jsxs("div",{children:[p.jsx("div",{className:"text-lg font-semibold text-white",children:n.level}),p.jsx("div",{className:"text-xs text-white/70",children:"Level"})]})]})]})]}),p.jsxs(Mi,{className:"lg:col-span-2",children:[p.jsx(ac,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:p.jsxs(lc,{className:"flex items-center gap-2",children:[p.jsx(zE,{className:"h-5 w-5 text-brand.pink"}),"Leaderboard"]})}),p.jsx(Di,{className:"space-y-3",children:e.map((d,h)=>{const g=d.chessUsername||d.displayName||(d.email?d.email.split("@")[0]:"Player");return p.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-white/10 bg-white/5 p-3",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"h-9 w-9 rounded-full bg-white/10 flex items-center justify-center",children:h+1}),p.jsxs("div",{children:[p.jsx("div",{className:"font-semibold text-white",children:g}),p.jsxs("div",{className:"text-xs text-white/60",children:["Level ",d.level]})]})]}),p.jsxs("div",{className:"font-semibold text-emerald-200",children:[d.totalXp," XP"]})]},`${d.id||d.email||d.displayName||h}`)})})]})]})})}function Gj(n){return n!==null?{comment:n,variations:[]}:{variations:[]}}function Yj(n,e,t,r,a){const d={move:n,variations:a};return e&&(d.suffix=e),t&&(d.nag=t),r!==null&&(d.comment=r),d}function Xj(...n){const[e,...t]=n;let r=e;for(const a of t)a!==null&&(r.variations=[a,...a.variations],a.variations=[],r=a);return e}function Jj(n,e){if(e.marker&&e.marker.comment){let t=e.root;for(;;){const r=t.variations[0];if(!r){t.comment=e.marker.comment;break}t=r}}return{headers:n,root:e.root,result:(e.marker&&e.marker.result)??void 0}}function Zj(n,e){function t(){this.constructor=n}t.prototype=e.prototype,n.prototype=new t}function yc(n,e,t,r){var a=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(a,yc.prototype),a.expected=e,a.found=t,a.location=r,a.name="SyntaxError",a}Zj(yc,Error);function jv(n,e,t){return t=t||" ",n.length>e?n:(e-=n.length,t+=t.repeat(e),n+t.slice(0,e))}yc.prototype.format=function(n){var e="Error: "+this.message;if(this.location){var t=null,r;for(r=0;r<n.length;r++)if(n[r].source===this.location.source){t=n[r].text.split(/\r\n|\n|\r/g);break}var a=this.location.start,d=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(a):a,h=this.location.source+":"+d.line+":"+d.column;if(t){var g=this.location.end,y=jv("",d.line.toString().length," "),_=t[a.line-1],N=a.line===g.line?g.column:_.length+1,T=N-a.column||1;e+=`
 --> `+h+`
`+y+` |
`+d.line+" | "+_+`
`+y+" | "+jv("",a.column-1," ")+jv("",T,"^")}else e+=`
 at `+h}return e};yc.buildMessage=function(n,e){var t={literal:function(_){return'"'+a(_.text)+'"'},class:function(_){var N=_.parts.map(function(T){return Array.isArray(T)?d(T[0])+"-"+d(T[1]):d(T)});return"["+(_.inverted?"^":"")+N.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(_){return _.description}};function r(_){return _.charCodeAt(0).toString(16).toUpperCase()}function a(_){return _.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(N){return"\\x0"+r(N)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(N){return"\\x"+r(N)})}function d(_){return _.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(N){return"\\x0"+r(N)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(N){return"\\x"+r(N)})}function h(_){return t[_.type](_)}function g(_){var N=_.map(h),T,k;if(N.sort(),N.length>0){for(T=1,k=1;T<N.length;T++)N[T-1]!==N[T]&&(N[k]=N[T],k++);N.length=k}switch(N.length){case 1:return N[0];case 2:return N[0]+" or "+N[1];default:return N.slice(0,-1).join(", ")+", or "+N[N.length-1]}}function y(_){return _?'"'+a(_)+'"':"end of input"}return"Expected "+g(n)+" but "+y(e)+" found."};function e3(n,e){e=e!==void 0?e:{};var t={},r=e.grammarSource,a={pgn:ks},d=ks,h="[",g='"',y="]",_=".",N="O-O-O",T="O-O",k="0-0-0",$="0-0",M="$",F="{",H="}",ye=";",le="(",C=")",ie="1-0",c="0-1",ze="1/2-1/2",de="*",Ie=/^[a-zA-Z]/,Je=/^[^"]/,Qe=/^[0-9]/,Ve=/^[.]/,$e=/^[a-zA-Z1-8\-=]/,be=/^[+#]/,te=/^[!?]/,ee=/^[^}]/,Y=/^[^\r\n]/,we=/^[ \t\r\n]/,ne=Gt("tag pair"),X=ot("[",!1),ce=ot('"',!1),R=ot("]",!1),q=Gt("tag name"),se=_t([["a","z"],["A","Z"]],!1,!1),ve=Gt("tag value"),Re=_t(['"'],!0,!1),je=Gt("move number"),qe=_t([["0","9"]],!1,!1),Be=ot(".",!1),Ze=_t(["."],!1,!1),gt=Gt("standard algebraic notation"),un=ot("O-O-O",!1),En=ot("O-O",!1),bs=ot("0-0-0",!1),Fn=ot("0-0",!1),an=_t([["a","z"],["A","Z"],["1","8"],"-","="],!1,!1),Un=_t(["+","#"],!1,!1),Us=Gt("suffix annotation"),At=_t(["!","?"],!1,!1),zs=Gt("NAG"),zn=ot("$",!1),os=Gt("brace comment"),Bn=ot("{",!1),Yn=_t(["}"],!0,!1),Xn=ot("}",!1),as=Gt("rest of line comment"),Cs=ot(";",!1),ls=_t(["\r",`
`],!0,!1),Nn=Gt("variation"),mr=ot("(",!1),Wn=ot(")",!1),cs=Gt("game termination marker"),Jn=ot("1-0",!1),Bs=ot("0-1",!1),oe=ot("1/2-1/2",!1),xe=ot("*",!1),Ce=Gt("whitespace"),Le=_t([" ","	","\r",`
`],!1,!1),ht=function(B,Q){return Jj(B,Q)},Vt=function(B){return Object.fromEntries(B)},Ft=function(B,Q){return[B,Q]},Kt=function(B,Q){return{root:B,marker:Q}},Tn=function(B,Q){return Xj(Gj(B),...Q.flat())},He=function(B,Q,G,De,Oe){return Yj(B,Q,G,De,Oe)},bt=function(B){return B},wt=function(B){return B.replace(/[\r\n]+/g," ")},Jt=function(B){return B.trim()},Ct=function(B){return B},Qt=function(B,Q){return{result:B,comment:Q}},V=e.peg$currPos|0,Ht=[{line:1,column:1}],Rt=V,tn=e.peg$maxFailExpected||[],ge=e.peg$silentFails|0,jt;if(e.startRule){if(!(e.startRule in a))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');d=a[e.startRule]}function ot(B,Q){return{type:"literal",text:B,ignoreCase:Q}}function _t(B,Q,G){return{type:"class",parts:B,inverted:Q,ignoreCase:G}}function tr(){return{type:"end"}}function Gt(B){return{type:"other",description:B}}function us(B){var Q=Ht[B],G;if(Q)return Q;if(B>=Ht.length)G=Ht.length-1;else for(G=B;!Ht[--G];);for(Q=Ht[G],Q={line:Q.line,column:Q.column};G<B;)n.charCodeAt(G)===10?(Q.line++,Q.column=1):Q.column++,G++;return Ht[B]=Q,Q}function Ws(B,Q,G){var De=us(B),Oe=us(Q),Fe={source:r,start:{offset:B,line:De.line,column:De.column},end:{offset:Q,line:Oe.line,column:Oe.column}};return Fe}function ke(B){V<Rt||(V>Rt&&(Rt=V,tn=[]),tn.push(B))}function qt(B,Q,G){return new yc(yc.buildMessage(B,Q),B,Q,G)}function ks(){var B,Q,G;return B=V,Q=Ss(),G=ri(),B=ht(Q,G),B}function Ss(){var B,Q,G;for(B=V,Q=[],G=nr();G!==t;)Q.push(G),G=nr();return G=nn(),B=Vt(Q),B}function nr(){var B,Q,G,De,Oe,Fe,dn;return ge++,B=V,nn(),n.charCodeAt(V)===91?(Q=h,V++):(Q=t,ge===0&&ke(X)),Q!==t?(nn(),G=ni(),G!==t?(nn(),n.charCodeAt(V)===34?(De=g,V++):(De=t,ge===0&&ke(ce)),De!==t?(Oe=si(),n.charCodeAt(V)===34?(Fe=g,V++):(Fe=t,ge===0&&ke(ce)),Fe!==t?(nn(),n.charCodeAt(V)===93?(dn=y,V++):(dn=t,ge===0&&ke(R)),dn!==t?B=Ft(G,Oe):(V=B,B=t)):(V=B,B=t)):(V=B,B=t)):(V=B,B=t)):(V=B,B=t),ge--,B===t&&ge===0&&ke(ne),B}function ni(){var B,Q,G;if(ge++,B=V,Q=[],G=n.charAt(V),Ie.test(G)?V++:(G=t,ge===0&&ke(se)),G!==t)for(;G!==t;)Q.push(G),G=n.charAt(V),Ie.test(G)?V++:(G=t,ge===0&&ke(se));else Q=t;return Q!==t?B=n.substring(B,V):B=Q,ge--,B===t&&(Q=t,ge===0&&ke(q)),B}function si(){var B,Q,G;for(ge++,B=V,Q=[],G=n.charAt(V),Je.test(G)?V++:(G=t,ge===0&&ke(Re));G!==t;)Q.push(G),G=n.charAt(V),Je.test(G)?V++:(G=t,ge===0&&ke(Re));return B=n.substring(B,V),ge--,Q=t,ge===0&&ke(ve),B}function ri(){var B,Q,G;return B=V,Q=ds(),nn(),G=Vn(),G===t&&(G=null),nn(),B=Kt(Q,G),B}function ds(){var B,Q,G,De;for(B=V,Q=Vs(),Q===t&&(Q=null),G=[],De=ii();De!==t;)G.push(De),De=ii();return B=Tn(Q,G),B}function ii(){var B,Q,G,De,Oe,Fe,dn,$t;if(B=V,nn(),St(),nn(),Q=oi(),Q!==t){for(G=gr(),G===t&&(G=null),De=[],Oe=sr();Oe!==t;)De.push(Oe),Oe=sr();for(Oe=nn(),Fe=Vs(),Fe===t&&(Fe=null),dn=[],$t=rr();$t!==t;)dn.push($t),$t=rr();B=He(Q,G,De,Fe,dn)}else V=B,B=t;return B}function St(){var B,Q,G,De,Oe,Fe;for(ge++,B=V,Q=[],G=n.charAt(V),Qe.test(G)?V++:(G=t,ge===0&&ke(qe));G!==t;)Q.push(G),G=n.charAt(V),Qe.test(G)?V++:(G=t,ge===0&&ke(qe));if(n.charCodeAt(V)===46?(G=_,V++):(G=t,ge===0&&ke(Be)),G!==t){for(De=nn(),Oe=[],Fe=n.charAt(V),Ve.test(Fe)?V++:(Fe=t,ge===0&&ke(Ze));Fe!==t;)Oe.push(Fe),Fe=n.charAt(V),Ve.test(Fe)?V++:(Fe=t,ge===0&&ke(Ze));Q=[Q,G,De,Oe],B=Q}else V=B,B=t;return ge--,B===t&&(Q=t,ge===0&&ke(je)),B}function oi(){var B,Q,G,De,Oe,Fe;if(ge++,B=V,Q=V,n.substr(V,5)===N?(G=N,V+=5):(G=t,ge===0&&ke(un)),G===t&&(n.substr(V,3)===T?(G=T,V+=3):(G=t,ge===0&&ke(En)),G===t&&(n.substr(V,5)===k?(G=k,V+=5):(G=t,ge===0&&ke(bs)),G===t&&(n.substr(V,3)===$?(G=$,V+=3):(G=t,ge===0&&ke(Fn)),G===t))))if(G=V,De=n.charAt(V),Ie.test(De)?V++:(De=t,ge===0&&ke(se)),De!==t){if(Oe=[],Fe=n.charAt(V),$e.test(Fe)?V++:(Fe=t,ge===0&&ke(an)),Fe!==t)for(;Fe!==t;)Oe.push(Fe),Fe=n.charAt(V),$e.test(Fe)?V++:(Fe=t,ge===0&&ke(an));else Oe=t;Oe!==t?(De=[De,Oe],G=De):(V=G,G=t)}else V=G,G=t;return G!==t?(De=n.charAt(V),be.test(De)?V++:(De=t,ge===0&&ke(Un)),De===t&&(De=null),G=[G,De],Q=G):(V=Q,Q=t),Q!==t?B=n.substring(B,V):B=Q,ge--,B===t&&(Q=t,ge===0&&ke(gt)),B}function gr(){var B,Q,G;for(ge++,B=V,Q=[],G=n.charAt(V),te.test(G)?V++:(G=t,ge===0&&ke(At));G!==t;)Q.push(G),Q.length>=2?G=t:(G=n.charAt(V),te.test(G)?V++:(G=t,ge===0&&ke(At)));return Q.length<1?(V=B,B=t):B=Q,ge--,B===t&&(Q=t,ge===0&&ke(Us)),B}function sr(){var B,Q,G,De,Oe;if(ge++,B=V,nn(),n.charCodeAt(V)===36?(Q=M,V++):(Q=t,ge===0&&ke(zn)),Q!==t){if(G=V,De=[],Oe=n.charAt(V),Qe.test(Oe)?V++:(Oe=t,ge===0&&ke(qe)),Oe!==t)for(;Oe!==t;)De.push(Oe),Oe=n.charAt(V),Qe.test(Oe)?V++:(Oe=t,ge===0&&ke(qe));else De=t;De!==t?G=n.substring(G,V):G=De,G!==t?B=bt(G):(V=B,B=t)}else V=B,B=t;return ge--,B===t&&ge===0&&ke(zs),B}function Vs(){var B;return B=Vi(),B===t&&(B=ai()),B}function Vi(){var B,Q,G,De,Oe;if(ge++,B=V,n.charCodeAt(V)===123?(Q=F,V++):(Q=t,ge===0&&ke(Bn)),Q!==t){for(G=V,De=[],Oe=n.charAt(V),ee.test(Oe)?V++:(Oe=t,ge===0&&ke(Yn));Oe!==t;)De.push(Oe),Oe=n.charAt(V),ee.test(Oe)?V++:(Oe=t,ge===0&&ke(Yn));G=n.substring(G,V),n.charCodeAt(V)===125?(De=H,V++):(De=t,ge===0&&ke(Xn)),De!==t?B=wt(G):(V=B,B=t)}else V=B,B=t;return ge--,B===t&&(Q=t,ge===0&&ke(os)),B}function ai(){var B,Q,G,De,Oe;if(ge++,B=V,n.charCodeAt(V)===59?(Q=ye,V++):(Q=t,ge===0&&ke(Cs)),Q!==t){for(G=V,De=[],Oe=n.charAt(V),Y.test(Oe)?V++:(Oe=t,ge===0&&ke(ls));Oe!==t;)De.push(Oe),Oe=n.charAt(V),Y.test(Oe)?V++:(Oe=t,ge===0&&ke(ls));G=n.substring(G,V),B=Jt(G)}else V=B,B=t;return ge--,B===t&&(Q=t,ge===0&&ke(as)),B}function rr(){var B,Q,G,De;return ge++,B=V,nn(),n.charCodeAt(V)===40?(Q=le,V++):(Q=t,ge===0&&ke(mr)),Q!==t?(G=ds(),G!==t?(nn(),n.charCodeAt(V)===41?(De=C,V++):(De=t,ge===0&&ke(Wn)),De!==t?B=Ct(G):(V=B,B=t)):(V=B,B=t)):(V=B,B=t),ge--,B===t&&ge===0&&ke(Nn),B}function Vn(){var B,Q,G;return ge++,B=V,n.substr(V,3)===ie?(Q=ie,V+=3):(Q=t,ge===0&&ke(Jn)),Q===t&&(n.substr(V,3)===c?(Q=c,V+=3):(Q=t,ge===0&&ke(Bs)),Q===t&&(n.substr(V,7)===ze?(Q=ze,V+=7):(Q=t,ge===0&&ke(oe)),Q===t&&(n.charCodeAt(V)===42?(Q=de,V++):(Q=t,ge===0&&ke(xe))))),Q!==t?(nn(),G=Vs(),G===t&&(G=null),B=Qt(Q,G)):(V=B,B=t),ge--,B===t&&(Q=t,ge===0&&ke(cs)),B}function nn(){var B,Q;for(ge++,B=[],Q=n.charAt(V),we.test(Q)?V++:(Q=t,ge===0&&ke(Le));Q!==t;)B.push(Q),Q=n.charAt(V),we.test(Q)?V++:(Q=t,ge===0&&ke(Le));return ge--,Q=t,ge===0&&ke(Ce),B}if(jt=d(),e.peg$library)return{peg$result:jt,peg$currPos:V,peg$FAILED:t,peg$maxFailExpected:tn,peg$maxFailPos:Rt};if(jt!==t&&V===n.length)return jt;throw jt!==t&&V<n.length&&ke(tr()),qt(tn,Rt<n.length?n.charAt(Rt):null,Rt<n.length?Ws(Rt,Rt+1):Ws(Rt,Rt))}const Bp=0xffffffffffffffffn;function $v(n,e){return(n<<e|n>>64n-e)&0xffffffffffffffffn}function b1(n,e){return n*e&Bp}function t3(n){return function(){let e=BigInt(n&Bp),t=BigInt(n>>64n&Bp);const r=b1($v(b1(e,5n),7n),9n);return t^=e,e=($v(e,24n)^t^t<<16n)&Bp,t=$v(t,37n),n=t<<64n|e,r}}const Vm=t3(0xa187eb39cdcaed8f31c4b365b102e01en),n3=Array.from({length:2},()=>Array.from({length:6},()=>Array.from({length:128},()=>Vm()))),s3=Array.from({length:8},()=>Vm()),r3=Array.from({length:16},()=>Vm()),Ov=Vm(),rs="w",Js="b",gn="p",x0="n",Wp="b",hd="r",jo="q",bn="k",Mv="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";class Tp{color;from;to;piece;captured;promotion;flags;san;lan;before;after;constructor(e,t){const{color:r,piece:a,from:d,to:h,flags:g,captured:y,promotion:_}=t,N=$n(d),T=$n(h);this.color=r,this.piece=a,this.from=N,this.to=T,this.san=e._moveToSan(t,e._moves({legal:!0})),this.lan=N+T,this.before=e.fen(),e._makeMove(t),this.after=e.fen(),e._undoMove(),this.flags="";for(const k in tt)tt[k]&g&&(this.flags+=Ra[k]);y&&(this.captured=y),_&&(this.promotion=_,this.lan+=_)}isCapture(){return this.flags.indexOf(Ra.CAPTURE)>-1}isPromotion(){return this.flags.indexOf(Ra.PROMOTION)>-1}isEnPassant(){return this.flags.indexOf(Ra.EP_CAPTURE)>-1}isKingsideCastle(){return this.flags.indexOf(Ra.KSIDE_CASTLE)>-1}isQueensideCastle(){return this.flags.indexOf(Ra.QSIDE_CASTLE)>-1}isBigPawn(){return this.flags.indexOf(Ra.BIG_PAWN)>-1}}const Kn=-1,Ra={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q",NULL_MOVE:"-"},tt={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64,NULL_MOVE:128},b0={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},i3={WhiteTitle:null,BlackTitle:null,WhiteElo:null,BlackElo:null,WhiteUSCF:null,BlackUSCF:null,WhiteNA:null,BlackNA:null,WhiteType:null,BlackType:null,EventDate:null,EventSponsor:null,Section:null,Stage:null,Board:null,Opening:null,Variation:null,SubVariation:null,ECO:null,NIC:null,Time:null,UTCTime:null,UTCDate:null,TimeControl:null,SetUp:null,FEN:null,Termination:null,Annotator:null,Mode:null,PlyCount:null},o3={...b0,...i3},et={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},Dv={b:[16,32,17,15],w:[-16,-32,-17,-15]},C1={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},a3=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],l3=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],c3={p:1,n:2,b:4,r:8,q:16,k:32},u3="pnbrqkPNBRQK",k1=[x0,Wp,hd,jo],d3=7,f3=6,h3=1,p3=0,Ip={[bn]:tt.KSIDE_CASTLE,[jo]:tt.QSIDE_CASTLE},Ao={w:[{square:et.a1,flag:tt.QSIDE_CASTLE},{square:et.h1,flag:tt.KSIDE_CASTLE}],b:[{square:et.a8,flag:tt.QSIDE_CASTLE},{square:et.h8,flag:tt.KSIDE_CASTLE}]},m3={b:h3,w:f3},Lv="--";function Ua(n){return n>>4}function Od(n){return n&15}function VC(n){return"0123456789".indexOf(n)!==-1}function $n(n){const e=Od(n),t=Ua(n);return"abcdefgh".substring(e,e+1)+"87654321".substring(t,t+1)}function ud(n){return n===rs?Js:rs}function g3(n){const e=n.split(/\s+/);if(e.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const t=parseInt(e[5],10);if(isNaN(t)||t<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const r=parseInt(e[4],10);if(isNaN(r)||r<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(e[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(e[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(e[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const a=e[0].split("/");if(a.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let h=0;h<a.length;h++){let g=0,y=!1;for(let _=0;_<a[h].length;_++)if(VC(a[h][_])){if(y)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};g+=parseInt(a[h][_],10),y=!0}else{if(!/^[prnbqkPRNBQK]$/.test(a[h][_]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};g+=1,y=!1}if(g!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(e[3][1]=="3"&&e[1]=="w"||e[3][1]=="6"&&e[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const d=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:h,regex:g}of d){if(!g.test(e[0]))return{ok:!1,error:`Invalid FEN: missing ${h} king`};if((e[0].match(g)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${h} kings`}}return Array.from(a[0]+a[7]).some(h=>h.toUpperCase()==="P")?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}function v3(n,e){const t=n.from,r=n.to,a=n.piece;let d=0,h=0,g=0;for(let y=0,_=e.length;y<_;y++){const N=e[y].from,T=e[y].to,k=e[y].piece;a===k&&t!==N&&r===T&&(d++,Ua(t)===Ua(N)&&h++,Od(t)===Od(N)&&g++)}return d>0?h>0&&g>0?$n(t):g>0?$n(t).charAt(1):$n(t).charAt(0):""}function Ro(n,e,t,r,a,d=void 0,h=tt.NORMAL){const g=Ua(r);if(a===gn&&(g===d3||g===p3))for(let y=0;y<k1.length;y++){const _=k1[y];n.push({color:e,from:t,to:r,piece:a,captured:d,promotion:_,flags:h|tt.PROMOTION})}else n.push({color:e,from:t,to:r,piece:a,captured:d,flags:h})}function S1(n){let e=n.charAt(0);return e>="a"&&e<="h"?n.match(/[a-h]\d.*[a-h]\d/)?void 0:gn:(e=e.toLowerCase(),e==="o"?bn:e)}function Fv(n){return n.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class at{_board=new Array(128);_turn=rs;_header={};_kings={w:Kn,b:Kn};_epSquare=-1;_halfMoves=0;_moveNumber=0;_history=[];_comments={};_castling={w:0,b:0};_hash=0n;_positionCount=new Map;constructor(e=Mv,{skipValidation:t=!1}={}){this.load(e,{skipValidation:t})}clear({preserveHeaders:e=!1}={}){this._board=new Array(128),this._kings={w:Kn,b:Kn},this._turn=rs,this._castling={w:0,b:0},this._epSquare=Kn,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{...o3},this._hash=this._computeHash(),this._positionCount=new Map,this._header.SetUp=null,this._header.FEN=null}load(e,{skipValidation:t=!1,preserveHeaders:r=!1}={}){let a=e.split(/\s+/);if(a.length>=2&&a.length<6){const g=["-","-","0","1"];e=a.concat(g.slice(-(6-a.length))).join(" ")}if(a=e.split(/\s+/),!t){const{ok:g,error:y}=g3(e);if(!g)throw new Error(y)}const d=a[0];let h=0;this.clear({preserveHeaders:r});for(let g=0;g<d.length;g++){const y=d.charAt(g);if(y==="/")h+=8;else if(VC(y))h+=parseInt(y,10);else{const _=y<"a"?rs:Js;this._put({type:y.toLowerCase(),color:_},$n(h)),h++}}this._turn=a[1],a[2].indexOf("K")>-1&&(this._castling.w|=tt.KSIDE_CASTLE),a[2].indexOf("Q")>-1&&(this._castling.w|=tt.QSIDE_CASTLE),a[2].indexOf("k")>-1&&(this._castling.b|=tt.KSIDE_CASTLE),a[2].indexOf("q")>-1&&(this._castling.b|=tt.QSIDE_CASTLE),this._epSquare=a[3]==="-"?Kn:et[a[3]],this._halfMoves=parseInt(a[4],10),this._moveNumber=parseInt(a[5],10),this._hash=this._computeHash(),this._updateSetup(e),this._incPositionCount()}fen({forceEnpassantSquare:e=!1}={}){let t=0,r="";for(let h=et.a8;h<=et.h1;h++){if(this._board[h]){t>0&&(r+=t,t=0);const{color:g,type:y}=this._board[h];r+=g===rs?y.toUpperCase():y.toLowerCase()}else t++;h+1&136&&(t>0&&(r+=t),h!==et.h1&&(r+="/"),t=0,h+=8)}let a="";this._castling[rs]&tt.KSIDE_CASTLE&&(a+="K"),this._castling[rs]&tt.QSIDE_CASTLE&&(a+="Q"),this._castling[Js]&tt.KSIDE_CASTLE&&(a+="k"),this._castling[Js]&tt.QSIDE_CASTLE&&(a+="q"),a=a||"-";let d="-";if(this._epSquare!==Kn)if(e)d=$n(this._epSquare);else{const h=this._epSquare+(this._turn===rs?16:-16),g=[h+1,h-1];for(const y of g){if(y&136)continue;const _=this._turn;if(this._board[y]?.color===_&&this._board[y]?.type===gn){this._makeMove({color:_,from:y,to:this._epSquare,piece:gn,captured:gn,flags:tt.EP_CAPTURE});const N=!this._isKingAttacked(_);if(this._undoMove(),N){d=$n(this._epSquare);break}}}}return[r,this._turn,a,d,this._halfMoves,this._moveNumber].join(" ")}_pieceKey(e){if(!this._board[e])return 0n;const{color:t,type:r}=this._board[e],a={w:0,b:1}[t],d={p:0,n:1,b:2,r:3,q:4,k:5}[r];return n3[a][d][e]}_epKey(){return this._epSquare===Kn?0n:s3[this._epSquare&7]}_castlingKey(){const e=this._castling.w>>5|this._castling.b>>3;return r3[e]}_computeHash(){let e=0n;for(let t=et.a8;t<=et.h1;t++){if(t&136){t+=7;continue}this._board[t]&&(e^=this._pieceKey(t))}return e^=this._epKey(),e^=this._castlingKey(),this._turn==="b"&&(e^=Ov),e}_updateSetup(e){this._history.length>0||(e!==Mv?(this._header.SetUp="1",this._header.FEN=e):(this._header.SetUp=null,this._header.FEN=null))}reset(){this.load(Mv)}get(e){return this._board[et[e]]}findPiece(e){const t=[];for(let r=et.a8;r<=et.h1;r++){if(r&136){r+=7;continue}!this._board[r]||this._board[r]?.color!==e.color||this._board[r].color===e.color&&this._board[r].type===e.type&&t.push($n(r))}return t}put({type:e,color:t},r){return this._put({type:e,color:t},r)?(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0):!1}_set(e,t){this._hash^=this._pieceKey(e),this._board[e]=t,this._hash^=this._pieceKey(e)}_put({type:e,color:t},r){if(u3.indexOf(e.toLowerCase())===-1||!(r in et))return!1;const a=et[r];if(e==bn&&!(this._kings[t]==Kn||this._kings[t]==a))return!1;const d=this._board[a];return d&&d.type===bn&&(this._kings[d.color]=Kn),this._set(a,{type:e,color:t}),e===bn&&(this._kings[t]=a),!0}_clear(e){this._hash^=this._pieceKey(e),delete this._board[e]}remove(e){const t=this.get(e);return this._clear(et[e]),t&&t.type===bn&&(this._kings[t.color]=Kn),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),t}_updateCastlingRights(){this._hash^=this._castlingKey();const e=this._board[et.e1]?.type===bn&&this._board[et.e1]?.color===rs,t=this._board[et.e8]?.type===bn&&this._board[et.e8]?.color===Js;(!e||this._board[et.a1]?.type!==hd||this._board[et.a1]?.color!==rs)&&(this._castling.w&=-65),(!e||this._board[et.h1]?.type!==hd||this._board[et.h1]?.color!==rs)&&(this._castling.w&=-33),(!t||this._board[et.a8]?.type!==hd||this._board[et.a8]?.color!==Js)&&(this._castling.b&=-65),(!t||this._board[et.h8]?.type!==hd||this._board[et.h8]?.color!==Js)&&(this._castling.b&=-33),this._hash^=this._castlingKey()}_updateEnPassantSquare(){if(this._epSquare===Kn)return;const e=this._epSquare+(this._turn===rs?-16:16),t=this._epSquare+(this._turn===rs?16:-16),r=[t+1,t-1];if(this._board[e]!==null||this._board[this._epSquare]!==null||this._board[t]?.color!==ud(this._turn)||this._board[t]?.type!==gn){this._hash^=this._epKey(),this._epSquare=Kn;return}const a=d=>!(d&136)&&this._board[d]?.color===this._turn&&this._board[d]?.type===gn;r.some(a)||(this._hash^=this._epKey(),this._epSquare=Kn)}_attacked(e,t,r){const a=[];for(let d=et.a8;d<=et.h1;d++){if(d&136){d+=7;continue}if(this._board[d]===void 0||this._board[d].color!==e)continue;const h=this._board[d],g=d-t;if(g===0)continue;const y=g+119;if(a3[y]&c3[h.type]){if(h.type===gn){if(g>0&&h.color===rs||g<=0&&h.color===Js)if(r)a.push($n(d));else return!0;continue}if(h.type==="n"||h.type==="k")if(r){a.push($n(d));continue}else return!0;const _=l3[y];let N=d+_,T=!1;for(;N!==t;){if(this._board[N]!=null){T=!0;break}N+=_}if(!T)if(r){a.push($n(d));continue}else return!0}}return r?a:!1}attackers(e,t){return t?this._attacked(t,et[e],!0):this._attacked(this._turn,et[e],!0)}_isKingAttacked(e){const t=this._kings[e];return t===-1?!1:this._attacked(ud(e),t)}hash(){return this._hash.toString(16)}isAttacked(e,t){return this._attacked(t,et[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const e={b:0,n:0,r:0,q:0,k:0,p:0},t=[];let r=0,a=0;for(let d=et.a8;d<=et.h1;d++){if(a=(a+1)%2,d&136){d+=7;continue}const h=this._board[d];h&&(e[h.type]=h.type in e?e[h.type]+1:1,h.type===Wp&&t.push(a),r++)}if(r===2)return!0;if(r===3&&(e[Wp]===1||e[x0]===1))return!0;if(r===e[Wp]+2){let d=0;const h=t.length;for(let g=0;g<h;g++)d+=t[g];if(d===0||d===h)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this._hash)>=3}isDrawByFiftyMoves(){return this._halfMoves>=100}isDraw(){return this.isDrawByFiftyMoves()||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isDraw()}moves({verbose:e=!1,square:t=void 0,piece:r=void 0}={}){const a=this._moves({square:t,piece:r});return e?a.map(d=>new Tp(this,d)):a.map(d=>this._moveToSan(d,a))}_moves({legal:e=!0,piece:t=void 0,square:r=void 0}={}){const a=r?r.toLowerCase():void 0,d=t?.toLowerCase(),h=[],g=this._turn,y=ud(g);let _=et.a8,N=et.h1,T=!1;if(a)if(a in et)_=N=et[a],T=!0;else return[];for(let $=_;$<=N;$++){if($&136){$+=7;continue}if(!this._board[$]||this._board[$].color===y)continue;const{type:M}=this._board[$];let F;if(M===gn){if(d&&d!==M)continue;F=$+Dv[g][0],this._board[F]||(Ro(h,g,$,F,gn),F=$+Dv[g][1],m3[g]===Ua($)&&!this._board[F]&&Ro(h,g,$,F,gn,void 0,tt.BIG_PAWN));for(let H=2;H<4;H++)F=$+Dv[g][H],!(F&136)&&(this._board[F]?.color===y?Ro(h,g,$,F,gn,this._board[F].type,tt.CAPTURE):F===this._epSquare&&Ro(h,g,$,F,gn,gn,tt.EP_CAPTURE))}else{if(d&&d!==M)continue;for(let H=0,ye=C1[M].length;H<ye;H++){const le=C1[M][H];for(F=$;F+=le,!(F&136);){if(!this._board[F])Ro(h,g,$,F,M);else{if(this._board[F].color===g)break;Ro(h,g,$,F,M,this._board[F].type,tt.CAPTURE);break}if(M===x0||M===bn)break}}}}if((d===void 0||d===bn)&&(!T||N===this._kings[g])){if(this._castling[g]&tt.KSIDE_CASTLE){const $=this._kings[g],M=$+2;!this._board[$+1]&&!this._board[M]&&!this._attacked(y,this._kings[g])&&!this._attacked(y,$+1)&&!this._attacked(y,M)&&Ro(h,g,this._kings[g],M,bn,void 0,tt.KSIDE_CASTLE)}if(this._castling[g]&tt.QSIDE_CASTLE){const $=this._kings[g],M=$-2;!this._board[$-1]&&!this._board[$-2]&&!this._board[$-3]&&!this._attacked(y,this._kings[g])&&!this._attacked(y,$-1)&&!this._attacked(y,M)&&Ro(h,g,this._kings[g],M,bn,void 0,tt.QSIDE_CASTLE)}}if(!e||this._kings[g]===-1)return h;const k=[];for(let $=0,M=h.length;$<M;$++)this._makeMove(h[$]),this._isKingAttacked(g)||k.push(h[$]),this._undoMove();return k}move(e,{strict:t=!1}={}){let r=null;if(typeof e=="string")r=this._moveFromSan(e,t);else if(e===null)r=this._moveFromSan(Lv,t);else if(typeof e=="object"){const d=this._moves();for(let h=0,g=d.length;h<g;h++)if(e.from===$n(d[h].from)&&e.to===$n(d[h].to)&&(!("promotion"in d[h])||e.promotion===d[h].promotion)){r=d[h];break}}if(!r)throw typeof e=="string"?new Error(`Invalid move: ${e}`):new Error(`Invalid move: ${JSON.stringify(e)}`);if(this.isCheck()&&r.flags&tt.NULL_MOVE)throw new Error("Null move not allowed when in check");const a=new Tp(this,r);return this._makeMove(r),this._incPositionCount(),a}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_movePiece(e,t){this._hash^=this._pieceKey(e),this._board[t]=this._board[e],delete this._board[e],this._hash^=this._pieceKey(t)}_makeMove(e){const t=this._turn,r=ud(t);if(this._push(e),e.flags&tt.NULL_MOVE){t===Js&&this._moveNumber++,this._halfMoves++,this._turn=r,this._epSquare=Kn;return}if(this._hash^=this._epKey(),this._hash^=this._castlingKey(),e.captured&&(this._hash^=this._pieceKey(e.to)),this._movePiece(e.from,e.to),e.flags&tt.EP_CAPTURE&&(this._turn===Js?this._clear(e.to-16):this._clear(e.to+16)),e.promotion&&(this._clear(e.to),this._set(e.to,{type:e.promotion,color:t})),this._board[e.to].type===bn){if(this._kings[t]=e.to,e.flags&tt.KSIDE_CASTLE){const a=e.to-1,d=e.to+1;this._movePiece(d,a)}else if(e.flags&tt.QSIDE_CASTLE){const a=e.to+1,d=e.to-2;this._movePiece(d,a)}this._castling[t]=0}if(this._castling[t]){for(let a=0,d=Ao[t].length;a<d;a++)if(e.from===Ao[t][a].square&&this._castling[t]&Ao[t][a].flag){this._castling[t]^=Ao[t][a].flag;break}}if(this._castling[r]){for(let a=0,d=Ao[r].length;a<d;a++)if(e.to===Ao[r][a].square&&this._castling[r]&Ao[r][a].flag){this._castling[r]^=Ao[r][a].flag;break}}if(this._hash^=this._castlingKey(),e.flags&tt.BIG_PAWN){let a;t===Js?a=e.to-16:a=e.to+16,!(e.to-1&136)&&this._board[e.to-1]?.type===gn&&this._board[e.to-1]?.color===r||!(e.to+1&136)&&this._board[e.to+1]?.type===gn&&this._board[e.to+1]?.color===r?(this._epSquare=a,this._hash^=this._epKey()):this._epSquare=Kn}else this._epSquare=Kn;e.piece===gn?this._halfMoves=0:e.flags&(tt.CAPTURE|tt.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,t===Js&&this._moveNumber++,this._turn=r,this._hash^=Ov}undo(){const e=this._hash,t=this._undoMove();if(t){const r=new Tp(this,t);return this._decPositionCount(e),r}return null}_undoMove(){const e=this._history.pop();if(e===void 0)return null;this._hash^=this._epKey(),this._hash^=this._castlingKey();const t=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber,this._hash^=this._epKey(),this._hash^=this._castlingKey(),this._hash^=Ov;const r=this._turn,a=ud(r);if(t.flags&tt.NULL_MOVE)return t;if(this._movePiece(t.to,t.from),t.piece&&(this._clear(t.from),this._set(t.from,{type:t.piece,color:r})),t.captured)if(t.flags&tt.EP_CAPTURE){let d;r===Js?d=t.to-16:d=t.to+16,this._set(d,{type:gn,color:a})}else this._set(t.to,{type:t.captured,color:a});if(t.flags&(tt.KSIDE_CASTLE|tt.QSIDE_CASTLE)){let d,h;t.flags&tt.KSIDE_CASTLE?(d=t.to+1,h=t.to-1):(d=t.to-2,h=t.to+1),this._movePiece(h,d)}return t}pgn({newline:e=`
`,maxWidth:t=0}={}){const r=[];let a=!1;for(const k in this._header)this._header[k]&&r.push(`[${k} "${this._header[k]}"]`+e),a=!0;a&&this._history.length&&r.push(e);const d=k=>{const $=this._comments[this.fen()];if(typeof $<"u"){const M=k.length>0?" ":"";k=`${k}${M}{${$}}`}return k},h=[];for(;this._history.length>0;)h.push(this._undoMove());const g=[];let y="";for(h.length===0&&g.push(d(""));h.length>0;){y=d(y);const k=h.pop();if(!k)break;if(!this._history.length&&k.color==="b"){const $=`${this._moveNumber}. ...`;y=y?`${y} ${$}`:$}else k.color==="w"&&(y.length&&g.push(y),y=this._moveNumber+".");y=y+" "+this._moveToSan(k,this._moves({legal:!0})),this._makeMove(k)}if(y.length&&g.push(d(y)),g.push(this._header.Result||"*"),t===0)return r.join("")+g.join(" ");const _=function(){return r.length>0&&r[r.length-1]===" "?(r.pop(),!0):!1},N=function(k,$){for(const M of $.split(" "))if(M){if(k+M.length>t){for(;_();)k--;r.push(e),k=0}r.push(M),k+=M.length,r.push(" "),k++}return _()&&k--,k};let T=0;for(let k=0;k<g.length;k++){if(T+g[k].length>t&&g[k].includes("{")){T=N(T,g[k]);continue}T+g[k].length>t&&k!==0?(r[r.length-1]===" "&&r.pop(),r.push(e),T=0):k!==0&&(r.push(" "),T++),r.push(g[k]),T+=g[k].length}return r.join("")}header(...e){for(let t=0;t<e.length;t+=2)typeof e[t]=="string"&&typeof e[t+1]=="string"&&(this._header[e[t]]=e[t+1]);return this._header}setHeader(e,t){return this._header[e]=t??b0[e]??null,this.getHeaders()}removeHeader(e){return e in this._header?(this._header[e]=b0[e]||null,!0):!1}getHeaders(){const e={};for(const[t,r]of Object.entries(this._header))r!==null&&(e[t]=r);return e}loadPgn(e,{strict:t=!1,newlineChar:r=`\r?
`}={}){r!==`\r?
`&&(e=e.replace(new RegExp(r,"g"),`
`));const a=e3(e);this.reset();const d=a.headers;let h="";for(const _ in d)_.toLowerCase()==="fen"&&(h=d[_]),this.header(_,d[_]);if(!t)h&&this.load(h,{preserveHeaders:!0});else if(d.SetUp==="1"){if(!("FEN"in d))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(d.FEN,{preserveHeaders:!0})}let g=a.root;for(;g;){if(g.move){const _=this._moveFromSan(g.move,t);if(_==null)throw new Error(`Invalid move in PGN: ${g.move}`);this._makeMove(_),this._incPositionCount()}g.comment!==void 0&&(this._comments[this.fen()]=g.comment),g=g.variations[0]}const y=a.result;y&&Object.keys(this._header).length&&this._header.Result!==y&&this.setHeader("Result",y)}_moveToSan(e,t){let r="";if(e.flags&tt.KSIDE_CASTLE)r="O-O";else if(e.flags&tt.QSIDE_CASTLE)r="O-O-O";else{if(e.flags&tt.NULL_MOVE)return Lv;if(e.piece!==gn){const a=v3(e,t);r+=e.piece.toUpperCase()+a}e.flags&(tt.CAPTURE|tt.EP_CAPTURE)&&(e.piece===gn&&(r+=$n(e.from)[0]),r+="x"),r+=$n(e.to),e.promotion&&(r+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?r+="#":r+="+"),this._undoMove(),r}_moveFromSan(e,t=!1){let r=Fv(e);if(t||(r==="0-0"?r="O-O":r==="0-0-0"&&(r="O-O-O")),r==Lv)return{color:this._turn,from:0,to:0,piece:"k",flags:tt.NULL_MOVE};let a=S1(r),d=this._moves({legal:!0,piece:a});for(let k=0,$=d.length;k<$;k++)if(r===Fv(this._moveToSan(d[k],d)))return d[k];if(t)return null;let h,g,y,_,N,T=!1;if(g=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),g?(h=g[1],y=g[2],_=g[3],N=g[4],y.length==1&&(T=!0)):(g=r.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),g&&(h=g[1],y=g[2],_=g[3],N=g[4],y.length==1&&(T=!0))),a=S1(r),d=this._moves({legal:!0,piece:h||a}),!_)return null;for(let k=0,$=d.length;k<$;k++)if(y){if((!h||h.toLowerCase()==d[k].piece)&&et[y]==d[k].from&&et[_]==d[k].to&&(!N||N.toLowerCase()==d[k].promotion))return d[k];if(T){const M=$n(d[k].from);if((!h||h.toLowerCase()==d[k].piece)&&et[_]==d[k].to&&(y==M[0]||y==M[1])&&(!N||N.toLowerCase()==d[k].promotion))return d[k]}}else if(r===Fv(this._moveToSan(d[k],d)).replace("x",""))return d[k];return null}ascii(){let e=`   +------------------------+
`;for(let t=et.a8;t<=et.h1;t++){if(Od(t)===0&&(e+=" "+"87654321"[Ua(t)]+" |"),this._board[t]){const r=this._board[t].type,d=this._board[t].color===rs?r.toUpperCase():r.toLowerCase();e+=" "+d+" "}else e+=" . ";t+1&136&&(e+=`|
`,t+=8)}return e+=`   +------------------------+
`,e+="     a  b  c  d  e  f  g  h",e}perft(e){const t=this._moves({legal:!1});let r=0;const a=this._turn;for(let d=0,h=t.length;d<h;d++)this._makeMove(t[d]),this._isKingAttacked(a)||(e-1>0?r+=this.perft(e-1):r++),this._undoMove();return r}setTurn(e){return this._turn==e?!1:(this.move("--"),!0)}turn(){return this._turn}board(){const e=[];let t=[];for(let r=et.a8;r<=et.h1;r++)this._board[r]==null?t.push(null):t.push({square:$n(r),type:this._board[r].type,color:this._board[r].color}),r+1&136&&(e.push(t),t=[],r+=8);return e}squareColor(e){if(e in et){const t=et[e];return(Ua(t)+Od(t))%2===0?"light":"dark"}return null}history({verbose:e=!1}={}){const t=[],r=[];for(;this._history.length>0;)t.push(this._undoMove());for(;;){const a=t.pop();if(!a)break;e?r.push(new Tp(this,a)):r.push(this._moveToSan(a,this._moves())),this._makeMove(a)}return r}_getPositionCount(e){return this._positionCount.get(e)??0}_incPositionCount(){this._positionCount.set(this._hash,(this._positionCount.get(this._hash)??0)+1)}_decPositionCount(e){const t=this._positionCount.get(e)??0;t===1?this._positionCount.delete(e):this._positionCount.set(e,t-1)}_pruneComments(){const e=[],t={},r=a=>{a in this._comments&&(t[a]=this._comments[a])};for(;this._history.length>0;)e.push(this._undoMove());for(r(this.fen());;){const a=e.pop();if(!a)break;this._makeMove(a),r(this.fen())}this._comments=t}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){return this.removeComment()}removeComment(){const e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>({fen:e,comment:this._comments[e]}))}deleteComments(){return this.removeComments()}removeComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>{const t=this._comments[e];return delete this._comments[e],{fen:e,comment:t}})}setCastlingRights(e,t){for(const a of[bn,jo])t[a]!==void 0&&(t[a]?this._castling[e]|=Ip[a]:this._castling[e]&=~Ip[a]);this._updateCastlingRights();const r=this.getCastlingRights(e);return(t[bn]===void 0||t[bn]===r[bn])&&(t[jo]===void 0||t[jo]===r[jo])}getCastlingRights(e){return{[bn]:(this._castling[e]&Ip[bn])!==0,[jo]:(this._castling[e]&Ip[jo])!==0}}moveNumber(){return this._moveNumber}}const Py="/assets/White%20Pawn-CsxYRWps.png",Ay="/assets/White%20Rook-Bo7aN8jK.png",Ry="/assets/White%20Knight-DNZQZ2iP.png",jy="/assets/White%20Bishop-DpinRom7.png",$y="/assets/White%20Queen-BemhFu2x.png",Oy="/assets/White%20King-CC7LKORR.png",My="/assets/Black%20Pawn-BvkQ8cBr.png",Dy="/assets/Black%20Rook-B15T88c8.png",Ly="/assets/Black%20Knight-fCWnImSB.png",Fy="/assets/Black%20Bishop-CY89vPKV.png",Uy="/assets/Black%20Queen-B0QwyR23.png",zy="/assets/Black%20King-BYuYmXG4.png",HC="/assets/Mac%20Cursor%20Open%20Hand-C_Ak_Ehz.png",bm="/assets/Mac%20Cursor%20Closed%20Hand-DIpKCVw4.png",y3=["Welcome to the board. Don't blinkyou'll miss your chance.","The South Knight arrives. Let's see if you survive more than ten moves.","I hope you brought a plan. You'll need more than hope to beat me.","I don't take prisoners. Make your first move count.","The game begins. Step carefullyI strike from angles you can't see."],w3=["Your move reveals more than you think.","I see through your strategy like glass.","That square belongs to me now.","You're playing checkersI'm playing war.","The board is shrinking for you.","Pressure makes diamondsor it breaks players.","Every move you make is another chance for me to punish you.","You're opening doors you won't be able to close."],E1=["I warned youI strike from the side.","Your king looks lonely. Let me help.","Check is just the beginning.","I'm not here to trade. I'm here to crush.","You opened the door. I'm walking through."],_3=["A little chaos never hurt me.","I don't need pieces. I need initiative.","Sacrifices are the language of the brave.","I'm all-in. Try to keep up."],x3=["This board belongs to me now.","Your king is running out of places to hide.","No more tricks. Just consequences.","Every move brings you closer to checkmate.","I already see the end. Do you?"],b3=["Game over. Welcome to the South.","Checkmate. Remember the nameSouth Knight.","Another challenger falls.","You played well. I played better.","That's how a knight ends a battle."],C3=["Well played. Even warriors fall.","You earned that one. Respect.","I'll be backstronger.","Good game. Don't get comfortable."],Pp={skill:20,depth:14,label:"Strong"};function Ap(n,e){return Math.floor(Math.random()*(e-n+1))+n}function N1(n){const e=n.trim().split(/\s+/),t=e.indexOf("bestmove");if(t===-1||!e[t+1])return null;const r=e[t+1];if(r.length<4)return null;const a=r.slice(0,2),d=r.slice(2,4),h=r[4];return{from:a,to:d,promotion:h||void 0}}function k3(){const{user:n}=pr(),e=D.useRef(new at),t=D.useRef(null),r=D.useRef({value:0}),a=D.useRef(null),d=D.useRef({gameId:0,entries:[]}),[h,g]=D.useState(25),[y,_]=D.useState(!1),[N,T]=D.useState("w"),[k,$]=D.useState(""),[M,F]=D.useState(""),[H,ye]=D.useState(e.current.fen()),[le,C]=D.useState(null),[ie,c]=D.useState(null),[ze,de]=D.useState("Engine loading..."),[Ie,Je]=D.useState(!1),[Qe,Ve]=D.useState("Booting Stockfish..."),[$e,be]=D.useState(!1),[te,ee]=D.useState("w"),[Y,we]=D.useState([]),ne=D.useRef({value:0}),[X,ce]=D.useState([]),R=D.useRef({value:!1}),[q,se]=D.useState(new Set),[ve,Re]=D.useState(null),[je,qe]=D.useState(null),[Be,Ze]=D.useState([]),[gt,un]=D.useState(!1),[En,bs]=D.useState(!1),Fn=Oi(n?.boardTheme).colors,an=oe=>{typeof document>"u"||(document.body.style.cursor=oe?`url(${bm}) 8 8, grabbing`:"")};D.useEffect(()=>()=>{an(!1)},[]),D.useEffect(()=>{const oe=()=>an(!1);return window.addEventListener("mouseup",oe),window.addEventListener("dragend",oe),()=>{window.removeEventListener("mouseup",oe),window.removeEventListener("dragend",oe)}},[]);const Un=oe=>{if(R.current.value)return;R.current.value=!0;const xe=oe==="win"?150:oe==="loss"?75:112;n&&LC(n.id,xe,{source:`practice_${oe}`})},Us=oe=>{if(!oe)return null;const xe={p:Py,r:Ay,n:Ry,b:jy,q:$y,k:Oy},Ce={p:My,r:Dy,n:Ly,b:Fy,q:Uy,k:zy};return oe.color==="w"?xe[oe.type]:Ce[oe.type]},At=(oe,xe)=>{const Ce="abcdefgh"[te==="w"?xe:7-xe],Le=te==="w"?8-oe:oe+1;return`${Ce}${Le}`},zs=D.useMemo(()=>{const xe=new at(H).board();return te==="w"?xe:xe.slice().reverse().map(Ce=>Ce.slice().reverse())},[H,te]),zn=D.useMemo(()=>le?new at(H).moves({square:le,verbose:!0}):[],[H,le]),os=oe=>{we(oe?[oe]:[])},Bn=oe=>{if(!oe.length)return;const xe=oe[Math.floor(Math.random()*oe.length)];os(xe)},Yn=oe=>{const xe=ne.current.value;xe>0&&xe%5===0&&Bn(oe)},Xn=(oe,xe)=>{const Ce=At(oe,xe);se(Le=>{const ht=new Set(Le);return ht.has(Ce)?ht.delete(Ce):ht.add(Ce),ht})},as=(oe,xe)=>{const Ce=At(oe,xe);Re({row:oe,col:xe,square:Ce}),qe(null),un(!1)},Cs=(oe,xe,Ce)=>{if(!ve||Ce!==2)return;const Le=At(oe,xe);if(ve.square===Le){un(!1),qe(null);return}un(!0),qe({row:oe,col:xe,square:Le})},ls=()=>{ve&&gt&&je?(Ze(oe=>[...oe,{start:ve,end:je}]),bs(!0)):ve&&!gt&&(Xn(ve.row,ve.col),bs(!0)),un(!1),Re(null),qe(null)},Nn=(oe,xe)=>{const Ce=new at(oe),Le={p:1,n:3,b:3,r:5,q:9,k:0};let ht=0;return Ce.board().forEach(Vt=>Vt.forEach(Ft=>{if(!Ft)return;const Kt=Le[Ft.type];ht+=Ft.color===xe?Kt:-Kt})),ht};D.useEffect(()=>{if(typeof Worker>"u"){Ve("Workers are not supported in this browser."),de("Engine unavailable in this browser.");return}const xe=[typeof SharedArrayBuffer=="function"&&crossOriginIsolated?"/stockfish/stockfish.js":null,"/stockfish/stockfish-lite-single.js","/stockfish/stockfish-asm.js"].filter(Boolean),Ce=He=>new Worker(He);let Le=null;const ht=()=>{Le&&(window.clearTimeout(Le),Le=null),Le=window.setTimeout(()=>{Ve(He=>`${He} (no response yet, trying fallback...)`),Kt()},4e3)},Vt=Ce(xe[0]);Ve(`Loading engine from ${xe[0]}...`),t.current=Vt;let Ft=0;const Kt=()=>{const He=Ft+1;if(He>=xe.length){Ve("Engine failed to load."),de("Engine unavailable. Check console for details."),Je(!1);return}t.current?.terminate(),Ft=He;const bt=xe[He];Ve(`Retrying with fallback engine (${bt}).`);const wt=Ce(bt);t.current=wt,wt.onmessage=Vt.onmessage,wt.onerror=Vt.onerror,wt.postMessage("uci"),wt.postMessage("isready"),ht()},Tn=He=>{const bt=typeof He.data=="string"?He.data:typeof He.data?.data=="string"?He.data.data:"";if(bt){if(bt.includes(" multipv ")){const wt=a.current,Jt=bt.match(/multipv\s+(\d+).*?score\s+(cp|mate)\s+(-?\d+).*?\spv\s+([a-h][1-8][a-h][1-8][qrbn]?)/i);if(wt&&Jt){const Ct=Math.max(1,parseInt(Jt[1],10))-1,Qt=Jt[3],V=Jt[4],Ht=Math.random()*5*(Math.random()<.5?-1:1),Rt=parseInt(Qt,10)+Ht,tn=Jt[2]==="mate"?"mate":"cp",ge=tn==="mate"?Rt>=0?1e5-Math.abs(Rt):-1e5+Math.abs(Rt):Rt,ot=[...d.current.gameId===wt.gameId?d.current.entries:[]];ot[Ct]={move:V,score:ge,type:tn},d.current={gameId:wt.gameId,entries:ot}}}if(bt==="uciok"){Ve("Engine online. Initialising..."),ht();return}if(bt==="readyok"){Je(!0),Ve("Stockfish ready. Start a game to play."),de("Ready to play."),Le&&(window.clearTimeout(Le),Le=null);return}if(bt.startsWith("bestmove")){be(!1),Ve("Bot moved.");const wt=a.current;if(!wt||wt.gameId!==r.current.value)return;const Jt=d.current;let Ct=null;if(Jt.gameId===wt.gameId&&Jt.entries.length){const jt=[...Jt.entries].map((ot,_t)=>({...ot,idx:_t})).filter(ot=>ot?.move).sort((ot,_t)=>(_t?.score??-999999)-(ot?.score??-999999));if(jt.length){const ot=jt[0],_t=ot.score??0,tr=ot.type==="mate",Gt=ne.current.value+1;let us=ot;if(!tr&&jt.length>1){const ke=jt.slice(0,Math.min(5,jt.length)),qt=ke.filter((ks,Ss)=>Ss>0&&Ss<=4&&_t-(ks.score??_t)<=100);if(Gt===h&&_t>-500){const ks=Ap(150,250);us=ke.find(nr=>_t-(nr.score??_t)>=ks)||ke[ke.length-1],g(Gt+Ap(25,30))}else qt.length?us=qt[Ap(0,qt.length-1)]:us=ke[0]}const Ws=`bestmove ${us.move}`;Ct=N1(Ws)}}if(Ct||(Ct=N1(bt)),!Ct){de("Bot could not find a move.");return}const Qt=new at(wt.fen),V=wt.fen.includes(" w ")?"b":"w",Ht=Nn(wt.fen,V);if(!Qt.move({from:Ct.from,to:Ct.to,promotion:Ct.promotion||"q"})){de("Bot produced an invalid move.");return}e.current=Qt,ye(Qt.fen()),C(null),c(null),ce([Ct.from,Ct.to]);const tn=Nn(Qt.fen(),V),ge=tn-Ht;ne.current.value+=1,Qt.isCheckmate()?(Bn(b3),Un("loss")):Qt.isDraw()?(Un("draw"),de("Draw. Your move.")):(Qt.isCheck()?Yn(E1):ge<=-1?Yn(_3):ge>=1?Yn(E1):Qt.board().flat().filter(Boolean).length<=10&&tn>1?Yn(x3):Yn(w3),de(Qt.isCheck()?"Your move (check).":"Your move.")),a.current=null}}};return Vt.onmessage=Tn,Vt.onerror=He=>{console.error("Stockfish worker error",He);const bt=xe[Ft];Ve(`Engine failed to load from ${bt}. If on localhost, keep the Vite dev server running so the file is served.`),de("Engine unavailable. Trying fallback..."),Je(!1),Kt()},Vt.postMessage("uci"),Vt.postMessage("isready"),ht(),()=>{Le&&window.clearTimeout(Le),Vt.terminate()}},[]);const mr=oe=>{try{const xe=oe.trim().split(/\s+/),Ce=parseInt(xe[5],10);return Number.isFinite(Ce)?Ce:1}catch{return 1}},Wn=oe=>{if(!t.current||!Ie){de("Engine is not ready yet.");return}const xe=mr(oe);a.current={fen:oe,gameId:r.current.value,fullmove:xe},d.current={gameId:r.current.value,entries:[]},be(!0),Ve(`Thinking (${Pp.label})...`),t.current.postMessage("stop"),t.current.postMessage(`setoption name Skill Level value ${Pp.skill}`),t.current.postMessage("setoption name MultiPV value 5"),t.current.postMessage(`position fen ${oe}`);const Ce=Math.min(14,Math.max(12,Pp.depth));t.current.postMessage(`go depth ${Ce}`)},cs=()=>{if(!Ie){de("Engine still loading. Please wait a moment.");return}F(""),r.current.value+=1,ne.current.value=0,g(Ap(25,30));let oe="";const xe=k.trim();if(xe)try{oe=new at(xe).fen()}catch{F("Invalid FEN. Please check the format.");return}const Ce=oe?new at(oe):new at;e.current=Ce,ye(Ce.fen()),C(null),c(null),ce([]),R.current.value=!1,ee(N),be(!1),de(N==="b"?"Bot thinking...":"Your move."),_(!1),a.current=null,t.current?.postMessage("ucinewgame");const Le=Pp;t.current?.postMessage(`setoption name Skill Level value ${Le.skill}`),t.current?.postMessage(`setoption name Skill Level Probability value ${Math.min(100,Le.skill*5)}`),Bn(y3),N==="b"&&window.setTimeout(()=>Wn(Ce.fen()),250)},Jn=(oe,xe)=>{Re(null),qe(null),Ze([]),se(new Set);const Ce=At(oe,xe),Le=new at(H);if(Le.turn()!==N)return;if(le===Ce){C(null);return}const ht=Le.get(Ce);if(le){Bs(le,Ce);return}ht&&ht.color===Le.turn()&&C(Ce)},Bs=(oe,xe)=>{const Ce=new at(H);if(Ce.turn()!==N)return;if(Nn(H,N),oe===xe){C(null),c(null);return}let Le=null;try{Le=Ce.move({from:oe,to:xe,promotion:"q"})}catch{Le=null}if(!Le){C(null);return}if(e.current=Ce,ye(Ce.fen()),C(null),ce([oe,xe]),Nn(Ce.fen(),N),de(Ce.isCheckmate()?"You delivered mate!":Ce.isCheck()?"Bot in check. Bot thinking...":"Bot thinking..."),Ce.isGameOver()){Ce.isCheckmate()?(Bn(C3),Un("win")):Ce.isDraw()&&Un("draw");return}Wn(Ce.fen())};return D.useEffect(()=>{const oe=new at(H);oe.isGameOver()&&(oe.isCheckmate()?de(oe.turn()===N?"You are checkmated.":"You delivered checkmate!"):de("Game over."))},[H,N]),p.jsxs(Ar,{children:[p.jsxs("div",{className:"flex flex-col gap-4 text-white",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"text-xl font-bold flex items-center gap-2",children:[p.jsx(ME,{className:"h-5 w-5 text-emerald-300"}),"Practice vs Bot"]}),p.jsx("div",{className:"text-sm text-white/60",children:"Choose your color, then play on a live board."})]}),p.jsx("div",{})]}),p.jsxs("div",{className:"grid grid-cols-[minmax(320px,1fr)_260px] gap-4 items-start",children:[p.jsx("div",{className:"relative",children:p.jsxs("div",{className:"relative inline-block pl-8 pb-8 w-full max-w-[840px]",children:[p.jsx("div",{className:"rounded-[28px] overflow-hidden border border-white/10 shadow-[0_20px_60px_rgba(0,0,0,0.45)] w-full",style:{backgroundColor:Fn.dark},children:p.jsxs("div",{className:"relative grid grid-cols-8 grid-rows-8 w-full max-w-[840px] aspect-square mx-auto",children:[zs.map((oe,xe)=>oe.map((Ce,Le)=>{const ht=At(xe,Le),Vt=(xe+Le)%2===0,Ft=le===ht,Kt=zn.some(He=>He.to===ht),Tn=X.includes(ht);return p.jsxs("button",{onClick:()=>Jn(xe,Le),draggable:!!Ce,onDragStart:He=>{const bt=new at(H),wt=At(xe,Le),Jt=bt.get(wt);Jt&&Jt.color===bt.turn()&&bt.turn()===N?(c(wt),He.dataTransfer?.setData("text/plain",wt)):He.preventDefault()},onDragOver:He=>{ie&&He.preventDefault()},onDrop:He=>{He.preventDefault();const bt=ie||He.dataTransfer?.getData("text/plain"),wt=At(xe,Le);bt&&Bs(bt,wt),c(null),an(!1)},onDragEnd:()=>{c(null),an(!1)},onContextMenu:He=>{if(He.preventDefault(),En){bs(!1);return}!ve&&!gt&&Xn(xe,Le)},onMouseDown:He=>{He.button===2?(He.preventDefault(),an(!0),as(xe,Le)):He.button===0&&Ce&&an(!0)},onMouseEnter:He=>Cs(xe,Le,He.buttons),onMouseMove:He=>Cs(xe,Le,He.buttons),onMouseUp:He=>{He.button===2&&(He.preventDefault(),ls(),an(!1))},className:`w-full h-full flex items-center justify-center text-2xl font-semibold relative overflow-hidden ${Ft?"ring-2 ring-pink-400":""} ${Kt?"after:absolute after:h-3 after:w-3 after:rounded-full after:bg-pink-400/70":""} ${Ce?"cursor-piece":"cursor-auto"}`,style:{backgroundColor:q.has(ht)?"#ef4444":Vt?Fn.light:Fn.dark,...Ce?{"--cursor-open":`url(${HC}) 8 8, grab`,"--cursor-closed":`url(${bm}) 8 8, grabbing`}:{}},children:[Tn&&p.jsx("div",{className:"absolute inset-0 bg-yellow-400/50 pointer-events-none z-0"}),Ce?p.jsx("img",{src:Us(Ce)||"",alt:"",className:`relative z-10 w-full h-full object-contain ${Ce.color==="w"&&Ce.type==="p"?"p-0 scale-110":"p-1"} ${Ce.color==="b"&&Ce.type==="k"?"scale-110 translate-y-0.5":""}`}):null]},`${xe}-${Le}`)})),ve&&je&&p.jsxs("svg",{className:"absolute inset-0 pointer-events-none",viewBox:"0 0 100 100",children:[p.jsx("defs",{children:p.jsx("marker",{id:"arrowhead-practice-current",markerWidth:"4",markerHeight:"4",refX:"2",refY:"2",orient:"auto",children:p.jsx("path",{d:"M0,0 L0,4 L4,2 z",fill:"rgba(234,179,8,0.8)"})})}),(()=>{const oe=(Le,ht)=>({x:(ht+.5)/8*100,y:(Le+.5)/8*100}),xe=oe(ve.row,ve.col),Ce=oe(je.row,je.col);return p.jsx("line",{x1:xe.x,y1:xe.y,x2:Ce.x,y2:Ce.y,stroke:"rgba(234,179,8,0.8)",strokeWidth:"1",markerEnd:"url(#arrowhead-practice-current)"})})()]}),Be.map((oe,xe)=>p.jsxs("svg",{className:"absolute inset-0 pointer-events-none",viewBox:"0 0 100 100",children:[p.jsx("defs",{children:p.jsx("marker",{id:`arrowhead-practice-${xe}`,markerWidth:"4",markerHeight:"4",refX:"2",refY:"2",orient:"auto",children:p.jsx("path",{d:"M0,0 L0,4 L4,2 z",fill:"rgba(234,179,8,0.8)"})})}),(()=>{const Ce=(Vt,Ft)=>({x:(Ft+.5)/8*100,y:(Vt+.5)/8*100}),Le=Ce(oe.start.row,oe.start.col),ht=Ce(oe.end.row,oe.end.col);return p.jsx("line",{x1:Le.x,y1:Le.y,x2:ht.x,y2:ht.y,stroke:"rgba(234,179,8,0.8)",strokeWidth:"1",markerEnd:`url(#arrowhead-practice-${xe})`})})()]},`arrow-${xe}`))]})}),p.jsx("div",{className:"pointer-events-none absolute left-0 top-0 bottom-6 grid grid-rows-8 text-xs font-semibold text-white/80",children:(te==="w"?Array.from({length:8},(oe,xe)=>8-xe):Array.from({length:8},(oe,xe)=>xe+1)).map(oe=>p.jsx("span",{className:"flex items-center justify-end pr-2",children:oe},`rank-${oe}`))}),p.jsx("div",{className:"pointer-events-none absolute left-6 right-0 bottom-0 grid grid-cols-8 text-xs font-semibold text-white/80",children:(te==="w"?"abcdefgh".split(""):"hgfedcba".split("")).map(oe=>p.jsx("span",{className:"text-center pt-1",children:oe},`file-${oe}`))})]})}),p.jsxs("div",{className:"rounded-2xl bg-slate-900 border border-white/10 text-white p-4 shadow-xl space-y-3",children:[p.jsxs("div",{className:"w-full flex flex-col items-center gap-3",children:[p.jsx("div",{className:"w-24 h-24 rounded-2xl overflow-hidden border border-white/10 bg-white/5 shadow-lg",children:p.jsx("img",{src:xm,alt:"Bot avatar",className:"w-full h-full object-cover"})}),p.jsx("div",{className:"text-sm text-white/70",children:"The South Knight"})]}),p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("div",{className:"font-semibold",children:"Session"}),p.jsx("div",{className:"flex items-center gap-2 text-xs text-white/70",children:p.jsxs("span",{className:"flex items-center gap-1",children:[p.jsx(BE,{className:"h-4 w-4"}),N==="w"?"White":"Black"]})})]}),p.jsxs("div",{className:"rounded-xl bg-white/5 border border-white/10 p-3 text-sm text-white/80 min-h-[64px]",children:[p.jsx("div",{className:"font-semibold text-white",children:ze}),Y.length?p.jsx("div",{className:"mt-2 space-y-1",children:Y.map((oe,xe)=>p.jsx("div",{className:"leading-relaxed text-white/80",children:oe},`${oe}-${xe}`))}):p.jsx("div",{className:"mt-1 text-white/60",children:"Awaiting moves..."})]}),p.jsx("div",{className:"flex gap-2",children:p.jsx(it,{variant:"outline",className:"w-full",onClick:()=>_(!0),children:"New Game"})})]})]})]}),y&&p.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/70 px-4",children:p.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-slate-900 text-white border border-white/10 shadow-2xl",children:[p.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/10",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-lg font-semibold",children:"Start Practice Game"}),p.jsx("div",{className:"text-xs text-white/60",children:"Pick your color and bot level."})]}),p.jsx("button",{className:"p-2 rounded-full hover:bg-white/10 text-white/70",onClick:()=>_(!1),"aria-label":"Close",children:p.jsx(La,{className:"h-4 w-4"})})]}),p.jsxs("div",{className:"p-5 space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx("div",{className:"text-sm text-white/80",children:"Your color"}),p.jsx("div",{className:"flex gap-2",children:["w","b"].map(oe=>p.jsx("button",{onClick:()=>T(oe),className:`flex-1 rounded-xl border px-3 py-3 text-sm ${N===oe?"border-pink-400 bg-white/10":"border-white/10 bg-white/5"}`,children:oe==="w"?"White":"Black"},oe))})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("div",{className:"text-sm text-white/80",children:"Custom starting position (FEN)"}),p.jsx("textarea",{value:k,onChange:oe=>$(oe.target.value),placeholder:"Optional: paste FEN to start from a specific position",className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-pink-400",rows:2}),M&&p.jsx("div",{className:"text-xs text-amber-300",children:M})]}),p.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[p.jsx(it,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),p.jsx(it,{onClick:cs,disabled:!Ie,children:Ie?"Start":"Engine loading..."})]})]})]})})]})}function S3(){return p.jsx("div",{className:"min-h-screen bg-slate-950 text-white flex items-center justify-center",children:p.jsxs("div",{className:"text-center space-y-2",children:[p.jsx("div",{className:"text-3xl font-semibold",children:"404"}),p.jsx("p",{className:"text-white/70",children:"Page not found"})]})})}var pd={exports:{}},E3=pd.exports,T1;function N3(){return T1||(T1=1,(function(n,e){(function(t,r){r(e)})(E3,(function(t){var r=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Rw<"u"?Rw:typeof self<"u"?self:{};function a(M){return M&&M.__esModule&&Object.prototype.hasOwnProperty.call(M,"default")?M.default:M}var d={exports:{}};(function(M){(function(F,H){M.exports&&(M.exports=H())})(r,function(){function F(C,ie){function c(){this.constructor=C}c.prototype=ie.prototype,C.prototype=new c}function H(C,ie,c,ze){var de=Error.call(this,C);return Object.setPrototypeOf&&Object.setPrototypeOf(de,H.prototype),de.expected=ie,de.found=c,de.location=ze,de.name="SyntaxError",de}F(H,Error);function ye(C,ie,c){return c=c||" ",C.length>ie?C:(ie-=C.length,c+=c.repeat(ie),C+c.slice(0,ie))}H.prototype.format=function(C){var ie="Error: "+this.message;if(this.location){var c=null,ze;for(ze=0;ze<C.length;ze++)if(C[ze].source===this.location.source){c=C[ze].text.split(/\r\n|\n|\r/g);break}var de=this.location.start,Ie=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(de):de,Je=this.location.source+":"+Ie.line+":"+Ie.column;if(c){var Qe=this.location.end,Ve=ye("",Ie.line.toString().length," "),$e=c[de.line-1],be=de.line===Qe.line?Qe.column:$e.length+1,te=be-de.column||1;ie+=`
 --> `+Je+`
`+Ve+` |
`+Ie.line+" | "+$e+`
`+Ve+" | "+ye("",de.column-1," ")+ye("",te,"^")}else ie+=`
 at `+Je}return ie},H.buildMessage=function(C,ie){var c={literal:function($e){return'"'+de($e.text)+'"'},class:function($e){var be=$e.parts.map(function(te){return Array.isArray(te)?Ie(te[0])+"-"+Ie(te[1]):Ie(te)});return"["+($e.inverted?"^":"")+be.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function($e){return $e.description}};function ze($e){return $e.charCodeAt(0).toString(16).toUpperCase()}function de($e){return $e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(be){return"\\x0"+ze(be)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(be){return"\\x"+ze(be)})}function Ie($e){return $e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(be){return"\\x0"+ze(be)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(be){return"\\x"+ze(be)})}function Je($e){return c[$e.type]($e)}function Qe($e){var be=$e.map(Je),te,ee;if(be.sort(),be.length>0){for(te=1,ee=1;te<be.length;te++)be[te-1]!==be[te]&&(be[ee]=be[te],ee++);be.length=ee}switch(be.length){case 1:return be[0];case 2:return be[0]+" or "+be[1];default:return be.slice(0,-1).join(", ")+", or "+be[be.length-1]}}function Ve($e){return $e?'"'+de($e)+'"':"end of input"}return"Expected "+Qe(C)+" but "+Ve(ie)+" found."};function le(C,ie){ie=ie!==void 0?ie:{};var c={},ze=ie.grammarSource,de={pgn:nd,tags:Vy,game:vp,games:YC},Ie=nd,Je="\uFEFF",Qe="Event",Ve="event",$e="Site",be="site",te="Date",ee="date",Y="Round",we="round",ne="White",X="white",ce="Black",R="black",q="Result",se="result",ve="WhiteTitle",Re="Whitetitle",je="whitetitle",qe="whiteTitle",Be="BlackTitle",Ze="Blacktitle",gt="blacktitle",un="blackTitle",En="WhiteELO",bs="WhiteElo",Fn="Whiteelo",an="whiteelo",Un="whiteElo",Us="BlackELO",At="BlackElo",zs="Blackelo",zn="blackelo",os="blackElo",Bn="WhiteUSCF",Yn="WhiteUscf",Xn="Whiteuscf",as="whiteuscf",Cs="whiteUscf",ls="BlackUSCF",Nn="BlackUscf",mr="Blackuscf",Wn="blackuscf",cs="blackUscf",Jn="WhiteNA",Bs="WhiteNa",oe="Whitena",xe="whitena",Ce="whiteNa",Le="whiteNA",ht="BlackNA",Vt="BlackNa",Ft="Blackna",Kt="blackna",Tn="blackNA",He="blackNa",bt="WhiteType",wt="Whitetype",Jt="whitetype",Ct="whiteType",Qt="BlackType",V="Blacktype",Ht="blacktype",Rt="blackType",tn="EventDate",ge="Eventdate",jt="eventdate",ot="eventDate",_t="EventSponsor",tr="Eventsponsor",Gt="eventsponsor",us="eventSponsor",Ws="Section",ke="section",qt="Stage",ks="stage",Ss="Board",nr="board",ni="Opening",si="opening",ri="Variation",ds="variation",ii="SubVariation",St="Subvariation",oi="subvariation",gr="subVariation",sr="ECO",Vs="Eco",Vi="eco",ai="NIC",rr="Nic",Vn="nic",nn="Time",B="time",Q="UTCTime",G="UTCtime",De="UtcTime",Oe="Utctime",Fe="utctime",dn="utcTime",$t="UTCDate",Ja="UTCdate",Za="UtcDate",li="Utcdate",Hi="utcdate",qi="utcDate",vr="TimeControl",el="Timecontrol",ci="timecontrol",vt="timeControl",Jo="SetUp",Zo="Setup",Ki="setup",Qi="setUp",ea="FEN",Gi="Fen",ui="fen",Hs="Termination",Es="termination",qs="Annotator",Ns="annotator",jr="Mode",$r="mode",A="PlyCount",z="Plycount",Z="plycount",pe="plyCount",Me="Variant",lt="variant",Nt="WhiteRatingDiff",fn="BlackRatingDiff",sn="WhiteFideId",Ke="BlackFideId",Ot="WhiteTeam",kt="BlackTeam",Yt="Clock",ta="WhiteClock",Xd="BlackClock",Yi='"',na="\\",Xi=".",di=":",ir="/",tl="B",nl="W",Jd="N",sa="?",Ji="-",sl="+",Zn="*",fi="1-0",rl="0-1",Zi="1/2-1/2",Zd="=",il="%csl",ol="%cal",hi="%",ra="%eval",Pc="[%",ef="}",al=",",Hm="Y",Ac="G",qm="R",Km="O",Qm="C",Gm="{",Ym="[",tf="]",Xm=";",nf="clk",sf="egt",rf="emt",ll="mct",Jm="(",Zm=")",of=" ",af="e.p.",lf="O-O-O",cf="O-O",eg="@",uf="Z0",cl="+-",df="$$$",tg="#",Rc="$",eo="!!",ff="??",jc="!?",$c="?!",hf="!",pf="",mf="",to="",ng="",sg="",rg="",gf="",vf="",ia="",oa="",yf="-+",ul="",ig="",wf="",Oc="",Mc="",_f="D",Dc="x",pi=/^[ \t\n\r]/,xf=/^[\n\r]/,bf=/^[\-a-zA-Z0-9_.]/,og=/^[^"\\\r\n]/,Or=/^[0-9?]/,fs=/^[0-9]/,Ts=/^[^\n\r]/,aa=/^[RNBQKP]/,Cf=/^[RNBQ]/,kf=/^[a-h]/,Sf=/^[1-8]/,Ef=O("\uFEFF",!1),Lc=O("Event",!1),ag=O("event",!1),lg=O("Site",!1),no=O("site",!1),Fc=O("Date",!1),la=O("date",!1),Uc=O("Round",!1),Nf=O("round",!1),dl=O("White",!1),so=O("white",!1),zc=O("Black",!1),Tf=O("black",!1),fl=O("Result",!1),If=O("result",!1),Pf=O("WhiteTitle",!1),Af=O("Whitetitle",!1),Rf=O("whitetitle",!1),jf=O("whiteTitle",!1),$f=O("BlackTitle",!1),Mr=O("Blacktitle",!1),Bc=O("blacktitle",!1),Wc=O("blackTitle",!1),cg=O("WhiteELO",!1),ug=O("WhiteElo",!1),ca=O("Whiteelo",!1),dg=O("whiteelo",!1),Of=O("whiteElo",!1),Mf=O("BlackELO",!1),Mt=O("BlackElo",!1),Vc=O("Blackelo",!1),hl=O("blackelo",!1),ua=O("blackElo",!1),Df=O("WhiteUSCF",!1),Hc=O("WhiteUscf",!1),da=O("Whiteuscf",!1),pl=O("whiteuscf",!1),ro=O("whiteUscf",!1),Lf=O("BlackUSCF",!1),fg=O("BlackUscf",!1),hg=O("Blackuscf",!1),Ff=O("blackuscf",!1),ml=O("blackUscf",!1),gl=O("WhiteNA",!1),qc=O("WhiteNa",!1),Kc=O("Whitena",!1),Qc=O("whitena",!1),Gc=O("whiteNa",!1),pg=O("whiteNA",!1),Uf=O("BlackNA",!1),mg=O("BlackNa",!1),gg=O("Blackna",!1),Yc=O("blackna",!1),Dr=O("blackNA",!1),zf=O("blackNa",!1),io=O("WhiteType",!1),or=O("Whitetype",!1),fa=O("whitetype",!1),yr=O("whiteType",!1),Xc=O("BlackType",!1),vg=O("Blacktype",!1),yg=O("blacktype",!1),mi=O("blackType",!1),ha=O("EventDate",!1),oo=O("Eventdate",!1),vl=O("eventdate",!1),Jc=O("eventDate",!1),ao=O("EventSponsor",!1),Lr=O("Eventsponsor",!1),Dt=O("eventsponsor",!1),Tt=O("eventSponsor",!1),Fr=O("Section",!1),In=O("section",!1),es=O("Stage",!1),gi=O("stage",!1),lo=O("Board",!1),ts=O("board",!1),yl=O("Opening",!1),Bf=O("opening",!1),Wf=O("Variation",!1),wl=O("variation",!1),Vf=O("SubVariation",!1),wr=O("Subvariation",!1),_l=O("subvariation",!1),Zc=O("subVariation",!1),Hf=O("ECO",!1),wg=O("Eco",!1),Ur=O("eco",!1),co=O("NIC",!1),uo=O("Nic",!1),xl=O("nic",!1),bl=O("Time",!1),Is=O("time",!1),Ps=O("UTCTime",!1),vi=O("UTCtime",!1),_r=O("UtcTime",!1),xr=O("Utctime",!1),yi=O("utctime",!1),qf=O("utcTime",!1),eu=O("UTCDate",!1),tu=O("UTCdate",!1),hs=O("UtcDate",!1),ps=O("Utcdate",!1),Ut=O("utcdate",!1),Ks=O("utcDate",!1),Kf=O("TimeControl",!1),Qf=O("Timecontrol",!1),nu=O("timecontrol",!1),su=O("timeControl",!1),Gf=O("SetUp",!1),Cl=O("Setup",!1),Yf=O("setup",!1),fo=O("setUp",!1),ru=O("FEN",!1),_g=O("Fen",!1),pa=O("fen",!1),kl=O("Termination",!1),Xf=O("termination",!1),Jf=O("Annotator",!1),ho=O("annotator",!1),Zf=O("Mode",!1),Sl=O("mode",!1),El=O("PlyCount",!1),po=O("Plycount",!1),iu=O("plycount",!1),ou=O("plyCount",!1),au=O("Variant",!1),lu=O("variant",!1),mo=O("WhiteRatingDiff",!1),As=O("BlackRatingDiff",!1),wi=O("WhiteFideId",!1),cu=O("BlackFideId",!1),eh=O("WhiteTeam",!1),br=O("BlackTeam",!1),zr=O("Clock",!1),uu=O("WhiteClock",!1),th=O("BlackClock",!1),ar=By("whitespace"),ms=st([" ","	",`
`,"\r"],!1,!1),ma=st([`
`,"\r"],!1,!1),du=st(["-",["a","z"],["A","Z"],["0","9"],"_","."],!1,!1),_i=O('"',!1),nh=st(['"',"\\","\r",`
`],!0,!1),go=O("\\",!1),vn=st([["0","9"],"?"],!1,!1),Br=O(".",!1),yn=st([["0","9"]],!1,!1),Rs=O(":",!1),ga=O("/",!1),xi=O("B",!1),sh=O("W",!1),fu=O("N",!1),zt=O("?",!1),vo=O("-",!1),va=O("+",!1),Nl=O("*",!1),Tl=O("1-0",!1),hu=O("0-1",!1),bi=O("1/2-1/2",!1),Lt=O("=",!1),ln=O("%csl",!1),hn=O("%cal",!1),yo=O("%",!1),ya=O("%eval",!1),wa=O("[%",!1),rh=O("}",!1),wn=Xr(),Il=st([`
`,"\r"],!0,!1),wo=O(",",!1),pu=O("Y",!1),lr=O("G",!1),js=O("R",!1),_a=O("O",!1),mu=O("C",!1),gu=O("{",!1),ih=O("[",!1),oh=O("]",!1),ah=O(";",!1),lh=O("clk",!1),ch=O("egt",!1),uh=O("emt",!1),dh=O("mct",!1),fh=O("(",!1),xa=O(")",!1),hh=By("integer"),ba=O(" ",!1),Pl=O("e.p.",!1),ph=O("O-O-O",!1),vu=O("O-O",!1),mh=O("@",!1),gh=O("Z0",!1),yu=O("+-",!1),vh=O("$$$",!1),wu=O("#",!1),yh=O("$",!1),wh=O("!!",!1),_h=O("??",!1),xg=O("!?",!1),xh=O("?!",!1),bg=O("!",!1),Cg=O("",!1),bh=O("",!1),Ch=O("",!1),kh=O("",!1),Al=O("",!1),kg=O("",!1),Sg=O("",!1),Eg=O("",!1),Qs=O("",!1),_u=O("",!1),Rl=O("-+",!1),Sh=O("",!1),Eh=O("",!1),Nh=O("",!1),xu=O("",!1),_o=O("",!1),bu=O("D",!1),Cu=st(["R","N","B","Q","K","P"],!1,!1),Ng=st(["R","N","B","Q"],!1,!1),Th=st([["a","h"]],!1,!1),Ih=st([["1","8"]],!1,!1),ku=O("x",!1),Su=function(o,m){return m},Ph=function(o,m){return[o].concat(m)},Tg=function(o){return o},ns=function(o,m,b){var x=_p;return _p=[],{tags:o,gameComment:m,moves:b,messages:x}},Pn=function(o,m){return m},Ah=function(o,m){var b={};return[o].concat(m).forEach(function(x){b[x.name]=x.value}),b},Rh=function(o){return o===null?{}:(o.messages=_p,o)},jh=function(o){return o},$h=function(o){return{name:"Event",value:o}},Oh=function(o){return{name:"Site",value:o}},Eu=function(o){return{name:"Date",value:o}},Mh=function(o){return{name:"Round",value:o}},Nu=function(o){return{name:"WhiteTitle",value:o}},Dh=function(o){return{name:"BlackTitle",value:o}},Lh=function(o){return{name:"WhiteElo",value:o}},Tu=function(o){return{name:"BlackElo",value:o}},Iu=function(o){return{name:"WhiteUSCF",value:o}},Fh=function(o){return{name:"BlackUSCF",value:o}},Pu=function(o){return{name:"WhiteNA",value:o}},jl=function(o){return{name:"BlackNA",value:o}},Ig=function(o){return{name:"WhiteType",value:o}},Uh=function(o){return{name:"BlackType",value:o}},Au=function(o){return{name:"White",value:o}},zh=function(o){return{name:"Black",value:o}},$l=function(o){return{name:"Result",value:o}},Cr=function(o){return{name:"EventDate",value:o}},Pg=function(o){return{name:"EventSponsor",value:o}},Bh=function(o){return{name:"Section",value:o}},Ru=function(o){return{name:"Stage",value:o}},Wh=function(o){return{name:"Board",value:o}},Vh=function(o){return{name:"Opening",value:o}},Ca=function(o){return{name:"Variation",value:o}},An=function(o){return{name:"SubVariation",value:o}},Ag=function(o){return{name:"ECO",value:o}},Rg=function(o){return{name:"NIC",value:o}},Ol=function(o){return{name:"Time",value:o}},Rn=function(o){return{name:"UTCTime",value:o}},jg=function(o){return{name:"UTCDate",value:o}},Ee=function(o){return{name:"TimeControl",value:o}},xo=function(o){return{name:"SetUp",value:o}},ju=function(o){return{name:"FEN",value:o}},Hh=function(o){return{name:"Termination",value:o}},$g=function(o){return{name:"Annotator",value:o}},ka=function(o){return{name:"Mode",value:o}},Ml=function(o){return{name:"PlyCount",value:o}},$u=function(o){return{name:"Variant",value:o}},qh=function(o){return{name:"WhiteRatingDiff",value:o}},Kh=function(o){return{name:"BlackRatingDiff",value:o}},Qh=function(o){return{name:"WhiteFideId",value:o}},Ou=function(o){return{name:"BlackFideId",value:o}},Mu=function(o){return{name:"WhiteTeam",value:o}},_n=function(o){return{name:"BlackTeam",value:o}},Gs=function(o){return{name:"Clock",value:o}},Wr=function(o){return{name:"WhiteClock",value:o}},Gh=function(o){return{name:"BlackClock",value:o}},Yh=function(o,m){return Ms({key:o,value:m,message:`Format of tag: "${o}" not correct: "${m}"`}),{name:o,value:m}},Ys=function(o,m){return Ms({key:o,value:m,message:`Tag: "${o}" not known: "${m}"`}),{name:o,value:m}},Xh=function(o){return o.join("")},cr=function(o){return o.map(m=>m.char||m).join("")},Og=function(){return{type:"char",char:"\\"}},Jh=function(){return{type:"char",char:'"'}},Zh=function(o){return o},ep=function(o,m,b){return{value:""+o.join("")+"."+m.join("")+"."+b.join(""),year:Aa(o),month:Aa(m),day:Aa(b)}},tp=function(o,m,b,x){let U=o.join("")+":"+m.join("")+":"+b.join(""),J=0;return x&&(U=U+"."+x,Ms({message:`Unusual use of millis in time: ${U}`}),Aa(x)),{value:U,hour:Aa(o),minute:Aa(m),second:Aa(b),millis:J}},Mg=function(o){return o.join("")},Dl=function(o){return o},Du=function(o,m){return o+"/"+m},$s=function(o){return o},mt=function(o){return o},pn=function(o){return o||(Ms({message:"Tag TimeControl has to have a value"}),"")},Zt=function(o,m){return m},xn=function(o,m){let b=[o].concat(m);return b.value=b.map(x=>x.value).join(":"),b},gs=function(o){return o},bo=function(){return{kind:"unknown",value:"?"}},cn=function(){return{kind:"unlimited",value:"-"}},Sa=function(o,m,b){return{kind:"movesInSecondsIncrement",moves:o,seconds:m,increment:b,value:""+o+"/"+m+"+"+b}},Ci=function(o,m){return{kind:"movesInSeconds",moves:o,seconds:m,value:""+o+"/"+m}},Ll=function(o,m){return{kind:"increment",seconds:o,increment:m,value:""+o+"+"+m}},Lu=function(o){return{kind:"suddenDeath",seconds:o,value:""+o}},Ea=function(o){return{kind:"hourglass",seconds:o,value:"*"+o}},ss=function(o){return o},Fu=function(o){return o},Co=function(o){return o},kr=function(o){return o},Fl=function(o){return o},Uu=function(o){return o},Vr=function(){return 0},Ul=function(){return Ms({message:'Use "-" for an unknown value'}),0},Hr=function(o){return cv(o)},zl=function(o,m,b,x,U,J,ue,Ne){var rt=Ne||[],Et={};return Et.moveNumber=m,Et.notation=b,J&&(Et.commentAfter=J.comment),o&&(Et.commentMove=o.comment),U&&(Et.drawOffer=!0),Et.variations=ue||[],Et.nag=x||null,rt.unshift(Et),Et.commentDiag=J,rt},Na=function(o){return o},zu=function(o){return[o]},Ta=function(o,m){return m},Bl=function(o,m){return Io([o].concat(m))},Hn=function(){},qr=function(o){return o},Xs=function(o){return{comment:o}},qn=function(o,m){return m},np=function(o,m){return Io([{colorFields:o}].concat(m[0]))},Wl=function(o,m){return m},Bu=function(o,m){return Io([{colorArrows:o}].concat(m[0]))},sp=function(o,m,b){return b},Kr=function(o,m,b){var x={};return x[o]=m,Io([x].concat(b[0]))},Wu=function(o,m,b){return b},Vu=function(o,m,b){var x={};return x[o]=m,Io([x].concat(b[0]))},Qr=function(o,m){return m},Hu=function(o,m){var b={};return b.eval=parseFloat(o),Io([b].concat(m[0]))},Gr=function(o,m,b){return b},rp=function(o,m,b){var x={};return x[o]=m.join(""),Io([x].concat(b[0]))},qu=function(o,m){return m},Ku=function(o,m){return m.length>0?Io([{comment:Aw(o.join(""))}].concat(Pw(m[0]))):{comment:o.join("")}},Vl=function(o){return o},Dg=function(o){return o},Lg=function(o){return o.join("")},ip=function(o,m){var b=[];b.push(o);for(var x=0;x<m.length;x++)b.push(m[x][2]);return b},op=function(o,m){return o+m},ki=function(o,m){var b=[];b.push(o);for(var x=0;x<m.length;x++)b.push(m[x][2]);return b},Fg=function(o,m,b){return o+m+b},ko=function(){return"Y"},ap=function(){return"G"},Xt=function(){return"R"},Ug=function(){return"B"},lp=function(){return"O"},zg=function(){return"C"},Bg=function(o,m){return o+m},cp=function(){return"clk"},up=function(){return"egt"},Wg=function(){return"emt"},Os=function(){return"mct"},Qu=function(o,m,b,x){let U=m;return o?U=o+U:Ms({message:"Hours and minutes missing"}),o&&(o.match(/:/g)||[]).length==2&&o.search(":")==2&&Ms({message:"Only 1 digit for hours normally used"}),b?U+=b:Ms({message:"Only 2 digit for seconds normally used"}),x&&(Ms({message:"Unusual use of millis in clock value"}),U+="."+x),U},Vg=function(o,m,b){let x=m;return o?x=o+x:Ms({message:"Hours and minutes missing"}),o&&(o.match(/:/g)||[]).length==2&&o.search(":")==1&&Ms({message:"Only 2 digits for hours normally used"}),b?x+=b:Ms({message:"Only 2 digit for seconds normally used"}),x},Yr=function(o,m){return m?o+m:(Ms({message:"No hours found"}),o)},Hl=function(o,m){let b=o;return m?b+=m+":":b+=":",b},Si=function(o,m){let b=o;return m?b+=m+":":(b+=":",Ms({message:"Only 2 digits for minutes normally used"})),b},ql=function(o){return o},Gu=function(o,m){var b=m||[];return b.unshift(o),b},Yu=function(o){return o},Hg=function(o){return cv(o)},Xu=function(){return""},qg=function(o,m,b,x,U,J,ue){var Ne={};return Ne.fig=o||null,Ne.disc=m||null,Ne.strike=b||null,Ne.col=x,Ne.row=U,Ne.check=ue||null,Ne.promotion=J,Ne.notation=(o||"")+(m||"")+(b||"")+x+U+(J||"")+(ue||""),Ne},dp=function(o,m,b,x,U,J,ue,Ne){var rt={};return rt.fig=o||null,rt.strike=x=="x"?x:null,rt.col=U,rt.row=J,rt.notation=(o&&o!=="P"?o:"")+m+b+(x=="x"?x:"-")+U+J+(ue||"")+(Ne||""),rt.check=Ne||null,rt.promotion=ue,rt},fp=function(o,m,b,x,U,J){var ue={};return ue.fig=o||null,ue.strike=m||null,ue.col=b,ue.row=x,ue.check=J||null,ue.promotion=U,ue.notation=(o||"")+(m||"")+b+x+(U||"")+(J||""),ue},Kl=function(o){var m={};return m.notation="O-O-O"+(o||""),m.check=o||null,m},Ql=function(o){var m={};return m.notation="O-O"+(o||""),m.check=o||null,m},hp=function(o,m,b){var x={};return x.fig=o,x.drop=!0,x.col=m,x.row=b,x.notation=o+"@"+m+b,x},Ju=function(){var o={};return o.notation="Z0",o},Kg=function(o){return o[1]},pp=function(o){return o[1]},Zu=function(o){return"="+o},Gl=function(o,m){var b=m||[];return b.unshift(o),b},ed=function(o){return"$"+o},Yl=function(){return"$3"},mp=function(){return"$4"},Qg=function(){return"$5"},Xl=function(){return"$6"},Gg=function(){return"$1"},Ia=function(){return"$2"},Yg=function(){return"$3"},Jl=function(){return"$4"},s=function(){return"$5"},i=function(){return"$6"},l=function(){return"$7"},f=function(){return"$10"},v=function(){return"$13"},w=function(){return"$14"},S=function(){return"$15"},j=function(){return"$16"},L=function(){return"$17"},K=function(){return"$18"},ae=function(){return"$19"},he=function(){return"$22"},re=function(){return"$32"},Se=function(){return"$36"},Te=function(){return"$40"},Pe=function(){return"$132"},en=function(){return"$220"},u=0,E=0,W=[{line:1,column:1}],fe=0,Ae=[],I=0,Ue;if("startRule"in ie){if(!(ie.startRule in de))throw new Error(`Can't start parsing from rule "`+ie.startRule+'".');Ie=de[ie.startRule]}function Ge(){return Jg(E,u)}function O(o,m){return{type:"literal",text:o,ignoreCase:m}}function st(o,m,b){return{type:"class",parts:o,inverted:m,ignoreCase:b}}function Xr(){return{type:"any"}}function Xg(){return{type:"end"}}function By(o){return{type:"other",description:o}}function Wy(o){var m=W[o],b;if(m)return m;for(b=o-1;!W[b];)b--;for(m=W[b],m={line:m.line,column:m.column};b<o;)C.charCodeAt(b)===10?(m.line++,m.column=1):m.column++,b++;return W[o]=m,m}function Jg(o,m,b){var x=Wy(o),U=Wy(m),J={source:ze,start:{offset:o,line:x.line,column:x.column},end:{offset:m,line:U.line,column:U.column}};return J}function P(o){u<fe||(u>fe&&(fe=u,Ae=[]),Ae.push(o))}function GC(o,m,b){return new H(H.buildMessage(o,m),o,m,b)}function gp(){var o;return C.charCodeAt(u)===65279?(o=Je,u++):(o=c,I===0&&P(Ef)),o}function YC(){var o,m,b,x,U,J;if(o=u,gp(),me(),m=u,b=vp(),b!==c){for(x=[],U=u,me(),J=vp(),J!==c?(E=U,U=Su(b,J)):(u=U,U=c);U!==c;)x.push(U),U=u,me(),J=vp(),J!==c?(E=U,U=Su(b,J)):(u=U,U=c);E=m,m=Ph(b,x)}else u=m,m=c;return m===c&&(m=null),E=o,o=Tg(m),o}function vp(){var o,m,b,x;return o=u,gp(),m=Vy(),b=nv(),b===c&&(b=null),x=nd(),x!==c?(E=o,o=ns(m,b,x)):(u=o,o=c),o}function Vy(){var o,m,b,x,U,J;if(o=u,gp(),me(),m=u,b=Zg(),b!==c){for(x=[],U=u,me(),J=Zg(),J!==c?(E=U,U=Pn(b,J)):(u=U,U=c);U!==c;)x.push(U),U=u,me(),J=Zg(),J!==c?(E=U,U=Pn(b,J)):(u=U,U=c);E=m,m=Ah(b,x)}else u=m,m=c;return m===c&&(m=null),b=me(),E=o,o=Rh(m),o}function Zg(){var o,m,b,x;return o=u,m=Pa(),m!==c?(me(),b=XC(),b!==c?(me(),x=So(),x!==c?(E=o,o=jh(b)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o}function XC(){var o,m,b,x,U;return o=u,m=JC(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=$h(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=ZC(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Oh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=qy(),m!==c?(b=me(),x=ev(),x!==c?(E=o,o=Eu(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=ek(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Mh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=sk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Nu(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=rk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Dh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Qy(),m!==c?(b=me(),x=mw(),x!==c?(E=o,o=Lh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Gy(),m!==c?(b=me(),x=mw(),x!==c?(E=o,o=Tu(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Yy(),m!==c?(b=me(),x=td(),x!==c?(E=o,o=Iu(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Xy(),m!==c?(b=me(),x=td(),x!==c?(E=o,o=Fh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=ik(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Pu(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=ok(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=jl(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=ak(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Ig(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=lk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Uh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=tk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Au(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=nk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=zh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Ky(),m!==c?(b=me(),x=Mk(),x!==c?(E=o,o=$l(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Jy(),m!==c?(b=me(),x=ev(),x!==c?(E=o,o=Cr(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=ck(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Pg(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=uk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Bh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=dk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Ru(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Zy(),m!==c?(b=me(),x=td(),x!==c?(E=o,o=Wh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=fk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Vh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=hk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Ca(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=pk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=An(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=mk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Ag(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=gk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Rg(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=ew(),m!==c?(b=me(),x=uw(),x!==c?(E=o,o=Ol(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=tw(),m!==c?(b=me(),x=uw(),x!==c?(E=o,o=Rn(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=nw(),m!==c?(b=me(),x=ev(),x!==c?(E=o,o=jg(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=sw(),m!==c?(b=me(),x=$k(),x!==c?(E=o,o=Ee(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=vk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=xo(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=yk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=ju(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=wk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Hh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=_k(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=$g(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=xk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=ka(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=rw(),m!==c?(b=me(),x=td(),x!==c?(E=o,o=Ml(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=bk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=$u(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Ck(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=qh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=kk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Kh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Sk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Qh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Ek(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Ou(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Nk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=Mu(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Tk(),m!==c?(b=me(),x=yt(),x!==c?(E=o,o=_n(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=iw(),m!==c?(b=me(),x=Ak(),x!==c?(E=o,o=Gs(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=ow(),m!==c?(b=me(),x=fw(),x!==c?(E=o,o=Wr(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=aw(),m!==c?(b=me(),x=fw(),x!==c?(E=o,o=Gh(x)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=u,I++,b=Hy(),I--,b!==c?(u=m,m=void 0):m=c,m!==c?(b=yp(),x=me(),U=yt(),U!==c?(E=o,o=Yh(b,U)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=u,I++,b=Hy(),I--,b===c?m=void 0:(u=m,m=c),m!==c?(b=yp(),x=me(),U=yt(),U!==c?(E=o,o=Ys(b,U)):(u=o,o=c)):(u=o,o=c))))))))))))))))))))))))))))))))))))))))))))))))),o}function Hy(){var o;return o=qy(),o===c&&(o=Qy(),o===c&&(o=Gy(),o===c&&(o=Yy(),o===c&&(o=Xy(),o===c&&(o=Ky(),o===c&&(o=Jy(),o===c&&(o=Zy(),o===c&&(o=ew(),o===c&&(o=tw(),o===c&&(o=nw(),o===c&&(o=sw(),o===c&&(o=rw(),o===c&&(o=iw(),o===c&&(o=ow(),o===c&&(o=aw()))))))))))))))),o}function JC(){var o;return C.substr(u,5)===Qe?(o=Qe,u+=5):(o=c,I===0&&P(Lc)),o===c&&(C.substr(u,5)===Ve?(o=Ve,u+=5):(o=c,I===0&&P(ag))),o}function ZC(){var o;return C.substr(u,4)===$e?(o=$e,u+=4):(o=c,I===0&&P(lg)),o===c&&(C.substr(u,4)===be?(o=be,u+=4):(o=c,I===0&&P(no))),o}function qy(){var o;return C.substr(u,4)===te?(o=te,u+=4):(o=c,I===0&&P(Fc)),o===c&&(C.substr(u,4)===ee?(o=ee,u+=4):(o=c,I===0&&P(la))),o}function ek(){var o;return C.substr(u,5)===Y?(o=Y,u+=5):(o=c,I===0&&P(Uc)),o===c&&(C.substr(u,5)===we?(o=we,u+=5):(o=c,I===0&&P(Nf))),o}function tk(){var o;return C.substr(u,5)===ne?(o=ne,u+=5):(o=c,I===0&&P(dl)),o===c&&(C.substr(u,5)===X?(o=X,u+=5):(o=c,I===0&&P(so))),o}function nk(){var o;return C.substr(u,5)===ce?(o=ce,u+=5):(o=c,I===0&&P(zc)),o===c&&(C.substr(u,5)===R?(o=R,u+=5):(o=c,I===0&&P(Tf))),o}function Ky(){var o;return C.substr(u,6)===q?(o=q,u+=6):(o=c,I===0&&P(fl)),o===c&&(C.substr(u,6)===se?(o=se,u+=6):(o=c,I===0&&P(If))),o}function sk(){var o;return C.substr(u,10)===ve?(o=ve,u+=10):(o=c,I===0&&P(Pf)),o===c&&(C.substr(u,10)===Re?(o=Re,u+=10):(o=c,I===0&&P(Af)),o===c&&(C.substr(u,10)===je?(o=je,u+=10):(o=c,I===0&&P(Rf)),o===c&&(C.substr(u,10)===qe?(o=qe,u+=10):(o=c,I===0&&P(jf))))),o}function rk(){var o;return C.substr(u,10)===Be?(o=Be,u+=10):(o=c,I===0&&P($f)),o===c&&(C.substr(u,10)===Ze?(o=Ze,u+=10):(o=c,I===0&&P(Mr)),o===c&&(C.substr(u,10)===gt?(o=gt,u+=10):(o=c,I===0&&P(Bc)),o===c&&(C.substr(u,10)===un?(o=un,u+=10):(o=c,I===0&&P(Wc))))),o}function Qy(){var o;return C.substr(u,8)===En?(o=En,u+=8):(o=c,I===0&&P(cg)),o===c&&(C.substr(u,8)===bs?(o=bs,u+=8):(o=c,I===0&&P(ug)),o===c&&(C.substr(u,8)===Fn?(o=Fn,u+=8):(o=c,I===0&&P(ca)),o===c&&(C.substr(u,8)===an?(o=an,u+=8):(o=c,I===0&&P(dg)),o===c&&(C.substr(u,8)===Un?(o=Un,u+=8):(o=c,I===0&&P(Of)))))),o}function Gy(){var o;return C.substr(u,8)===Us?(o=Us,u+=8):(o=c,I===0&&P(Mf)),o===c&&(C.substr(u,8)===At?(o=At,u+=8):(o=c,I===0&&P(Mt)),o===c&&(C.substr(u,8)===zs?(o=zs,u+=8):(o=c,I===0&&P(Vc)),o===c&&(C.substr(u,8)===zn?(o=zn,u+=8):(o=c,I===0&&P(hl)),o===c&&(C.substr(u,8)===os?(o=os,u+=8):(o=c,I===0&&P(ua)))))),o}function Yy(){var o;return C.substr(u,9)===Bn?(o=Bn,u+=9):(o=c,I===0&&P(Df)),o===c&&(C.substr(u,9)===Yn?(o=Yn,u+=9):(o=c,I===0&&P(Hc)),o===c&&(C.substr(u,9)===Xn?(o=Xn,u+=9):(o=c,I===0&&P(da)),o===c&&(C.substr(u,9)===as?(o=as,u+=9):(o=c,I===0&&P(pl)),o===c&&(C.substr(u,9)===Cs?(o=Cs,u+=9):(o=c,I===0&&P(ro)))))),o}function Xy(){var o;return C.substr(u,9)===ls?(o=ls,u+=9):(o=c,I===0&&P(Lf)),o===c&&(C.substr(u,9)===Nn?(o=Nn,u+=9):(o=c,I===0&&P(fg)),o===c&&(C.substr(u,9)===mr?(o=mr,u+=9):(o=c,I===0&&P(hg)),o===c&&(C.substr(u,9)===Wn?(o=Wn,u+=9):(o=c,I===0&&P(Ff)),o===c&&(C.substr(u,9)===cs?(o=cs,u+=9):(o=c,I===0&&P(ml)))))),o}function ik(){var o;return C.substr(u,7)===Jn?(o=Jn,u+=7):(o=c,I===0&&P(gl)),o===c&&(C.substr(u,7)===Bs?(o=Bs,u+=7):(o=c,I===0&&P(qc)),o===c&&(C.substr(u,7)===oe?(o=oe,u+=7):(o=c,I===0&&P(Kc)),o===c&&(C.substr(u,7)===xe?(o=xe,u+=7):(o=c,I===0&&P(Qc)),o===c&&(C.substr(u,7)===Ce?(o=Ce,u+=7):(o=c,I===0&&P(Gc)),o===c&&(C.substr(u,7)===Le?(o=Le,u+=7):(o=c,I===0&&P(pg))))))),o}function ok(){var o;return C.substr(u,7)===ht?(o=ht,u+=7):(o=c,I===0&&P(Uf)),o===c&&(C.substr(u,7)===Vt?(o=Vt,u+=7):(o=c,I===0&&P(mg)),o===c&&(C.substr(u,7)===Ft?(o=Ft,u+=7):(o=c,I===0&&P(gg)),o===c&&(C.substr(u,7)===Kt?(o=Kt,u+=7):(o=c,I===0&&P(Yc)),o===c&&(C.substr(u,7)===Tn?(o=Tn,u+=7):(o=c,I===0&&P(Dr)),o===c&&(C.substr(u,7)===He?(o=He,u+=7):(o=c,I===0&&P(zf))))))),o}function ak(){var o;return C.substr(u,9)===bt?(o=bt,u+=9):(o=c,I===0&&P(io)),o===c&&(C.substr(u,9)===wt?(o=wt,u+=9):(o=c,I===0&&P(or)),o===c&&(C.substr(u,9)===Jt?(o=Jt,u+=9):(o=c,I===0&&P(fa)),o===c&&(C.substr(u,9)===Ct?(o=Ct,u+=9):(o=c,I===0&&P(yr))))),o}function lk(){var o;return C.substr(u,9)===Qt?(o=Qt,u+=9):(o=c,I===0&&P(Xc)),o===c&&(C.substr(u,9)===V?(o=V,u+=9):(o=c,I===0&&P(vg)),o===c&&(C.substr(u,9)===Ht?(o=Ht,u+=9):(o=c,I===0&&P(yg)),o===c&&(C.substr(u,9)===Rt?(o=Rt,u+=9):(o=c,I===0&&P(mi))))),o}function Jy(){var o;return C.substr(u,9)===tn?(o=tn,u+=9):(o=c,I===0&&P(ha)),o===c&&(C.substr(u,9)===ge?(o=ge,u+=9):(o=c,I===0&&P(oo)),o===c&&(C.substr(u,9)===jt?(o=jt,u+=9):(o=c,I===0&&P(vl)),o===c&&(C.substr(u,9)===ot?(o=ot,u+=9):(o=c,I===0&&P(Jc))))),o}function ck(){var o;return C.substr(u,12)===_t?(o=_t,u+=12):(o=c,I===0&&P(ao)),o===c&&(C.substr(u,12)===tr?(o=tr,u+=12):(o=c,I===0&&P(Lr)),o===c&&(C.substr(u,12)===Gt?(o=Gt,u+=12):(o=c,I===0&&P(Dt)),o===c&&(C.substr(u,12)===us?(o=us,u+=12):(o=c,I===0&&P(Tt))))),o}function uk(){var o;return C.substr(u,7)===Ws?(o=Ws,u+=7):(o=c,I===0&&P(Fr)),o===c&&(C.substr(u,7)===ke?(o=ke,u+=7):(o=c,I===0&&P(In))),o}function dk(){var o;return C.substr(u,5)===qt?(o=qt,u+=5):(o=c,I===0&&P(es)),o===c&&(C.substr(u,5)===ks?(o=ks,u+=5):(o=c,I===0&&P(gi))),o}function Zy(){var o;return C.substr(u,5)===Ss?(o=Ss,u+=5):(o=c,I===0&&P(lo)),o===c&&(C.substr(u,5)===nr?(o=nr,u+=5):(o=c,I===0&&P(ts))),o}function fk(){var o;return C.substr(u,7)===ni?(o=ni,u+=7):(o=c,I===0&&P(yl)),o===c&&(C.substr(u,7)===si?(o=si,u+=7):(o=c,I===0&&P(Bf))),o}function hk(){var o;return C.substr(u,9)===ri?(o=ri,u+=9):(o=c,I===0&&P(Wf)),o===c&&(C.substr(u,9)===ds?(o=ds,u+=9):(o=c,I===0&&P(wl))),o}function pk(){var o;return C.substr(u,12)===ii?(o=ii,u+=12):(o=c,I===0&&P(Vf)),o===c&&(C.substr(u,12)===St?(o=St,u+=12):(o=c,I===0&&P(wr)),o===c&&(C.substr(u,12)===oi?(o=oi,u+=12):(o=c,I===0&&P(_l)),o===c&&(C.substr(u,12)===gr?(o=gr,u+=12):(o=c,I===0&&P(Zc))))),o}function mk(){var o;return C.substr(u,3)===sr?(o=sr,u+=3):(o=c,I===0&&P(Hf)),o===c&&(C.substr(u,3)===Vs?(o=Vs,u+=3):(o=c,I===0&&P(wg)),o===c&&(C.substr(u,3)===Vi?(o=Vi,u+=3):(o=c,I===0&&P(Ur)))),o}function gk(){var o;return C.substr(u,3)===ai?(o=ai,u+=3):(o=c,I===0&&P(co)),o===c&&(C.substr(u,3)===rr?(o=rr,u+=3):(o=c,I===0&&P(uo)),o===c&&(C.substr(u,3)===Vn?(o=Vn,u+=3):(o=c,I===0&&P(xl)))),o}function ew(){var o;return C.substr(u,4)===nn?(o=nn,u+=4):(o=c,I===0&&P(bl)),o===c&&(C.substr(u,4)===B?(o=B,u+=4):(o=c,I===0&&P(Is))),o}function tw(){var o;return C.substr(u,7)===Q?(o=Q,u+=7):(o=c,I===0&&P(Ps)),o===c&&(C.substr(u,7)===G?(o=G,u+=7):(o=c,I===0&&P(vi)),o===c&&(C.substr(u,7)===De?(o=De,u+=7):(o=c,I===0&&P(_r)),o===c&&(C.substr(u,7)===Oe?(o=Oe,u+=7):(o=c,I===0&&P(xr)),o===c&&(C.substr(u,7)===Fe?(o=Fe,u+=7):(o=c,I===0&&P(yi)),o===c&&(C.substr(u,7)===dn?(o=dn,u+=7):(o=c,I===0&&P(qf))))))),o}function nw(){var o;return C.substr(u,7)===$t?(o=$t,u+=7):(o=c,I===0&&P(eu)),o===c&&(C.substr(u,7)===Ja?(o=Ja,u+=7):(o=c,I===0&&P(tu)),o===c&&(C.substr(u,7)===Za?(o=Za,u+=7):(o=c,I===0&&P(hs)),o===c&&(C.substr(u,7)===li?(o=li,u+=7):(o=c,I===0&&P(ps)),o===c&&(C.substr(u,7)===Hi?(o=Hi,u+=7):(o=c,I===0&&P(Ut)),o===c&&(C.substr(u,7)===qi?(o=qi,u+=7):(o=c,I===0&&P(Ks))))))),o}function sw(){var o;return C.substr(u,11)===vr?(o=vr,u+=11):(o=c,I===0&&P(Kf)),o===c&&(C.substr(u,11)===el?(o=el,u+=11):(o=c,I===0&&P(Qf)),o===c&&(C.substr(u,11)===ci?(o=ci,u+=11):(o=c,I===0&&P(nu)),o===c&&(C.substr(u,11)===vt?(o=vt,u+=11):(o=c,I===0&&P(su))))),o}function vk(){var o;return C.substr(u,5)===Jo?(o=Jo,u+=5):(o=c,I===0&&P(Gf)),o===c&&(C.substr(u,5)===Zo?(o=Zo,u+=5):(o=c,I===0&&P(Cl)),o===c&&(C.substr(u,5)===Ki?(o=Ki,u+=5):(o=c,I===0&&P(Yf)),o===c&&(C.substr(u,5)===Qi?(o=Qi,u+=5):(o=c,I===0&&P(fo))))),o}function yk(){var o;return C.substr(u,3)===ea?(o=ea,u+=3):(o=c,I===0&&P(ru)),o===c&&(C.substr(u,3)===Gi?(o=Gi,u+=3):(o=c,I===0&&P(_g)),o===c&&(C.substr(u,3)===ui?(o=ui,u+=3):(o=c,I===0&&P(pa)))),o}function wk(){var o;return C.substr(u,11)===Hs?(o=Hs,u+=11):(o=c,I===0&&P(kl)),o===c&&(C.substr(u,11)===Es?(o=Es,u+=11):(o=c,I===0&&P(Xf))),o}function _k(){var o;return C.substr(u,9)===qs?(o=qs,u+=9):(o=c,I===0&&P(Jf)),o===c&&(C.substr(u,9)===Ns?(o=Ns,u+=9):(o=c,I===0&&P(ho))),o}function xk(){var o;return C.substr(u,4)===jr?(o=jr,u+=4):(o=c,I===0&&P(Zf)),o===c&&(C.substr(u,4)===$r?(o=$r,u+=4):(o=c,I===0&&P(Sl))),o}function rw(){var o;return C.substr(u,8)===A?(o=A,u+=8):(o=c,I===0&&P(El)),o===c&&(C.substr(u,8)===z?(o=z,u+=8):(o=c,I===0&&P(po)),o===c&&(C.substr(u,8)===Z?(o=Z,u+=8):(o=c,I===0&&P(iu)),o===c&&(C.substr(u,8)===pe?(o=pe,u+=8):(o=c,I===0&&P(ou))))),o}function bk(){var o;return C.substr(u,7)===Me?(o=Me,u+=7):(o=c,I===0&&P(au)),o===c&&(C.substr(u,7)===lt?(o=lt,u+=7):(o=c,I===0&&P(lu))),o}function Ck(){var o;return C.substr(u,15)===Nt?(o=Nt,u+=15):(o=c,I===0&&P(mo)),o}function kk(){var o;return C.substr(u,15)===fn?(o=fn,u+=15):(o=c,I===0&&P(As)),o}function Sk(){var o;return C.substr(u,11)===sn?(o=sn,u+=11):(o=c,I===0&&P(wi)),o}function Ek(){var o;return C.substr(u,11)===Ke?(o=Ke,u+=11):(o=c,I===0&&P(cu)),o}function Nk(){var o;return C.substr(u,9)===Ot?(o=Ot,u+=9):(o=c,I===0&&P(eh)),o}function Tk(){var o;return C.substr(u,9)===kt?(o=kt,u+=9):(o=c,I===0&&P(br)),o}function iw(){var o;return C.substr(u,5)===Yt?(o=Yt,u+=5):(o=c,I===0&&P(zr)),o}function ow(){var o;return C.substr(u,10)===ta?(o=ta,u+=10):(o=c,I===0&&P(uu)),o}function aw(){var o;return C.substr(u,10)===Xd?(o=Xd,u+=10):(o=c,I===0&&P(th)),o}function me(){var o,m;for(I++,o=[],pi.test(C.charAt(u))?(m=C.charAt(u),u++):(m=c,I===0&&P(ms));m!==c;)o.push(m),pi.test(C.charAt(u))?(m=C.charAt(u),u++):(m=c,I===0&&P(ms));return I--,m=c,I===0&&P(ar),o}function Zl(){var o,m;if(o=[],pi.test(C.charAt(u))?(m=C.charAt(u),u++):(m=c,I===0&&P(ms)),m!==c)for(;m!==c;)o.push(m),pi.test(C.charAt(u))?(m=C.charAt(u),u++):(m=c,I===0&&P(ms));else o=c;return o}function Ik(){var o,m;if(o=[],xf.test(C.charAt(u))?(m=C.charAt(u),u++):(m=c,I===0&&P(ma)),m!==c)for(;m!==c;)o.push(m),xf.test(C.charAt(u))?(m=C.charAt(u),u++):(m=c,I===0&&P(ma));else o=c;return o}function yp(){var o,m,b;for(o=u,m=[],bf.test(C.charAt(u))?(b=C.charAt(u),u++):(b=c,I===0&&P(du));b!==c;)m.push(b),bf.test(C.charAt(u))?(b=C.charAt(u),u++):(b=c,I===0&&P(du));return E=o,m=Xh(m),o=m,o}function jn(){var o;return C.charCodeAt(u)===34?(o=Yi,u++):(o=c,I===0&&P(_i)),o}function yt(){var o,m,b,x,U;if(o=u,C.charCodeAt(u)===34?(m=Yi,u++):(m=c,I===0&&P(_i)),m!==c){for(cw(),b=[],x=lw();x!==c;)b.push(x),x=lw();x=cw(),C.charCodeAt(u)===34?(U=Yi,u++):(U=c,I===0&&P(_i)),U!==c?(E=o,o=cr(b)):(u=o,o=c)}else u=o,o=c;return o}function lw(){var o,m,b,x;return og.test(C.charAt(u))?(o=C.charAt(u),u++):(o=c,I===0&&P(nh)),o===c&&(o=u,m=Pk(),m!==c?(b=u,C.charCodeAt(u)===92?(x=na,u++):(x=c,I===0&&P(go)),x!==c&&(E=b,x=Og()),b=x,b===c&&(b=u,C.charCodeAt(u)===34?(x=Yi,u++):(x=c,I===0&&P(_i)),x!==c&&(E=b,x=Jh()),b=x),b!==c?(E=o,o=Zh(b)):(u=o,o=c)):(u=o,o=c)),o}function cw(){var o,m;for(I++,o=[],pi.test(C.charAt(u))?(m=C.charAt(u),u++):(m=c,I===0&&P(ms));m!==c;)o.push(m),pi.test(C.charAt(u))?(m=C.charAt(u),u++):(m=c,I===0&&P(ms));return I--,m=c,I===0&&P(ar),o}function Pk(){var o;return C.charCodeAt(u)===92?(o=na,u++):(o=c,I===0&&P(go)),o}function ev(){var o,m,b,x,U,J,ue,Ne,rt;return o=u,m=jn(),m!==c?(b=u,Or.test(C.charAt(u))?(x=C.charAt(u),u++):(x=c,I===0&&P(vn)),x!==c?(Or.test(C.charAt(u))?(U=C.charAt(u),u++):(U=c,I===0&&P(vn)),U!==c?(Or.test(C.charAt(u))?(J=C.charAt(u),u++):(J=c,I===0&&P(vn)),J!==c?(Or.test(C.charAt(u))?(ue=C.charAt(u),u++):(ue=c,I===0&&P(vn)),ue!==c?(x=[x,U,J,ue],b=x):(u=b,b=c)):(u=b,b=c)):(u=b,b=c)):(u=b,b=c),b!==c?(C.charCodeAt(u)===46?(x=Xi,u++):(x=c,I===0&&P(Br)),x!==c?(U=u,Or.test(C.charAt(u))?(J=C.charAt(u),u++):(J=c,I===0&&P(vn)),J!==c?(Or.test(C.charAt(u))?(ue=C.charAt(u),u++):(ue=c,I===0&&P(vn)),ue!==c?(J=[J,ue],U=J):(u=U,U=c)):(u=U,U=c),U!==c?(C.charCodeAt(u)===46?(J=Xi,u++):(J=c,I===0&&P(Br)),J!==c?(ue=u,Or.test(C.charAt(u))?(Ne=C.charAt(u),u++):(Ne=c,I===0&&P(vn)),Ne!==c?(Or.test(C.charAt(u))?(rt=C.charAt(u),u++):(rt=c,I===0&&P(vn)),rt!==c?(Ne=[Ne,rt],ue=Ne):(u=ue,ue=c)):(u=ue,ue=c),ue!==c?(Ne=jn(),Ne!==c?(E=o,o=ep(b,U,ue)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o}function uw(){var o,m,b,x,U,J,ue,Ne,rt;if(o=u,m=jn(),m!==c){if(b=[],fs.test(C.charAt(u))?(x=C.charAt(u),u++):(x=c,I===0&&P(yn)),x!==c)for(;x!==c;)b.push(x),fs.test(C.charAt(u))?(x=C.charAt(u),u++):(x=c,I===0&&P(yn));else b=c;if(b!==c)if(C.charCodeAt(u)===58?(x=di,u++):(x=c,I===0&&P(Rs)),x!==c){if(U=[],fs.test(C.charAt(u))?(J=C.charAt(u),u++):(J=c,I===0&&P(yn)),J!==c)for(;J!==c;)U.push(J),fs.test(C.charAt(u))?(J=C.charAt(u),u++):(J=c,I===0&&P(yn));else U=c;if(U!==c)if(C.charCodeAt(u)===58?(J=di,u++):(J=c,I===0&&P(Rs)),J!==c){if(ue=[],fs.test(C.charAt(u))?(Ne=C.charAt(u),u++):(Ne=c,I===0&&P(yn)),Ne!==c)for(;Ne!==c;)ue.push(Ne),fs.test(C.charAt(u))?(Ne=C.charAt(u),u++):(Ne=c,I===0&&P(yn));else ue=c;ue!==c?(Ne=dw(),Ne===c&&(Ne=null),rt=jn(),rt!==c?(E=o,o=tp(b,U,ue,Ne)):(u=o,o=c)):(u=o,o=c)}else u=o,o=c;else u=o,o=c}else u=o,o=c;else u=o,o=c}else u=o,o=c;return o}function dw(){var o,m,b,x;if(o=u,C.charCodeAt(u)===46?(m=Xi,u++):(m=c,I===0&&P(Br)),m!==c){if(b=[],fs.test(C.charAt(u))?(x=C.charAt(u),u++):(x=c,I===0&&P(yn)),x!==c)for(;x!==c;)b.push(x),fs.test(C.charAt(u))?(x=C.charAt(u),u++):(x=c,I===0&&P(yn));else b=c;b!==c?(E=o,o=Mg(b)):(u=o,o=c)}else u=o,o=c;return o}function Ak(){var o,m,b,x;return o=u,m=jn(),m!==c?(b=Rk(),b!==c?(x=jn(),x!==c?(E=o,o=Dl(b)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o}function Rk(){var o,m,b,x;return o=u,m=jk(),m!==c?(C.charCodeAt(u)===47?(b=ir,u++):(b=c,I===0&&P(ga)),b!==c?(x=hw(),x!==c?(E=o,o=Du(m,x)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o}function jk(){var o;return C.charCodeAt(u)===66?(o=tl,u++):(o=c,I===0&&P(xi)),o===c&&(C.charCodeAt(u)===87?(o=nl,u++):(o=c,I===0&&P(sh)),o===c&&(C.charCodeAt(u)===78?(o=Jd,u++):(o=c,I===0&&P(fu)))),o}function fw(){var o,m,b,x;return o=u,m=jn(),m!==c?(b=hw(),b!==c?(x=jn(),x!==c?(E=o,o=$s(b)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o}function hw(){var o,m;return o=u,m=xw(),m!==c&&(E=o,m=mt(m)),o=m,o}function $k(){var o,m,b,x;return o=u,m=jn(),m!==c?(b=Ok(),x=jn(),x!==c?(E=o,o=pn(b)):(u=o,o=c)):(u=o,o=c),o}function Ok(){var o,m,b,x,U,J,ue;if(o=u,m=u,b=tv(),b!==c){for(x=[],U=u,C.charCodeAt(u)===58?(J=di,u++):(J=c,I===0&&P(Rs)),J!==c?(ue=tv(),ue!==c?(E=U,U=Zt(b,ue)):(u=U,U=c)):(u=U,U=c);U!==c;)x.push(U),U=u,C.charCodeAt(u)===58?(J=di,u++):(J=c,I===0&&P(Rs)),J!==c?(ue=tv(),ue!==c?(E=U,U=Zt(b,ue)):(u=U,U=c)):(u=U,U=c);E=m,m=xn(b,x)}else u=m,m=c;return m===c&&(m=null),E=o,m=gs(m),o=m,o}function tv(){var o,m,b,x,U,J;return o=u,C.charCodeAt(u)===63?(m=sa,u++):(m=c,I===0&&P(zt)),m!==c&&(E=o,m=bo()),o=m,o===c&&(o=u,C.charCodeAt(u)===45?(m=Ji,u++):(m=c,I===0&&P(vo)),m!==c&&(E=o,m=cn()),o=m,o===c&&(o=u,m=Sr(),m!==c?(C.charCodeAt(u)===47?(b=ir,u++):(b=c,I===0&&P(ga)),b!==c?(x=Sr(),x!==c?(C.charCodeAt(u)===43?(U=sl,u++):(U=c,I===0&&P(va)),U!==c?(J=Sr(),J!==c?(E=o,o=Sa(m,x,J)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Sr(),m!==c?(C.charCodeAt(u)===47?(b=ir,u++):(b=c,I===0&&P(ga)),b!==c?(x=Sr(),x!==c?(E=o,o=Ci(m,x)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Sr(),m!==c?(C.charCodeAt(u)===43?(b=sl,u++):(b=c,I===0&&P(va)),b!==c?(x=Sr(),x!==c?(E=o,o=Ll(m,x)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Sr(),m!==c&&(E=o,m=Lu(m)),o=m,o===c&&(o=u,C.charCodeAt(u)===42?(m=Zn,u++):(m=c,I===0&&P(Nl)),m!==c?(b=Sr(),b!==c?(E=o,o=Ea(b)):(u=o,o=c)):(u=o,o=c))))))),o}function Mk(){var o,m,b,x;return o=u,m=jn(),m!==c?(b=pw(),b!==c?(x=jn(),x!==c?(E=o,o=ss(b)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o}function pw(){var o,m;return o=u,C.substr(u,3)===fi?(m=fi,u+=3):(m=c,I===0&&P(Tl)),m!==c&&(E=o,m=Fu(m)),o=m,o===c&&(o=u,C.substr(u,3)===rl?(m=rl,u+=3):(m=c,I===0&&P(hu)),m!==c&&(E=o,m=Co(m)),o=m,o===c&&(o=u,C.substr(u,7)===Zi?(m=Zi,u+=7):(m=c,I===0&&P(bi)),m!==c&&(E=o,m=kr(m)),o=m,o===c&&(o=u,C.charCodeAt(u)===42?(m=Zn,u++):(m=c,I===0&&P(Nl)),m!==c&&(E=o,m=Fl(m)),o=m))),o}function mw(){var o,m,b,x;return o=u,m=td(),m!==c&&(E=o,m=Uu(m)),o=m,o===c&&(o=u,m=jn(),m!==c?(C.charCodeAt(u)===45?(b=Ji,u++):(b=c,I===0&&P(vo)),b!==c?(x=jn(),x!==c?(E=o,o=Vr()):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=jn(),m!==c?(b=jn(),b!==c?(E=o,o=Ul()):(u=o,o=c)):(u=o,o=c))),o}function td(){var o,m,b,x;if(o=u,m=jn(),m!==c){if(b=[],fs.test(C.charAt(u))?(x=C.charAt(u),u++):(x=c,I===0&&P(yn)),x!==c)for(;x!==c;)b.push(x),fs.test(C.charAt(u))?(x=C.charAt(u),u++):(x=c,I===0&&P(yn));else b=c;b!==c?(x=jn(),x!==c?(E=o,o=Hr(b)):(u=o,o=c)):(u=o,o=c)}else u=o,o=c;return o}function nd(){var o,m,b,x,U,J,ue,Ne,rt,Et;return o=u,gp(),m=me(),b=nv(),b===c&&(b=null),me(),x=Qk(),x===c&&(x=null),me(),U=Gk(),U!==c?(me(),J=Tw(),J===c&&(J=null),ue=Dk(),ue===c&&(ue=null),me(),Ne=nv(),Ne===c&&(Ne=null),me(),rt=Cw(),rt===c&&(rt=null),Et=nd(),Et===c&&(Et=null),E=o,o=zl(b,x,U,J,ue,Ne,rt,Et)):(u=o,o=c),o===c&&(o=u,me(),m=Lk(),m!==c?(b=me(),E=o,o=Na(m)):(u=o,o=c)),o}function Dk(){var o,m,b,x;return o=u,m=kw(),m!==c?(C.charCodeAt(u)===61?(b=Zd,u++):(b=c,I===0&&P(Lt)),b!==c?(x=Sw(),x!==c?(m=[m,b,x],o=m):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o}function Lk(){var o,m;return o=u,m=pw(),m!==c&&(E=o,m=zu(m)),o=m,o}function nv(){var o,m,b,x,U;if(o=u,m=sv(),m!==c){for(b=[],x=u,me(),U=sv(),U!==c?(E=x,x=Ta(m,U)):(u=x,x=c);x!==c;)b.push(x),x=u,me(),U=sv(),U!==c?(E=x,x=Ta(m,U)):(u=x,x=c);E=o,o=Bl(m,b)}else u=o,o=c;return o}function sv(){var o,m,b,x;return o=u,m=ww(),m!==c?(b=_w(),b!==c?(E=o,o=Hn()):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=ww(),m!==c?(b=vs(),b!==c?(x=_w(),x!==c?(E=o,o=qr(b)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=Fk(),m!==c&&(E=o,m=Xs(m)),o=m)),o}function vs(){var o,m,b,x,U,J,ue,Ne,rt,Et,ct,We,mn;if(o=u,m=me(),b=Pa(),b!==c)if(C.substr(u,4)===il?(x=il,u+=4):(x=c,I===0&&P(ln)),x!==c)if(U=Zl(),U!==c)if(J=Uk(),J===c&&(J=null),ue=me(),Ne=So(),Ne!==c){for(rt=me(),Et=[],ct=u,We=vs(),We!==c&&(E=ct,We=qn(J,We)),ct=We;ct!==c;)Et.push(ct),ct=u,We=vs(),We!==c&&(E=ct,We=qn(J,We)),ct=We;E=o,o=np(J,Et)}else u=o,o=c;else u=o,o=c;else u=o,o=c;else u=o,o=c;if(o===c){if(o=u,m=me(),b=Pa(),b!==c)if(C.substr(u,4)===ol?(x=ol,u+=4):(x=c,I===0&&P(hn)),x!==c)if(U=Zl(),U!==c)if(J=zk(),J===c&&(J=null),ue=me(),Ne=So(),Ne!==c){for(rt=me(),Et=[],ct=u,We=vs(),We!==c&&(E=ct,We=Wl(J,We)),ct=We;ct!==c;)Et.push(ct),ct=u,We=vs(),We!==c&&(E=ct,We=Wl(J,We)),ct=We;E=o,o=Bu(J,Et)}else u=o,o=c;else u=o,o=c;else u=o,o=c;else u=o,o=c;if(o===c){if(o=u,m=me(),b=Pa(),b!==c)if(C.charCodeAt(u)===37?(x=hi,u++):(x=c,I===0&&P(yo)),x!==c)if(U=Wk(),U!==c)if(J=Zl(),J!==c)if(ue=xw(),ue!==c)if(Ne=me(),rt=So(),rt!==c){for(Et=me(),ct=[],We=u,mn=vs(),mn!==c&&(E=We,mn=sp(U,ue,mn)),We=mn;We!==c;)ct.push(We),We=u,mn=vs(),mn!==c&&(E=We,mn=sp(U,ue,mn)),We=mn;E=o,o=Kr(U,ue,ct)}else u=o,o=c;else u=o,o=c;else u=o,o=c;else u=o,o=c;else u=o,o=c;else u=o,o=c;if(o===c){if(o=u,m=me(),b=Pa(),b!==c)if(C.charCodeAt(u)===37?(x=hi,u++):(x=c,I===0&&P(yo)),x!==c)if(U=Vk(),U!==c)if(J=Zl(),J!==c)if(ue=Hk(),ue!==c)if(Ne=me(),rt=So(),rt!==c){for(Et=me(),ct=[],We=u,mn=vs(),mn!==c&&(E=We,mn=Wu(U,ue,mn)),We=mn;We!==c;)ct.push(We),We=u,mn=vs(),mn!==c&&(E=We,mn=Wu(U,ue,mn)),We=mn;E=o,o=Vu(U,ue,ct)}else u=o,o=c;else u=o,o=c;else u=o,o=c;else u=o,o=c;else u=o,o=c;else u=o,o=c;if(o===c){if(o=u,m=me(),b=Pa(),b!==c)if(C.substr(u,5)===ra?(x=ra,u+=5):(x=c,I===0&&P(ya)),x!==c)if(U=Zl(),U!==c)if(J=yp(),ue=me(),Ne=So(),Ne!==c){for(rt=me(),Et=[],ct=u,We=vs(),We!==c&&(E=ct,We=Qr(J,We)),ct=We;ct!==c;)Et.push(ct),ct=u,We=vs(),We!==c&&(E=ct,We=Qr(J,We)),ct=We;E=o,o=Hu(J,Et)}else u=o,o=c;else u=o,o=c;else u=o,o=c;else u=o,o=c;if(o===c){if(o=u,m=me(),b=Pa(),b!==c)if(C.charCodeAt(u)===37?(x=hi,u++):(x=c,I===0&&P(yo)),x!==c)if(U=yp(),J=Zl(),J!==c){if(ue=[],Ne=vw(),Ne!==c)for(;Ne!==c;)ue.push(Ne),Ne=vw();else ue=c;if(ue!==c)if(Ne=So(),Ne!==c){for(rt=me(),Et=[],ct=u,We=vs(),We!==c&&(E=ct,We=Gr(U,ue,We)),ct=We;ct!==c;)Et.push(ct),ct=u,We=vs(),We!==c&&(E=ct,We=Gr(U,ue,We)),ct=We;E=o,o=rp(U,ue,Et)}else u=o,o=c;else u=o,o=c}else u=o,o=c;else u=o,o=c;else u=o,o=c;if(o===c){if(o=u,m=[],b=gw(),b!==c)for(;b!==c;)m.push(b),b=gw();else m=c;if(m!==c){for(b=[],x=u,U=me(),J=vs(),J!==c?(E=x,x=qu(m,J)):(u=x,x=c);x!==c;)b.push(x),x=u,U=me(),J=vs(),J!==c?(E=x,x=qu(m,J)):(u=x,x=c);E=o,o=Ku(m,b)}else u=o,o=c}}}}}}return o}function gw(){var o,m,b,x;return o=u,m=u,I++,C.substr(u,2)===Pc?(b=Pc,u+=2):(b=c,I===0&&P(wa)),I--,b===c?m=void 0:(u=m,m=c),m!==c?(b=u,I++,C.charCodeAt(u)===125?(x=ef,u++):(x=c,I===0&&P(rh)),I--,x===c?b=void 0:(u=b,b=c),b!==c?(C.length>u?(x=C.charAt(u),u++):(x=c,I===0&&P(wn)),x!==c?(E=o,o=Vl(x)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o}function vw(){var o,m,b;return o=u,m=u,I++,b=So(),I--,b===c?m=void 0:(u=m,m=c),m!==c?(C.length>u?(b=C.charAt(u),u++):(b=c,I===0&&P(wn)),b!==c?(E=o,o=Dg(b)):(u=o,o=c)):(u=o,o=c),o}function Fk(){var o,m,b,x;if(o=u,m=Bk(),m!==c){for(b=[],Ts.test(C.charAt(u))?(x=C.charAt(u),u++):(x=c,I===0&&P(Il));x!==c;)b.push(x),Ts.test(C.charAt(u))?(x=C.charAt(u),u++):(x=c,I===0&&P(Il));x=Ik(),x!==c?(E=o,o=Lg(b)):(u=o,o=c)}else u=o,o=c;return o}function Uk(){var o,m,b,x,U,J,ue;if(o=u,m=rv(),m!==c){for(me(),b=[],x=u,C.charCodeAt(u)===44?(U=al,u++):(U=c,I===0&&P(wo)),U!==c?(J=me(),ue=rv(),ue!==c?(U=[U,J,ue],x=U):(u=x,x=c)):(u=x,x=c);x!==c;)b.push(x),x=u,C.charCodeAt(u)===44?(U=al,u++):(U=c,I===0&&P(wo)),U!==c?(J=me(),ue=rv(),ue!==c?(U=[U,J,ue],x=U):(u=x,x=c)):(u=x,x=c);E=o,o=ip(m,b)}else u=o,o=c;return o}function rv(){var o,m,b;return o=u,m=yw(),m!==c?(b=ov(),b!==c?(E=o,o=op(m,b)):(u=o,o=c)):(u=o,o=c),o}function zk(){var o,m,b,x,U,J,ue;if(o=u,m=iv(),m!==c){for(me(),b=[],x=u,C.charCodeAt(u)===44?(U=al,u++):(U=c,I===0&&P(wo)),U!==c?(J=me(),ue=iv(),ue!==c?(U=[U,J,ue],x=U):(u=x,x=c)):(u=x,x=c);x!==c;)b.push(x),x=u,C.charCodeAt(u)===44?(U=al,u++):(U=c,I===0&&P(wo)),U!==c?(J=me(),ue=iv(),ue!==c?(U=[U,J,ue],x=U):(u=x,x=c)):(u=x,x=c);E=o,o=ki(m,b)}else u=o,o=c;return o}function iv(){var o,m,b,x;return o=u,m=yw(),m!==c?(b=ov(),b!==c?(x=ov(),x!==c?(E=o,o=Fg(m,b,x)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o}function yw(){var o,m;return o=u,C.charCodeAt(u)===89?(m=Hm,u++):(m=c,I===0&&P(pu)),m!==c&&(E=o,m=ko()),o=m,o===c&&(o=u,C.charCodeAt(u)===71?(m=Ac,u++):(m=c,I===0&&P(lr)),m!==c&&(E=o,m=ap()),o=m,o===c&&(o=u,C.charCodeAt(u)===82?(m=qm,u++):(m=c,I===0&&P(js)),m!==c&&(E=o,m=Xt()),o=m,o===c&&(o=u,C.charCodeAt(u)===66?(m=tl,u++):(m=c,I===0&&P(xi)),m!==c&&(E=o,m=Ug()),o=m,o===c&&(o=u,C.charCodeAt(u)===79?(m=Km,u++):(m=c,I===0&&P(_a)),m!==c&&(E=o,m=lp()),o=m,o===c&&(o=u,C.charCodeAt(u)===67?(m=Qm,u++):(m=c,I===0&&P(mu)),m!==c&&(E=o,m=zg()),o=m))))),o}function ov(){var o,m,b;return o=u,m=No(),m!==c?(b=To(),b!==c?(E=o,o=Bg(m,b)):(u=o,o=c)):(u=o,o=c),o}function ww(){var o;return C.charCodeAt(u)===123?(o=Gm,u++):(o=c,I===0&&P(gu)),o}function _w(){var o;return C.charCodeAt(u)===125?(o=ef,u++):(o=c,I===0&&P(rh)),o}function Pa(){var o;return C.charCodeAt(u)===91?(o=Ym,u++):(o=c,I===0&&P(ih)),o}function So(){var o;return C.charCodeAt(u)===93?(o=tf,u++):(o=c,I===0&&P(oh)),o}function Bk(){var o;return C.charCodeAt(u)===59?(o=Xm,u++):(o=c,I===0&&P(ah)),o}function Wk(){var o,m;return o=u,C.substr(u,3)===nf?(m=nf,u+=3):(m=c,I===0&&P(lh)),m!==c&&(E=o,m=cp()),o=m,o===c&&(o=u,C.substr(u,3)===sf?(m=sf,u+=3):(m=c,I===0&&P(ch)),m!==c&&(E=o,m=up()),o=m,o===c&&(o=u,C.substr(u,3)===rf?(m=rf,u+=3):(m=c,I===0&&P(uh)),m!==c&&(E=o,m=Wg()),o=m)),o}function Vk(){var o,m;return o=u,C.substr(u,3)===ll?(m=ll,u+=3):(m=c,I===0&&P(dh)),m!==c&&(E=o,m=Os()),o=m,o}function xw(){var o,m,b,x,U;return o=u,m=bw(),m===c&&(m=null),b=Eo(),b!==c?(x=Eo(),x===c&&(x=null),U=dw(),U===c&&(U=null),E=o,o=Qu(m,b,x,U)):(u=o,o=c),o}function Hk(){var o,m,b,x;return o=u,m=bw(),m===c&&(m=null),b=Eo(),b!==c?(x=Eo(),x===c&&(x=null),E=o,o=Vg(m,b,x)):(u=o,o=c),o}function bw(){var o,m,b;return o=u,m=qk(),m!==c?(b=Kk(),b===c&&(b=null),E=o,o=Yr(m,b)):(u=o,o=c),o}function qk(){var o,m,b,x;return o=u,m=Eo(),m!==c?(b=Eo(),b===c&&(b=null),C.charCodeAt(u)===58?(x=di,u++):(x=c,I===0&&P(Rs)),x!==c?(E=o,o=Hl(m,b)):(u=o,o=c)):(u=o,o=c),o}function Kk(){var o,m,b,x;return o=u,m=Eo(),m!==c?(b=Eo(),b===c&&(b=null),C.charCodeAt(u)===58?(x=di,u++):(x=c,I===0&&P(Rs)),x!==c?(E=o,o=Si(m,b)):(u=o,o=c)):(u=o,o=c),o}function Eo(){var o,m;return o=u,fs.test(C.charAt(u))?(m=C.charAt(u),u++):(m=c,I===0&&P(yn)),m!==c&&(E=o,m=ql(m)),o=m,o}function Cw(){var o,m,b,x,U;return o=u,m=kw(),m!==c?(b=nd(),b!==c?(x=Sw(),x!==c?(me(),U=Cw(),U===c&&(U=null),E=o,o=Gu(b,U)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o}function kw(){var o;return C.charCodeAt(u)===40?(o=Jm,u++):(o=c,I===0&&P(fh)),o}function Sw(){var o;return C.charCodeAt(u)===41?(o=Zm,u++):(o=c,I===0&&P(xa)),o}function Qk(){var o,m,b,x,U;if(o=u,m=Sr(),m!==c){for(b=[],x=Nw();x!==c;)b.push(x),x=Nw();for(x=[],U=Ew();U!==c;)x.push(U),U=Ew();E=o,o=Yu(m)}else u=o,o=c;return o}function Ew(){var o;return C.charCodeAt(u)===46?(o=Xi,u++):(o=c,I===0&&P(Br)),o}function Sr(){var o,m,b;if(I++,o=u,m=[],fs.test(C.charAt(u))?(b=C.charAt(u),u++):(b=c,I===0&&P(yn)),b!==c)for(;b!==c;)m.push(b),fs.test(C.charAt(u))?(b=C.charAt(u),u++):(b=c,I===0&&P(yn));else m=c;return m!==c&&(E=o,m=Hg(m)),o=m,I--,o===c&&(m=c,I===0&&P(hh)),o}function Nw(){var o,m,b;if(o=u,m=[],C.charCodeAt(u)===32?(b=of,u++):(b=c,I===0&&P(ba)),b!==c)for(;b!==c;)m.push(b),C.charCodeAt(u)===32?(b=of,u++):(b=c,I===0&&P(ba));else m=c;return m!==c&&(E=o,m=Xu()),o=m,o}function Gk(){var o,m,b,x,U,J,ue,Ne,rt;return o=u,m=wp(),m===c&&(m=null),b=u,I++,x=Xk(),I--,x!==c?(u=b,b=void 0):b=c,b!==c?(x=Iw(),x!==c?(U=lv(),U===c&&(U=null),J=No(),J!==c?(ue=To(),ue!==c?(Ne=av(),Ne===c&&(Ne=null),rt=sd(),rt===c&&(rt=null),me(),C.substr(u,4)===af?u+=4:I===0&&P(Pl),E=o,o=qg(m,x,U,J,ue,Ne,rt)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=wp(),m===c&&(m=null),b=No(),b!==c?(x=To(),x!==c?(U=Zk(),U===c&&(U=null),J=No(),J!==c?(ue=To(),ue!==c?(Ne=av(),Ne===c&&(Ne=null),rt=sd(),rt===c&&(rt=null),E=o,o=dp(m,b,x,U,J,ue,Ne,rt)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,m=wp(),m===c&&(m=null),b=lv(),b===c&&(b=null),x=No(),x!==c?(U=To(),U!==c?(J=av(),J===c&&(J=null),ue=sd(),ue===c&&(ue=null),E=o,o=fp(m,b,x,U,J,ue)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,C.substr(u,5)===lf?(m=lf,u+=5):(m=c,I===0&&P(ph)),m!==c?(b=sd(),b===c&&(b=null),E=o,o=Kl(b)):(u=o,o=c),o===c&&(o=u,C.substr(u,3)===cf?(m=cf,u+=3):(m=c,I===0&&P(vu)),m!==c?(b=sd(),b===c&&(b=null),E=o,o=Ql(b)):(u=o,o=c),o===c&&(o=u,m=wp(),m!==c?(C.charCodeAt(u)===64?(b=eg,u++):(b=c,I===0&&P(mh)),b!==c?(x=No(),x!==c?(U=To(),U!==c?(E=o,o=hp(m,x,U)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,C.substr(u,2)===uf?(m=uf,u+=2):(m=c,I===0&&P(gh)),m!==c&&(E=o,m=Ju()),o=m)))))),o}function sd(){var o,m,b,x;return o=u,m=u,b=u,I++,C.substr(u,2)===cl?(x=cl,u+=2):(x=c,I===0&&P(yu)),I--,x===c?b=void 0:(u=b,b=c),b!==c?(C.charCodeAt(u)===43?(x=sl,u++):(x=c,I===0&&P(va)),x!==c?(b=[b,x],m=b):(u=m,m=c)):(u=m,m=c),m!==c&&(E=o,m=Kg(m)),o=m,o===c&&(o=u,m=u,b=u,I++,C.substr(u,3)===df?(x=df,u+=3):(x=c,I===0&&P(vh)),I--,x===c?b=void 0:(u=b,b=c),b!==c?(C.charCodeAt(u)===35?(x=tg,u++):(x=c,I===0&&P(wu)),x!==c?(b=[b,x],m=b):(u=m,m=c)):(u=m,m=c),m!==c&&(E=o,m=pp(m)),o=m),o}function av(){var o,m;return o=u,C.charCodeAt(u)===61?u++:I===0&&P(Lt),m=Jk(),m!==c?(E=o,o=Zu(m)):(u=o,o=c),o}function Tw(){var o,m,b;return o=u,m=Yk(),m!==c?(me(),b=Tw(),b===c&&(b=null),E=o,o=Gl(m,b)):(u=o,o=c),o}function Yk(){var o,m,b;return o=u,C.charCodeAt(u)===36?(m=Rc,u++):(m=c,I===0&&P(yh)),m!==c?(b=Sr(),b!==c?(E=o,o=ed(b)):(u=o,o=c)):(u=o,o=c),o===c&&(o=u,C.substr(u,2)===eo?(m=eo,u+=2):(m=c,I===0&&P(wh)),m!==c&&(E=o,m=Yl()),o=m,o===c&&(o=u,C.substr(u,2)===ff?(m=ff,u+=2):(m=c,I===0&&P(_h)),m!==c&&(E=o,m=mp()),o=m,o===c&&(o=u,C.substr(u,2)===jc?(m=jc,u+=2):(m=c,I===0&&P(xg)),m!==c&&(E=o,m=Qg()),o=m,o===c&&(o=u,C.substr(u,2)===$c?(m=$c,u+=2):(m=c,I===0&&P(xh)),m!==c&&(E=o,m=Xl()),o=m,o===c&&(o=u,C.charCodeAt(u)===33?(m=hf,u++):(m=c,I===0&&P(bg)),m!==c&&(E=o,m=Gg()),o=m,o===c&&(o=u,C.charCodeAt(u)===63?(m=sa,u++):(m=c,I===0&&P(zt)),m!==c&&(E=o,m=Ia()),o=m,o===c&&(o=u,C.charCodeAt(u)===8252?(m=pf,u++):(m=c,I===0&&P(Cg)),m!==c&&(E=o,m=Yg()),o=m,o===c&&(o=u,C.charCodeAt(u)===8263?(m=mf,u++):(m=c,I===0&&P(bh)),m!==c&&(E=o,m=Jl()),o=m,o===c&&(o=u,C.charCodeAt(u)===8265?(m=to,u++):(m=c,I===0&&P(Ch)),m!==c&&(E=o,m=s()),o=m,o===c&&(o=u,C.charCodeAt(u)===8264?(m=ng,u++):(m=c,I===0&&P(kh)),m!==c&&(E=o,m=i()),o=m,o===c&&(o=u,C.charCodeAt(u)===9633?(m=sg,u++):(m=c,I===0&&P(Al)),m!==c&&(E=o,m=l()),o=m,o===c&&(o=u,C.charCodeAt(u)===61?(m=Zd,u++):(m=c,I===0&&P(Lt)),m!==c&&(E=o,m=f()),o=m,o===c&&(o=u,C.charCodeAt(u)===8734?(m=rg,u++):(m=c,I===0&&P(kg)),m!==c&&(E=o,m=v()),o=m,o===c&&(o=u,C.charCodeAt(u)===10866?(m=gf,u++):(m=c,I===0&&P(Sg)),m!==c&&(E=o,m=w()),o=m,o===c&&(o=u,C.charCodeAt(u)===10865?(m=vf,u++):(m=c,I===0&&P(Eg)),m!==c&&(E=o,m=S()),o=m,o===c&&(o=u,C.charCodeAt(u)===177?(m=ia,u++):(m=c,I===0&&P(Qs)),m!==c&&(E=o,m=j()),o=m,o===c&&(o=u,C.charCodeAt(u)===8723?(m=oa,u++):(m=c,I===0&&P(_u)),m!==c&&(E=o,m=L()),o=m,o===c&&(o=u,C.substr(u,2)===cl?(m=cl,u+=2):(m=c,I===0&&P(yu)),m!==c&&(E=o,m=K()),o=m,o===c&&(o=u,C.substr(u,2)===yf?(m=yf,u+=2):(m=c,I===0&&P(Rl)),m!==c&&(E=o,m=ae()),o=m,o===c&&(o=u,C.charCodeAt(u)===10752?(m=ul,u++):(m=c,I===0&&P(Sh)),m!==c&&(E=o,m=he()),o=m,o===c&&(o=u,C.charCodeAt(u)===10227?(m=ig,u++):(m=c,I===0&&P(Eh)),m!==c&&(E=o,m=re()),o=m,o===c&&(o=u,C.charCodeAt(u)===8594?(m=wf,u++):(m=c,I===0&&P(Nh)),m!==c&&(E=o,m=Se()),o=m,o===c&&(o=u,C.charCodeAt(u)===8593?(m=Oc,u++):(m=c,I===0&&P(xu)),m!==c&&(E=o,m=Te()),o=m,o===c&&(o=u,C.charCodeAt(u)===8646?(m=Mc,u++):(m=c,I===0&&P(_o)),m!==c&&(E=o,m=Pe()),o=m,o===c&&(o=u,C.charCodeAt(u)===68?(m=_f,u++):(m=c,I===0&&P(bu)),m!==c&&(E=o,m=en()),o=m))))))))))))))))))))))))),o}function Iw(){var o;return o=No(),o===c&&(o=To()),o}function Xk(){var o,m,b,x,U;return o=u,m=Iw(),m!==c?(b=lv(),b===c&&(b=null),x=No(),x!==c?(U=To(),U!==c?(m=[m,b,x,U],o=m):(u=o,o=c)):(u=o,o=c)):(u=o,o=c),o}function wp(){var o;return aa.test(C.charAt(u))?(o=C.charAt(u),u++):(o=c,I===0&&P(Cu)),o}function Jk(){var o;return Cf.test(C.charAt(u))?(o=C.charAt(u),u++):(o=c,I===0&&P(Ng)),o}function No(){var o;return kf.test(C.charAt(u))?(o=C.charAt(u),u++):(o=c,I===0&&P(Th)),o}function To(){var o;return Sf.test(C.charAt(u))?(o=C.charAt(u),u++):(o=c,I===0&&P(Ih)),o}function lv(){var o;return C.charCodeAt(u)===120?(o=Dc,u++):(o=c,I===0&&P(ku)),o}function Zk(){var o;return C.charCodeAt(u)===120?(o=Dc,u++):(o=c,I===0&&P(ku)),o===c&&(C.charCodeAt(u)===45?(o=Ji,u++):(o=c,I===0&&P(vo))),o}var _p=[];function Ms(o){var m=Object.assign(o,Ge());return _p.push(m),m}function cv(o){return parseInt(o.join(""),10)}function Aa(o){return o.join("").match(/\?/)?o.join(""):cv(o)}function Io(o){var m={};return o.forEach(function(b){for(var x in b)Array.isArray(b[x])?m[x]=m[x]?m[x].concat(b[x]):b[x]:m[x]=m[x]?Aw(m[x])+" "+Pw(b[x]):b[x]}),m}function Pw(o){if(typeof o!="string")return o;var m=/^\s+/;return o.replace(m,"")}function Aw(o){if(typeof o!="string")return o;var m=/\s+$/;return o.replace(m,"")}if(Ue=Ie(),Ue!==c&&u===C.length)return Ue;throw Ue!==c&&u<C.length&&P(Xg()),GC(Ae,fe<C.length?C.charAt(fe):null,fe<C.length?Jg(fe,fe+1):Jg(fe,fe))}return{SyntaxError:H,parse:le}})})(d);var h=d.exports,g=a(h);function y(M,F){return!F||F.startRule==="games"?T(M,F):_(M,F)}function _(M,F={startRule:"game"}){M=M.trim();let H=g.parse(M,F),ye={moves:[],messages:[]};if(F.startRule==="pgn"){let le=H;ye.moves=le}else if(F.startRule==="tags"){let le=H;ye.tags=le}else ye=H;return N(ye,M,F)}function N(M,F,H){function ye(C){if(H.startRule!=="tags"){let ie=C.moves[C.moves.length-1];if(typeof ie=="string"&&(C.moves.pop(),C.tags)){let c=C.tags.Result;c&&ie!==c&&C.messages.push({key:"Result",value:c,message:"Result in tags is different to result in SAN"}),C.tags.Result=ie}}return C}function le(C){function ie(c){function ze(Ve){return Ve.split(/\s+/)[1]}function de(Ve,$e){function be(te){return te==="w"?"b":"w"}return Ve.turn=$e,Ve.variations&&Ve.variations.forEach(function(te){let ee=$e;te.forEach(Y=>ee=de(Y,ee))}),be($e)}let Je=H.fen||c.tags&&c.tags.FEN||"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Qe=ze(Je);return c.moves.forEach(Ve=>Qe=de(Ve,Qe)),c}return C.moves?ie(C):C}return le(ye(M))}function T(M,F={startRule:"games"}){function H(ie){if(!Array.isArray(ie))return[];if(ie.length===0)return ie;let c=ie.pop();return(c.tags!==void 0||c.moves.length>0)&&ie.push(c),ie}function ye(ie,c,ze={startRule:"games"}){return H(ie)}const le=Object.assign({startRule:"games"},F);let C=g.parse(M,le);return C?(ye(C,M,le),C.forEach(ie=>{N(ie,M,le)}),C):[]}const k=(M,F=`
`)=>M.replace(/\r?\n/g,F);function $(M,F={startRule:"games"}){let H=k(M).split(`

`),ye=[],le={tags:"",pgn:"",all:""};return H.forEach(function(C){if(C.startsWith("["))le.tags=C;else if(C){le.pgn=C;let ie=le.tags?le.tags+`

`+le.pgn:le.pgn;le.all=ie,ye.push(le),le={tags:"",pgn:"",all:""}}}),ye}t.parse=y,t.parseGame=_,t.parseGames=T,t.split=$,Object.defineProperty(t,"__esModule",{value:!0})}))})(pd,pd.exports)),pd.exports}var T3=N3();function qC(n){const e=n.trim(),t=e.startsWith("http")?e:`https://${e}`;try{return new URL(t)}catch{return null}}function I3(n){if(!n)return null;const e=n.searchParams.get("t")??n.searchParams.get("start");if(!e)return null;const t=Number(e);if(Number.isFinite(t)&&t>=0)return Math.floor(t);const r=e.match(/(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s?)?/i);if(!r)return null;const[,a,d,h]=r,g=Number(a)||0,y=Number(d)||0,_=Number(h)||0,N=g*3600+y*60+_;return N>0?N:null}function Rp(n){if(!n)return null;const e=n.trim().replace(/[^-\w]/g,"");return e?e.length>11?e.slice(0,11):e:null}function P3(n){const e=qC(n),t=I3(e)??void 0,r=e?.hostname.replace(/^www\./,"")||"",a=e?.pathname.split("/").filter(Boolean)||[];if(r==="youtu.be"&&a[0]){const g=Rp(a[0]);if(g)return{id:g,startSeconds:t}}if(r.endsWith("youtube.com")||r.endsWith("youtube-nocookie.com")){const g=Rp(e?.searchParams.get("v"));if(g)return{id:g,startSeconds:t};if(a.length>=2&&["embed","shorts","live","v"].includes(a[0])){const y=Rp(a[1]);if(y)return{id:y,startSeconds:t}}}const d=n.match(/(?:v=|youtu\.be\/|embed\/|shorts\/|live\/)([\w-]{6,})/i),h=Rp(d?.[1]);return h?{id:h,startSeconds:t}:null}function I1(n){if(!n)return null;const e=n.trim();if(!e)return null;const t=P3(e);if(t){const r=new URLSearchParams({rel:"0",modestbranding:"1"});return typeof t.startSeconds=="number"&&r.set("start",String(t.startSeconds)),{type:"youtube",src:`https://www.youtube-nocookie.com/embed/${t.id}?${r.toString()}`}}return{type:"html5",src:e}}function Vp(n,e){try{return n.move(e,{sloppy:!0})}catch{return null}}function A3(n){const e=n.trim().split(/\s+/);for(;e.length<6;)e.length===0?e.push(""):e.length===1?e.push("w"):e.length===2?e.push("KQkq"):e.length===3?e.push("-"):e.push(e.length===4?"0":"1");const[t,r,a,d,h,g]=e.slice(0,6),y=r?.toLowerCase()==="b"?"b":"w",_=/^(K?Q?k?q?|-)$/i.test(a)?a:"-",N=/^([a-h][36]|-)$/i.test(d)?d:"-",T=Number.isFinite(Number(h))?String(Number(h)):"0",k=Number.isFinite(Number(g))&&Number(g)>0?String(Number(g)):"1";return[t,y,_||"-",N||"-",T,k].join(" ")}function P1(n){if(!n)return null;try{const e=new at;return e.load(n)===!1?null:e.fen()}catch{return null}}function A1(n){const t=[n?.fen,n?.FEN,n?.startFen,n?.startFEN,n?.boardFen,n?.fenString,n?.position,n?.puzzleFen,n?.quizQuestions?.[0]?.fen,n?.quizQuestions?.[0]?.FEN,n?.quizQuestions?.[0]?.startFen,n?.quizQuestions?.[0]?.startFEN,n?.quizQuestions?.[0]?.fenString,n?.quizQuestions?.[0]?.position,n?.questions?.[0]?.fen,n?.questions?.[0]?.FEN,n?.questions?.[0]?.startFen,n?.questions?.[0]?.startFEN,n?.questions?.[0]?.fenString,n?.questions?.[0]?.position].find(r=>typeof r=="string"&&r.trim().length>0);return t?A3(t):null}function R3(n){return n.replace(/\s+/g," ").trim()}function j3(n){return n.split(/\r?\n/).filter(e=>!e.trim().startsWith("[")).join(" ").replace(/;.*/g,"")}function $3(n){let e="",t=0;for(let r=0;r<n.length;r++){const a=n[r];if(a==="("){t++;continue}if(a===")"){t>0&&t--;continue}t===0&&(e+=a)}return e}function O3(n){return n.split(/\s+/).filter(Boolean)}function R1(n){let e=n.replace(/\u2026/g,"...");return e=e.replace(/^\d+\.(\.\.)?/,""),e=e.replace(/[!?+#]+$/g,""),/^\$?\d+$/.test(e.trim())?"":e.trim()}function j1(n){return/^\d+\.+$/.test(n)||/^\d+\.\.\.$/.test(n)}function $1(n){return n==="1-0"||n==="0-1"||n==="1/2-1/2"||n==="*"}function M3(n){try{const t=T3.parse(n,{startRule:"games",sloppy:!0})?.[0];if(!t?.moves)return{mainline:[],rootVariations:[],variationMap:{}};const r={},a=(g,y,_)=>{const N=[];return g.forEach(T=>{const k=y.fen(),M=(T?.notation?.notation||T?.move?.notation||T?.san||(typeof T?.move=="string"?T.move:"")||"")?.toString().trim();if(!M)return;const F=T.variations?.map(le=>a(le,new at(y.fen())))||[];F.length&&(r[k]=F,_&&_(F));const H=Vp(y,M);if(!H)return;const ye={san:H.san,from:H.from,to:H.to,fen:y.fen(),comment:(T.commentAfter||T.comment||T.commentBefore||"").trim()||null,variations:F.length?F:[]};N.push(ye)}),N},d=[],h=a(t.moves,new at,g=>d.push(...g));return t.variations?.length&&t.variations.forEach(g=>{d.push(a(g,new at))}),{mainline:h,rootVariations:d,variationMap:r}}catch{return{mainline:[],rootVariations:[],variationMap:{}}}}const O1=[{label:"P",color:"w",type:"p"},{label:"N",color:"w",type:"n"},{label:"B",color:"w",type:"b"},{label:"R",color:"w",type:"r"},{label:"Q",color:"w",type:"q"},{label:"K",color:"w",type:"k"},{label:"P",color:"b",type:"p"},{label:"N",color:"b",type:"n"},{label:"B",color:"b",type:"b"},{label:"R",color:"b",type:"r"},{label:"Q",color:"b",type:"q"},{label:"K",color:"b",type:"k"},{label:"",color:"w",type:"empty"}];function M1({id:n}){const{user:e}=pr(),t=Oi(e?.boardTheme).colors,r=!!e?.isAdmin,a=D.useRef(new at),d=D.useRef(null),[h,g]=D.useState(a.current.fen()),[y,_]=D.useState([]),[N,T]=D.useState(null),[k,$]=D.useState("w"),[M]=D.useState(!1),[F,H]=D.useState(O1[0]),[ye,le]=D.useState(!1),[C,ie]=D.useState(null),[c,ze]=D.useState({}),[de,Ie]=D.useState(n||""),[Je,Qe]=D.useState(null),[Ve,$e]=D.useState(!1),[be,te]=D.useState(null),[ee,Y]=D.useState(null),[we,ne]=D.useState(!1),[X,ce]=D.useState(null),[R,q]=D.useState(null),[se,ve]=D.useState(-1),[Re,je]=D.useState(null),[qe,Be]=D.useState(null),[Ze,gt]=D.useState(!1),[un,En]=D.useState(null),[bs,Fn]=D.useState([]),[an,Un]=D.useState(null),[Us,At]=D.useState(null),[zs,zn]=D.useState(!1),[os,Bn]=D.useState(!1),[Yn,Xn]=D.useState([]),[as,Cs]=D.useState({}),[ls,Nn]=D.useState({}),[mr,Wn]=D.useState({}),[cs,Jn]=D.useState(null),[Bs,oe]=D.useState(!1),[xe,Ce]=D.useState(0),[Le,ht]=D.useState(0),[Vt,Ft]=D.useState(!1),[Kt,Tn]=D.useState(1),[He,bt]=D.useState(!1),[wt,Jt]=D.useState(new Set),[Ct,Qt]=D.useState(null),[V,Ht]=D.useState(null),[Rt,tn]=D.useState([]),[ge,jt]=D.useState(!1),[ot,_t]=D.useState(!1),[tr,Gt]=D.useState([]),[us,Ws]=D.useState(new Set),ke="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",qt=A=>{typeof document>"u"||(document.body.style.cursor=A?`url(${bm}) 8 8, grabbing`:"")};D.useEffect(()=>()=>{qt(!1)},[]),D.useEffect(()=>{const A=()=>qt(!1);return window.addEventListener("mouseup",A),window.addEventListener("dragend",A),()=>{window.removeEventListener("mouseup",A),window.removeEventListener("dragend",A)}},[]),D.useEffect(()=>{const A=()=>qt(!1);return window.addEventListener("mouseup",A),window.addEventListener("dragend",A),()=>{window.removeEventListener("mouseup",A),window.removeEventListener("dragend",A)}},[]);const ks=D.useMemo(()=>{const z=new at(h).board();return k==="w"?z:z.slice().reverse().map(Z=>Z.slice().reverse())},[h,k]),Ss=se===-1||se===y.length-1,nr=k==="w"?"abcdefgh".split(""):"hgfedcba".split(""),ni=k==="w"?Array.from({length:8},(A,z)=>8-z):Array.from({length:8},(A,z)=>z+1),si=D.useMemo(()=>N?new at(h).moves({square:N,verbose:!0}):[],[h,N]),ri=A=>{if(!A)return null;const z={p:Py,r:Ay,n:Ry,b:jy,q:$y,k:Oy},Z={p:My,r:Dy,n:Ly,b:Fy,q:Uy,k:zy};return A.color==="w"?z[A.type]:Z[A.type]},ds=(A,z)=>{const Z="abcdefgh"[k==="w"?z:7-z],pe=k==="w"?8-A:A+1;return`${Z}${pe}`},ii=(A,z)=>{if(Qt(null),Ht(null),tn([]),Jt(new Set),X?.type==="quiz")return;const Z=ds(A,z);if(M){const lt=new at;lt.load(h),F.type==="empty"?lt.remove(Z):lt.put({color:F.color,type:F.type},Z),g(lt.fen());return}if(N===Z){T(null);return}const pe=new at(h),Me=pe.get(Z);if(N){St(N,Z);return}Me&&Me.color===pe.turn()&&T(Z)},St=(A,z)=>{if(X?.type==="quiz"||X?.type==="study"){T(null),ie(null),qt(!1);return}if(M)return;if(!Ss){T(null),ie(null),qt(!1);return}const Z=new at(h),pe=Z.move({from:A,to:z,promotion:"q"});if(pe){const Me=Z.fen();a.current=Z,_(lt=>{const Nt=[...lt,{san:pe.san,from:pe.from,to:pe.to,fen:Me}];return ve(Nt.length-1),q(Me),Nt}),g(Me)}T(null)},oi=D.useMemo(()=>{const A=[];return y.forEach((z,Z)=>{const pe=Math.floor(Z/2);A[pe]||(A[pe]={}),Z%2===0?A[pe].white=z:A[pe].black=z}),A},[y]),gr=A=>{g(A.fen),T(null),ie(null);const z=y.findIndex(Z=>Z.fen===A.fen&&Z.from===A.from&&Z.to===A.to);z>=0&&ve(z),q(A.fen)};D.useEffect(()=>{de||($e(!0),Yd("course-london").then(A=>{Ie(A?.id||"course-london"),$e(!1)}))},[de]),D.useEffect(()=>{if(!de)return;$e(!0);const A=gj(de,z=>{Qe(z),$e(!1)});return()=>A()},[de]),D.useEffect(()=>{let A=!1;return(async()=>{if(!(!e||!de))try{const Z=await UC(e.id,de);if(A)return;Ws(new Set(Z?.completedLessonIds||[]))}catch{A||Ws(new Set)}})(),()=>{A=!0}},[e?.id,de]),D.useEffect(()=>{ee?ee.type!=="video"&&je(null):(je(null),Be(null))},[ee]);const sr=D.useMemo(()=>Je?.chapters?Object.values(Je.chapters).sort((A,z)=>A.index-z.index):[],[Je]),Vs=A=>{ze(z=>({...z,[A]:!z[A]}))},Vi=async()=>{!r||!de||te({mode:"create",title:"",index:sr.length})},ai=async A=>{!r||!de||!window.confirm("Delete this chapter and its subsections?")||await Rj(de,A)},rr=async(A,z)=>{!r||!de||!window.confirm("Delete this subsection?")||await Oj(de,A,z)},Vn=async A=>{!e||!de||A.type!=="quiz"&&(us.has(A.id)||(Ws(z=>new Set(z).add(A.id)),await _0(e.id,de,A.id,A.type)))},nn=A=>{Jn(null);try{let{mainline:z,variationMap:Z}=M3(A);if(!z.length){const Nt=[A];for(const fn of Nt){const sn=new at;if(sn.loadPgn(fn,{sloppy:!0})){const Ke=sn.history({verbose:!0}),Ot=[],kt=new at;Ke.forEach(Yt=>{kt.move(Yt),Ot.push({san:Yt.san,from:Yt.from,to:Yt.to,fen:kt.fen(),comment:Yt.comment||null,variations:[]})}),z=Ot,Z={};break}}}if(!z.length){const Nt=O3(A),fn=new at,sn=[];Nt.forEach(Ke=>{if(Ke==="("||Ke===")"||typeof Ke=="object")return;const Ot=R1(Ke);if(!Ot||$1(Ot)||j1(Ot))return;const kt=Vp(fn,Ot);kt&&sn.push({san:kt.san,from:kt.from,to:kt.to,fen:fn.fen(),comment:null,variations:[]})}),sn.length&&(z=sn,Z={})}if(!z.length){const fn=R3($3(j3(A))).replace(/\{[^}]*\}/g,"").split(/\s+/).filter(Boolean),sn=new at,Ke=[];fn.forEach(Ot=>{const kt=R1(Ot);if(!kt||$1(kt)||j1(kt))return;const Yt=Vp(sn,kt);Yt&&Ke.push({san:Yt.san,from:Yt.from,to:Yt.to,fen:sn.fen(),comment:null,variations:[]})}),Ke.length&&(z=Ke,Z={})}if(!z.length){Jn("Could not load this PGN, falling back to empty board."),Xn([]),Cs({}),Nn({}),Wn({}),_([]),ve(-1),q(null),g(new at().fen()),T(null),ie(null);return}const pe=Nt=>{const fn={},sn={},Ke=new at;return Nt.forEach((Ot,kt)=>{const Yt=Ke.fen();fn[Yt]=Ot,sn[Yt]=kt,Vp(Ke,Ot.san)}),{map:fn,idxMap:sn}},{map:Me,idxMap:lt}=pe(z);Xn(z),Cs(Z),Nn(Me),Wn(lt),_(z),ve(-1),q(null),g(new at().fen()),T(null),ie(null),Jn(null)}catch(z){console.warn("Failed to load PGN",z),Xn([]),Cs({}),Nn({}),Wn({}),_([]),ve(-1),q(null),g(new at().fen()),Jn("Could not load this PGN. Try another file or share the PGN text.")}T(null),ie(null)},B=A=>{if(ce(A),A.type==="study"&&A.pgn){Fn([]),Un(null),En(null),Jn(null),nn(A.pgn);return}if(A.type==="quiz"){const z=A1(A),Z=P1(z)||new at().fen();g(Z);const pe=A.questions||[];Fn(pe.map(()=>"")),Un(null),At(null),Bn(!1),zn(!1),T(null),ie(null),_([]),Xn([]),ve(-1),q(null),Jn(null),En(A.trainerNote?.trim()||null);return}else g(new at().fen()),Fn([]),Un(null),At(null),Bn(!1),zn(!1),T(null),ie(null),_([]),Xn([]),ve(-1),q(null),Jn(null),En(A.type==="video"&&A.trainerNote?.trim()||null)};D.useEffect(()=>{if(X?.type!=="quiz")return;const A=A1(X),z=P1(A)||new at().fen();g(z),T(null),ie(null)},[X]),D.useEffect(()=>{if(X?.type!=="study")return;if(!y.length){ve(-1),q(null),g(new at().fen());return}const A=se>=0?y[se].fen:new at().fen();as[A]?.length},[y,se,as,g,X]),D.useEffect(()=>{if(!X){En(null);return}if(X.type==="study"){if(se>=0&&y[se]){const A=y[se].comment?.trim();En(A||null)}else En(null);return}if(X.type==="video"||X.type==="quiz"){const A=X.trainerNote?.trim();En(A||null);return}En(null)},[X,se,y]),D.useEffect(()=>{if(X?.type==="study"){let A;se>=0&&y[se]?A=y[se]:y.length&&(A=y[y.length-1]),Gt(A?[A.from,A.to]:[])}else Gt([])},[X,se,y]);const Q=()=>{if(!y.length)return;const A=se===-1?y.length-1:Math.max(0,se-1);ve(A),q(y[A].fen),g(y[A].fen),T(null),ie(null)},G=()=>{if(!y.length)return;const A=se>=0?y[se].fen:new at().fen();if(as[A]?.length)return;const z=se===-1?0:Math.min(y.length-1,se+1);ve(z),q(y[z].fen),g(y[z].fen),T(null),ie(null)},De=X?.type!=="video",Oe=X?.type!=="video",Fe=I1(X?.videoUrl),dn=X?.type==="video",$t=dn&&X.videoUrl?.trim()||"",Ja=D.useMemo(()=>{if(!$t)return"No video link provided yet.";if($t.startsWith("data:"))return"Embedded video file (data URL)";const A=qC($t);if(A){if(A.hostname.replace(/^www\./,"").includes("youtube"))return"Video ready";const z=A.hostname.replace(/^www\./,""),Z=A.pathname&&A.pathname!=="/"?A.pathname:"";return`Source: ${z}${Z}`}return $t.length>80?`${$t.slice(0,80)}...`:$t},[$t]),Za=!!$t&&Fe?.type!=="youtube";Fe?.type==="html5"||Fe?.type==="youtube"||Fe?.type;const li=Fe?Fe.type==="html5"?"Custom player using your hosted video file.":null:$t?"We couldn't read this link. Use a direct MP4/WEBM/HLS URL or a YouTube link.":"No video URL yet. Add one from the section editor to start playback.",Hi=(A,z)=>{const Z=ds(A,z);Jt(pe=>{const Me=new Set(pe);return Me.has(Z)?Me.delete(Z):Me.add(Z),Me})},qi=(A,z)=>{const Z=ds(A,z);Qt({row:A,col:z,square:Z}),Ht(null),jt(!1)},vr=(A,z,Z)=>{if(!Ct||Z!==2)return;const pe=ds(A,z);if(Ct.square===pe){jt(!1),Ht(null);return}jt(!0),Ht({row:A,col:z,square:pe})},el=()=>{Ct&&ge&&V?(tn(A=>[...A,{start:Ct,end:V}]),_t(!0)):Ct&&!ge&&(Hi(Ct.row,Ct.col),_t(!0)),jt(!1),Qt(null),Ht(null)},ci=()=>{oe(!1),Ce(0),ht(0),Ft(!1),bt(!1),Tn(1),d.current&&(d.current.currentTime=0,d.current.pause())};D.useEffect(()=>{if(!dn){ci();return}Fe?.type==="html5"&&ci()},[dn,$t,Fe]),D.useEffect(()=>{if(Fe?.type!=="html5")return;const A=d.current;A&&(A.volume=Kt,A.muted=He)},[Kt,He,Fe]);const vt=()=>{if(Fe?.type!=="html5")return;const A=d.current;A&&(A.paused?A.play():A.pause())},Jo=()=>{const A=d.current;!A||Vt||Ce(A.currentTime||0)},Zo=()=>{const A=d.current;A&&ht(A.duration||0)},Ki=A=>{const z=d.current;Ce(A),z&&(z.currentTime=A)},Qi=A=>{const z=d.current,Z=Math.min(1,Math.max(0,A));Tn(Z),z&&(z.volume=Z,bt(Z===0))},ea=()=>{const A=d.current;if(!A)return;const z=!He;bt(z),A.muted=z,!z&&A.volume===0&&Qi(.5)},Gi=A=>{if(!Number.isFinite(A))return"0:00";const z=Math.max(0,Math.floor(A)),Z=Math.floor(z/60),pe=z%60;return`${Z}:${pe.toString().padStart(2,"0")}`},ui=D.useMemo(()=>{if(X?.type!=="study")return[];const A=se>=0?y[se].fen:new at().fen();return as[A]||[]},[se,X,y,as]),Hs=D.useMemo(()=>{if(X?.type!=="quiz")return null;const A=X.questions||[];if(A.length){const Z=A[0];if(Z?.options?.length){const Me=typeof Z.correctIndex=="number"&&Z.correctIndex>=0?Z.correctIndex:0;return{...Z,correctIndex:Me}}const pe=A.map((Me,lt)=>Me?.prompt||`Option ${lt+1}`).filter(Boolean);if(pe.length){const Me=A.findIndex(lt=>typeof lt?.correctIndex=="number"&&lt.correctIndex>=0);return{id:Z?.id||"derived",prompt:Z?.prompt||"Select the correct option",options:pe,correctIndex:Me>=0?Me:0}}}const z=X.quizQuestions||[];return z.length?{id:"legacy",prompt:"Select the correct option",options:z.map((Z,pe)=>Z.prompt||`Option ${pe+1}`),correctIndex:0}:null},[X]),Es=D.useMemo(()=>{if(X?.type!=="study")return null;const A=se>=0?y[se].fen:new at().fen();return ls[A]||null},[se,X,y,ls]),qs=X?.type==="study"&&ui.length>0,Ns=A=>{if(A&&A.length){const Me=se+1,lt=Me>=0?y.slice(0,Me):[],Nt=[...lt,...A];_(Nt);const fn=lt.length,sn=Nt[fn]?.fen||new at().fen();ve(fn),q(sn),g(sn),T(null),ie(null);return}const z=se>=0?y[se].fen:new at().fen(),Z=ls[z],pe=mr[z];Z!=null&&pe!=null&&(_(Yn),ve(pe),q(Z.fen),g(Z.fen)),T(null),ie(null)},jr=()=>{if(X?.type!=="study"||!X.pgn)return;const A=new Blob([X.pgn],{type:"application/x-chess-pgn"}),z=URL.createObjectURL(A),Z=document.createElement("a"),pe=(X.title||"study").replace(/[^a-z0-9-_]+/gi,"_");Z.href=z,Z.download=`${pe||"study"}.pgn`,document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),setTimeout(()=>URL.revokeObjectURL(z),2e3)},$r=async()=>{if(X?.type!=="quiz"||!Hs)return;if(an==null){At("Pick an option first.");return}if(!(an===(Hs.correctIndex??0))){At("Not quite. Try again.");return}if(!e){At("Sign in to earn XP for this quiz.");return}if(!de){At("Course not loaded yet. Try again.");return}if(os){At("XP already awarded for this quiz.");return}try{zn(!0),await _0(e.id,de,X.id,X.type),Bn(!0),At("Correct! XP awarded.")}catch(z){console.warn("Failed to award XP for quiz",z),At("Could not award XP right now. Please try again.")}finally{zn(!1)}};return p.jsxs(Ar,{children:[p.jsxs("div",{className:"flex items-start gap-6",children:[Oe&&p.jsxs("div",{className:"min-w-[220px] max-w-[260px] rounded-2xl bg-slate-900 border border-white/10 text-white shadow-xl",children:[p.jsxs("div",{className:"p-4",children:[p.jsx("div",{className:"font-semibold text-lg",children:X?.type==="quiz"?"Options":"Moves"}),p.jsx("div",{className:"text-xs text-white/60 mb-2",children:X?.type==="study"&&cs?cs:X?.type==="quiz"?"Answer the questions below":"Played so far"})]}),p.jsx("div",{className:"max-h-[480px] overflow-auto px-4 pb-4",children:X?.type==="quiz"?p.jsx("div",{className:"space-y-3",children:Hs?p.jsxs("div",{className:"space-y-3",children:[p.jsx("div",{className:"text-sm text-white/70 whitespace-pre-wrap",children:"Select the correct option"}),Hs.options?.map((A,z)=>p.jsxs("label",{className:"flex items-center gap-3 rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white/90 hover:border-pink-400",children:[p.jsx("input",{type:"radio",name:"quiz-option",className:"h-4 w-4 text-pink-500",checked:an===z,onChange:()=>{Un(z),Fn(Z=>{const pe=[...Z];return pe[0]=A,pe}),At(null)}}),p.jsx("span",{children:A||`Option ${z+1}`})]},`${Hs.id||"opt"}-${z}`)),p.jsxs("div",{className:"pt-1",children:[p.jsx(it,{size:"sm",className:"w-full justify-center",disabled:an==null||zs,onClick:$r,children:zs?"Submitting...":"Submit"}),Us&&p.jsx("div",{className:"mt-2 text-xs text-white/80","aria-live":"polite",children:Us})]})]}):p.jsx("div",{className:"text-xs text-white/60",children:"No options available."})}):X?.type==="study"&&qs?p.jsxs("div",{className:"space-y-2",children:[Es&&p.jsxs("button",{className:"w-full text-left rounded-lg bg-white/10 hover:bg-white/20 text-white px-3 py-2 text-sm",onClick:()=>Ns(null),children:["Mainline: ",Es.san]}),ui.map((A,z)=>p.jsxs("button",{className:"w-full text-left rounded-lg border border-white/10 hover:border-pink-400 text-white px-3 py-2 text-sm",onClick:()=>Ns(A),children:["Variation ",z+1,": ",A[0]?.san||"Line"]},`variation-${z}`))]}):p.jsxs(p.Fragment,{children:[oi.length===0&&p.jsx("div",{className:"text-white/50 text-sm",children:"No moves yet. Start playing."}),oi.map((A,z)=>p.jsxs("div",{className:"grid grid-cols-[32px_1fr_1fr] items-center gap-3 text-sm py-1",children:[p.jsxs("div",{className:"text-white/50",children:[z+1,"."]}),p.jsx("button",{className:`text-left text-white rounded-md px-2 py-1 ${R===A.white?.fen?"bg-white/10":""} ${A.white?"hover:text-pink-300":"text-white/50"}`,disabled:!A.white,onClick:()=>A.white&&gr(A.white),children:A.white?.san||"-"}),p.jsx("button",{className:`text-left text-white rounded-md px-2 py-1 ${R===A.black?.fen?"bg-white/10":""} ${A.black?"hover:text-pink-300":"text-white/50"}`,disabled:!A.black,onClick:()=>A.black&&gr(A.black),children:A.black?.san||""})]},z))]})})]}),p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"flex items-center justify-between mb-3",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-xl font-bold text-white",children:Je?.title||"Course"}),p.jsx("div",{className:"text-sm text-white/60",children:Je?.description||"Live course layout"})]}),p.jsx("div",{className:"flex items-center gap-2",children:p.jsxs(it,{variant:"ghost",className:"bg-white/5 hover:bg-white/10",onClick:()=>le(!0),children:[p.jsx(PE,{className:"h-5 w-5 mr-2"}),"Chapters"]})})]}),p.jsxs("div",{className:"grid grid-cols-[minmax(320px,1fr)_280px] gap-4 items-start",children:[p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"relative inline-block pl-8 pb-8 w-full max-w-[840px]",children:X?.type==="video"?p.jsxs("div",{className:"w-full rounded-[28px] overflow-hidden border border-white/10 bg-slate-900/80 shadow-[0_20px_60px_rgba(0,0,0,0.45)]",children:[p.jsxs("div",{className:"flex flex-col gap-3 px-6 py-5 border-b border-white/10 sm:flex-row sm:items-center sm:justify-between",children:[p.jsxs("div",{className:"space-y-1",children:[p.jsx("div",{className:"text-[11px] uppercase tracking-[0.2em] text-white/50",children:"Video subsection"}),p.jsx("div",{className:"text-2xl font-bold text-white leading-tight",children:X.title||"Video lesson"}),li&&p.jsx("div",{className:"text-sm text-white/60",children:li})]}),p.jsx("div",{className:"flex items-center gap-2"})]}),p.jsxs("div",{className:"relative bg-black",children:[Fe?.type==="blocked"&&p.jsxs("div",{className:"aspect-video w-full flex flex-col items-center justify-center gap-3 px-6 text-center text-white/80",children:[p.jsx("div",{className:"text-lg font-semibold text-white",children:"Link not playable"}),p.jsx("p",{className:"text-sm text-white/60 max-w-xl",children:Fe.reason}),$t&&p.jsx("div",{className:"text-xs text-white/50 break-all max-w-lg bg-white/5 border border-white/10 px-3 py-2 rounded-lg",children:$t}),p.jsx("div",{className:"text-xs text-white/60",children:"Use a YouTube link or a direct MP4/WEBM/HLS URL to play here."})]}),Fe?.type==="youtube"&&p.jsx("div",{className:"relative w-full",children:p.jsx("iframe",{src:Fe.src,title:X.title||"Video lesson",className:"w-full aspect-video",loading:"lazy",referrerPolicy:"origin-when-cross-origin",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0},Fe.src)}),Fe?.type==="html5"&&p.jsxs("div",{className:"relative w-full",children:[p.jsx("video",{ref:d,src:Fe.src,className:"w-full aspect-video object-contain bg-black",playsInline:!0,onLoadedMetadata:Zo,onTimeUpdate:Jo,onEnded:()=>oe(!1),onPause:()=>oe(!1),onPlay:()=>oe(!0),muted:He,crossOrigin:"anonymous"},Fe.src),p.jsxs("div",{className:"absolute inset-x-0 bottom-0 flex flex-col gap-3 bg-gradient-to-t from-black/80 via-black/50 to-transparent px-4 pb-4 pt-6",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("button",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-white/10 text-white hover:bg-white/20",onClick:vt,"aria-label":Bs?"Pause":"Play",children:Bs?p.jsx(OE,{className:"h-5 w-5"}):p.jsx(gx,{className:"h-5 w-5"})}),p.jsxs("div",{className:"flex items-center gap-2 text-xs text-white/80 min-w-[110px]",children:[p.jsx("span",{children:Gi(xe)}),p.jsx("span",{className:"text-white/40",children:"/"}),p.jsx("span",{children:Gi(Le)})]}),p.jsx("div",{className:"flex-1",children:p.jsx("input",{type:"range",min:0,max:Math.max(Le||0,.1),step:"0.1",value:Math.min(xe,Le||0),onChange:A=>Ki(Number(A.target.value)),onMouseDown:()=>Ft(!0),onMouseUp:()=>Ft(!1),onTouchStart:()=>Ft(!0),onTouchEnd:()=>Ft(!1),className:"w-full accent-pink-400"})})]}),p.jsxs("div",{className:"flex items-center justify-between gap-3 text-white/80 text-xs",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("button",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-white/10 text-white hover:bg-white/20",onClick:ea,"aria-label":He?"Unmute":"Mute",children:He||Kt===0?p.jsx(KE,{className:"h-5 w-5"}):p.jsx(qE,{className:"h-5 w-5"})}),p.jsx("input",{type:"range",min:0,max:1,step:.05,value:Kt,onChange:A=>Qi(Number(A.target.value)),className:"w-28 accent-pink-400"})]}),p.jsx("div",{className:"flex items-center gap-2",children:p.jsx("span",{className:"rounded-full bg-white/10 border border-white/10 px-3 py-1 text-[11px] uppercase tracking-[0.15em] text-white/70",children:"Custom player"})})]})]}),p.jsxs("div",{className:"absolute left-4 top-4 flex items-center gap-2 rounded-full border border-white/10 bg-black/70 px-3 py-1 text-xs text-white/80",children:[p.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-400"}),"Playing hosted video"]})]}),!Fe&&p.jsxs("div",{className:"aspect-video w-full flex flex-col items-center justify-center gap-3 px-6 text-center text-white/70",children:[p.jsx("div",{className:"text-lg font-semibold text-white",children:"No video ready"}),p.jsx("p",{className:"text-sm text-white/60 max-w-xl",children:"Add a direct MP4/WEBM/HLS link, a YouTube link, or upload a video file from the section editor to start playback."})]})]}),p.jsxs("div",{className:"flex flex-col gap-2 px-6 py-4 border-t border-white/10 sm:flex-row sm:items-center sm:justify-between",children:[p.jsxs("div",{className:"flex items-center gap-2 text-sm text-white/70",children:[p.jsx("span",{className:`h-2 w-2 rounded-full ${Fe?"bg-emerald-400":"bg-amber-400"}`}),Ja]}),Za&&p.jsx("div",{className:"text-xs text-white/50 break-all max-w-full sm:max-w-[320px]",children:$t})]})]}):p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"rounded-[28px] overflow-hidden border border-white/10 shadow-[0_20px_60px_rgba(0,0,0,0.45)] w-full",style:{backgroundColor:t.dark},children:p.jsxs("div",{className:"relative grid grid-cols-8 grid-rows-8 w-full max-w-[840px] aspect-square mx-auto",children:[ks.map((A,z)=>A.map((Z,pe)=>{const Me=ds(z,pe),lt=(z+pe)%2===0,Nt=N===Me,fn=si.some(Ke=>Ke.to===Me),sn=tr.includes(Me);return p.jsxs("button",{onClick:()=>ii(z,pe),draggable:!M&&!!Z,onDragStart:Ke=>{if(M||!Z)return;const Ot=new at(h),kt=ds(z,pe),Yt=Ot.get(kt);if(X?.type==="quiz"){Ke.preventDefault();return}if(X?.type==="study"){Ke.preventDefault(),qt(!1);return}if(!Ss){Ke.preventDefault(),qt(!1);return}if(Yt&&Yt.color===Ot.turn()){if(ie(kt),Ke.dataTransfer?.setData("text/plain",kt),Ke.dataTransfer){const ta=new Image;ta.src=ke,Ke.dataTransfer.setDragImage(ta,0,0)}qt(!0)}else Ke.preventDefault()},onDragOver:Ke=>{X?.type!=="quiz"&&!M&&C&&Ke.preventDefault()},onDrop:Ke=>{if(M||X?.type==="quiz"||X?.type==="study")return;Ke.preventDefault();const Ot=C||Ke.dataTransfer?.getData("text/plain"),kt=ds(z,pe);Ot&&St(Ot,kt),ie(null),qt(!1)},onDragEnd:()=>{ie(null),qt(!1)},onContextMenu:Ke=>{if(Ke.preventDefault(),ot){_t(!1);return}!Ct&&!ge&&Hi(z,pe)},onMouseDown:Ke=>{Ke.button===2?(Ke.preventDefault(),qi(z,pe)):Ke.button===0&&Z&&(X?.type==="study"||!Ss?qt(!1):qt(!0))},onMouseEnter:Ke=>vr(z,pe,Ke.buttons),onMouseMove:Ke=>vr(z,pe,Ke.buttons),onMouseUp:Ke=>{Ke.button===2?(Ke.preventDefault(),el()):Ke.button===0&&qt(!1)},className:`w-full h-full flex items-center justify-center text-2xl font-semibold relative overflow-hidden ${Nt?"ring-2 ring-pink-400":""} ${fn?"after:absolute after:h-3 after:w-3 after:rounded-full after:bg-pink-400/70":""} ${Z?"cursor-piece":"cursor-auto"}`,style:{backgroundColor:wt.has(Me)?"#ef4444":lt?t.light:t.dark,...Z?{"--cursor-open":`url(${HC}) 8 8, grab`,"--cursor-closed":`url(${bm}) 8 8, grabbing`}:{}},"data-has-piece":!!Z,"data-square":Me,"data-piece":Z?`${Z.color}${Z.type}`:"","data-test":"board-square",children:[sn&&p.jsx("div",{className:"absolute inset-0 bg-yellow-400/50 pointer-events-none z-0"}),Z?p.jsx("img",{src:ri(Z)||"",alt:"",className:`relative z-10 w-full h-full object-contain ${Z.color==="w"&&Z.type==="p"?"p-0 scale-110":"p-1"} ${Z.color==="b"&&Z.type==="k"?"scale-110 translate-y-0.5":""}`}):null]},`${z}-${pe}`)})),Ct&&V&&p.jsxs("svg",{className:"absolute inset-0 pointer-events-none",viewBox:"0 0 100 100",children:[p.jsx("defs",{children:p.jsx("marker",{id:"arrowhead-lesson-current",markerWidth:"4",markerHeight:"4",refX:"2",refY:"2",orient:"auto",children:p.jsx("path",{d:"M0,0 L0,4 L4,2 z",fill:"rgba(234,179,8,0.8)"})})}),(()=>{const A=(pe,Me)=>({x:(Me+.5)/8*100,y:(pe+.5)/8*100}),z=A(Ct.row,Ct.col),Z=A(V.row,V.col);return p.jsx("line",{x1:z.x,y1:z.y,x2:Z.x,y2:Z.y,stroke:"rgba(234,179,8,0.8)",strokeWidth:"1",markerEnd:"url(#arrowhead-lesson-current)"})})()]}),Rt.map((A,z)=>p.jsxs("svg",{className:"absolute inset-0 pointer-events-none",viewBox:"0 0 100 100",children:[p.jsx("defs",{children:p.jsx("marker",{id:`arrowhead-lesson-${z}`,markerWidth:"4",markerHeight:"4",refX:"2",refY:"2",orient:"auto",children:p.jsx("path",{d:"M0,0 L0,4 L4,2 z",fill:"rgba(234,179,8,0.8)"})})}),(()=>{const Z=(lt,Nt)=>({x:(Nt+.5)/8*100,y:(lt+.5)/8*100}),pe=Z(A.start.row,A.start.col),Me=Z(A.end.row,A.end.col);return p.jsx("line",{x1:pe.x,y1:pe.y,x2:Me.x,y2:Me.y,stroke:"rgba(234,179,8,0.8)",strokeWidth:"1",markerEnd:`url(#arrowhead-lesson-${z})`})})()]},`arrow-${z}`)),Rt.map((A,z)=>p.jsxs("svg",{className:"absolute inset-0 pointer-events-none",viewBox:"0 0 100 100",children:[p.jsx("defs",{children:p.jsx("marker",{id:`arrowhead-lesson-${z}`,markerWidth:"4",markerHeight:"4",refX:"2",refY:"2",orient:"auto",children:p.jsx("path",{d:"M0,0 L0,4 L4,2 z",fill:"rgba(234,179,8,0.8)"})})}),(()=>{const Z=(lt,Nt)=>({x:(Nt+.5)/8*100,y:(lt+.5)/8*100}),pe=Z(A.start.row,A.start.col),Me=Z(A.end.row,A.end.col);return p.jsx("line",{x1:pe.x,y1:pe.y,x2:Me.x,y2:Me.y,stroke:"rgba(234,179,8,0.8)",strokeWidth:"1",markerEnd:`url(#arrowhead-lesson-${z})`})})()]},`arrow-${z}`))]})}),p.jsx("div",{className:"pointer-events-none absolute left-0 top-0 bottom-6 grid grid-rows-8 text-xs font-semibold text-white/80",children:ni.map(A=>p.jsx("span",{className:"flex items-center justify-end pr-2",children:A},`rank-${A}`))}),p.jsx("div",{className:"pointer-events-none absolute left-6 right-0 bottom-0 grid grid-cols-8 text-xs font-semibold text-white/80",children:nr.map(A=>p.jsx("span",{className:"text-center pt-1",children:A},`file-${A}`))})]})}),De&&p.jsxs("div",{className:"mt-3 flex items-center gap-2 text-white",children:[p.jsxs("div",{className:"flex rounded-full bg-white/10 p-1",children:[p.jsx("button",{className:`px-3 py-1 rounded-full text-sm ${k==="w"?"bg-white text-slate-900 font-semibold":"text-white/80"}`,onClick:()=>$("w"),children:"W"}),p.jsx("button",{className:`px-3 py-1 rounded-full text-sm ${k==="b"?"bg-white text-slate-900 font-semibold":"text-white/80"}`,onClick:()=>$("b"),children:"B"})]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("button",{className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white","aria-label":"Prev move",onClick:Q,children:p.jsx(fx,{className:"h-4 w-4"})}),p.jsx("button",{className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white","aria-label":"Next move",onClick:G,children:p.jsx(xE,{className:"h-4 w-4"})}),X?.type==="study"&&X.pgn&&p.jsx("button",{className:"p-2 rounded-full bg-white/10 hover:bg-white/20 text-white","aria-label":"Download PGN",onClick:jr,children:p.jsx(SE,{className:"h-4 w-4"})})]})]}),M&&p.jsx("div",{className:"mt-3 flex flex-wrap gap-2 text-white",children:O1.map(A=>p.jsx("button",{onClick:()=>H(A),className:`px-2 py-1 rounded-md border text-xs ${F===A?"bg-pink-500 text-white border-pink-500":"bg-white/5 border-white/10"}`,children:A.label},`${A.label}-${A.type}`))})]}),p.jsx("div",{className:"space-y-3",children:un&&p.jsxs("div",{className:"rounded-xl bg-slate-900 border border-white/10 text-white p-4 shadow-lg",children:[p.jsx("div",{className:"font-semibold mb-2",children:"Trainer Note"}),p.jsx("p",{className:"text-sm text-white/80 whitespace-pre-wrap",children:un})]})})]})]})]}),ye&&p.jsxs("div",{className:"fixed inset-0 z-30 flex",children:[p.jsx("div",{className:"flex-1 bg-black/50",onClick:()=>le(!1)}),p.jsxs("div",{className:"w-full max-w-md h-full bg-slate-900 text-white border-l border-white/10 shadow-2xl overflow-y-auto",children:[p.jsxs("div",{className:"p-5 border-b border-white/10 flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-xl font-bold",children:Je?.title||"Course"}),p.jsx("div",{className:"text-sm text-white/60",children:"Select a chapter or drill"})]}),p.jsx("button",{className:"p-2 rounded-full hover:bg-white/10",onClick:()=>le(!1),"aria-label":"Close navigation",children:p.jsx(La,{className:"h-4 w-4"})})]}),p.jsxs("div",{className:"p-4 space-y-3",children:[r&&p.jsx(it,{variant:"outline",size:"sm",onClick:Vi,className:"w-full justify-center",children:"Add chapter"}),Ve&&p.jsx("div",{className:"text-white/70 text-sm",children:"Loading chapters..."}),!Ve&&sr.length===0&&p.jsx("div",{className:"text-white/60 text-sm",children:"No chapters yet."}),sr.map(A=>{const z=c[A.id],Z=Object.values(A.subsections||{});return p.jsxs("div",{className:"rounded-xl border border-white/10 bg-white/5 hover:border-pink-400",children:[p.jsxs("div",{className:"p-3 flex items-center justify-between gap-2",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-sm font-semibold",children:A.title}),p.jsxs("div",{className:"text-xs text-white/60",children:["Items: ",Z.length]})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[r&&p.jsxs(p.Fragment,{children:[p.jsx(it,{size:"sm",variant:"ghost",onClick:()=>Y({chapterId:A.id,mode:"create",type:"video",title:"",videoUrl:"",pgn:"",fen:"",quizQuestions:[{id:"q1",prompt:""}],correctQuestionIndex:1,trainerNote:""}),"aria-label":"Add subsection",children:p.jsx(P0,{className:"h-4 w-4"})}),p.jsx(it,{size:"sm",variant:"ghost",onClick:()=>ai(A.id),"aria-label":"Delete chapter",children:p.jsx(A0,{className:"h-4 w-4"})})]}),p.jsx(it,{size:"sm",variant:"outline",onClick:()=>Vs(A.id),children:z?"Close":"Open"})]})]}),z&&p.jsxs("div",{className:"bg-white/10 border-t border-white/10",children:[Z.map(pe=>p.jsxs("div",{className:"flex items-center justify-between px-4 py-2 text-sm text-white/80 hover:bg-white/10 cursor-pointer",onClick:()=>B(pe),children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"h-2 w-2 rounded-full bg-white/40"}),p.jsx("span",{className:"capitalize text-white/60",children:pe.type}),p.jsx("span",{children:pe.title})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[!r&&(pe.type==="video"||pe.type==="study")&&(us.has(pe.id)?p.jsx("span",{className:"text-emerald-300 text-xs font-semibold",children:"Completed"}):p.jsx(it,{size:"sm",variant:"outline",onClick:Me=>{Me.stopPropagation(),Vn(pe)},children:"Complete"})),r&&p.jsx(it,{size:"sm",variant:"ghost",onClick:Me=>{Me.stopPropagation(),rr(A.id,pe.id)},children:"Delete"})]})]},`${A.id}-${pe.id}`)),Z.length===0&&p.jsx("div",{className:"px-4 py-2 text-xs text-white/60",children:"No subsections yet."})]})]},A.id)})]})]})]}),be&&p.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/70 px-4",children:p.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-slate-900 text-white border border-white/10 shadow-2xl",children:[p.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/10",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-lg font-semibold",children:be.mode==="create"?"Add chapter":"Edit chapter"}),p.jsx("div",{className:"text-xs text-white/60",children:"Admin-only"})]}),p.jsx("button",{className:"p-2 rounded-full hover:bg-white/10 text-white/70",onClick:()=>te(null),"aria-label":"Close",children:p.jsx(La,{className:"h-4 w-4"})})]}),p.jsxs("div",{className:"p-5 space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"Title"}),p.jsx("input",{value:be.title,onChange:A=>te(z=>z&&{...z,title:A.target.value}),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",placeholder:"Chapter title"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"Order"}),p.jsx("input",{type:"number",value:be.index,onChange:A=>te(z=>z&&{...z,index:Number(A.target.value)}),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",min:0}),p.jsx("div",{className:"text-xs text-white/60",children:"Lower numbers appear first."})]}),p.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[p.jsx(it,{variant:"outline",onClick:()=>te(null),children:"Cancel"}),p.jsx(it,{onClick:async()=>{!de||!be.title.trim()||(be.mode==="create"?await Aj(de,be.title.trim(),be.index):be.chapter&&await jj(de,be.chapter.id,{title:be.title.trim(),index:be.index}),te(null))},children:"Save"})]})]})]})}),ee&&p.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/70 px-4",children:p.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-slate-900 text-white border border-white/10 shadow-2xl",children:[p.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/10",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-lg font-semibold",children:"Add subsection"}),p.jsx("div",{className:"text-xs text-white/60",children:"Admin-only"})]}),p.jsx("button",{className:"p-2 rounded-full hover:bg-white/10 text-white/70",onClick:()=>Y(null),"aria-label":"Close",children:p.jsx(La,{className:"h-4 w-4"})})]}),p.jsxs("div",{className:"p-5 space-y-4",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"Type"}),p.jsxs("div",{className:"relative",children:[p.jsxs("button",{type:"button",onClick:()=>ne(A=>!A),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none hover:border-white/20 flex items-center justify-between capitalize",children:[p.jsx("span",{children:ee.type}),p.jsx("span",{className:"text-xs text-white/60",children:we?"Hide":"Show"})]}),we&&p.jsx("div",{className:"absolute z-20 mt-2 w-full rounded-2xl bg-slate-800 border border-white/10 shadow-2xl overflow-hidden",children:["video","study","quiz"].map(A=>p.jsx("button",{onClick:()=>{Y(z=>z&&{...z,type:A}),ne(!1)},className:"w-full text-left px-4 py-2 text-sm text-white hover:bg-white/10 capitalize",children:A},A))})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"Title"}),p.jsx("input",{value:ee.title,onChange:A=>Y(z=>z&&{...z,title:A.target.value}),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",placeholder:"Subsection title"})]}),ee.type==="video"&&p.jsxs("div",{className:"space-y-2",children:[p.jsxs("label",{className:"text-sm text-white/80 flex items-center justify-between",children:[p.jsx("span",{children:"Video URL or Upload"}),p.jsx("span",{className:"text-xs text-white/60",children:"No size limit"})]}),p.jsx("input",{value:ee.videoUrl,onChange:A=>Y(z=>z&&{...z,videoUrl:A.target.value}),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",placeholder:"https://..."}),p.jsx("input",{type:"file",accept:"video/*",onChange:A=>{const z=A.target.files?.[0];if(!z)return;je(null);const Z=new FileReader;Z.onerror=()=>je("Could not read the video file. Try again or use a hosted link instead."),Z.onload=pe=>{const Me=pe.target?.result;typeof Me=="string"?Y(lt=>lt&&{...lt,videoUrl:Me}):je("Could not process the video file. Please try another file or a URL.")};try{Z.readAsDataURL(z)}catch{je("Video is too large to inline here. Please host it (e.g., MP4 link) and paste the URL.")}},className:"w-full text-sm text-white/80 file:mr-3 file:rounded-lg file:border-none file:bg-white/10 file:px-3 file:py-2 file:text-white hover:file:bg-white/20"}),Re&&p.jsx("div",{className:"text-xs text-red-300",children:Re}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"Trainer note (optional)"}),p.jsx("textarea",{value:ee.trainerNote,onChange:A=>Y(z=>z&&{...z,trainerNote:A.target.value}),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",rows:2,placeholder:"Message to show in Trainer Note during this video"})]})]}),ee.type==="study"&&p.jsxs("div",{className:"space-y-2",children:[p.jsxs("label",{className:"text-sm text-white/80 flex items-center justify-between",children:[p.jsx("span",{children:"PGN"}),p.jsx("span",{className:"text-xs text-white/60",children:"Paste or upload PGN"})]}),p.jsx("textarea",{value:ee.pgn,onChange:A=>Y(z=>z&&{...z,pgn:A.target.value}),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",rows:3,placeholder:"Paste PGN"}),p.jsx("input",{type:"file",accept:".pgn,text/plain",onChange:A=>{const z=A.target.files?.[0];if(!z)return;const Z=new FileReader;Z.onload=pe=>{const Me=pe.target?.result;typeof Me=="string"&&Y(lt=>lt&&{...lt,pgn:Me})},Z.readAsText(z)},className:"w-full text-sm text-white/80 file:mr-3 file:rounded-lg file:border-none file:bg-white/10 file:px-3 file:py-2 file:text-white hover:file:bg-white/20"})]}),ee.type==="quiz"&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"space-y-2",children:[p.jsxs("label",{className:"text-sm text-white/80 flex items-center justify-between gap-2",children:[p.jsx("span",{children:"Options"}),p.jsxs("button",{type:"button",onClick:()=>Y(A=>A&&{...A,quizQuestions:[...A.quizQuestions,{id:`q${A.quizQuestions.length+1}`,prompt:""}]}),className:"inline-flex items-center gap-1 rounded-md bg-white/10 px-2 py-1 text-xs hover:bg-white/20",children:[p.jsx(vx,{className:"h-3 w-3"}),"Add"]})]}),p.jsx("div",{className:"space-y-3",children:ee.quizQuestions.map((A,z)=>p.jsx("textarea",{value:A.prompt,onChange:Z=>Y(pe=>pe&&{...pe,quizQuestions:pe.quizQuestions.map((Me,lt)=>lt===z?{...Me,prompt:Z.target.value}:Me)}),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",rows:2,placeholder:`Option ${z+1}`},A.id))})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"FEN"}),p.jsx("input",{value:ee.fen,onChange:A=>Y(z=>z&&{...z,fen:A.target.value}),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",placeholder:"e.g. rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"Correct option number"}),p.jsx("input",{type:"number",min:1,value:ee.correctQuestionIndex,onChange:A=>Y(z=>z&&{...z,correctQuestionIndex:Number(A.target.value)||1}),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",placeholder:"Enter the question number (e.g. 1)"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-sm text-white/80",children:"Trainer note (optional)"}),p.jsx("textarea",{value:ee.trainerNote,onChange:A=>Y(z=>z&&{...z,trainerNote:A.target.value}),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-pink-400",rows:2,placeholder:"Message to show in Trainer Note during this quiz"})]})]}),p.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[p.jsx(it,{variant:"outline",onClick:()=>Y(null),children:"Cancel"}),p.jsx(it,{disabled:Ze,onClick:async()=>{if(!ee)return;if(Be(null),!de){Be("Course is still loading. Try again in a moment.");return}const A=ee.title.trim();if(!A){Be("Add a title for this subsection.");return}const z=ee.trainerNote.trim();let Z=null;if(ee.type==="video"){const pe=ee.videoUrl.trim();if(!pe){Be("Add a video link or upload a file before saving.");return}const Me=I1(pe);if(!Me){Be("Video link is not valid. Use a direct MP4/WEBM/HLS URL or YouTube link.");return}if(Me.type==="blocked"){Be(Me.reason||"This video link cannot be played here.");return}if(pe.startsWith("data:")&&pe.length>4e6){Be("Video is too large to inline. Please host it (e.g., MP4 link) and paste the URL.");return}Z={id:"",type:"video",title:A,videoUrl:pe,...z?{trainerNote:z}:{}}}else if(ee.type==="study")Z={id:"",type:"study",title:A,pgn:ee.pgn.trim()};else{const pe=ee.quizQuestions.map(Nt=>Nt.prompt.trim()),Me=Math.max(0,Math.min(pe.length-1,ee.correctQuestionIndex-1)),lt=[{id:"q1",prompt:"Select the correct option",options:pe,correctIndex:Me}];Z={id:"",type:"quiz",title:A,fen:ee.fen.trim()||void 0,...z?{trainerNote:z}:{},questions:lt}}if(Z)try{gt(!0),await $j(de,ee.chapterId,Z),Y(null),ne(!1)}catch(pe){console.error("Failed to save subsection",pe),Be("Could not save. Check your connection and try again.")}finally{gt(!1)}},children:Ze?"Saving...":"Save"})]}),qe&&p.jsx("div",{className:"text-xs text-red-300 pt-1 text-right",children:qe})]})]})})]})}function D3(){const{user:n,logout:e,setUser:t}=pr(),[r,a]=D.useState(()=>n?.chessUsername?n.chessUsername:n?.displayName?n.displayName:n?.email?n.email.split("@")[0]:"YourUsername"),[d,h]=D.useState(!1),[g,y]=D.useState(""),[_,N]=D.useState("idle"),[T,k]=D.useState(null),[$,M]=D.useState(null),[F,H]=D.useState(!1),[ye,le]=D.useState(()=>Oi(n?.boardTheme).key),[C,ie]=D.useState(D1[0].value),[c,ze]=D.useState(!1),[de,Ie]=D.useState([]),[Je,Qe]=D.useState(!1),[Ve,$e]=D.useState(null),be="k5rr/5R2/8/2p1P1p1/1p2Q3/1P6/K2p4/3b4 w - - 0 1",te=D.useMemo(()=>z3(be),[]);D.useEffect(()=>{n?.chessUsername?a(n.chessUsername):n?.displayName?a(n.displayName):n?.email&&a(n.email.split("@")[0])},[n]),D.useEffect(()=>{le(Oi(n?.boardTheme).key)},[n?.boardTheme]);const ee=async R=>{const q=await fetch(`https://api.chess.com/pub/player/${encodeURIComponent(R)}/games/archives`);if(!q.ok)throw new Error("Could not read game archives for this user.");const ve=(await q.json()).archives||[],Re=ve[ve.length-1];if(!Re)return[];const je=await fetch(Re);if(!je.ok)return[];const qe=await je.json(),Be={};return(qe.games||[]).slice(-50).forEach(Ze=>{const gt=Ze?.opening||Ze?.eco||Ze?.eco_url;if(!gt||typeof gt!="string")return;const un=gt.toLowerCase();Be[un]=(Be[un]||0)+1}),Object.entries(Be).sort((Ze,gt)=>gt[1]-Ze[1]).slice(0,3).map(([Ze])=>Ze)},Y=(R,q)=>{const se=q.map(Re=>({id:Re.id,title:Re.title.toLowerCase(),course:Re})),ve=[];return R.forEach(Re=>{const je=Re.toLowerCase().split(/[^a-z]+/).filter(Boolean),qe=je[0]||Re.toLowerCase(),Be=se.find(Ze=>Ze.title.includes(qe)||je.some(gt=>gt.length>3&&Ze.title.includes(gt))||qe.includes("sicilian")&&Ze.title.includes("dragon"));Be&&!ve.includes(Be.id)&&ve.push(Be.id)}),!ve.length&&q.length&&ve.push(q[0].id),ve.slice(0,3)},we=D.useMemo(()=>r,[r]),ne=async R=>{if(n){$e(R);try{await Dj(n.id,R),Ie(q=>q.filter(se=>se.course.id!==R))}finally{$e(null)}}},X=[{key:"logout",title:"Log Out",description:"Sign out from PawnPoint on this device.",accent:"bg-emerald-600",icon:qv,action:{type:"button",label:"Log Out",variant:"outline",onClick:()=>e()}},{key:"chess",title:"Chess.com Account",description:"Your account is connected with the following chess.com username:",highlight:we,accent:"bg-emerald-700",icon:_x,action:{type:"button",label:"Change Account",variant:"outline",onClick:()=>{y(r||""),k(null),M(null),N("idle"),h(!0)}}},{key:"board",title:"Board and Theme Customization",description:"Customize your chessboard and chess pieces.",accent:"bg-emerald-700",icon:IE,action:{type:"button",label:"Set up Preferences",variant:"outline",onClick:()=>{H(!0)}}},{key:"reset",title:"Reset Progress",description:"Choose which courses to reset",accent:"bg-emerald-700",icon:DE,action:{type:"button",label:"Reset Progress",variant:"outline",onClick:async()=>{if(n){ze(!0),Qe(!0);try{const[R,q]=await Promise.all([_m(),Mj(n.id)]),se=Object.entries(q||{}).map(([ve,Re])=>{const je=R.find(Be=>Be.id===ve);if(!je)return null;const qe=Re.progressPercent??Re.percent??0;return qe<=0?null:{course:je,percent:qe}}).filter(Boolean);Ie(se)}finally{Qe(!1)}}}}},{key:"email",title:"Change Email",description:`Your account is registered with: ${n?.email||"unknown"}`,accent:"bg-emerald-700",icon:px,action:{type:"button",label:"Change Email",variant:"outline",onClick:()=>{}}},{key:"delete",title:"Delete Account",description:"Important: Deleting your account will permanently remove all your progress and data. This action cannot be undone.",accent:"bg-rose-700",icon:UE,danger:!0,action:{type:"button",label:"Delete Account",variant:"outline",onClick:()=>{}}}],ce=async()=>{const q=g.trim().toLowerCase();if(!q){k("Enter a chess.com username.");return}N("loading"),k(null),M(null);try{const se=await fetch(`https://api.chess.com/pub/player/${encodeURIComponent(q)}`);if(!se.ok)throw new Error("User not found on chess.com");const ve=await se.json(),Re={username:ve.username,name:ve.name,followers:ve.followers,country:ve.country,lastOnline:ve.last_online,status:ve.status,title:ve.title,avatar:ve.avatar};M(Re),N("success")}catch(se){N("error"),k(se?.message||"Could not find that user. Check the spelling and try again.")}};return p.jsxs(Ar,{children:[p.jsxs("div",{className:"max-w-4xl mx-auto px-4 pb-16",children:[p.jsx("h1",{className:"text-2xl font-bold text-white mb-6",children:"Settings"}),p.jsx("div",{className:"rounded-3xl bg-slate-900/90 border border-white/10 shadow-2xl overflow-hidden",children:p.jsx("div",{className:"divide-y divide-white/5",children:X.map(R=>{const q=R.icon;return p.jsxs("div",{className:"flex flex-col gap-4 px-5 py-4 sm:flex-row sm:items-center sm:justify-between hover:bg-white/5",children:[p.jsxs("div",{className:"flex items-start gap-4",children:[p.jsx("div",{className:`h-12 w-12 rounded-full flex items-center justify-center text-white ${R.accent}`,children:p.jsx(q,{className:"h-6 w-6"})}),p.jsxs("div",{className:"space-y-1",children:[p.jsx("div",{className:"text-lg font-semibold text-white",children:R.title}),p.jsx("div",{className:"text-sm text-white/70 leading-snug",children:R.description}),R.highlight&&p.jsx("div",{className:"text-sm font-semibold text-emerald-300",children:R.highlight})]})]}),p.jsx("div",{className:"min-w-[140px] flex justify-end",children:(()=>{const se=R.action;return se.type==="button"?p.jsx(it,{variant:se.variant??"outline",className:`w-full sm:w-auto ${R.danger?"border-rose-300 text-rose-100 hover:bg-rose-500/20":""}`,onClick:se.onClick,children:se.label}):se.type==="toggle"?p.jsx("button",{className:`relative inline-flex h-7 w-12 items-center rounded-full transition ${se.value?"bg-emerald-500":"bg-white/20"}`,onClick:()=>se.onToggle(!se.value),disabled:se.disabled,"aria-pressed":se.value,children:p.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white shadow transition ${se.value?"translate-x-6":"translate-x-1"}`})}):p.jsx("div",{className:"rounded-full bg-slate-600 text-white/80 px-4 py-2 text-sm select-none",children:se.label})})()})]},R.key)})})})]}),d&&p.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/70 px-4",children:p.jsxs("div",{className:"w-full max-w-md rounded-3xl bg-slate-900 text-white border border-white/10 shadow-2xl relative",children:[p.jsx("button",{className:"absolute right-3 top-3 text-white/70 hover:text-white",onClick:()=>h(!1),"aria-label":"Close",children:""}),p.jsxs("div",{className:"px-6 py-6 space-y-4",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-xl font-bold",children:"Change your Chess.com account"}),p.jsx("div",{className:"text-sm text-white/70 mt-1",children:"We will use this information to:"})]}),p.jsx("div",{className:"space-y-2 text-sm text-white/80",children:["Recommend you the best courses to study","Analyze your games and tell you where you make mistakes","Break down your chess skills and what to improve"].map((R,q)=>p.jsxs("div",{className:"flex items-start gap-2",children:[p.jsx(I0,{className:"h-4 w-4 text-emerald-400 mt-0.5"}),p.jsx("span",{children:R})]},q))}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-xs uppercase tracking-[0.08em] text-white/50",children:"Chess.com username"}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("input",{value:g,onChange:R=>y(R.target.value),className:"w-full rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-sm outline-none focus:ring-2 focus:ring-emerald-400",placeholder:"Chess.com username",onKeyDown:R=>{R.key==="Enter"&&(R.preventDefault(),ce())}}),p.jsx(it,{variant:"outline",className:"whitespace-nowrap",onClick:ce,disabled:_==="loading",children:_==="loading"?"Searching...":"Link"})]}),T&&p.jsx("div",{className:"text-xs text-rose-300",children:T}),_==="success"&&$&&p.jsxs("div",{className:"rounded-xl border border-emerald-400/40 bg-emerald-500/10 px-3 py-3 text-sm space-y-1",children:[p.jsxs("div",{className:"font-semibold text-emerald-200 flex items-center gap-2",children:[p.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-400"}),$.username]}),$.title&&p.jsxs("div",{className:"text-white/80",children:["Title: ",$.title]}),p.jsx("div",{className:"text-white/70",children:L3($.lastOnline)||"Activity data unavailable"})]})]}),p.jsx("div",{className:"pt-2",children:p.jsx(it,{className:"w-full justify-center",onClick:async()=>{if(_!=="success"||!$){await ce();return}try{N("loading");const R=g.trim(),q=$.username.toLowerCase(),se=await ee(q),ve=await _m(),Re=Y(se,ve);zj(Re,R||$.username),a(R||$.username);const je=await Sj(R||$.username);je&&t(je),N("success"),h(!1)}catch(R){N("error"),k(R?.message||"Could not fetch openings to build recommendations.")}},children:_==="success"?"Save account":_==="loading"?"Working...":"Continue"})})]})]})}),F&&p.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 px-4",children:p.jsxs("div",{className:"w-full max-w-4xl rounded-3xl bg-slate-900 text-white border border-white/10 shadow-2xl",children:[p.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/10",children:[p.jsx("div",{className:"text-lg font-semibold",children:"Board customization"}),p.jsx("button",{className:"text-white/70 hover:text-white",onClick:()=>H(!1),"aria-label":"Close",children:""})]}),p.jsxs("div",{className:"p-5 space-y-6",children:[p.jsxs("div",{className:"rounded-2xl bg-slate-800/70 border border-white/10 p-4",children:[p.jsx("div",{className:"text-white mb-3 font-semibold",children:"Active Piece: White Queen"}),p.jsx("div",{className:"flex flex-col gap-3 items-center",children:p.jsx("div",{className:"relative inline-block",children:p.jsx("div",{className:"grid grid-cols-8 grid-rows-8 w-[360px] aspect-square overflow-hidden rounded-xl border border-white/10",children:te.map(R=>p.jsxs("div",{className:"relative flex items-center justify-center text-xs font-semibold",style:{background:R.isLight?jp[ye]?.light||jp.brown.light:jp[ye]?.dark||jp.brown.dark,color:"#111"},children:[R.isHighlight&&p.jsx("div",{className:"absolute inset-0",style:{backgroundColor:U3,opacity:.8}}),R.piece&&p.jsx("img",{src:B3(R.piece),alt:"",className:"relative z-10 h-[36px] w-[36px] object-contain",draggable:!1}),R.coord&&p.jsx("div",{className:"absolute left-1 bottom-1 text-[10px] text-black/70",children:R.coord})]},R.name))})})})]}),p.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-white",children:[p.jsx(F1,{label:"Board",value:ye,onChange:R=>le(R),options:F3}),p.jsx(F1,{label:"Pieces",value:C,onChange:R=>ie(R),options:D1})]}),p.jsx("div",{className:"flex justify-end",children:p.jsx(it,{className:"px-6",onClick:async()=>{const R=Oi(ye).key,q=await Ej(R);q&&t(q),H(!1)},children:"Save"})})]})]})}),c&&p.jsx("div",{className:"fixed inset-0 z-40 flex items-start justify-center bg-black/60 px-4 py-10 overflow-y-auto",children:p.jsxs("div",{className:"w-full max-w-5xl rounded-2xl bg-slate-900 text-white border border-white/10 shadow-2xl p-6 space-y-4",children:[p.jsxs("button",{className:"flex items-center gap-2 text-sm text-white/70",onClick:()=>ze(!1),children:[p.jsx(fx,{className:"h-4 w-4"}),"Back"]}),p.jsx("div",{className:"text-2xl font-bold",children:"Reset Progress"}),Je?p.jsx("div",{className:"text-white/70 text-sm",children:"Loading your courses"}):de.length===0?p.jsx("div",{className:"text-white/70 text-sm",children:"You have no courses with earned XP to reset."}):p.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:de.map(({course:R,percent:q})=>p.jsxs("div",{className:"rounded-xl border border-white/10 bg-slate-800/60 p-4 flex items-center gap-4",children:[p.jsx("div",{className:"h-14 w-14 rounded-xl overflow-hidden bg-white/5 flex items-center justify-center",children:p.jsx("img",{src:R.thumbnailUrl,alt:R.title,className:"h-full w-full object-cover"})}),p.jsxs("div",{className:"flex-1 space-y-2",children:[p.jsx("div",{className:"font-semibold text-white",children:R.title}),p.jsxs("div",{className:"flex items-center gap-2 text-xs text-white/70",children:[p.jsx("div",{className:"flex-1 h-2 rounded-full bg-white/10 overflow-hidden",children:p.jsx("div",{className:"h-full bg-emerald-400",style:{width:`${Math.min(100,Math.max(0,q))}%`}})}),p.jsxs("span",{className:"font-semibold text-white",children:[q,"%"]})]})]}),p.jsx(it,{variant:"outline",className:"min-w-[88px]",disabled:Ve===R.id,onClick:()=>ne(R.id),children:Ve===R.id?"Resetting...":"Reset"})]},R.id))})]})})]})}function L3(n){if(!n)return null;const e=Date.now()/1e3-n;return e<3600?"Active recently":e<86400?"Active today":`Active ${Math.floor(e/86400)}d ago`}const F3=Object.keys(vm).map(n=>({label:n.charAt(0).toUpperCase()+n.slice(1),value:n})),D1=[{label:"chess.com",value:"chesscom"}],L1={w:{p:Py,r:Ay,n:Ry,b:jy,q:$y,k:Oy},b:{p:My,r:Dy,n:Ly,b:Fy,q:Uy,k:zy}},jp=vm,U3="#f3cd4b";function z3(n){const e=n.split(" ")[0].split("/"),t=[];e.forEach((a,d)=>{let h=0;a.split("").forEach(g=>{if(/[1-8]/.test(g)){const y=Number(g);for(let _=0;_<y;_++){const N=`${"abcdefgh"[h]}${8-d}`;t.push({name:N,piece:null,isLight:(h+d)%2===0,coord:N}),h++}}else{const y=`${"abcdefgh"[h]}${8-d}`;t.push({name:y,piece:g,isLight:(h+d)%2===0,coord:y}),h++}})});const r=["d3","e2","e5","f3"];return t.map(a=>({...a,isHighlight:r.includes(a.name)}))}function F1({label:n,value:e,onChange:t,options:r}){return p.jsxs("div",{className:"space-y-1",children:[p.jsx("div",{className:"text-white/80 text-sm",children:n}),p.jsxs("div",{className:"relative",children:[p.jsxs("button",{className:"w-full flex items-center justify-between rounded-xl bg-slate-800 border border-white/10 px-3 py-3 text-white text-sm",children:[p.jsx("span",{children:r.find(a=>a.value===e)?.label||e}),p.jsx(_E,{className:"h-4 w-4 text-white/60"})]}),p.jsx("select",{className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",value:e,onChange:a=>t(a.target.value),children:r.map(a=>p.jsx("option",{value:a.value,children:a.label},a.value))})]})]})}function B3(n){if(!n||n.length===0)return"";const e=n===n.toUpperCase(),t=n.toLowerCase();return e?L1.w[t]:L1.b[t]}const KC="/assets/Advent%20Calendar-J5ITks2v.png",Hp="/assets/Christmas%20Pawn-D_bCmMDk.png",QC="/assets/Gift-ueUQQsya.png",W3="/assets/Grinch%20pfp-zl_ex9Kh.png",V3="/assets/Mistletoe%20pfp-BFt_2ImS.png",H3="/assets/Rook%20pfp-CqClYD4h.png",q3="/assets/Santa%20pfp-DfWqBBWO.png",K3="/assets/Snowman%20pfp-J9IJC07F.png",Q3="/assets/Tree%20pfp-BT-iifK4.png",$p=[{label:"Gift Box",value:QC},{label:"Christmas Pawn",value:Hp},{label:"Advent Banner",value:KC},{label:"Grinch",value:W3},{label:"Mistletoe",value:V3},{label:"Rook",value:H3},{label:"Santa",value:q3},{label:"Snowman",value:K3},{label:"Tree",value:Q3}],U1=["Emerald King","Sapphire Queen","Ruby Rook","Amber Bishop","Onyx Knight","Ivory Pawn"];function G3(){const{user:n,setUser:e}=pr(),[t,r]=D.useState(z1()),a=D.useMemo(()=>24-Math.max(0,t.days),[t.days]),[d,h]=D.useState({}),[g,y]=D.useState(!1),[_,N]=D.useState(null),[T,k]=D.useState({}),[$,M]=D.useState({type:"pfp",value:$p[0].value}),[F,H]=D.useState(null),[ye,le]=D.useState(()=>{try{const te=localStorage.getItem("advent_unlocked_videos");return te?JSON.parse(te):{}}catch{return{}}}),[C,ie]=D.useState(()=>{try{const te=localStorage.getItem("advent_claimed_days");return te?new Set(JSON.parse(te)):new Set}catch{return new Set}});D.useEffect(()=>{const te=setInterval(()=>r(z1()),1e3);return()=>clearInterval(te)},[]),D.useEffect(()=>{(async()=>{try{const ee=await Ic(Dn(Ln,"adventGifts"));ee.exists()&&k(ee.val())}catch(ee){console.warn("Failed to load advent gifts",ee)}})()},[]);const c=n?.totalXp??0,ze=n?.pawns??0,de=Math.floor(c/25),Ie=!!n?.isAdmin,Je=(te,ee)=>ee?.type==="video"?ye[te]||ee.value:"",Qe=te=>{te&&window.open(te,"_blank","noopener,noreferrer")},Ve=te=>{ie(ee=>{if(ee.has(te))return ee;const Y=new Set(ee);return Y.add(te),localStorage.setItem("advent_claimed_days",JSON.stringify(Array.from(Y))),Y})},$e=async(te,ee)=>{if(!n)return;let Y=ee;try{const we=await Fj(n.id,ee);we&&e(we),ee.type==="video"&&ee.value&&le(ne=>{const X={...ne,[te]:ee.value};return localStorage.setItem("advent_unlocked_videos",JSON.stringify(X)),X}),Y=ee.type==="video"?{...ee,value:Je(te,ee)}:ee}catch(we){console.warn("Failed to unlock gift",we)}finally{Ve(te),H({day:te,gift:Y})}},be=async(te,ee,Y)=>{if(!n)return;const we=Y||T[te]||{type:"pawns",value:ee};if(C.has(te)){h(ce=>({...ce,[te]:!0})),H({day:te,gift:we.type==="video"?{...we,value:Je(te,we)}:we});return}if((n.pawns||0)<ee){alert("Not enough pawns to unlock this reward.");return}const ne=(n.pawns||0)-ee,X={...n,pawns:ne};e(X),localStorage.setItem("pawnpoint_user",JSON.stringify(X));try{await vc(Dn(Ln,`users/${n.id}`),X)}catch(ce){console.warn("Failed to update pawns after purchase",ce)}h(ce=>({...ce,[te]:!0})),await $e(te,we)};return p.jsx(Ar,{children:p.jsxs("div",{className:"relative w-full min-h-screen overflow-hidden",children:[p.jsx("div",{className:"fixed inset-0 -z-10",style:{backgroundImage:`url(${WC})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),p.jsxs("div",{className:"relative flex flex-col items-center gap-6 px-4 pb-12 pt-12",children:[p.jsxs("div",{className:"absolute right-4 top-4 flex items-center gap-2 rounded-full bg-white/10 border border-white/15 px-4 py-2 text-white shadow-lg",children:[p.jsx("img",{src:Hp,alt:"Pawn counter",className:"h-6 w-6 object-contain"}),p.jsxs("div",{className:"text-sm font-semibold",children:[ze," Pawns"]})]}),p.jsx("div",{className:"w-full max-w-5xl flex flex-col gap-2",children:p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("img",{src:Hp,alt:"Christmas Pawn",className:"h-16 w-16 object-contain"}),p.jsxs("div",{className:"text-left text-white",children:[p.jsx("div",{className:"text-lg font-semibold",children:"Welcome to the Pawn Point Advent Calendar!"}),p.jsx("div",{className:"text-sm text-white/80",children:"Every day leading up to Christmas, you can open a new tile and unlock a special holiday-themed cosmetic, surprise reward, or limited-edition item. Check back daily to discover what the South Knight has prepared for youyour festive journey begins now!"})]})]})}),p.jsxs("div",{className:"w-full max-w-5xl rounded-3xl bg-slate-900 border border-white/10 shadow-2xl overflow-hidden relative mx-auto",children:[p.jsx("img",{src:KC,alt:"Advent Calendar",className:"w-full h-full object-contain"}),p.jsx("div",{className:"absolute inset-4 grid grid-cols-6 grid-rows-4 gap-1.5 p-1 pointer-events-none",children:Array.from({length:24}).map((te,ee)=>{const Y=ee+1,we=Y<=a,ne=d[Y]||C.has(Y),X=Y*10,ce=T[Y];return p.jsxs("div",{className:`reward-card relative rounded-lg bg-black/45 backdrop-blur-sm border border-white/10 flex flex-col items-center justify-center gap-2 text-white font-semibold text-sm pointer-events-auto transition-transform duration-500 ${ne?"rotate-y-180":""}`,style:{transformStyle:"preserve-3d"},onClick:()=>{ne||(we||Ie)&&(h(R=>({...R,[Y]:!0})),ce&&$e(Y,ce))},children:[Ie&&p.jsx("button",{className:"absolute right-1.5 top-1.5 h-7 w-7 rounded-full bg-white/20 hover:bg-white/30 flex items-center justify-center",onClick:R=>{R.stopPropagation(),N(Y),M(T[Y]||{type:"pfp",value:$p[0].value})},"aria-label":"Edit gift",children:p.jsx(P0,{className:"h-4 w-4"})}),ne?p.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 w-full h-full bg-gradient-to-br from-[#3b0b47] via-[#4c0c58] to-[#2b0a38] rounded-lg relative p-2 text-center",style:{transform:"rotateY(180deg)"},children:[p.jsx("button",{className:"absolute right-2 top-2 text-white/80 hover:text-white text-sm",onClick:R=>{R.preventDefault(),R.stopPropagation(),h(q=>({...q,[Y]:!1}))},"aria-label":"Close reward",children:""}),p.jsx("img",{src:QC,alt:"Gift",className:"h-20 w-20 md:h-24 md:w-24 object-contain drop-shadow-[0_12px_24px_rgba(255,180,80,0.75)] animate-bounce"}),p.jsxs("div",{className:"space-y-1 text-xs text-white/80",children:[p.jsx("div",{className:"font-semibold text-sm text-white",children:"Reward"}),p.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-full bg-gradient-to-r from-amber-300 to-orange-500 px-4 py-1.5 text-xs font-semibold text-[#2b0b38] shadow-md hover:shadow-lg",onClick:async R=>{R.preventDefault(),R.stopPropagation(),!(!we&&!Ie)&&await be(Y,X,ce)},children:`${X} Pawns`}),ce&&p.jsxs("div",{className:"text-[11px] text-white/80",children:["Unlocked: ",B1(ce)]}),ce?.type==="video"&&Je(Y,ce)&&p.jsx(it,{size:"sm",className:"mt-1 bg-emerald-500 text-slate-900 hover:bg-emerald-400",onClick:R=>{R.preventDefault(),R.stopPropagation(),Qe(Je(Y,ce))},children:"Watch Video"})]})]}):p.jsxs("div",{className:"flex flex-col items-center gap-2 py-3 px-2",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[we?p.jsx(AE,{className:"h-4 w-4 text-emerald-300"}):p.jsx(hx,{className:"h-4 w-4 text-white/80"}),p.jsx("span",{children:Y})]}),(we||Ie)&&p.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded-md bg-emerald-500 hover:bg-emerald-400 text-black font-semibold relative z-10",onClick:async R=>{R.preventDefault(),R.stopPropagation(),!(!we&&!Ie)&&await be(Y,X,ce)},children:"Redeem"}),ce&&Ie&&p.jsxs("div",{className:"text-[10px] text-white/70 flex items-center gap-1",children:[p.jsx(I0,{className:"h-3 w-3 text-emerald-300"}),p.jsx("span",{children:B1(ce)})]})]})]},ee)})})]}),p.jsx("button",{type:"button",className:"mt-2 inline-flex items-center justify-center rounded-xl bg-emerald-500 px-5 py-2 text-sm font-semibold text-slate-900 shadow-lg hover:bg-emerald-400 focus:outline-none focus:ring-2 focus:ring-emerald-300",onClick:()=>y(!0),children:"Cash in XP"})]}),g&&p.jsx("div",{className:"fixed inset-0 z-30 flex items-center justify-center bg-black/60 px-4",children:p.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-slate-900 text-white border border-white/10 shadow-2xl p-6 space-y-4",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-lg font-semibold",children:"Cash in XP"}),p.jsx("div",{className:"text-sm text-white/70",children:"Convert your XP into Pawns (25 XP = 1 Pawn)"})]}),p.jsx("button",{className:"h-9 w-9 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center",onClick:()=>y(!1),"aria-label":"Close",children:""})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-white/5 border border-white/10 px-4 py-3",children:[p.jsx("div",{className:"text-sm text-white/70",children:"Your XP"}),p.jsxs("div",{className:"text-lg font-semibold text-white",children:[c," XP"]})]}),p.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-white/5 border border-white/10 px-4 py-3",children:[p.jsxs("div",{className:"flex items-center gap-2 text-sm text-white/70",children:[p.jsx("img",{src:Hp,alt:"Pawn",className:"h-6 w-6 object-contain"}),p.jsx("span",{children:"Pawns you can claim"})]}),p.jsx("div",{className:"text-lg font-semibold text-white",children:de})]})]}),p.jsx("div",{className:"text-xs text-white/60",children:"Pawns are calculated from your current XP. Check back after earning more XP to claim additional Pawns."}),p.jsxs("div",{className:"flex justify-between items-center gap-3",children:[p.jsx("button",{className:"rounded-lg bg-amber-400 px-4 py-2 text-sm font-semibold text-slate-900 hover:bg-amber-300 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!n||de<=0,onClick:async()=>{if(!n||de<=0)return;const te=await _j(n.id);te&&e(ee=>ee&&{...ee,pawns:(ee.pawns||0)+te.pawnsAdded,totalXp:te.remainingXp,level:Math.floor(te.remainingXp/100)+1})},children:"Claim Now!"}),p.jsx("button",{className:"rounded-lg bg-emerald-500 px-4 py-2 text-sm font-semibold text-slate-900 hover:bg-emerald-400",onClick:()=>y(!1),children:"Close"})]})]})}),_!==null&&Ie&&p.jsx("div",{className:"fixed inset-0 z-40 flex items-start justify-center bg-black/60 px-4 py-10 overflow-y-auto",children:p.jsxs("div",{className:"w-full max-w-2xl rounded-2xl bg-slate-900 text-white border border-white/10 shadow-2xl p-6 space-y-4",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"text-lg font-semibold",children:["Edit Gift for Day ",_]}),p.jsx("div",{className:"text-sm text-white/70",children:"Choose what users receive when they open this tile."})]}),p.jsx("button",{className:"h-9 w-9 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center",onClick:()=>N(null),"aria-label":"Close gift editor",children:"-"})]}),p.jsxs("div",{className:"grid sm:grid-cols-2 gap-3 text-sm",children:[p.jsxs("label",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/5 px-3 py-2 cursor-pointer",children:[p.jsx("input",{type:"radio",name:"gift-type",checked:$.type==="pfp",onChange:()=>M({type:"pfp",value:$p[0].value}),className:"accent-emerald-400"}),p.jsx(TE,{className:"h-4 w-4 text-emerald-300"}),p.jsx("span",{children:"Profile Picture"})]}),p.jsxs("label",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/5 px-3 py-2 cursor-pointer",children:[p.jsx("input",{type:"radio",name:"gift-type",checked:$.type==="tagline",onChange:()=>M({type:"tagline",value:""}),className:"accent-emerald-400"}),p.jsx(WE,{className:"h-4 w-4 text-emerald-300"}),p.jsx("span",{children:"Special Tagline"})]}),p.jsxs("label",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/5 px-3 py-2 cursor-pointer",children:[p.jsx("input",{type:"radio",name:"gift-type",checked:$.type==="piece",onChange:()=>M({type:"piece",value:U1[0]}),className:"accent-emerald-400"}),p.jsx(kE,{className:"h-4 w-4 text-emerald-300"}),p.jsx("span",{children:"Chess Piece Cosmetic"})]}),p.jsxs("label",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/5 px-3 py-2 cursor-pointer",children:[p.jsx("input",{type:"radio",name:"gift-type",checked:$.type==="video",onChange:()=>M({type:"video",value:""}),className:"accent-emerald-400"}),p.jsx(HE,{className:"h-4 w-4 text-emerald-300"}),p.jsx("span",{children:"Video"})]})]}),$.type==="pfp"&&p.jsxs("div",{className:"space-y-2",children:[p.jsx("div",{className:"text-sm text-white/70",children:"Select profile picture"}),p.jsx("div",{className:"grid grid-cols-3 gap-3",children:$p.map(te=>p.jsxs("button",{className:`relative rounded-xl border px-2 py-2 bg-white/5 hover:bg-white/10 ${$.value===te.value?"border-emerald-400 ring-2 ring-emerald-300/60":"border-white/10"}`,onClick:()=>M({type:"pfp",value:te.value}),children:[p.jsx("img",{src:te.value,alt:te.label,className:"h-16 w-full object-cover rounded-lg"}),p.jsx("div",{className:"mt-1 text-xs text-white/80 text-center",children:te.label})]},te.value))})]}),$.type==="tagline"&&p.jsxs("div",{className:"space-y-2",children:[p.jsx("div",{className:"text-sm text-white/70",children:"Custom tagline"}),p.jsx("input",{className:"w-full rounded-xl bg-white/5 border border-white/10 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-emerald-400",placeholder:'e.g. "The Calculator"',value:$.value,onChange:te=>M({type:"tagline",value:te.target.value})})]}),$.type==="piece"&&p.jsxs("div",{className:"space-y-2",children:[p.jsx("div",{className:"text-sm text-white/70",children:"Select chess piece cosmetic"}),p.jsx("div",{className:"grid grid-cols-2 gap-2",children:U1.map(te=>p.jsx("button",{className:`rounded-xl border px-3 py-2 text-left text-sm ${$.value===te?"border-emerald-400 bg-emerald-400/10":"border-white/10 bg-white/5"}`,onClick:()=>M({type:"piece",value:te}),children:te},te))})]}),$.type==="video"&&p.jsxs("div",{className:"space-y-2",children:[p.jsx("div",{className:"text-sm text-white/70",children:"Video URL (MP4 or stream link)"}),p.jsx("input",{className:"w-full rounded-xl bg-white/5 border border-white/10 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-emerald-400",placeholder:"https://...",value:$.value,onChange:te=>M({type:"video",value:te.target.value})})]}),p.jsxs("div",{className:"flex justify-end gap-2",children:[p.jsx(it,{variant:"ghost",onClick:()=>N(null),children:"Cancel"}),p.jsx(it,{onClick:()=>{_!==null&&(k(te=>({...te,[_]:$})),(async()=>{try{await vc(Dn(Ln,`adventGifts/${_}`),$)}catch(te){console.warn("Failed to persist gift config",te)}finally{N(null)}})())},children:"Save Gift"})]})]})}),F&&p.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/70 px-4",children:p.jsxs("div",{className:"w-full max-w-lg rounded-2xl bg-slate-900 text-white border border-white/10 shadow-2xl p-6 space-y-4",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"text-lg font-semibold",children:["You unlocked Day ",F.day]}),p.jsx("div",{className:"text-sm text-white/70",children:"Enjoy your new reward!"})]}),p.jsx("button",{className:"h-9 w-9 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center",onClick:()=>H(null),"aria-label":"Close",children:"-"})]}),F.gift.type==="pfp"&&p.jsxs("div",{className:"space-y-3 text-sm",children:[p.jsx("div",{className:"text-white/80",children:"Profile Picture unlocked."}),p.jsx("img",{src:F.gift.value,alt:"Unlocked avatar",className:"h-32 w-32 rounded-full object-cover border border-white/10 shadow-lg mx-auto"}),p.jsx("div",{className:"text-white/70 text-sm text-center",children:"Equip it from My Profile."})]}),F.gift.type==="tagline"&&p.jsxs("div",{className:"space-y-3 text-sm",children:[p.jsx("div",{className:"text-white/80",children:"New tagline unlocked:"}),p.jsx("div",{className:"rounded-xl bg-white/5 border border-white/10 px-4 py-3 text-center text-emerald-200 font-semibold",children:F.gift.value||"New Tagline"}),p.jsx("div",{className:"text-white/70 text-sm text-center",children:"Manage taglines in My Profile."})]}),F.gift.type==="video"&&p.jsxs("div",{className:"space-y-3 text-sm",children:[p.jsx("div",{className:"text-white/80",children:"Video unlocked:"}),F.gift.value?p.jsx(it,{className:"bg-emerald-500 text-slate-900 hover:bg-emerald-400",onClick:()=>Qe(F.gift.value),children:"Watch Video"}):p.jsx("div",{className:"text-white/60",children:"No video URL provided."}),p.jsx("div",{className:"text-white/70 text-sm text-center",children:"You can rewatch from this tile anytime."})]}),F.gift.type==="piece"&&p.jsxs("div",{className:"space-y-3 text-sm",children:[p.jsx("div",{className:"text-white/80",children:"Chess set unlocked:"}),p.jsx("div",{className:"rounded-xl bg-white/5 border border-white/10 px-4 py-3 text-center text-emerald-200 font-semibold",children:F.gift.value||"New Chess Set"}),p.jsx("div",{className:"text-white/70 text-sm text-center",children:"Available in Board Customisation."})]}),p.jsx("div",{className:"flex justify-end",children:p.jsx(it,{onClick:()=>H(null),children:"Close"})})]})})]})})}function z1(){const n=new Date,e=new Date(n.getFullYear(),11,25,0,0,0),t=n.getTime()+n.getTimezoneOffset()*6e4,r=7200*1e3,a=t+r,d=e.getTime()-a,h=Math.max(0,Math.floor(d/1e3)),g=Math.floor(h/86400),y=Math.floor(h%86400/3600),_=Math.floor(h%3600/60),N=h%60;return{days:g,hours:y,minutes:_,seconds:N}}function B1(n){switch(n.type){case"pfp":return"Profile Picture";case"tagline":return n.value?`Tagline: ${n.value}`:"Tagline";case"piece":return n.value||"Chess Piece";case"video":return"Video Reward";case"pawns":return`${n.value} Pawns`;default:return"Reward"}}const Y3="/assets/Snowflake%20Background-Cas1sPFf.png";function X3(){const{user:n,setUser:e}=pr(),[,t]=Ko(),[r,a]=D.useState(!1),[d,h]=D.useState(n?.avatarUrl||xm),{data:g}=Cd({queryKey:["profile",n?.id],enabled:!!n,queryFn:()=>zC(n)}),y=n?.totalXp||0,_=n?.level||1,N=n?.streak||0;n?.unlockedPfps;const T=n?.unlockedTaglines||[],[k,$]=D.useState(n?.taglinesEnabled??!0),[M,F]=D.useState(n?.selectedTagline||""),H=[{id:"south",label:"South Knight",url:xm},{id:"pink",label:"Sunrise",url:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200'><defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'><stop stop-color='%23ff6b9a' offset='0%' /><stop stop-color='%23ffb347' offset='100%' /></linearGradient></defs><rect width='200' height='200' rx='100' fill='url(%23g)'/><text x='50%' y='54%' dominant-baseline='middle' text-anchor='middle' font-size='96' font-family='Segoe UI Emoji'></text></svg>"},{id:"mint",label:"Minty",url:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200'><defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='0'><stop stop-color='%2322d3ee' offset='0%' /><stop stop-color='%2322c55e' offset='100%' /></linearGradient></defs><rect width='200' height='200' rx='100' fill='url(%23g)'/><text x='50%' y='54%' dominant-baseline='middle' text-anchor='middle' font-size='96' font-family='Segoe UI Emoji'></text></svg>"},{id:"violet",label:"Night",url:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200'><defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'><stop stop-color='%237c3aed' offset='0%' /><stop stop-color='%230ea5e9' offset='100%' /></linearGradient></defs><rect width='200' height='200' rx='100' fill='url(%23g)'/><text x='50%' y='54%' dominant-baseline='middle' text-anchor='middle' font-size='96' font-family='Segoe UI Emoji'></text></svg>"},{id:"aqua",label:"Aqua",url:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200'><defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='0'><stop stop-color='%230ea5e9' offset='0%' /><stop stop-color='%233b82f6' offset='100%' /></linearGradient></defs><rect width='200' height='200' rx='100' fill='url(%23g)'/><text x='50%' y='54%' dominant-baseline='middle' text-anchor='middle' font-size='96' font-family='Segoe UI Emoji'></text></svg>"},{id:"rose",label:"Rose",url:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200'><defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'><stop stop-color='%23ec4899' offset='0%' /><stop stop-color='%23a855f7' offset='100%' /></linearGradient></defs><rect width='200' height='200' rx='100' fill='url(%23g)'/><text x='50%' y='54%' dominant-baseline='middle' text-anchor='middle' font-size='96' font-family='Segoe UI Emoji'></text></svg>"},{id:"mono",label:"Classic",url:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200'><defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'><stop stop-color='%234b5563' offset='0%' /><stop stop-color='%239ca3af' offset='100%' /></linearGradient></defs><rect width='200' height='200' rx='100' fill='url(%23g)'/><text x='50%' y='54%' dominant-baseline='middle' text-anchor='middle' font-size='96' font-family='Segoe UI Emoji'></text></svg>"}],ye=le=>{if(h(le),n){const C={...n,avatarUrl:le};localStorage.setItem("pawnpoint_user",JSON.stringify(C)),e(C)}a(!1)};return D.useEffect(()=>{n?.avatarUrl&&h(n.avatarUrl),$(n?.taglinesEnabled??!0),F(n?.selectedTagline||"")},[n?.avatarUrl,n?.taglinesEnabled,n?.selectedTagline]),D.useEffect(()=>{if(!M&&T.length){const le=T[0];F(le)}},[T,M]),n?p.jsx(Ar,{children:p.jsxs("div",{className:"flex flex-col gap-6",children:[p.jsxs("div",{className:"relative overflow-hidden rounded-3xl border border-white/10 bg-slate-900 shadow-2xl",children:[p.jsx("img",{src:Y3,alt:"",className:"absolute inset-0 h-full w-full object-cover opacity-50 pointer-events-none"}),p.jsxs("div",{className:"relative z-10 flex flex-col lg:flex-row lg:items-center gap-6 p-6",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("div",{className:"relative h-24 w-24 rounded-full overflow-hidden border-4 border-white/40 shadow-lg",children:[p.jsx("img",{src:d,alt:"Avatar",className:"h-full w-full object-cover"}),p.jsx("button",{onClick:()=>a(!0),className:"absolute bottom-1 right-1 h-8 w-8 rounded-full bg-white/80 text-slate-900 flex items-center justify-center shadow-lg hover:bg-white transition","aria-label":"Change profile picture",children:p.jsx(P0,{className:"h-4 w-4"})})]}),p.jsxs("div",{className:"space-y-1 text-white",children:[p.jsx("div",{className:"text-2xl font-bold",children:n.chessUsername||n.displayName}),k&&M&&p.jsx("div",{className:"text-xs text-white/70 max-w-xs overflow-hidden text-ellipsis whitespace-nowrap",children:M}),p.jsx("div",{className:"text-sm text-white/80",children:n.email}),p.jsxs("div",{className:"text-sm text-white/70",children:["Member since"," ",n.createdAt?new Date(n.createdAt).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"your start date"]}),p.jsxs("div",{className:"text-sm text-white/70",children:["Chess.com: ",n.chessUsername||"Not linked"]})]})]}),p.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-3 justify-start lg:justify-end",children:[p.jsxs("div",{className:"rounded-full bg-cyan-500/20 text-cyan-100 border border-cyan-400/40 px-3 py-1 text-sm",children:["Current Streak: ",N," days"]}),p.jsx(it,{variant:"outline",onClick:()=>t("/settings"),children:"Settings"}),p.jsx(it,{variant:"ghost",onClick:()=>t("/dashboard"),children:"Back to Dashboard"})]})]})]}),p.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[p.jsx(Mi,{children:p.jsxs(Di,{className:"flex items-center gap-3 py-4",children:[p.jsx("div",{className:"h-11 w-11 rounded-xl bg-emerald-500/20 border border-emerald-400/40 flex items-center justify-center text-emerald-200 font-semibold",children:""}),p.jsxs("div",{children:[p.jsx("div",{className:"text-xl font-bold text-white",children:y}),p.jsx("div",{className:"text-sm text-white/70",children:"Total XP"})]})]})}),p.jsx(Mi,{children:p.jsxs(Di,{className:"flex items-center gap-3 py-4",children:[p.jsx("div",{className:"h-11 w-11 rounded-xl bg-indigo-500/20 border border-indigo-400/40 flex items-center justify-center text-indigo-200 font-semibold",children:""}),p.jsxs("div",{children:[p.jsx("div",{className:"text-xl font-bold text-white",children:_}),p.jsx("div",{className:"text-sm text-white/70",children:"Level"})]})]})})]}),r&&p.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/70 px-4",children:p.jsxs("div",{className:"w-full max-w-3xl rounded-2xl bg-slate-900 text-white border border-white/10 shadow-2xl p-6 space-y-4",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("div",{className:"text-xl font-semibold",children:"Change Profile Picture"}),p.jsx("div",{className:"text-sm text-white/70",children:"Select the picture you want to use for your profile"})]}),p.jsx("button",{className:"h-10 w-10 rounded-full bg-white/10 flex items-center justify-center hover:bg-white/20 transition",onClick:()=>a(!1),"aria-label":"Close",children:p.jsx(La,{className:"h-5 w-5"})})]}),p.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:H.map(le=>{const C=d===le.url;return p.jsxs("button",{onClick:()=>ye(le.url),className:`relative rounded-full p-1 border aspect-square ${C?"border-emerald-400 ring-2 ring-emerald-400/60":"border-transparent"} hover:border-white/30 transition`,style:{width:"6rem",height:"6rem"},children:[p.jsx("img",{src:le.url,alt:le.label,className:"h-full w-full rounded-full object-cover"}),C&&p.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-emerald-300 pointer-events-none"})]},le.id)})}),p.jsx("div",{className:"flex justify-end",children:p.jsx(it,{variant:"outline",onClick:()=>a(!1),children:"Close"})})]})})]})}):null}function Ei({children:n}){const{user:e,loading:t}=pr(),[,r]=Ko();return D.useEffect(()=>{!t&&!e&&r("/login")},[t,e,r]),t?p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-white/70",children:"Loading..."}):e?n:(r("/login"),p.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-white/70",children:"Redirecting to login..."}))}function J3(){return p.jsxs(pE,{children:[p.jsx(Ls,{path:"/",component:GE}),p.jsx(Ls,{path:"/login",component:()=>p.jsx(_1,{mode:"login"})}),p.jsx(Ls,{path:"/signup",component:()=>p.jsx(_1,{mode:"signup"})}),p.jsx(Ls,{path:"/dashboard",children:()=>p.jsx(Ei,{children:p.jsx(Vj,{})})}),p.jsx(Ls,{path:"/courses",children:()=>p.jsx(Ei,{children:p.jsx(Hj,{})})}),p.jsx(Ls,{path:"/courses/:id",children:n=>p.jsx(Ei,{children:p.jsx(Kj,{id:n.id})})}),p.jsx(Ls,{path:"/lesson",children:()=>p.jsx(Ei,{children:p.jsx(M1,{})})}),p.jsx(Ls,{path:"/lesson/:id",children:n=>p.jsx(Ei,{children:p.jsx(M1,{id:n.id})})}),p.jsx(Ls,{path:"/leaderboard",children:()=>p.jsx(Ei,{children:p.jsx(Qj,{})})}),p.jsx(Ls,{path:"/advent",children:()=>p.jsx(Ei,{children:p.jsx(G3,{})})}),p.jsx(Ls,{path:"/practice",component:k3}),p.jsx(Ls,{path:"/profile",children:()=>p.jsx(Ei,{children:p.jsx(X3,{})})}),p.jsx(Ls,{path:"/settings",children:()=>p.jsx(Ei,{children:p.jsx(D3,{})})}),p.jsx(Ls,{component:S3})]})}function Z3(){return p.jsx(Wj,{children:p.jsx(J3,{})})}const e4=new $S({defaultOptions:{queries:{refetchOnWindowFocus:!1,staleTime:1e3*60*5}}});dS.createRoot(document.getElementById("root")).render(p.jsx(V1.StrictMode,{children:p.jsx(OS,{client:e4,children:p.jsx(Z3,{})})}));
